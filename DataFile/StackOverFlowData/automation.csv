Title,Description,Views,Votes,Answers
automatically execute an Excel macro on a cell change,"
How can I automatically execute an Excel macro each time a value in a particular cell changes?
Right now, my working code is:
Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range(""H5"")) Is Nothing Then Macro
End Sub

where ""H5"" is the particular cell being monitored and Macro is the name of the macro.
Is there a better way?
",526k,"
            98
        ","['\nYour code looks pretty good.\nBe careful, however, for your call to Range(""H5"") is a shortcut command to Application.Range(""H5""), which is equivalent to Application.ActiveSheet.Range(""H5""). This could be fine, if the only changes are user-changes -- which is the most typical -- but it is possible for the worksheet\'s cell values to change when it is not the active sheet via programmatic changes, e.g. VBA.\nWith this in mind, I would utilize Target.Worksheet.Range(""H5""):\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Target.Worksheet.Range(""H5"")) Is Nothing Then Macro\nEnd Sub\n\nOr you can use Me.Range(""H5""), if the event handler is on the code page for the worksheet in question (it usually is):\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(""H5"")) Is Nothing Then Macro\nEnd Sub\n\n', '\nI spent a lot of time researching this and learning how it all works, after really messing up the event triggers. Since there was so much scattered info I decided to share what I have found to work all in one place, step by step as follows:\n1) Open VBA Editor, under VBA Project (YourWorkBookName.xlsm) open Microsoft Excel Object and select the Sheet to which the change event will pertain.\n2) The default code view is ""General."" From the drop-down list at the top middle, select ""Worksheet.""\n3) Private Sub Worksheet_SelectionChange is already there as it should be, leave it alone. Copy/Paste Mike Rosenblum\'s code from above and change the .Range reference to the cell for which you are watching for a change (B3, in my case). Do not place your Macro yet, however (I removed the word ""Macro"" after ""Then""):\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(""H5"")) Is Nothing Then\nEnd Sub\n\nor from the drop-down list at the top left, select ""Change"" and in the space between Private Sub and End Sub, paste If Not Intersect(Target, Me.Range(""H5"")) Is Nothing Then\n4) On the line after ""Then"" turn off events so that when you call your macro, it does not trigger events and try to run this Worksheet_Change again in a never ending cycle that crashes Excel and/or otherwise messes everything up:\nApplication.EnableEvents = False\n\n5) Call your macro\nCall YourMacroName\n\n6) Turn events back on so the next change (and any/all other events) trigger:\nApplication.EnableEvents = True\n\n7) End the If block and the Sub:\n    End If\nEnd Sub\n\nThe entire code:\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Me.Range(""B3"")) Is Nothing Then\n        Application.EnableEvents = False\n        Call UpdateAndViewOnly\n        Application.EnableEvents = True\n    End If\nEnd Sub\n\nThis takes turning events on/off out of the Modules which creates problems and simply lets the change trigger, turns off events, runs your macro and turns events back on.\n', '\nHandle the Worksheet_Change event or the Workbook_SheetChange event.\nThe event handlers take an argument ""Target As Range"", so you can check if the range that\'s changing includes the cell you\'re interested in.\n', '\nI prefer this way, not using a cell but a range\n    Dim cell_to_test As Range, cells_changed As Range\n\n    Set cells_changed = Target(1, 1)\n    Set cell_to_test = Range( RANGE_OF_CELLS_TO_DETECT )\n\n    If Not Intersect(cells_changed, cell_to_test) Is Nothing Then \n       Macro\n    End If\n\n', '\nI have a cell which is linked to online stock database and updated frequently. I want to trigger a macro whenever the cell value is updated.\nI believe this is similar to cell value change by a program or any external data update but above examples somehow do not work for me. I think the problem is because excel internal events are not triggered, but thats my guess.\nI did the following,\nPrivate Sub Worksheet_Change(ByVal Target As Range) \n  If Not Intersect(Target, Target.Worksheets(""Symbols"").Range(""$C$3"")) Is Nothing Then\n   \'Run Macro\nEnd Sub\n\n']"
Switch tabs using Selenium WebDriver with Java,"
Using Selenium WebDriver with Java.
I am trying to automate a functionality where I have to open a new tab do some operations there and come back to previous tab (Parent).
I used switch handle but it's not working.
And one strange thing the two tabs are having same window handle due to which I am not able to switch between tabs.
However when I am trying with different Firefox windows it works, but for tab it's not working.
How can I switch tabs?
Or, how can I switch tabs without using window handle as window handle is same of both tabs in my case?
(I have observed that when you open different tabs in same window, window handle remains same)
",384k,"
            75
        ","['\n    psdbComponent.clickDocumentLink();\n    ArrayList<String> tabs2 = new ArrayList<String> (driver.getWindowHandles());\n    driver.switchTo().window(tabs2.get(1));\n    driver.close();\n    driver.switchTo().window(tabs2.get(0));\n\nThis code perfectly worked for me. Try it out. You always need to switch your driver to new tab, before you want to do something on new tab.\n', '\nThis is a simple solution for opening a new tab, changing focus to it, closing the tab and return focus to the old/original tab:\n@Test\npublic void testTabs() {\n    driver.get(""https://business.twitter.com/start-advertising"");\n    assertStartAdvertising();\n\n    // considering that there is only one tab opened in that point.\n    String oldTab = driver.getWindowHandle();\n    driver.findElement(By.linkText(""Twitter Advertising Blog"")).click();\n    ArrayList<String> newTab = new ArrayList<String>(driver.getWindowHandles());\n    newTab.remove(oldTab);\n    // change focus to new tab\n    driver.switchTo().window(newTab.get(0));\n    assertAdvertisingBlog();\n\n    // Do what you want here, you are in the new tab\n\n    driver.close();\n    // change focus back to old tab\n    driver.switchTo().window(oldTab);\n    assertStartAdvertising();\n\n    // Do what you want here, you are in the old tab\n}\n\nprivate void assertStartAdvertising() {\n    assertEquals(""Start Advertising | Twitter for Business"", driver.getTitle());\n}\n\nprivate void assertAdvertisingBlog() {\n    assertEquals(""Twitter Advertising"", driver.getTitle());\n}\n\n', '\nThere is a difference how web driver handles different windows and how it handles different tabs.\nCase 1:\nIn case there are multiple windows, then the following code can help:\n//Get the current window handle\nString windowHandle = driver.getWindowHandle();\n\n//Get the list of window handles\nArrayList tabs = new ArrayList (driver.getWindowHandles());\nSystem.out.println(tabs.size());\n//Use the list of window handles to switch between windows\ndriver.switchTo().window(tabs.get(0));\n\n//Switch back to original window\ndriver.switchTo().window(mainWindowHandle);\n\n\nCase 2:\nIn case there are multiple tabs in the same window, then there is only one window handle. Hence switching between window handles keeps the control in the same tab. In this case using Ctrl + \\t (Ctrl + Tab) to switch between tabs is more useful.\n//Open a new tab using Ctrl + t\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL +""t"");\n//Switch between tabs using Ctrl + \\t\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL +""\\t"");\n\nDetailed sample code can be found here:\nhttp://design-interviews.blogspot.com/2014/11/switching-between-tabs-in-same-browser-window.html\n', '\nWork around\nAssumption : By Clicking something on your web page leads to open a new tab.\nUse below logic to switch to second tab.\nnew Actions(driver).sendKeys(driver.findElement(By.tagName(""html"")), Keys.CONTROL).sendKeys(driver.findElement(By.tagName(""html"")),Keys.NUMPAD2).build().perform();\n\nIn the same manner you can switch back to first tab again.\nnew Actions(driver).sendKeys(driver.findElement(By.tagName(""html"")), Keys.CONTROL).sendKeys(driver.findElement(By.tagName(""html"")),Keys.NUMPAD1).build().perform();\n\n', '\nSince the driver.window_handles is not in order , a better solution is this.\n\nfirst switch to the first tab using the shortcut Control + X to switch to the \'x\' th tab in the browser window .\n\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + ""1"");\n# goes to 1st tab\n\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + ""4"");\n# goes to 4th tab if its exists or goes to last tab.\n\n', '\nString selectLinkOpeninNewTab = Keys.chord(Keys.CONTROL, Keys.RETURN);\n    WebElement e = driver.findElement(By\n            .xpath(""html/body/header/div/div[1]/nav/a""));\ne.sendKeys(selectLinkOpeninNewTab);//to open the link in a current page in to the browsers new tab\n\n    e.sendKeys(Keys.CONTROL + ""\\t"");//to move focus to next tab in same browser\n    try {\n        Thread.sleep(8000);\n    } catch (InterruptedException e1) {\n        // TODO Auto-generated catch block\n        e1.printStackTrace();\n    }\n    //to wait some time in that tab\n    e.sendKeys(Keys.CONTROL + ""\\t"");//to switch the focus to old tab again\n\nHope it helps to you..\n', '\nThe first thing you need to do is opening a new tab and save it\'s handle name. It will be best to do it using javascript and not keys(ctrl+t) since keys aren\'t always available on automation servers. example:\npublic static String openNewTab(String url) {\n    executeJavaScript(""window.parent = window.open(\'parent\');"");\n    ArrayList<String> tabs = new ArrayList<String>(bot.driver.getWindowHandles());\n    String handleName = tabs.get(1);\n    bot.driver.switchTo().window(handleName);\n    System.setProperty(""current.window.handle"", handleName);\n    bot.driver.get(url);\n    return handleName;\n}\n\nThe second thing you need to do is switching between the tabs. Doing it by switch window handles only, will not always work since the tab you\'ll work on, won\'t always be in focus and Selenium will fail from time to time.\nAs I said, it\'s a bit problematic to use keys, and javascript doesn\'t really support switching tabs, so I used alerts to switch tabs and it worked like a charm:\npublic static void switchTab(int tabNumber, String handleName) {\n        driver.switchTo().window(handleName);\n        System.setProperty(""current.window.handle"", handleName);\n        if (tabNumber==1)\n            executeJavaScript(""alert(\\""alert\\"");"");\n        else\n            executeJavaScript(""parent.alert(\\""alert\\"");"");\n        bot.wait(1000);\n        driver.switchTo().alert().accept();\n    }\n\n', '\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL,Keys.SHIFT,Keys.TAB);\n\nThis method helps in switching between multiple windows. The restricting problem with this method is that it can only be used so many times until the required window is reached. Hope it helps.\n', '\nWith Selenium 2.53.1 using firefox 47.0.1 as the WebDriver in Java: no matter how many tabs I opened, ""driver.getWindowHandles()"" would only return one handle so it was impossible to switch between tabs.\nOnce I started using Chrome 51.0, I could get all handles.  The following code show how to access multiple drivers and multiple tabs within each driver.\n// INITIALIZE TWO DRIVERS (THESE REPRESENT SEPARATE CHROME WINDOWS)\ndriver1 = new ChromeDriver();\ndriver2 = new ChromeDriver();\n\n// LOOP TO OPEN AS MANY TABS AS YOU WISH\nfor(int i = 0; i < TAB_NUMBER; i++) {\n   driver1.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + ""t"");\n   // SLEEP FOR SPLIT SECOND TO ALLOW DRIVER TIME TO OPEN TAB\n   Thread.sleep(100);\n\n// STORE TAB HANDLES IN ARRAY LIST FOR EASY ACCESS\nArrayList tabs1 = new ArrayList<String> (driver1.getWindowHandles());\n\n// REPEAT FOR THE SECOND DRIVER (SECOND CHROME BROWSER WINDOW)\n\n// LOOP TO OPEN AS MANY TABS AS YOU WISH\nfor(int i = 0; i < TAB_NUMBER; i++) {\n   driver2.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + ""t"");\n   // SLEEP FOR SPLIT SECOND TO ALLOW DRIVER TIME TO OPEN TAB\n   Thread.sleep(100);\n\n// STORE TAB HANDLES IN ARRAY LIST FOR EASY ACCESS\nArrayList tabs2 = new ArrayList<String> (driver1.getWindowHandles());\n\n// NOW PERFORM DESIRED TASKS WITH FIRST BROWSER IN ANY TAB\nfor(int ii = 0; ii <= TAB_NUMBER; ii++) {\n   driver1.switchTo().window(tabs1.get(ii));\n   // LOGIC FOR THAT DRIVER\'S CURRENT TAB\n}\n\n// PERFORM DESIRED TASKS WITH SECOND BROWSER IN ANY TAB\nfor(int ii = 0; ii <= TAB_NUMBER; ii++) {\n   drvier2.switchTo().window(tabs2.get(ii));\n   // LOGIC FOR THAT DRIVER\'S CURRENT TAB\n}\n\nHopefully that gives you a good idea of how to manipulate multiple tabs in multiple browser windows.\n', '\nSimple Answer which worked for me:\nfor (String handle1 : driver1.getWindowHandles()) {\n        System.out.println(handle1); \n        driver1.switchTo().window(handle1);     \n}\n\n', '\nSet<String> tabs = driver.getWindowHandles();\nIterator<String> it = tabs.iterator();\ntab1 = it.next();\ntab2 = it.next();\ndriver.switchTo().window(tab1);\ndriver.close();\ndriver.switchTo().window(tab2);\n\nTry this. It should work\n', ""\nI had a problem recently, the link was opened in a new tab, but selenium focused still on the initial tab.\nI'm using Chromedriver and the only way to focus on a tab was for me to use switch_to_window().\nHere's the Python code:\ndriver.switch_to_window(driver.window_handles[-1])\n\nSo the tip is to find out the name of the window handle you need, they are stored as list in\ndriver.window_handles\n\n"", '\nPlease see below:\nWebDriver driver = new FirefoxDriver();\n\ndriver.manage().window().maximize();\ndriver.get(""https://www.irctc.co.in/"");\nString oldTab = driver.getWindowHandle();\n\n//For opening window in New Tab\nString selectLinkOpeninNewTab = Keys.chord(Keys.CONTROL,Keys.RETURN); \ndriver.findElement(By.linkText(""Hotels & Lounge"")).sendKeys(selectLinkOpeninNewTab);\n\n// Perform Ctrl + Tab to focus on new Tab window\nnew Actions(driver).sendKeys(Keys.chord(Keys.CONTROL, Keys.TAB)).perform();\n\n// Switch driver control to focused tab window\ndriver.switchTo().window(oldTab);\n\ndriver.findElement(By.id(""textfield"")).sendKeys(""bangalore"");\n\nHope this is helpful!\n', '\nIt is A very simple process: assume you have two tabs so you need to first close the current tab by using client.window(callback) because the switch command ""switches to the first available one"". Then you can easily switch tab using client.switchTab.\n', '\nA brief example of how to switch between tabs in a browser (in case with one window):\n// open the first tab\ndriver.get(""https://www.google.com"");\nThread.sleep(2000);\n\n// open the second tab\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + ""t"");\ndriver.get(""https://www.google.com"");\nThread.sleep(2000);\n\n// switch to the previous tab\ndriver.findElement(By.cssSelector(""body"")).sendKeys(Keys.CONTROL + """" + Keys.SHIFT + """" + Keys.TAB);\nThread.sleep(2000);\n\nI write Thread.sleep(2000) just to have a timeout to see switching between the tabs.\nYou can use CTRL+TAB for switching to the next tab and CTRL+SHIFT+TAB for switching to the previous tab.\n', '\nThis will work for the MacOS for Firefox and Chrome:\n// opens the default browser tab with the first webpage\ndriver.get(""the url 1"");\nthread.sleep(2000);\n\n// opens the second tab\ndriver.findElement(By.cssSelector(""Body"")).sendKeys(Keys.COMMAND + ""t"");\ndriver.get(""the url 2"");\nThread.sleep(2000);\n\n// comes back to the first tab\ndriver.findElement(By.cssSelector(""Body"")).sendKeys(Keys.COMMAND, Keys.SHIFT, ""{"");\n\n', '\nTo get parent window handles.   \nString parentHandle = driverObj.getWindowHandle();\npublic String switchTab(String parentHandle){\n    String currentHandle ="""";\n    Set<String> win  = ts.getDriver().getWindowHandles();   \n\n    Iterator<String> it =  win.iterator();\n    if(win.size() > 1){\n        while(it.hasNext()){\n            String handle = it.next();\n            if (!handle.equalsIgnoreCase(parentHandle)){\n                ts.getDriver().switchTo().window(handle);\n                currentHandle = handle;\n            }\n        }\n    }\n    else{\n        System.out.println(""Unable to switch"");\n    }\n    return currentHandle;\n}\n\n', '\nThe flaw with the selected answer is that it unnecessarily assumes order in webDriver.getWindowHandles().  The getWindowHandles() method returns a Set, which does not guarantee order. \nI used the following code to change tabs, which does not assume any ordering. \nString currentTabHandle = driver.getWindowHandle();\nString newTabHandle = driver.getWindowHandles()\n       .stream()\n       .filter(handle -> !handle.equals(currentTabHandle ))\n       .findFirst()\n       .get();\ndriver.switchTo().window(newTabHandle);\n\n', '\nprotected void switchTabsUsingPartOfUrl(String platform) {\n    String currentHandle = null;\n    try {\n        final Set<String> handles = driver.getWindowHandles();\n        if (handles.size() > 1) {\n            currentHandle = driver.getWindowHandle();\n        }\n        if (currentHandle != null) {\n            for (final String handle : handles) {\n                driver.switchTo().window(handle);\n                if (currentUrl().contains(platform) && !currentHandle.equals(handle)) {\n                    break;\n                }\n            }\n        } else {\n            for (final String handle : handles) {\n                driver.switchTo().window(handle);\n                if (currentUrl().contains(platform)) {\n                    break;\n                }\n            }\n        }\n    } catch (Exception e) {\n        System.out.println(""Switching tabs failed"");\n    }\n}\n\nCall this method and pass parameter a substring of url of the tab you want to switch to\n', '\npublic class TabBrowserDemo {\npublic static void main(String[] args) throws InterruptedException {\n    System.out.println(""Main Started"");\n    System.setProperty(""webdriver.gecko.driver"", ""driver//geckodriver.exe"");\n    WebDriver driver = new FirefoxDriver();\n    driver.get(""https://www.irctc.co.in/eticketing/userSignUp.jsf"");\n    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);\n\n    driver.findElement(By.xpath(""//a[text()=\'Flights\']"")).click();\n    waitForLoad(driver);\n    Set<String> ids = driver.getWindowHandles();\n    Iterator<String> iterator = ids.iterator();\n    String parentID = iterator.next();\n    System.out.println(""Parent WIn id "" + parentID);\n    String childID = iterator.next();\n    System.out.println(""child win id "" + childID);\n\n    driver.switchTo().window(childID);\n    List<WebElement> hyperlinks = driver.findElements(By.xpath(""//a""));\n\n    System.out.println(""Total links in tabbed browser "" + hyperlinks.size());\n\n    Thread.sleep(3000);\n//  driver.close();\n    driver.switchTo().window(parentID);\n    List<WebElement> hyperlinksOfParent = driver.findElements(By.xpath(""//a""));\n\n    System.out.println(""Total links "" + hyperlinksOfParent.size());\n\n}\n\npublic static void waitForLoad(WebDriver driver) {\n    ExpectedCondition<Boolean> pageLoadCondition = new\n            ExpectedCondition<Boolean>() {\n                public Boolean apply(WebDriver driver) {\n                    return ((JavascriptExecutor)driver).executeScript(""return document.readyState"").equals(""complete"");\n                }\n            };\n    WebDriverWait wait = new WebDriverWait(driver, 30);\n    wait.until(pageLoadCondition);\n}\n\n', '\n    public void switchToNextTab() {\n        ArrayList<String> tab = new ArrayList<>(driver.getWindowHandles());\n        driver.switchTo().window(tab.get(1));\n    }\n    \n    public void closeAndSwitchToNextTab() {\n        driver.close();\n        ArrayList<String> tab = new ArrayList<>(driver.getWindowHandles());\n        driver.switchTo().window(tab.get(1));\n    }\n\n    public void switchToPreviousTab() {\n        ArrayList<String> tab = new ArrayList<>(driver.getWindowHandles());\n        driver.switchTo().window(tab.get(0));\n    }\n\n    public void closeTabAndReturn() {\n        driver.close();\n        ArrayList<String> tab = new ArrayList<>(driver.getWindowHandles());\n        driver.switchTo().window(tab.get(0));\n    }\n\n    public void switchToPreviousTabAndClose() {\n        ArrayList<String> tab = new ArrayList<>(driver.getWindowHandles());\n        driver.switchTo().window(tab.get(1));\n        driver.close();\n    }\n\n', '\nWebDriver driver = new FirefoxDriver();\n\ndriver.switchTo().window(driver.getWindowHandles().toArray()[numPage].toString());\n\nnumPage - int (0,1..)\n\n', '\nString mainWindow = driver.getWindowHandle();\nseleniumHelper.switchToChildWindow();\n..\n..//your assertion steps\nseleniumHelper.switchToWindow(mainWindow);\n', '\nwith Java I used this for switching the selenium focus to the new tab.\n//Before the action that redirect to the new tab:\nString windHandleCurrent = driver.getWindowHandle();\n// code that click in a btn/link in order to open a new tab goes here\n// now to make selenium move to the new tab \nArrayList<String> windows = new ArrayList<String>(driver.getWindowHandles());\n    for(int i =0;i<windows.size();i++ ) {\n        String aWindow = windows.get(i);\n        if(aWindow != windHandleCurrent) {\n            driver.switchTo().window(aWindow);\n        }\n    }\n// now you can code your AssertJUnit for the new tab.\n\n', '\nSelenium 4 has new features:\n// Opens a new tab and switches to new tab\ndriver.switchTo().newWindow(WindowType.TAB);\n// Opens a new window and switches to new window\ndriver.switchTo().newWindow(WindowType.WINDOW);\n', '\ndriver.getWindowHandles() is a Set.I converted it to array of objects  by\nObject[] a=driver.getWindowHandles().toArray;\n\nSay you want to switch to 2nd tab then (after conversion) use\ndriver.switchTo().windows(a[1].toString());\n\n']"
headless internet browser? [closed],"









                        As it currently stands, this question is not a good fit for our Q&A format. We expect answers to be supported by facts, references,  or expertise, but this question will likely solicit debate, arguments, polling, or extended discussion. If you feel that this question  can be improved and possibly reopened, visit the help center for guidance.
                        
                    


Closed 10 years ago.



I would like to do the following. Log into a website, click a couple of specific links, then click a download link. I'd like to run this as either a scheduled task on windows or cron job on Linux. I'm not picky about the language I use, but I'd like this to run with out putting a browser window up on the screen if possible.
",70k,"
            71
        ","['\nHere are a list of headless browsers that I know about:\n\nHtmlUnit - Java. Custom browser engine. Limited JavaScript support/DOM emulated. Open source.\nGhost - Python only. WebKit-based. Full JavaScript support. Open source.\nTwill - Python/command line. Custom browser engine. No JavaScript. Open source.\nPhantomJS - Command line/all platforms. WebKit-based. Full JavaScript support. Open source.\nAwesomium - C++/.NET/all platforms. Chromium-based. Full JavaScript support. Commercial/free.\nSimpleBrowser - .NET 4/C#. Custom browser engine. No JavaScript support. Open source.\nZombieJS - Node.js. Custom browser engine. JavaScript support/emulated DOM. Open source. Based on jsdom.\nEnvJS - JavaScript via Java/Rhino. Custom browser engine. JavaScript support/emulated DOM. Open source.\nWatir-webdriver with headless gem - Ruby via WebDriver.  Full JS Support via Browsers (Firefox/Chrome/Safari/IE). \nSpynner - Python only.  PyQT and WebKit. \njsdom - Node.js. Custom browser engine. Supports JS via emulated DOM. Open source.\nTrifleJS - port of PhantomJS using MSIE (Trident) and V8. Open source.\nui4j - Pure Java 8 solution. A wrapper library around the JavaFx WebKit Engine incl. headless modes.\nChromium Embedded Framework - Full up-to-date embedded version of Chromium with off-screen rendering as needed. C/C++, with .NET wrappers (and other languages). As it is Chromium, it has support for everything. BSD licensed.\nSelenium WebDriver - Full support for JavaScript via browsers (Firefox, IE, Chrome, Safari, Opera). Officially supported bindings are C#, Java, JavaScript, Haskell, Perl, Ruby, PHP, Python, Objective-C, and R. Unofficial bindings are available for Qt and Go. Open source.\n\nHeadless browsers that have JavaScript support via an emulated DOM generally have issues with some sites that use more advanced/obscure browser features, or have functionality that has visual dependencies (e.g. via CSS positions and so forth), so whilst the pure JavaScript support in these browsers is generally complete, the actual supported browser functionality should be considered as partial only.\n(Note: Original version of this post only mentioned HtmlUnit, hence the comments. If you know of other headless browser implementations and have edit rights, feel free to edit this post and add them.)\n', ""\nCheck out twill, a very convenient scripting language for precisely what you're looking for. From the examples:\nsetlocal username <your username>\nsetlocal password <your password>\n\ngo http://www.slashdot.org/\nformvalue 1 unickname $username\nformvalue 1 upasswd $password\nsubmit\n\ncode 200     # make sure form submission is correct!\n\nThere's also a Python API if you're looking for more flexibility.\n"", '\nHave a look at PhantomJS, a JavaScript based automation framework available for Windows, Mac OS X, Linux, other *ix systems.\nUsing PhantomJS, you can do things like this:\nconsole.log(\'Loading a web page\');\n\nvar page = new WebPage();\nvar url = ""http://www.phantomjs.org/"";\n\npage.open(url, function (status) {\n    // perform your task once the page is ready ...\n    phantom.exit();\n});\n\nOr evaluate a page\'s title:\nvar page = require(\'webpage\').create();\npage.open(url, function (status) {\n    var title = page.evaluate(function () {\n        return document.title;\n    });\n    console.log(\'Page title is \' + title);\n});\n\nExamples from PhantomJS\' Quickstart page. You can even render a page to a PNG, JPEG or PDF using the render() method.\n', '\nI once did that using the Internet Explorer ActiveX control (WebBrowser, MSHTML). You can instantiate it without making it visible.\nThis can be done with any language which supports COM (Delphi, VB6, VB.net, C#, C++, ...)\nOf course this is a quick-and-dirty solution and might not be appropriate in your situation.\n', '\nPhantomJS is a headless WebKit-based browser that you can script with JavaScript.\n', '\nExcept for the auto-download of the file (as that is a dialog box) a win form with the embedded webcontrol will do this.\nYou could look at Watin and Watin Recorder. They may help with C# code that can login to your website, navigate to a URL and possibly even help automate the file download.\nYMMV though.\n', ""\nIf the links are known (e.g, you don't have to search the page for them), then you can probably use wget. I believe that it will do the state management across multiple fetches.\nIf you are a little more enterprising, then I would delve into the new goodies in Python 3.0. They redid the interface to their HTTP stack and, IMHO, have a very nice interface that is susceptible to this type of scripting.\n"", '\nNode.js with YUI on the server. Check out this video: http://www.yuiblog.com/blog/2010/09/29/video-glass-node/\nThe guy in this video Dav Glass shows an example of how he uses node to fetch a page from Digg. He then attached YUI to the DOM he grabbed and can completely manipulate it.\n', '\nIf you use PHP - try http://mink.behat.org/\n', '\nYou can use Watir with Ruby or Watin with mono.\n', ""\nAlso you can use Live Http Headers (Firefox extension) to record headers which are sent to site (Login -> Links -> Download Link) and then replicate them with php using fsockopen. Only thing which you'll probably need to variate is the cookie's value which you receive from login page. \n"", '\nlibCURL could be used to create something like this.\n', '\nCan you not just use a download manager?\nThere\'s better ones, but FlashGet has browser-integration, and supports authentication. You can login, click a bunch of links and queue them up and schedule the download.\nYou could write something that, say, acts as a proxy which catches specific links and queues them for later download, or a Javascript bookmarklet that modifies links to go to ""http://localhost:1234/download_queuer?url="" + $link.href and have that queue the downloads - but you\'d be reinventing the download-manager-wheel, and with authentication it can be more complicated..\nOr, if you want the ""login, click links"" bit to be automated also - look into screen-scraping.. Basically you load the page via a HTTP library, find the download links and download them..\nSlightly simplified example, using Python:\nimport urllib\nfrom BeautifulSoup import BeautifulSoup\nsrc = urllib.urlopen(""http://%s:%s@example.com"" % (""username"", ""password""))\nsoup = BeautifulSoup(src)\n\nfor link_tag in soup.findAll(""a""):\n    link = link_tag[""href""]\n    filename = link.split(""/"")[-1] # get everything after last /\n    urllib.urlretrieve(link, filename)\n\nThat would download every link on example.com, after authenticating with the username/password of ""username"" and ""password"". You could, of course, find more specific links using BeautifulSoup\'s HTML selector\'s (for example, you could find all links with the class ""download"", or URL\'s that start with http://cdn.example.com).\nYou could do the same in pretty much any language..\n', ""\n.NET contains System.Windows.Forms.WebBrowser.  You can create an instance of this, send it to a URL, and then easily parse the html on that page.  You could then follow any links you found, etc.  \nI have worked with this object only minimally, so I'm no expert, but if you're already familiar with .NET then it would probably be worth looking into.\n""]"
Typing the Enter/Return key in Selenium,"
I'm looking for a quick way to type the Enter or Return key in Selenium.
Unfortunately, the form I'm trying to test (not my own code, so I can't modify) doesn't have a Submit button. When working with it manually, I just type Enter or Return. How can I do that with the Selenium type command as there is no button to click?
",909k,"
            330
        ","['\nimport org.openqa.selenium.Keys\n\nWebElement.sendKeys(Keys.RETURN);\n\n\nThe import statement is for Java. For other languages, it is maybe different. For example, in Python it is from selenium.webdriver.common.keys import Keys\n', '\nJava\ndriver.findElement(By.id(""Value"")).sendKeys(Keys.RETURN);\n\nOR,\ndriver.findElement(By.id(""Value"")).sendKeys(Keys.ENTER);\n\n\nPython\nfrom selenium.webdriver.common.keys import Keys\ndriver.find_element_by_name(""Value"").send_keys(Keys.RETURN)\n\nOR,\ndriver.find_element_by_name(""Value"").send_keys(Keys.ENTER)\n\nOR,\nelement = driver.find_element_by_id(""Value"")\nelement.send_keys(""keysToSend"")\nelement.submit()\n\n\nRuby\nelement = @driver.find_element(:name, ""value"")\nelement.send_keys ""keysToSend""\nelement.submit\n\nOR,\nelement = @driver.find_element(:name, ""value"")\nelement.send_keys ""keysToSend""\nelement.send_keys:return\n\nOR,\n@driver.action.send_keys(:enter).perform\n@driver.action.send_keys(:return).perform\n\n\nC#\ndriver.FindElement(By.Id(""Value"")).SendKeys(Keys.Return);\n\nOR,\ndriver.FindElement(By.Id(""Value"")).SendKeys(Keys.Enter);\n\n', '\nYou can use either of  Keys.ENTER or Keys.RETURN. Here are the details:\nUsage:\n\nJava:\n\nUsing Keys.ENTER:\nimport org.openqa.selenium.Keys;\ndriver.findElement(By.id(""element_id"")).sendKeys(Keys.ENTER);\n\n\nUsing Keys.RETURN:\nimport org.openqa.selenium.Keys;\ndriver.findElement(By.id(""element_id"")).sendKeys(Keys.RETURN);\n\n\n\n\nPython:\n\nUsing Keys.ENTER:\nfrom selenium.webdriver.common.keys import Keys\ndriver.find_element_by_id(""element_id"").send_keys(Keys.ENTER)\n\n\nUsing Keys.RETURN:\nfrom selenium.webdriver.common.keys import Keys\ndriver.find_element_by_id(""element_id"").send_keys(Keys.RETURN)\n\n\n\n\n\nKeys.ENTER and Keys.RETURN both are from org.openqa.selenium.Keys, which extends java.lang.Enum<Keys> and implements java.lang.CharSequence.\n\nEnum Keys\nEnum Keys is the representations of pressable keys that aren\'t text. These are stored in the Unicode PUA (Private Use Area) code points, 0xE000-0xF8FF.\nKey Codes:\nThe special keys codes for them are as follows:\n\nRETURN = u\'\\ue006\'\nENTER = u\'\\ue007\'\n\nThe implementation of all the Enum Keys are handled the same way.\nHence these is No Functional or Operational difference while working with either sendKeys(Keys.ENTER); or WebElement.sendKeys(Keys.RETURN); through Selenium.\n\nEnter Key and Return Key\nOn computer keyboards, the Enter (or the Return on Mac\xa0OS\xa0X) in most cases causes a command line, window form, or dialog box to operate its default function. This is typically to finish an ""entry"" and begin the desired process and is usually an alternative to pressing an OK button.\nThe Return is often also referred as the Enter and they usually perform identical functions; however in some particular applications (mainly page layout) Return operates specifically like the Carriage Return key from which it originates. In contrast, the Enter is commonly labelled with its name in plain text on generic PC keyboards.\n\nReferences\n\nEnter Key\nCarriage Return\n\n', '\nNow that Selenium 2 has been released, it\'s a bit easier to send an Enter key, since you can do it with the send_keys method of the selenium.webdriver.remote.webelement.WebElement class (this example code is in Python, but the same method exists in Java):\n>>> from selenium import webdriver\n>>> wd = webdriver.Firefox()\n>>> wd.get(""http://localhost/example/page"")\n>>> textbox = wd.find_element_by_css_selector(""input"")\n>>> textbox.send_keys(""Hello World\\n"")\n\n', '\nIn Python\nStep 1. from selenium.webdriver.common.keys import Keys\nStep 2. driver.find_element_by_name("""").send_keys(Keys.ENTER)\nNote: you have to write Keys.ENTER\n', '\nWhen writing HTML tests, the ENTER key is available as ${KEY_ENTER}.\nYou can use it with sendKeys, here is an example:\nsendKeys | id=search | ${KEY_ENTER}\n\n', '\nselenium.keyPress(""css=input.tagit-input.ui-autocomplete-input"", ""13"");\n\n', '\nYou just do this:\nfinal private WebElement input = driver.findElement(By.id(""myId""));\ninput.clear();\ninput.sendKeys(value); // The value we want to set to input\ninput.sendKeys(Keys.RETURN);\n\n', ""\nFor those folks who are using WebDriverJS Keys.RETURN would be referenced as \nwebdriver.Key.RETURN\n\nA more complete example as a reference might be helpful too:\nvar pressEnterToSend = function () {\n    var deferred = webdriver.promise.defer();\n    webdriver.findElement(webdriver.By.id('id-of-input-element')).then(function (element) {\n        element.sendKeys(webdriver.Key.RETURN);\n        deferred.resolve();\n    });\n\n    return deferred.promise;\n};\n\n"", '\ndriver.findElement(By.id(""Value"")).sendKeys(Keys.RETURN); or driver.findElement(By.id(""Value"")).sendKeys(Keys.ENTER);\n', '\nFor Selenium Remote Control with Java:\nselenium.keyPress(""elementID"", ""\\13"");\n\nFor Selenium WebDriver (a.k.a. Selenium 2) with Java:\ndriver.findElement(By.id(""elementID"")).sendKeys(Keys.ENTER);\n\nOr,\ndriver.findElement(By.id(""elementID"")).sendKeys(Keys.RETURN);\n\nAnother way to press Enter in WebDriver is by using the Actions class:\nActions action = new Actions(driver);\naction.sendKeys(driver.findElement(By.id(""elementID"")), Keys.ENTER).build().perform();\n\n', '\nsearch = browser.find_element_by_xpath(""//*[@type=\'text\']"")\nsearch.send_keys(u\'\\ue007\')\n\n#ENTER = u\'\\ue007\'\nRefer to Selenium\'s documentation \'Special Keys\'.\n', '\nI just like to note that I needed this for my Cucumber tests and found out that if you like to simulate pressing the enter/return key, you need to send the :return value and not the :enter value (see the values described here)\n', '\nTry to use an XPath expression for searching the element and then, the following code works:\ndriver.findElement(By.xpath("".//*[@id=\'txtFilterContentUnit\']"")).sendKeys(Keys.ENTER);\n\n', ""\nYou can call submit() on the element object in which you entered your text.\nAlternatively, you can specifically send the Enter key to it as shown in this Python snippet:\nfrom selenium.webdriver.common.keys import Keys\nelement.send_keys(Keys.ENTER) # 'element' is the WebElement object corresponding to the input field on the page\n\n"", '\nIf you are looking for ""how to press the Enter key from the keyboard in Selenium WebDriver (Java)"",then below code will definitely help you.\n// Assign a keyboard object\nKeyboard keyboard = ((HasInputDevices) driver).getKeyboard();\n\n// Enter a key\nkeyboard.pressKey(Keys.ENTER);\n\n', '\nTo enter keys using Selenium, first you need to import the following library:\nimport org.openqa.selenium.Keys\n\nthen add this code where you want to enter the key\nWebElement.sendKeys(Keys.RETURN);\n\nYou can replace RETURN with any key from the list according to your requirement.\n', '\nThere are the following ways of pressing keys - C#:\nDriver.FindElement(By.Id(""Value"")).SendKeys(Keys.Return);\n\nOR\nOpenQA.Selenium.Interactions.Actions action = new OpenQA.Selenium.Interactions.Actions(Driver);\naction.SendKeys(OpenQA.Selenium.Keys.Escape);\n\nOR\nIWebElement body = GlobalDriver.FindElement(By.TagName(""body""));\nbody.SendKeys(Keys.Escape);\n\n', '\nobject.sendKeys(""your message"", Keys.ENTER);\n\nIt works.\n', ""\nWhen you don't want to search any locator, you can use the Robot class. For example,\nRobot robot = new Robot();\nrobot.keyPress(KeyEvent.VK_ENTER);\nrobot.keyRelease(KeyEvent.VK_ENTER);\n\n"", '\nIf you just want to press the Enter key (python):\nfrom selenium.webdriver.common.action_chains import ActionChains\nfrom selenium.webdriver.common.keys import Keys\n\naction = ActionChains(driver)\naction.send_keys(Keys.ENTER)\naction.perform()\n\n', '\nActions action = new Actions(driver);\naction.sendKeys(Keys.RETURN);\n\n', '\nFor Ruby:\ndriver.find_element(:id, ""XYZ"").send_keys:return\n\n', '\nFor Selenium WebDriver using XPath (if the key is visible):\ndriver.findElement(By.xpath(""xpath of text field"")).sendKeys(Keys.ENTER);\n\nor,\ndriver.findElement(By.xpath(""xpath of text field"")).sendKeys(Keys.RETURN);\n\n', '\nI had to send the Enter key in the middle of a text. So I passed the following text to send keys function to achieve 1\\n2\\n3:\n1\\N{U+E007}2\\N{U+E007}3\n\n', '\nJava/JavaScript:\nYou could probably do it this way also, non-natively:\npublic void triggerButtonOnEnterKeyInTextField(String textFieldId, String clickableButId)\n{\n    ((JavascriptExecutor) driver).executeScript(\n        ""   elementId = arguments[0];\n            buttonId = arguments[1];\n            document.getElementById(elementId)\n                .addEventListener(""keyup"", function(event) {\n                    event.preventDefault();\n                    if (event.keyCode == 13) {\n                        document.getElementById(buttonId).click();\n                    }\n                });"",\n\n        textFieldId,\n        clickableButId);\n}\n\n', '\nIt could be achieved using Action interface as well. In case of WebDriver -\nWebElement username = driver.findElement(By.name(""q""));\nusername.sendKeys(searchKey);\nActions action = new Actions(driver);\naction.sendKeys(Keys.RETURN);\naction.perform();\n\n', '\nYou can try:\nselenium.keyPress(""id="""", ""\\\\13"");\n\n', '\nIf you are in this specific situation:\na) want to just press the key, but you not have a specific webElement to click on\nb) you are using Selenium 2 (WebDriver)\nThen the solution is:\n    Actions builder = new Actions(webDriverInstance);\n    builder.sendKeys(Keys.RETURN).perform();\n\n', ""\nFor everyone using JavaScript / Node.js, this worked for me:\ndriver.findElement(By.xpath('xpath')).sendKeys('ENTER');\n\n""]"
.doc to pdf using python,"
I'am tasked with converting tons of .doc files to .pdf. And the only way my supervisor wants me to do this is through MSWord 2010. I know I should be able to automate this with python COM automation. Only problem is I dont know how and where to start. I tried searching for some tutorials but was not able to find any (May be I might have, but I don't know what I'm looking for). 
Right now I'm reading through this. Dont know how useful this is going to be.
",171k,"
            73
        ","[""\nA simple example using comtypes, converting a single file, input and output filenames given as commandline arguments:\nimport sys\nimport os\nimport comtypes.client\n\nwdFormatPDF = 17\n\nin_file = os.path.abspath(sys.argv[1])\nout_file = os.path.abspath(sys.argv[2])\n\nword = comtypes.client.CreateObject('Word.Application')\ndoc = word.Documents.Open(in_file)\ndoc.SaveAs(out_file, FileFormat=wdFormatPDF)\ndoc.Close()\nword.Quit()\n\nYou could also use pywin32, which would be the same except for:\nimport win32com.client\n\nand then:\nword = win32com.client.Dispatch('Word.Application')\n\n"", '\nYou can use the docx2pdf python package to bulk convert docx to pdf. It can be used as both a CLI and a python library. It requires Microsoft Office to be installed and uses COM on Windows and AppleScript (JXA) on macOS.\nfrom docx2pdf import convert\n\nconvert(""input.docx"")\nconvert(""input.docx"", ""output.pdf"")\nconvert(""my_docx_folder/"")\n\npip install docx2pdf\ndocx2pdf input.docx output.pdf\n\nDisclaimer: I wrote the docx2pdf package. https://github.com/AlJohri/docx2pdf\n', ""\nI have tested many solutions but no one of them works efficiently on Linux distribution.\nI recommend this solution :\nimport sys\nimport subprocess\nimport re\n\n\ndef convert_to(folder, source, timeout=None):\n    args = [libreoffice_exec(), '--headless', '--convert-to', 'pdf', '--outdir', folder, source]\n\n    process = subprocess.run(args, stdout=subprocess.PIPE, stderr=subprocess.PIPE, timeout=timeout)\n    filename = re.search('-> (.*?) using filter', process.stdout.decode())\n\n    return filename.group(1)\n\n\ndef libreoffice_exec():\n    # TODO: Provide support for more platforms\n    if sys.platform == 'darwin':\n        return '/Applications/LibreOffice.app/Contents/MacOS/soffice'\n    return 'libreoffice'\n\nand you call your function:\nresult = convert_to('TEMP Directory',  'Your File', timeout=15)\n\nAll resources:\n\nhttps://michalzalecki.com/converting-docx-to-pdf-using-python/\n\n"", '\nI have worked on this problem for half a day, so I think I should share some of my experience on this matter. Steven\'s answer is right, but it will fail on my computer. There are two key points to fix it here:\n(1). The first time when I created the \'Word.Application\' object, I should make it (the word app) visible before open any documents. (Actually, even I myself cannot explain why this works. If I do not do this on my computer, the program will crash when I try to open a document in the invisible model, then the \'Word.Application\' object will be deleted by OS. )\n(2). After doing (1), the program will work well sometimes but may fail often. The crash error ""COMError: (-2147418111, \'Call was rejected by callee.\', (None, None, None, 0, None))"" means that the COM Server may not be able to response so quickly. So I add a delay before I tried to open a document.\nAfter doing these two steps, the program will work perfectly with no failure anymore. The demo code is as below. If you have encountered the same problems, try to follow these two steps. Hope it helps.\n    import os\n    import comtypes.client\n    import time\n\n\n    wdFormatPDF = 17\n\n\n    # absolute path is needed\n    # be careful about the slash \'\\\', use \'\\\\\' or \'/\' or raw string r""...""\n    in_file=r\'absolute path of input docx file 1\'\n    out_file=r\'absolute path of output pdf file 1\'\n\n    in_file2=r\'absolute path of input docx file 2\'\n    out_file2=r\'absolute path of outputpdf file 2\'\n\n    # print out filenames\n    print in_file\n    print out_file\n    print in_file2\n    print out_file2\n\n\n    # create COM object\n    word = comtypes.client.CreateObject(\'Word.Application\')\n    # key point 1: make word visible before open a new document\n    word.Visible = True\n    # key point 2: wait for the COM Server to prepare well.\n    time.sleep(3)\n\n    # convert docx file 1 to pdf file 1\n    doc=word.Documents.Open(in_file) # open docx file 1\n    doc.SaveAs(out_file, FileFormat=wdFormatPDF) # conversion\n    doc.Close() # close docx file 1\n    word.Visible = False\n    # convert docx file 2 to pdf file 2\n    doc = word.Documents.Open(in_file2) # open docx file 2\n    doc.SaveAs(out_file2, FileFormat=wdFormatPDF) # conversion\n    doc.Close() # close docx file 2   \n    word.Quit() # close Word Application \n\n', '\nunoconv (writen in Python) and OpenOffice running as a headless daemon.\nhttps://github.com/unoconv/unoconv\nhttp://dag.wiee.rs/home-made/unoconv/\nWorks very nicely for doc, docx, ppt, pptx, xls, xlsx.\nVery useful if you need to convert docs or save/convert to certain formats on a server.\n', ""\nAs an alternative to the SaveAs function, you could also use ExportAsFixedFormat which gives you access to the PDF options dialog you would normally see in Word. With this you can specify bookmarks and other document properties.\ndoc.ExportAsFixedFormat(OutputFileName=pdf_file,\n    ExportFormat=17, #17 = PDF output, 18=XPS output\n    OpenAfterExport=False,\n    OptimizeFor=0,  #0=Print (higher res), 1=Screen (lower res)\n    CreateBookmarks=1, #0=No bookmarks, 1=Heading bookmarks only, 2=bookmarks match word bookmarks\n    DocStructureTags=True\n    );\n\nThe full list of function arguments is: 'OutputFileName', 'ExportFormat', 'OpenAfterExport', 'OptimizeFor', 'Range', 'From', 'To', 'Item', 'IncludeDocProps', 'KeepIRM', 'CreateBookmarks', 'DocStructureTags', 'BitmapMissingFonts', 'UseISO19005_1', 'FixedFormatExtClassPtr'\n"", ""\nIt's worth noting that Stevens answer works, but make sure if using a for loop to export multiple files to place the ClientObject or Dispatch statements before the loop - it only needs to be created once - see my problem: Python win32com.client.Dispatch looping through Word documents and export to PDF; fails when next loop occurs\n"", ""\nIf you don't mind using PowerShell have a look at this Hey, Scripting Guy! article. The code presented could be adopted to use the wdFormatPDF enumeration value of WdSaveFormat (see here).\nThis blog article presents a different implementation of the same idea.\n"", '\nI have modified it for ppt support as well. My solution support all the below-specified extensions.\nword_extensions = ["".doc"", "".odt"", "".rtf"", "".docx"", "".dotm"", "".docm""]\nppt_extensions = ["".ppt"", "".pptx""]\n\nMy Solution: Github Link\nI have modified code from Docx2PDF\n', '\nI tried the accepted answer but wasn\'t particularly keen on the bloated PDFs Word was producing which was usually an order of magnitude bigger than expected. After looking how to disable the dialogs when using a virtual PDF printer I came across Bullzip PDF Printer and I\'ve been rather impressed with its features. It\'s now replaced the other virtual printers I used previously. You\'ll find a ""free community edition"" on their download page.\nThe COM API can be found here and a list of the usable settings can be found here. The settings are written to a ""runonce"" file which is used for one print job only and then removed automatically. When printing multiple PDFs we need to make sure one print job completes before starting another to ensure the settings are used correctly for each file.\nimport os, re, time, datetime, win32com.client\n\ndef print_to_Bullzip(file):\n    util = win32com.client.Dispatch(""Bullzip.PDFUtil"")\n    settings = win32com.client.Dispatch(""Bullzip.PDFSettings"")\n    settings.PrinterName = util.DefaultPrinterName      # make sure we\'re controlling the right PDF printer\n\n    outputFile = re.sub(""\\.[^.]+$"", "".pdf"", file)\n    statusFile = re.sub(""\\.[^.]+$"", "".status"", file)\n\n    settings.SetValue(""Output"", outputFile)\n    settings.SetValue(""ConfirmOverwrite"", ""no"")\n    settings.SetValue(""ShowSaveAS"", ""never"")\n    settings.SetValue(""ShowSettings"", ""never"")\n    settings.SetValue(""ShowPDF"", ""no"")\n    settings.SetValue(""ShowProgress"", ""no"")\n    settings.SetValue(""ShowProgressFinished"", ""no"")     # disable balloon tip\n    settings.SetValue(""StatusFile"", statusFile)         # created after print job\n    settings.WriteSettings(True)                        # write settings to the runonce.ini\n    util.PrintFile(file, util.DefaultPrinterName)       # send to Bullzip virtual printer\n\n    # wait until print job completes before continuing\n    # otherwise settings for the next job may not be used\n    timestamp = datetime.datetime.now()\n    while( (datetime.datetime.now() - timestamp).seconds < 10):\n        if os.path.exists(statusFile) and os.path.isfile(statusFile):\n            error = util.ReadIniString(statusFile, ""Status"", ""Errors"", \'\')\n            if error != ""0"":\n                raise IOError(""PDF was created with errors"")\n            os.remove(statusFile)\n            return\n        time.sleep(0.1)\n    raise IOError(""PDF creation timed out"")\n\n', '\nI was working with this solution but I needed to search all .docx, .dotm, .docm, .odt, .doc or .rtf and then turn them all to .pdf (python 3.7.5). Hope it works...\nimport os\nimport win32com.client\n\nwdFormatPDF = 17\n\nfor root, dirs, files in os.walk(r\'your directory here\'):\n    for f in files:\n\n        if  f.endswith("".doc"")  or f.endswith("".odt"") or f.endswith("".rtf""):\n            try:\n                print(f)\n                in_file=os.path.join(root,f)\n                word = win32com.client.Dispatch(\'Word.Application\')\n                word.Visible = False\n                doc = word.Documents.Open(in_file)\n                doc.SaveAs(os.path.join(root,f[:-4]), FileFormat=wdFormatPDF)\n                doc.Close()\n                word.Quit()\n                word.Visible = True\n                print (\'done\')\n                os.remove(os.path.join(root,f))\n                pass\n            except:\n                print(\'could not open\')\n                # os.remove(os.path.join(root,f))\n        elif f.endswith("".docx"") or f.endswith("".dotm"") or f.endswith("".docm""):\n            try:\n                print(f)\n                in_file=os.path.join(root,f)\n                word = win32com.client.Dispatch(\'Word.Application\')\n                word.Visible = False\n                doc = word.Documents.Open(in_file)\n                doc.SaveAs(os.path.join(root,f[:-5]), FileFormat=wdFormatPDF)\n                doc.Close()\n                word.Quit()\n                word.Visible = True\n                print (\'done\')\n                os.remove(os.path.join(root,f))\n                pass\n            except:\n                print(\'could not open\')\n                # os.remove(os.path.join(root,f))\n        else:\n            pass\n\nThe try and except was for those documents I couldn\'t read and won\'t exit the code until the last document.\n', '\nYou should start from investigating so called virtual PDF print drivers.\nAs soon as you will find one you should be able to write batch file that prints your DOC files into PDF files. You probably can do this in Python too (setup printer driver output and issue document/print command in MSWord, later can be done using command line AFAIR).\n', '\nimport docx2txt\nfrom win32com import client\n\nimport os\n\nfiles_from_folder = r""c:\\\\doc""\n\ndirectory = os.fsencode(files_from_folder)\n\namount = 1\n\nword = client.DispatchEx(""Word.Application"")\nword.Visible = True\n\nfor file in os.listdir(directory):\n    filename = os.fsdecode(file)\n    print(filename)\n\n    if filename.endswith(\'docx\'):\n        text = docx2txt.process(os.path.join(files_from_folder, filename))\n\n        print(f\'{filename} transfered ({amount})\')\n        amount += 1\n        new_filename = filename.split(\'.\')[0] + \'.txt\'\n\n        try:\n            with open(os.path.join(files_from_folder + r\'\\txt_files\', new_filename), \'w\', encoding=\'utf-8\') as t:\n                t.write(text)\n        except:\n            os.mkdir(files_from_folder + r\'\\txt_files\')\n            with open(os.path.join(files_from_folder + r\'\\txt_files\', new_filename), \'w\', encoding=\'utf-8\') as t:\n                t.write(text)\n    elif filename.endswith(\'doc\'):\n        doc = word.Documents.Open(os.path.join(files_from_folder, filename))\n        text = doc.Range().Text\n        doc.Close()\n\n        print(f\'{filename} transfered ({amount})\')\n        amount += 1\n        new_filename = filename.split(\'.\')[0] + \'.txt\'\n\n        try:\n            with open(os.path.join(files_from_folder + r\'\\txt_files\', new_filename), \'w\', encoding=\'utf-8\') as t:\n                t.write(text)\n        except:\n            os.mkdir(files_from_folder + r\'\\txt_files\')\n            with open(os.path.join(files_from_folder + r\'\\txt_files\', new_filename), \'w\', encoding=\'utf-8\') as t:\n                t.write(text)\nword.Quit()\n\nThe Source Code, see here:\nhttps://neculaifantanaru.com/en/python-full-code-how-to-convert-doc-and-docx-files-to-pdf-from-the-folder.html\n', ""\nI would suggest ignoring your supervisor and use OpenOffice which has a Python api.  OpenOffice has built in support for Python and someone created a library specific for this purpose (PyODConverter).\nIf he isn't happy with the output, tell him it could take you weeks to do it with word.\n""]"
Best practice - Git + Build automation - Keeping configs separate,"
Searching for the best approach to keep my config files separate, yet not introduce extra steps for new developers setting up their environments.
I am guessing a submodule would suffice to do the job, but then how would I switch configs seamlessly depending on the task at hand, aka pull in DEV config regularly, pull PROD branch of config repo during build?
Needs to be:

Easy and painless for new devs.  
PROD config files should only be accessible to select users + build user.

Thank you in advance.
",2k,"
            6
        ","['\nThat is called content filter driver, and it allows you to declare, in a .gitattributes file (and only for your config files type) a smudge script which will automatically on checkout:\n\ncombine a config file template file (config.tpl)\nwith the right config file value (config.dev, config.prod, ...)\nin order to produced a non-versioned config file (private file)\n\n\nSee ""Customizing Git - Git Attributes"":\necho \'*.cfg.tpl filter=config\' >> .gitattributes\ngit config --global filter.config.smudge yourScript\n\nWith that approach, you don\'t need submodules, but you can generate as many config file you need depending on your environment, like for instance your branch:\nA bit like in ""Find Git branch name in post-update hook"", your smudge script can find out in which branch it is currently executing with:\n#!/bin/sh\nbranch=$(git rev-parse --symbolic --abbrev-ref HEAD)\n\n']"
Stored procedure that Automatically delete rows older than 7 days in MYSQL,"
I would like to know if is possible to create a stored procedure that automatically, every day at 00:00, deletes every row of every table that is over 7 days.
I have seen few solutions but not sure if its what I am looking for, and would be nice if someone has any good example. I know this could be done with simple scripts in python and php, but I would like something more automated by MySQL.
Any help would be really appreciate.
Thanks!
",16k,"
            2
        ","[""\nMysql has its EVENT functionality for avoiding complicated cron interactions when much of what you are scheduling is sql related, and less file related. See the Manual page here. Hopefully the below reads as a quick overview of the important steps and things to consider, and verifiable testing too.\nshow variables where variable_name='event_scheduler';\n+-----------------+-------+\n| Variable_name   | Value |\n+-----------------+-------+\n| event_scheduler | OFF   |\n+-----------------+-------+\n\nooops, the event scheduler is not turned on. Nothing will trigger.\nSET GLOBAL event_scheduler = ON;  -- turn her on and confirm below\nshow variables where variable_name='event_scheduler';\n+-----------------+-------+\n| Variable_name   | Value |\n+-----------------+-------+\n| event_scheduler | ON    |\n+-----------------+-------+\n\nSchema for testing\ncreate table theMessages\n(   id int auto_increment primary key,\n    userId int not null,\n    message varchar(255) not null,\n    updateDt datetime not null,\n    key(updateDt)\n    -- FK's not shown\n);\n-- it is currently 2015-09-10 13:12:00\n-- truncate table theMessages;\ninsert theMessages(userId,message,updateDt) values (1,'I need to go now, no followup questions','2015-08-24 11:10:09');\ninsert theMessages(userId,message,updateDt) values (7,'You always say that ... just hiding','2015-08-29');\ninsert theMessages(userId,message,updateDt) values (1,'7 day test1','2015-09-03 12:00:00');\ninsert theMessages(userId,message,updateDt) values (1,'7 day test2','2015-09-03 14:00:00');\n\nCreate 2 events, 1st runs daily, 2nd runs every 10 minutes\nIgnore what they are actually doing (playing against one another). The point is on time difference approaches and scheduling.\nDELIMITER $$\nCREATE EVENT `delete7DayOldMessages`\n  ON SCHEDULE EVERY 1 DAY STARTS '2015-09-01 00:00:00'\n  ON COMPLETION PRESERVE\nDO BEGIN\n   delete from theMessages \n   where datediff(now(),updateDt)>6; -- not terribly exact, yesterday but <24hrs is still 1 day\n   -- etc etc all your stuff in here\nEND;$$\nDELIMITER ;\n\n...\nDELIMITER $$\nCREATE EVENT `Every_10_Minutes_Cleanup`\n  ON SCHEDULE EVERY 10 MINUTE STARTS '2015-09-01 00:00:00'\n  ON COMPLETION PRESERVE\nDO BEGIN\n   delete from theMessages \n   where TIMESTAMPDIFF(HOUR, updateDt, now())>168; -- messages over 1 week old (168 hours)\n   -- etc etc all your stuff in here\nEND;$$\nDELIMITER ;\n\nShow event statuses (different approaches)\nshow events from so_gibberish; -- list all events by schema name (db name)\nshow events; -- <--------- from workbench / sqlyog\nshow events\\G;` -- <--------- I like this one from mysql> prompt\n\n*************************** 1. row ***************************\n                  Db: so_gibberish\n                Name: delete7DayOldMessages\n             Definer: root@localhost\n           Time zone: SYSTEM\n                Type: RECURRING\n          Execute at: NULL\n      Interval value: 1\n      Interval field: DAY\n              Starts: 2015-09-01 00:00:00\n                Ends: NULL\n              Status: ENABLED\n          Originator: 1\ncharacter_set_client: utf8\ncollation_connection: utf8_general_ci\n  Database Collation: utf8_general_ci\n*************************** 2. row ***************************\n                  Db: so_gibberish\n                Name: Every_10_Minutes_Cleanup\n             Definer: root@localhost\n           Time zone: SYSTEM\n                Type: RECURRING\n          Execute at: NULL\n      Interval value: 10\n      Interval field: MINUTE\n              Starts: 2015-09-01 00:00:00\n                Ends: NULL\n              Status: ENABLED\n          Originator: 1\ncharacter_set_client: utf8\ncollation_connection: utf8_general_ci\n  Database Collation: utf8_general_ci\n2 rows in set (0.06 sec)\n\nRandom stuff to consider\ndrop event someEventName; -- <----- a good thing to know about\ncan't alias datediff and use in where clause in 1 line, so\nselect id,DATEDIFF(now(),updateDt) from theMessages where datediff(now(),updateDt)>6;\n\nget more exact, 168 hours for 1 week old\nselect id,TIMESTAMPDIFF(HOUR, updateDt, now()) as `difference` FROM theMessages;\n+----+------------+\n| id | difference |\n+----+------------+\n|  1 |        410 |\n|  2 |        301 |\n|  3 |        169 |\n|  4 |        167 |\n+----+------------+\n\nThe link to the Manual Page shows quite a bit of flexibilty with interval choices, shown below:\n\ninterval:\nquantity {YEAR | QUARTER | MONTH | DAY | HOUR | MINUTE |\n          WEEK | SECOND | YEAR_MONTH | DAY_HOUR | DAY_MINUTE |\n          DAY_SECOND | HOUR_MINUTE | HOUR_SECOND | MINUTE_SECOND}\n\n\nConcurrency\nEmbed any concurrency measures necessary that multiple events (or multiple firings of the same event) don't cause data to run amok.\nSet and Forget\nRemember, for now, because you are going to forget it, that these events just keep firing. So build in solid code that will just keep running, even when you forget. Which you most likely will.\nYour particular requirements\nYou need to determine which rows need to be deleted first by table, such that it honors Primary Key constraints. Just lump them all in proper order inside of the obvious area via the CREATE EVENT statement, which can be massive.\n"", '\nYou can use below stored procedure and either schedule it by crontab or through events.\nNote: Just change mydb with your Database, which database tables data you want to delete and test first in testing environment.\nDELIMITER $$\n\nUSE `mydb`$$\n\nDROP PROCEDURE IF EXISTS `sp_delete`$$\n\nCREATE DEFINER=`root`@`localhost` PROCEDURE `sp_delete`()\nBEGIN\nDECLARE done INT(1) DEFAULT 0;\nDECLARE _tbl VARCHAR(100) DEFAULT \'\';\nDECLARE CONTINUE HANDLER FOR SQLSTATE \'02000\' SET done=done;\n\nDECLARE cur1 CURSOR FOR SELECT table_name FROM information_schema.tables WHERE table_schema=\'mydb\' AND table_type=\'base table\';\nDECLARE CONTINUE HANDLER FOR SQLSTATE \'02000\' SET done=done;\nOPEN cur1;\n\nREPEAT\nFETCH cur1 INTO _tbl;\nIF _db = \'\' THEN\n    SET done = 1;\nEND IF;\n            IF (done<>1) THEN\n\n                             SET @str=CONCAT(""delete from "",_tbl,"" where updateon < SUBDATE(CURDATE(),INTERVAL 7 DAY)"");\n                 PREPARE stmt FROM @str;\n                 EXECUTE stmt;\n                 DEALLOCATE PREPARE stmt;\n\n            END IF;\n\nUNTIL done\nEND REPEAT;\n     CLOSE cur1;\n     SELECT \'done\';\n\n\nEND$$\n\nDELIMITER ;\n\n']"
Selenium waitForElement,"
How do I write the function for Selenium to wait for a table with just a class identifier in Python? I'm having a devil of a time learning to use Selenium's Python webdriver functions.
",101k,"
            48
        ","[""\nFrom the Selenium Documentation PDF :\nimport contextlib\nimport selenium.webdriver as webdriver\nimport selenium.webdriver.support.ui as ui\n\nwith contextlib.closing(webdriver.Firefox()) as driver:\n    driver.get('http://www.google.com')\n    wait = ui.WebDriverWait(driver,10)\n    # Do not call `implicitly_wait` if using `WebDriverWait`.\n    #     It magnifies the timeout.\n    # driver.implicitly_wait(10)  \n    inputElement=driver.find_element_by_name('q')\n    inputElement.send_keys('Cheese!')\n    inputElement.submit()\n    print(driver.title)\n\n    wait.until(lambda driver: driver.title.lower().startswith('cheese!'))\n    print(driver.title)\n\n    # This raises\n    #     selenium.common.exceptions.TimeoutException: Message: None\n    #     after 10 seconds\n    wait.until(lambda driver: driver.find_element_by_id('someId'))\n    print(driver.title)\n\n"", ""\nSelenium 2's Python bindings have a new support class called expected_conditions.py for doing all sorts of things like testing if an element is visible. It's available here.\nNOTE: the above file is in the trunk as of Oct 12, 2012, but not yet in the latest download which is still 2.25. For the time being until a new Selenium version is released, you can just save this file locally for now and include it in your imports like I've done below.\nTo make life a little simpler, you can combine some of these expected condition methods with the Selenium wait until logic to make some very handy functions similar to what was available in Selenium 1. For example, I put this into my base class called SeleniumTest which all of my Selenium test classes extend:\nfrom selenium.common.exceptions import TimeoutException\nfrom selenium.webdriver.common.by import By\nimport selenium.webdriver.support.expected_conditions as EC\nimport selenium.webdriver.support.ui as ui\n\n@classmethod\ndef setUpClass(cls):\n    cls.selenium = WebDriver()\n    super(SeleniumTest, cls).setUpClass()\n\n@classmethod\ndef tearDownClass(cls):\n    cls.selenium.quit()\n    super(SeleniumTest, cls).tearDownClass()\n\n# return True if element is visible within 2 seconds, otherwise False\ndef is_visible(self, locator, timeout=2):\n    try:\n        ui.WebDriverWait(driver, timeout).until(EC.visibility_of_element_located((By.CSS_SELECTOR, locator)))\n        return True\n    except TimeoutException:\n        return False\n\n# return True if element is not visible within 2 seconds, otherwise False\ndef is_not_visible(self, locator, timeout=2):\n    try:\n        ui.WebDriverWait(driver, timeout).until_not(EC.visibility_of_element_located((By.CSS_SELECTOR, locator)))\n        return True\n    except TimeoutException:\n        return False\n\nYou can then use these easily in your tests like so:\ndef test_search_no_city_entered_then_city_selected(self):\n    sel = self.selenium\n    sel.get('%s%s' % (self.live_server_url, '/'))\n    self.is_not_visible('#search-error')\n\n"", '\nI have made good experiences using:\n\ntime.sleep(seconds)\nwebdriver.Firefox.implicitly_wait(seconds)\n\nThe first one is pretty obvious - just wait a few seconds for some stuff.\nFor all my Selenium Scripts the sleep() with a few seconds (range from 1 to 3) works when I run them on my laptop, but on my Server the time to wait has a wider range, so I use implicitly_wait() too. I usually use implicitly_wait(30), which is really enough.\n\nAn implicit wait is to tell WebDriver to poll the DOM for a certain amount of time when trying to find an element or elements if they are not immediately available. The default setting is 0. Once set, the implicit wait is set for the life of the WebDriver object instance.\n\n', '\nI implemented the following for python for wait_for_condition since the python selenium driver does not support this function.\ndef wait_for_condition(c):\nfor x in range(1,10):\n    print ""Waiting for ajax: "" + c\n    x = browser.execute_script(""return "" + c)\n    if(x):\n        return\n    time.sleep(1)\n\nto be used as\nWait that an ExtJS Ajax call is not pending:\nwait_for_condition(""!Ext.Ajax.isLoading()"")\n\nA Javascript variable is set\nwait_for_condition(""CG.discovery != undefined;"")\n\netc.\n', '\nYou could always use a short sleep in a loop and pass it your element id:\ndef wait_for_element(element):\n     count = 1\n     if(self.is_element_present(element)):\n          if(self.is_visible(element)):\n              return\n          else:\n              time.sleep(.1)\n              count = count + 1\n     else:\n         time.sleep(.1)\n         count = count + 1\n         if(count > 300):\n             print(""Element %s not found"" % element)\n             self.stop\n             #prevents infinite loop\n\n', '\nUse Wait Until Page Contains Element with the proper XPath locator. For example, given the following HTML:\n<body>\n  <div id=""myDiv"">\n    <table class=""myTable"">\n      <!-- implementation -->\n    </table>\n  </div>\n</body>\n\n... you can enter the following keyword:\nWait Until Page Contains Element  //table[@class=\'myTable\']  5 seconds\n\nUnless I missed something, there is no need to create a new function for this.\n', '\nIn case this helps ...\nIn the Selenium IDE, I added ...\n  Command: waitForElementPresent\n  Target: //table[@class=\'pln\']\nThen I did File>Export TestCase As Python2(Web Driver), and it gave me this ...\ndef test_sel(self):\n    driver = self.driver\n    for i in range(60):\n        try:\n            if self.is_element_present(By.XPATH, ""//table[@class=\'pln\']""): break\n        except: pass\n        time.sleep(1)\n    else: self.fail(""time out"")\n\n', ""\neasier solution: \n    from selenium.webdriver.common.by import By    \n    import time\n\n    while len(driver.find_elements(By.ID, 'cs-paginate-next'))==0:\n        time.sleep(100)\n\n"", ""\nHopefully this helps\nfrom selenium import webdriver\nfrom selenium.webdriver.support import expected_conditions as EC\nfrom selenium.webdriver.support.wait import WebDriverWait\nfrom selenium.webdriver.common.by import By   \n\n\ndriver = webdriver.Firefox()\ndriver.get('www.url.com')\n\ntry:\n    wait = driver.WebDriverWait(driver,10).until(EC.presence_of_element_located(By.CLASS_NAME,'x'))\nexcept:\n    pass\n\n"", ""\nIf I don't know something about selenium command, I use selenium web idea RC with firefox. You can choose and add command in the combobox and when finish your test case after you can export the test code different language. like java, ruby, phyton, C#, etc..\n"", '\nYou can modify this function to all type of elements. The one below is just for the class element:\nWhere ""driver"" is the driver, ""element_name"" is the class name you are looking for, and ""sec"" is the maximum amount of seconds you are willing to wait.\ndef wait_for_class_element(driver,element_name,sec):\n\n    for i in range(sec):        \n        try:\n            driver.find_element_by_class_name(element_name)\n            break\n        except:        \n            print(""not yet"")\n            time.sleep(1)\n\n', ""\nI found an easier way to build this using a custom function, which is recursive in nature\nfrom selenium import webdriver\nimport time\n\ndef wait_element_by_id(id_value):\n    try:\n        elem = driver.find_element_by_id(id_value)\n    except:\n        time.sleep(2)\n        print 'Waiting for id '+id_value\n        wait_element_by_id(id_value)\n\nYou can replace find_element_by_id with find_element_by_name or find_element_by_tag_name based on your requirement\n"", '\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support import expected_conditions as EC\nfrom selenium.webdriver.support.ui import WebDriverWait\n\n\n# wait until present\nWebDriverWait(driver, waittime).until(\n    EC.presence_of_element_located((By.CSS_SELECTOR, css_selector))\n)\n\n# wait until visible\nWebDriverWait(driver, waittime).until(\n    EC.visibility_of_element_located((By.CSS_SELECTOR, css_selector))\n)\n\n', ""\nI hope that's might help:\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.common.keys import Keys\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as ec\n\ndriver = webdriver.Chrome()\ndriver.get(myURL)\nwait = WebDriverWait(driver, 10) \n\nwait.until(ec.presence_of_element_located((By.XPATH, myXPATH)))\n\nI recommend you to read this article to make it more clear.\n""]"
How to Automatically Start a Download in PHP?,"
What code do you need to add in PHP to automatically have the browser download a file to the local machine when a link is visited?
I am specifically thinking of functionality similar to that of download sites that prompt the user to save a file to disk once you click on the name of the software?
",114k,"
            55
        ","['\nSend the following headers before outputting the file:\nheader(""Content-Disposition: attachment; filename=\\"""" . basename($File) . ""\\"""");\nheader(""Content-Type: application/octet-stream"");\nheader(""Content-Length: "" . filesize($File));\nheader(""Connection: close"");\n\n@grom: Interesting about the \'application/octet-stream\' MIME type. I wasn\'t aware of that, have always just used \'application/force-download\' :)\n', '\nHere is an example of sending back a pdf.\nheader(\'Content-type: application/pdf\');\nheader(\'Content-Disposition: attachment; filename=""\' . basename($filename) . \'""\');\nheader(\'Content-Transfer-Encoding: binary\');\nreadfile($filename);\n\n@Swish I didn\'t find application/force-download content type to do anything different (tested in IE and Firefox). Is there a reason for not sending back the actual MIME type?\nAlso in the PHP manual Hayley Watson posted:\n\nIf you wish to force a file to be downloaded and saved, instead of being rendered, remember that there is no such MIME type as ""application/force-download"". The correct type to use in this situation is ""application/octet-stream"", and using anything else is merely relying on the fact that clients are supposed to ignore unrecognised MIME types and use ""application/octet-stream"" instead (reference: Sections 4.1.4 and 4.5.1 of RFC 2046).\n\nAlso according IANA there is no registered application/force-download type.\n', '\nA clean example.\n<?php\n    header(\'Content-Type: application/download\');\n    header(\'Content-Disposition: attachment; filename=""example.txt""\');\n    header(""Content-Length: "" . filesize(""example.txt""));\n\n    $fp = fopen(""example.txt"", ""r"");\n    fpassthru($fp);\n    fclose($fp);\n?>\n\n', '\nNone of above worked for me!\nWorking on 2021 for WordPress and PHP:\n<?php\n$file = ABSPATH . \'pdf.pdf\'; // Where ABSPATH is the absolute server path, not url\n//echo $file; //Be sure you are echoing the absolute path and file name\n$filename = \'Custom file name for the.pdf\'; /* Note: Always use .pdf at the end. */\n\nheader(\'Content-type: application/pdf\');\nheader(\'Content-Disposition: inline; filename=""\' . $filename . \'""\');\nheader(\'Content-Transfer-Encoding: binary\');\nheader(\'Content-Length: \' . filesize($file));\nheader(\'Accept-Ranges: bytes\');\n@readfile($file);\n\nThanks to: https://qastack.mx/programming/4679756/show-a-pdf-files-in-users-browser-via-php-perl\n', '\nmy code works for txt,doc,docx,pdf,ppt,pptx,jpg,png,zip extensions and I think its better to use the actual MIME types explicitly.\n$file_name = ""a.txt"";\n\n// extracting the extension:\n$ext = substr($file_name, strpos($file_name,\'.\')+1);\n\nheader(\'Content-disposition: attachment; filename=\'.$file_name);\n\nif(strtolower($ext) == ""txt"")\n{\n    header(\'Content-type: text/plain\'); // works for txt only\n}\nelse\n{\n    header(\'Content-type: application/\'.$ext); // works for all extensions except txt\n}\nreadfile($decrypted_file_path);\n\n']"
Headless browser for C# (.NET)? [closed],"






Closed. This question does not meet Stack Overflow guidelines. It is not currently accepting answers.
                        
                    










 We don’t allow questions seeking recommendations for books, tools, software libraries, and more. You can edit the question so it can be answered with facts and citations.


Closed 6 years ago.







                        Improve this question
                    



I am (was) a Python developer who is building a GUI web scraping application. Recently I've decided to migrate to .NET framework and write the same application in C# (this decision wasn't mine).
In Python, I've used the Mechanize library. However, I can't seem to find anything similar in .NET. What I need is a browser that will run in a headless mode, which has the ability to fill out forms, submit them, etc. JavaScript parser is not a must, but it would be quite useful. 
",57k,"
            40
        ","['\nThere are some options:\n\nWebKit.Net (free)\n\nAwesomium\nIt is based on Chrome/WebKit and works like a charm.\nThere is a free license available but also a commercial one and if need be you can buy the source code :-)\n\nHTML Agility Pack (free) (An HTML Parser library, NOT a headless browser)\nThis helps with extracting information from HTML etc. and might be useful in your case (possibly in combination with HttpWebRequest)\n\n\n', ""\nMore solutions:\n\nPhantomJS - full featured headless web\nbrowser. Often used in pair with Selenium which allows you to\naccess the browser from .NET application.\nOptimus (nuget package)- lightweight headless web browser. It's in beta but it is sufficient for some cases.\n\nI used to use both for web testing. But they are also suitable for web scraping.\n"", ""\nYou may be after TrifleJS (currently in beta), or something similar using the .NET WebBrowser class which communicates with IE via a windowless ActiveX/COM API.\nYou'll essentially be running a fully fledged browser (not a http request wrapper) using Internet Explorer's Trident engine, if you are not interested in the JavaScript API (a port of phantomjs) you may still be able to use some of the C# codebase to get around key concepts (custom headers, cookies, script execution, screenshot rendering etc). \nNote that this can also emulate different versions of IE depending on what you have installed.\n\n""]"
Karate UI drag and drop [duplicate],"






This question already has an answer here:
                        
                    



KarateDSL UI Testing - Friendly Locators not working

                                (1 answer)
                            

Closed 2 years ago.



I am studying KarateUI possibilities. And I tried to use drag and drop functionality of framework.
I used a page with draggable elements https://www.seleniumeasy.com/test/drag-and-drop-demo.html and my script does not work on it. What is wrong with my script? Here it is:
mouse().move('{div/span}Draggable 1').down().move('#mydropzone').up()

And i also see in console of IDE next log
16:11:40.196 [ForkJoinPool-1-worker-1] DEBUG c.intuit.karate.driver.DriverOptions - >> {""method"":""Input.dispatchMouseEvent"",""params"":{""type"":""mouseMoved"",""x"":31,""y"":820},""id"":16}
16:11:40.200 [nioEventLoopGroup-2-1] DEBUG c.intuit.karate.driver.DriverOptions - << {""id"":16,""result"":{}}
16:11:40.203 [ForkJoinPool-1-worker-1] DEBUG c.intuit.karate.driver.DriverOptions - >> {""method"":""Input.dispatchMouseEvent"",""params"":{""type"":""mousePressed"",""x"":31,""y"":820,""button"":""left"",""clickCount"":1},""id"":17}
16:11:40.234 [nioEventLoopGroup-2-1] DEBUG c.intuit.karate.driver.DriverOptions - << {""id"":17,""result"":{}}
16:11:40.234 [ForkJoinPool-1-worker-1] DEBUG c.intuit.karate.driver.DriverOptions - >> {""method"":""Input.dispatchMouseEvent"",""params"":{""type"":""mouseMoved"",""x"":231,""y"":827},""id"":18}
16:11:40.242 [nioEventLoopGroup-2-1] DEBUG c.intuit.karate.driver.DriverOptions - << {""id"":18,""result"":{}}
16:11:40.242 [ForkJoinPool-1-worker-1] DEBUG c.intuit.karate.driver.DriverOptions - >> {""method"":""Input.dispatchMouseEvent"",""params"":{""type"":""mouseReleased"",""x"":231,""y"":827,""button"":""left"",""clickCount"":1},""id"":19}
16:11:40.250 [nioEventLoopGroup-2-1] DEBUG c.intuit.karate.driver.DriverOptions - << {""id"":19,""result"":{}}

",4k,"
            1
        ","['\nDrag and drop is actually quite hard to get right, so I recommend doing this via JavaScript. Executing JS is actually quite easy using Karate:\n* driver \'https://www.seleniumeasy.com/test/drag-and-drop-demo.html\'\n* script(""var myDragEvent = new Event(\'dragstart\'); myDragEvent.dataTransfer = new DataTransfer()"")\n* waitFor(\'{}Draggable 1\').script(""_.dispatchEvent(myDragEvent)"")\n* script(""var myDropEvent = new Event(\'drop\'); myDropEvent.dataTransfer = myDragEvent.dataTransfer"")\n* script(\'#mydropzone\', ""_.dispatchEvent(myDropEvent)"")\n* screenshot()\n\nSo with a little bit of awareness of some of the internals - e.g. the HTML5 DataTransfer API - you can do pretty much anything. I think ""bending the rules"" in cases like this is fine when it comes to automating complex E2E user-interactions in a browser.\nYou can of course wrap the drag-and-drop into a re-usable function in Karate, just keep in mind that ""DOM JS"" is sent to the browser as plain-text.\nRefer the docs: https://github.com/intuit/karate/tree/master/karate-core#function-composition\nEDIT: for those looking for other examples of using JS on the DOM:\n\nhttps://stackoverflow.com/a/60618233/143475\nhttps://stackoverflow.com/a/61478834/143475\nhttps://stackoverflow.com/a/66677401/143475\nhttps://stackoverflow.com/a/67701399/143475\nhttps://stackoverflow.com/a/67629911/143475\n\n']"
How can I use powershell to run through an installer?,"
I am trying to install a piece of software that when done manually has configuration options you can choose from when going through the process. I am trying to figure out a way to automate this using powershell but am stuck as to how I can set those configuration options. I believe I would need to run the start-process command on the installer .exe but I don't know where to go from there. Can I use the parameters on the start-process command to pass in the configurations I want? 
",11k,"
            0
        ","['\nUPDATE: Several links towards the bottom with information on how to handle installation, configuration and file extraction for setup.exe files.\nUPDATE: See Windows Installer PowerShell Module on github.com (scroll down for description, use releases tab for download). I haven\'t really tested it much, but it is from Heath Stewart - Microsoft Senior Software Engineer (github).\n\nI had a quick look for that installer, but didn\'t find it easily. Essentially the installer is either a Windows Installer database (MSI) or something else  - generally a setup.exe of some kind. An MSI database can also be wrapped in a setup.exe.\nYou should be aware that for legacy style installers a common practice for large scale deployment is to capture the legacy install with an application repackager tool, and then compile an MSI file to use for installation (effectively converting an installer from an old format to modern MSI format). This is a specialist task requiring good understanding of Windows and setups. It is generally done in large corporations for very large software distributions. If you are in a large company there might be a team dedicated to packaging software like the one you mention. Maybe check with your management. If the setup is an MSI the same team can also modify that for you according to your specifications.\n\nWith regards to your installer EXE. Try to run setup.exe /a from the command line and see if you get an option to extract files to a ""network install point"" (administrative install). Then you are dealing with an MSI file wrapped in a setup.exe. If that doesn\'t work you can try setup.exe /x or setup.exe /extract as well. \nWindows Installer has built-in features to allow you to customize the install via PUBLIC properties (uppercase) set at the command line or applied via a transform (Windows Installer\'s mechanism to apply substantial changes to the vendor file - it is a partial database that gets applied to the installation database from the vendor at runtime).\nNon-MSI, legacy installer technologies generally have fewer reliable ways to customize the installation settings, and they tend to be rather ad hoc when they are there. In particular the silent running and uninstall may be features that are missing or poorly executed. These installs are generally all wrapped in EXE format, and there are many tools used to generate them - each with their own quirks and features.\nIn other words, it all depends on what the installer is implemented as. Give that setup.exe /a a go, and update your answer with new information for us (don\'t add too many comments - we will check back).\n\nWith regards to using PowerShell. I haven\'t used PowerShell for deployment so far to be perfectly honest. Here is a basic description of how to install using PowerShell: https://kevinmarquette.github.io/2016-10-21-powershell-installing-msi-files/\nYou can also invoke automation for MSI files from PowerShell, I don\'t think this is relevant for what you asked, but here is a quick link for modifying a transform file: http://www.itninja.com/question/ps-how-to-edit-a-mst-file.\nThe normal way to install MSI files is via Window\'s built-in msiexec.exe command line. The basic msiexec.exe command line to install software is:\nmsiexec.exe /I ""C:\\Your.msi"" /QN /L*V ""C:\\msilog.log"" TRANSFORMS=""C:\\1031.mst;C:\\My.mst""\n\nQuick Parameter Explanation:\n/I = run install sequence\n/QN = run completely silently\n/L*V ""C:\\msilog.log"" = verbose logging\nTRANSFORMS=""C:\\1031.mst;C:\\My.mst"" = Apply transforms 1031.mst and My.mst (see below).\n\nWhat is a transform? Explained here: How to make better use of MSI files.\nAdvanced Installer has a general page on msiexec.exe command lines. And here is Microsoft\'s msiexec.exe documentation on MSDN.\n\nSome links:\n\nPerhaps see Michael Urman\'s answer here: Programmatically extract contents of InstallShield setup.exe. This is for Installshield packaged EXE files only.\nInstallshield setup.exe commands (general reference with some sample command lines - towards the end of the document it looks like the command lines are not correct, but the first ones look ok. The later ones are pretty obscure anyway - just thought I\'d let you know since I link to it). Here is the official Installshield help documentation.\nWise setup.exe commands - Wise is no longer available, but if the setup is older it can still be packaged with Wise.\nAdvanced Installer standard command line. For this tool setups can apparently be extracted with setup.exe /x or setup.exe /extract. See the link for full list. \nThere was also a ""silent switch finder"" tool used to find hidden switches in exe files (for deployment), but it failed a virustotal.com scan so I won\'t link to it. Maybe it is using something exotic, such as scanning a file\'s header at a bit level or something weird that is flagged as malware by mistake? Either way, not a tool I would use.\nAnd finally: http://unattended.sourceforge.net/installers.php. This link isn\'t bad, it presents some of the tools above and a few others - and the most common switches used. Untested by me, but looks ok.\nAnd there are other deployment tools that have their own way of packaging and delivering EXE files - it can be a jungle. I can provide a list of such tools with more links, but maybe that\'s just confusing. Please try what is provided above first.\nHere is a generic answer that might be helpful as well: Extract MSI from EXE\n\n']"
Running script upon login in mac OS X [closed],"






Closed. This question is off-topic. It is not currently accepting answers.
                        
                    










Want to improve this question? Update the question so it's on-topic for Stack Overflow.


Closed 10 years ago.


This post was edited and submitted for review 8 months ago and failed to reopen the post:

Original close reason(s) were not resolved






                        Improve this question
                    



I am wondering if anyone is able to help me out with getting a shell (.sh) program to automatically run whenever I log in to my account on my computer. I am running Mac OS X 10.6.7.
I have a file ""Example.sh"" that I want to run when I log onto my computer. I do not have a problem running it when I am already logged in, but I want this to run automatically.
",329k,"
            338
        ","['\nFollow this:\n\nstart Automator.app\n\nselect Application\n\nclick Show library in the toolbar (if hidden)\n\nadd Run shell script (from the Actions/Utilities)\n\ncopy & paste your script into the window\n\ntest it\n\nsave somewhere (for example you can make an Applications folder in your HOME, you will get an your_name.app)\n\ngo to System Preferences -> Users & Groups -> Login items (or System Preferences -> Accounts -> Login items / depending of your MacOS version)\n\nadd this app\n\ntest & done ;)\n\n\nEDIT:\nI\'ve recently earned a ""Good answer"" badge for this answer. While my solution is simple and working, the cleanest way to run any program or shell script at login time is described in @trisweb\'s answer, unless, you want interactivity.\nWith automator solution you can do things like next:\n\nso, asking to run a script or quit the app, asking passwords, running other automator workflows at login time, conditionally run applications at login time and so on...\n', '\ntl;dr: use OSX\'s native process launcher and manager, launchd.\nTo do so, make a launchctl daemon. You\'ll have full control over all aspects of the script. You can run once or keep alive as a daemon. In most cases, this is the way to go.\n\nCreate a .plist file according to the instructions in the Apple Dev docs here or more detail below.\nPlace in ~/Library/LaunchAgents\nLog in (or run manually via launchctl load [filename.plist])\n\nFor more on launchd, the wikipedia article is quite good and describes the system and its advantages over other older systems.\n\nHere\'s the specific plist file to run a script at login.\n\nUpdated 2017/09/25 for OSX El Capitan and newer (credit to José Messias Jr):\n\n<?xml version=""1.0"" encoding=""UTF-8""?>\n<!DOCTYPE plist PUBLIC ""-//Apple Computer//DTD PLIST 1.0//EN"" ""http://www.apple.com/DTDs/PropertyList-1.0.dtd"">\n<plist version=""1.0"">\n<dict>\n   <key>Label</key>\n   <string>com.user.loginscript</string>\n   <key>ProgramArguments</key>\n   <array><string>/path/to/executable/script.sh</string></array>\n   <key>RunAtLoad</key>\n   <true/>\n</dict>\n</plist>\n\nReplace the <string> after the Program key with your desired command (note that any script referenced by that command must be executable: chmod a+x /path/to/executable/script.sh to ensure it is for all users).\nSave as ~/Library/LaunchAgents/com.user.loginscript.plist\nRun launchctl load ~/Library/LaunchAgents/com.user.loginscript.plist and log out/in to test (or to test directly, run launchctl start com.user.loginscript)\nTail /var/log/system.log for error messages.\nThe key is that this is a User-specific launchd entry, so it will be run on login for the given user. System-specific launch daemons (placed in /Library/LaunchDaemons) are run on boot.\nIf you want a script to run on login for all users, I believe LoginHook is your only option, and that\'s probably the reason it exists.\n', '\n\nCreate a shell script named as login.sh in your $HOME folder.\n\nPaste the following one-line script into Script Editor: do shell script ""$HOME/login.sh""\n\nThen save it as an application.\n\nFinally add the application to your login items.\n\n\nIf you want to make the script output visual, you can swap step 2 for this:\ntell application ""Terminal""\n  activate\n  do script ""$HOME/login.sh""\nend tell\n\nIf multiple commands are needed something like this can be used:\ntell application ""Terminal""\n  activate\n  do script ""cd $HOME""\n  do script ""./login.sh"" in window 1\nend tell\n\n']"
How to copy a file to a remote server in Python using SCP or SSH?,"
I have a text file on my local machine that is generated by a daily Python script run in cron. 
I would like to add a bit of code to have that file sent securely to my server over SSH.
",358k,"
            134
        ","['\nTo do this in Python (i.e. not wrapping scp through subprocess.Popen or similar) with the Paramiko library, you would do something like this:\nimport os\nimport paramiko\n\nssh = paramiko.SSHClient() \nssh.load_host_keys(os.path.expanduser(os.path.join(""~"", "".ssh"", ""known_hosts"")))\nssh.connect(server, username=username, password=password)\nsftp = ssh.open_sftp()\nsftp.put(localpath, remotepath)\nsftp.close()\nssh.close()\n\n(You would probably want to deal with unknown hosts, errors, creating any directories necessary, and so on).\n', '\nYou can call the scp bash command (it copies files over SSH) with subprocess.run:\nimport subprocess\nsubprocess.run([""scp"", FILE, ""USER@SERVER:PATH""])\n#e.g. subprocess.run([""scp"", ""foo.bar"", ""joe@srvr.net:/path/to/foo.bar""])\n\nIf you\'re creating the file that you want to send in the same Python program, you\'ll want to call subprocess.run command outside the with block you\'re using to open the file (or call .close() on the file first if you\'re not using a with block), so you know it\'s flushed to disk from Python.\nYou need to generate (on the source machine) and install (on the destination machine) an ssh key beforehand so that the scp automatically gets authenticated with your public ssh key (in other words, so your script doesn\'t ask for a password).\n', '\nYou\'d probably use the subprocess module. Something like this:\nimport subprocess\np = subprocess.Popen([""scp"", myfile, destination])\nsts = os.waitpid(p.pid, 0)\n\nWhere destination is probably of the form user@remotehost:remotepath. Thanks to\n@Charles Duffy for pointing out the weakness in my original answer, which used a single string argument to specify the scp operation shell=True - that wouldn\'t handle whitespace in paths.\nThe module documentation has examples of error checking that you may want to perform in conjunction with this operation.\nEnsure that you\'ve set up proper credentials so that you can perform an unattended, passwordless scp between the machines. There is a stackoverflow question for this already.\n', '\nThere are a couple of different ways to approach the problem:\n\nWrap command-line programs\nuse a Python library that provides SSH capabilities (eg - Paramiko or Twisted Conch)\n\nEach approach has its own quirks. You will need to setup SSH keys to enable password-less logins if you are wrapping system commands like ""ssh"", ""scp"" or ""rsync."" You can embed a password in a script using Paramiko or some other library, but you might find the lack of documentation frustrating, especially if you are not familiar with the basics of the SSH connection (eg - key exchanges, agents, etc). It probably goes without saying that SSH keys are almost always a better idea than passwords for this sort of stuff.\nNOTE: its hard to beat rsync if you plan on transferring files via SSH, especially if the alternative is plain old scp.\nI\'ve used Paramiko with an eye towards replacing system calls but found myself drawn back to the wrapped commands due to their ease of use and immediate familiarity. You might be different. I gave Conch the once-over some time ago but it didn\'t appeal to me.\nIf opting for the system-call path, Python offers an array of options such as os.system or the commands/subprocess modules. I\'d go with the subprocess module if using version 2.4+.\n', '\nReached the same problem, but instead of ""hacking"" or emulating command line:\nFound this answer here.\nfrom paramiko import SSHClient\nfrom scp import SCPClient\n\nssh = SSHClient()\nssh.load_system_host_keys()\nssh.connect(\'example.com\')\n\nwith SCPClient(ssh.get_transport()) as scp:\n    scp.put(\'test.txt\', \'test2.txt\')\n    scp.get(\'test2.txt\')\n\n', '\nYou can do something like this, to handle the host key checking as well\nimport os\nos.system(""sshpass -p password scp -o StrictHostKeyChecking=no local_file_path username@hostname:remote_path"")\n\n', '\nfabric could be used to upload files vis ssh:\n#!/usr/bin/env python\nfrom fabric.api import execute, put\nfrom fabric.network import disconnect_all\n\nif __name__==""__main__"":\n    import sys\n    # specify hostname to connect to and the remote/local paths\n    srcdir, remote_dirname, hostname = sys.argv[1:]\n    try:\n        s = execute(put, srcdir, remote_dirname, host=hostname)\n        print(repr(s))\n    finally:\n        disconnect_all()\n\n', '\nYou can use the vassal package, which is exactly designed for this.\nAll you need is to install vassal and do\nfrom vassal.terminal import Terminal\nshell = Terminal([""scp username@host:/home/foo.txt foo_local.txt""])\nshell.run()\n\nAlso, it will save you authenticate credential and don\'t need to type them again and again.\n', '\nUsing the external resource paramiko;\n    from paramiko import SSHClient\n    from scp import SCPClient\n    import os\n\n    ssh = SSHClient() \n    ssh.load_host_keys(os.path.expanduser(os.path.join(""~"", "".ssh"", ""known_hosts"")))\n    ssh.connect(server, username=\'username\', password=\'password\')\n    with SCPClient(ssh.get_transport()) as scp:\n            scp.put(\'test.txt\', \'test2.txt\')\n\n', ""\nI used sshfs to mount the remote directory via ssh, and shutil to copy the files:\n$ mkdir ~/sshmount\n$ sshfs user@remotehost:/path/to/remote/dst ~/sshmount\n\nThen in python:\nimport shutil\nshutil.copy('a.txt', '~/sshmount')\n\nThis method has the advantage that you can stream data over if you are generating data rather than caching locally and sending a single large file.\n"", ""\nTry this if you wan't to use SSL certificates:\nimport subprocess\n\ntry:\n    # Set scp and ssh data.\n    connUser = 'john'\n    connHost = 'my.host.com'\n    connPath = '/home/john/'\n    connPrivateKey = '/home/user/myKey.pem'\n\n    # Use scp to send file from local to host.\n    scp = subprocess.Popen(['scp', '-i', connPrivateKey, 'myFile.txt', '{}@{}:{}'.format(connUser, connHost, connPath)])\n\nexcept CalledProcessError:\n    print('ERROR: Connection to host failed!')\n\n"", '\nA very simple approach is the following: \nimport os\nos.system(\'sshpass -p ""password"" scp user@host:/path/to/file ./\')\n\nNo python library are required (only os), and it works, however using this method relies on another ssh client to be installed. This could result in undesired behavior if ran on another system.\n', '\nCalling scp command via subprocess doesn\'t allow to receive the progress report inside the script. pexpect could be used to extract that info:\nimport pipes\nimport re\nimport pexpect # $ pip install pexpect\n\ndef progress(locals):\n    # extract percents\n    print(int(re.search(br\'(\\d+)%$\', locals[\'child\'].after).group(1)))\n\ncommand = ""scp %s %s"" % tuple(map(pipes.quote, [srcfile, destination]))\npexpect.run(command, events={r\'\\d+%\': progress})\n\nSee python copy file in local network (linux -> linux)\n', '\nKind of hacky, but the following should work :)\nimport os\nfilePath = ""/foo/bar/baz.py""\nserverPath = ""/blah/boo/boom.py""\nos.system(""scp ""+filePath+"" user@myserver.com:""+serverPath)\n\n']"
"Exception in thread ""main"" org.openqa.selenium.NoSuchElementException: Unable to locate element: //*[@id='login-email']","
I had to re-test the xpath, Previously it was working fine, But now it gives me an error. 
I tried with different locators as well, Like id, name. but still get the same error.
package staging;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.firefox.FirefoxDriver;

public class login {

    public static void main (String[]args){
        System.setProperty(""webdriver.gecko.driver"",""C:\\Program Files\\geckodriver.exe"");
        WebDriver driver = new FirefoxDriver();

        //opening the browser
        driver.get(""https://staging.keela.co/login"");

        //logging
        driver.findElement(By.xpath(""//*[@id='login-email']"")).sendKeys(""bandanakeela@yopmail.com"");
        driver.findElement(By.xpath(""//*[@id='login-password']"")).sendKeys(""keela"");
        driver.findElement(By.xpath(""//*[@id='login-form']/div[3]/div/button"")).click();       
 }
}

",12k,"
            5
        ","['\nAs you access the url https://staging.keela.co/login there is a Ajax loader which blocks the UI, so we have to wait for the Ajax loader to complete loading the all the WebElements and the email and password field becomes visible. To achieve that we will introduce ExplicitWait i.e. WebDriverWait with ExpectedConditions set to elementToBeClickable for the email field.Here is the working code block:   \nSystem.setProperty(""webdriver.gecko.driver"",""C:\\\\Utility\\\\BrowserDrivers\\\\geckodriver.exe"");\nWebDriver driver = new FirefoxDriver();\ndriver.get(""https://staging.keela.co/login"");\nWebDriverWait wait = new WebDriverWait (driver, 15);\nWebElement element = wait.until(ExpectedConditions.elementToBeClickable(By.xpath(""//input[@id=\'login-email\']"")));\nelement.sendKeys(""bandanakeela@yopmail.com"");\ndriver.findElement(By.xpath(""//input[@id=\'login-password\']"")).sendKeys(""keela"");\ndriver.findElement(By.xpath(""//button[@class=\'btn btn-sm btn-block btn-primary\']"")).click(); \n\n', '\nTry this below code.\nNote: If id attribute is available then you should use id and for xpath try to use relative xpath.\nI have used explicit wait method, so your driver may able to find the next webelement, after page is fully loaded. \ndriver.get(""https://staging.keela.co/login"");\ndriver.manage().window().maximize();\n\n//Explicit wait for 60 seconds, to find the webelement. You can increase or decrease the time as per your specification.        \nnew WebDriverWait(driver, 60).until(ExpectedConditions.elementToBeClickable(driver.findElement(By.id(""login-email""))));\ndriver.findElement(By.id(""login-email"")).sendKeys(""bandanakeela@yopmail.com"");\ndriver.findElement(By.id(""login-password"")).sendKeys(""keela"");\ndriver.findElement(By.xpath(""//button[@type=\'submit\'][text()=\'Log in\']"")).click();\n\n', '\nThe page is using js to construct elements. So I would suggest you to use phantomjs driver. \nThen you have to wait until element exist. You see the gear icon when page is loading. wait until the element loads. and also you can use id instead of xpath since you know your element id .\nYou can choose which wait type you want to use. Explicit Waits or Implicit Waits.\nHere is the selenium documentation.\nand example code for wait:\nWebElement myDynamicElement = (new WebDriverWait(driver, 10))\n  .until(ExpectedConditions.presenceOfElementLocated(By.id(""login-email"")));\n\nor you can wait until page load:\nnew WebDriverWait(firefoxDriver, pageLoadTimeout).until(\n          webDriver -> ((JavascriptExecutor) webDriver).executeScript(""return document.readyState"").equals(""complete""));\n\n', '\nYou are opening the URL and at the very next moment entering email-id. Before entering email-id, you need to check if the page is fully loaded. In this case, explicit wait will help you out-\n//opening the browser\ndriver.get(""https://staging.keela.co/login"");\n\n//Explicit wait\n\nWebDriverWait wait = new WebDriverWait(WebDriverRefrence,20);\nWebElement email;\nemail = wait.until(ExpectedConditions.visibilityOfElementLocated(By.id(""login-email"")));\n\n//logging\ndriver.findElement(By.xpath(""//*[@id=\'login-email\']"")).sendKeys(""bandanakeela@yopmail.com"");\ndriver.findElement(By.xpath(""//*[@id=\'login-password\']"")).sendKeys(""keela"");\ndriver.findElement(By.xpath(""//*[@id=\'login-form\']/div[3]/div/button"")).click();\n\n']"
Have bash script answer interactive prompts [duplicate],"






This question already has answers here:
                        
                    



Passing arguments to an interactive program non-interactively

                                (5 answers)
                            

Closed 2 years ago.
The community reviewed whether to reopen this question 1 year ago and left it closed:

Original close reason(s) were not resolved




Is it possible to have a bash script automatically handle prompts that would normally be presented to the user with default actions?  Currently I am using a bash script to call an in-house tool that will display prompts to the user (prompting for Y/N) to complete actions, however the script I'm writing needs to be completely ""hands-off"", so I need a way to send Y|N to the prompt to allow the program to continue execution.  Is this possible?
",215k,"
            157
        ","['\nA simple\necho ""Y Y N N Y N Y Y N"" | ./your_script\n\nThis allow you to pass any sequence of ""Y"" or ""N"" to your script.\n', '\nThis is not ""auto-completion"", this is automation. One common tool for these things is called Expect.\nYou might also get away with just piping input from yes.\n', '\nIf you only have Y to send : \n$> yes Y |./your_script\n\nIf you only have N to send : \n$> yes N |./your_script\n\n', '\nI found the best way to send input is to use cat and a text file to pass along whatever input you need.\ncat ""input.txt"" | ./Script.sh\n\n', ""\nIn my situation I needed to answer some questions without Y or N but with text or blank.  I found the best way to do this in my situation was to create a shellscript file.  In my case I called it autocomplete.sh\nI was needing to answer some questions for a doctrine schema exporter so my file looked like this.\n-- This is an example only --\nphp vendor/bin/mysql-workbench-schema-export mysqlworkbenchfile.mwb ./doctrine << EOF\n`#Export to Doctrine Annotation Format`                                     1\n`#Would you like to change the setup configuration before exporting`        y\n`#Log to console`                                                           y\n`#Log file`                                                                 testing.log\n`#Filename [%entity%.%extension%]`\n`#Indentation [4]`\n`#Use tabs [no]`\n`#Eol delimeter (win, unix) [win]`\n`#Backup existing file [yes]`\n`#Add generator info as comment [yes]`\n`#Skip plural name checking [no]`\n`#Use logged storage [no]`\n`#Sort tables and views [yes]`\n`#Export only table categorized []`\n`#Enhance many to many detection [yes]`\n`#Skip many to many tables [yes]`\n`#Bundle namespace []`\n`#Entity namespace []`\n`#Repository namespace []`\n`#Use automatic repository [yes]`\n`#Skip column with relation [no]`\n`#Related var name format [%name%%related%]`\n`#Nullable attribute (auto, always) [auto]`\n`#Generated value strategy (auto, identity, sequence, table, none) [auto]`\n`#Default cascade (persist, remove, detach, merge, all, refresh, ) [no]`\n`#Use annotation prefix [ORM\\]`\n`#Skip getter and setter [no]`\n`#Generate entity serialization [yes]`\n`#Generate extendable entity [no]`                                          y\n`#Quote identifier strategy (auto, always, none) [auto]`\n`#Extends class []`\n`#Property typehint [no]`\nEOF\n\nThe thing I like about this strategy is you can comment what your answers are and using EOF a blank line is just that (the default answer).  Turns out by the way this exporter tool has its own JSON counterpart for answering these questions, but I figured that out after I did this =).\nto run the script simply be in the directory you want and run 'sh autocomplete.sh' in terminal.\nIn short by using << EOL & EOF in combination with Return Lines you can answer each question of the prompt as necessary.  Each new line is a new answer.\nMy example just shows how this can be done with comments also using the ` character so you remember what each step is.\nNote the other advantage of this method is you can answer with more then just Y or N ... in fact you can answer with blanks!\nHope this helps someone out.\n"", ""\nThere is a special build-in util for this - 'yes'.\nTo answer all questions with the same answer, you can run \nyes [answer] |./your_script\n\nOr you can put it inside your script have specific answer to each question\n""]"
Is there a PHP equivalent of Perl's WWW::Mechanize?,"
I'm looking for a library that has functionality similar to Perl's WWW::Mechanize, but for PHP. Basically, it should allow me to submit HTTP GET and POST requests with a simple syntax, and then parse the resulting page and return in a simple format all forms and their fields, along with all links on the page.
I know about CURL, but it's a little too barebones, and the syntax is pretty ugly (tons of curl_foo($curl_handle, ...) statements
Clarification:
I want something more high-level than the answers so far. For example, in Perl, you could do something like:
# navigate to the main page
$mech->get( 'http://www.somesite.com/' ); 

# follow a link that contains the text 'download this'
$mech->follow_link( text_regex => qr/download this/i );

# submit a POST form, to log into the site
$mech->submit_form(
    with_fields      => {
        username    => 'mungo',
        password    => 'lost-and-alone',
    }
);

# save the results as a file
$mech->save_content('somefile.zip');

To do the same thing using HTTP_Client or wget or CURL would be a lot of work, I'd have to manually parse the pages to find the links, find the form URL, extract all the hidden fields, and so on. The reason I'm asking for a PHP solution is that I have no experience with Perl, and I could probably build what I need with a lot of work, but it would be much quicker if I could do the above in PHP.
",15k,"
            26
        ","[""\nSimpleTest's ScriptableBrowser can be used independendly from the testing framework. I've used it for numerous automation-jobs.\n"", '\nI feel compelled to answer this, even though its an old post... I\'ve been working with PHP curl a lot and it is not as good anywhere near comparable to something like WWW:Mechanize, which I am switching to (I think I am going to go with the Ruby language implementation).. Curl is outdated as it requires too much ""grunt work"" to automate anything, the simpletest scriptable browser looked promising to me but in testing it, it won\'t work on most web forms I try it on... honestly, I think PHP is lacking in this category of scraping, web automation so its best to look at a different language, just wanted to post this since I have spent countless hours on this topic and maybe it will save someone else some time in the future.\n', '\nIt\'s 2016 now and there\'s Mink. It even supports different engines from headless pure-PHP ""browser"" (without JavaScript), over Selenium (which needs a browser like Firefox or Chrome) to a headless ""browser.js"" in NPM, which DOES support JavaScript.\n', '\nTry looking in the PEAR library. If all else fails, create an object wrapper for curl.\nYou can so something simple like this:\nclass curl {\n    private $resource;\n\n    public function __construct($url) {\n        $this->resource = curl_init($url);\n    }\n\n    public function __call($function, array $params) {\n        array_unshift($params, $this->resource);\n        return call_user_func_array(""curl_$function"", $params);\n    }\n}\n\n', ""\nTry one of the following:\n\nPEAR's HTTP_Request\nZend_Http_Client\n\n(Yes, it's ZendFramework code, but it doesn't make your class slower using it since it just loads the required libs.)\n"", '\nLook into Snoopy:\nhttp://sourceforge.net/projects/snoopy/\n', '\nCurl is the way to go for simple requests. It runs cross platform, has a PHP extension and is widely adopted and tested.\nI created a nice class that can GET and POST an array of data (INCLUDING FILES!) to a url by just calling CurlHandler::Get($url, $data) || CurlHandler::Post($url, $data). There\'s an optional HTTP User authentication option too :)\n/**\n * CURLHandler handles simple HTTP GETs and POSTs via Curl \n * \n * @package Pork\n * @author SchizoDuckie\n * @copyright SchizoDuckie 2008\n * @version 1.0\n * @access public\n */\nclass CURLHandler\n{\n\n    /**\n     * CURLHandler::Get()\n     * \n     * Executes a standard GET request via Curl.\n     * Static function, so that you can use: CurlHandler::Get(\'http://www.google.com\');\n     * \n     * @param string $url url to get\n     * @return string HTML output\n     */\n    public static function Get($url)\n    {\n       return self::doRequest(\'GET\', $url);\n    }\n\n    /**\n     * CURLHandler::Post()\n     * \n     * Executes a standard POST request via Curl.\n     * Static function, so you can use CurlHandler::Post(\'http://www.google.com\', array(\'q\'=>\'StackOverFlow\'));\n     * If you want to send a File via post (to e.g. PHP\'s $_FILES), prefix the value of an item with an @ ! \n     * @param string $url url to post data to\n     * @param Array $vars Array with key=>value pairs to post.\n     * @return string HTML output\n     */\n    public static function Post($url, $vars, $auth = false) \n    {\n       return self::doRequest(\'POST\', $url, $vars, $auth);\n    }\n\n    /**\n     * CURLHandler::doRequest()\n     * This is what actually does the request\n     * <pre>\n     * - Create Curl handle with curl_init\n     * - Set options like CURLOPT_URL, CURLOPT_RETURNTRANSFER and CURLOPT_HEADER\n     * - Set eventual optional options (like CURLOPT_POST and CURLOPT_POSTFIELDS)\n     * - Call curl_exec on the interface\n     * - Close the connection\n     * - Return the result or throw an exception.\n     * </pre>\n     * @param mixed $method Request Method (Get/ Post)\n     * @param mixed $url URI to get or post to\n     * @param mixed $vars Array of variables (only mandatory in POST requests)\n     * @return string HTML output\n     */\n    public static function doRequest($method, $url, $vars=array(), $auth = false)\n    {\n        $curlInterface = curl_init();\n\n        curl_setopt_array ($curlInterface, array( \n            CURLOPT_URL => $url,\n            CURLOPT_RETURNTRANSFER => 1,\n            CURLOPT_FOLLOWLOCATION =>1,\n            CURLOPT_HEADER => 0));\n        if (strtoupper($method) == \'POST\')\n        {\n            curl_setopt_array($curlInterface, array(\n                CURLOPT_POST => 1,\n                CURLOPT_POSTFIELDS => http_build_query($vars))\n            );  \n        }\n        if($auth !== false)\n        {\n              curl_setopt($curlInterface, CURLOPT_USERPWD, $auth[\'username\'] . "":"" . $auth[\'password\']);\n        }\n        $result = curl_exec ($curlInterface);\n        curl_close ($curlInterface);\n\n        if($result === NULL)\n        {\n            throw new Exception(\'Curl Request Error: \'.curl_errno($curlInterface) . "" - "" . curl_error($curlInterface));\n        }\n        else\n        {\n            return($result);\n        }\n    }\n\n}\n\n?>\n\n[edit] Read the clarification only now... You probably want to go with one of the tools mentioned above that automates stuff. You could also decide to use a clientside firefox extension like ChickenFoot for more flexibility. I\'ll leave the example class above here for future searches.\n', '\nIf you\'re using CakePHP in your project, or if you\'re inclined to extract the relevant library you can use their curl wrapper HttpSocket. It has the simple page-fetching syntax you describe, e.g., \n# This is the sugar for importing the library within CakePHP       \nApp::import(\'Core\', \'HttpSocket\');\n$HttpSocket = new HttpSocket();\n\n$result = $HttpSocket->post($login_url,\narray(\n  ""username"" => ""username"",\n  ""password"" => ""password""\n)\n);\n\n...although it doesn\'t have a way to parse the response page. For that I\'m going to use simplehtmldom: http://net.tutsplus.com/tutorials/php/html-parsing-and-screen-scraping-with-the-simple-html-dom-library/ which describes itself as having a jQuery-like syntax.\nI tend to agree that the bottom line is that PHP doesn\'t have the awesome scraping/automation libraries that Perl/Ruby have.\n', ""\nIf you're on a *nix system you could use shell_exec() with wget, which has a lot of nice options.\n""]"
CRON job to run on the last day of the month,"
I need to create a CRON job that will run on the last day of every month.
I will create it using cPanel.
Any help is appreciated. 
Thanks
",236k,"
            136
        ","['\nPossibly the easiest way is to simply do three separate jobs:\n55 23 30 4,6,9,11        * myjob.sh\n55 23 31 1,3,5,7,8,10,12 * myjob.sh\n55 23 28 2               * myjob.sh\n\nThat will run on the 28th of February though, even on leap years so, if that\'s a problem, you\'ll need to find another way.\n\nHowever, it\'s usually both substantially easier and correct to run the job as soon as possible on the first day of each month, with something like:\n0 0 1 * * myjob.sh\n\nand modify the script to process the previous month\'s data.\nThis removes any hassles you may encounter with figuring out which day is the last of the month, and also ensures that all data for that month is available, assuming you\'re processing data. Running at five minutes to midnight on the last day of the month may see you missing anything that happens between then and midnight.\nThis is the usual way to do it anyway, for most end-of-month jobs.\n\nIf you still really want to run it on the last day of the month, one option is to simply detect if tomorrow is the first (either as part of your script, or in the crontab itself).\nSo, something like:\n55 23 28-31 * * [[ ""$(date --date=tomorrow +\\%d)"" == ""01"" ]] && myjob.sh\n\nshould be a good start, assuming you have a relatively intelligent date program.\nIf your date program isn\'t quite advanced enough to give you relative dates, you can just put together a very simple program to give you tomorrow\'s day of the month (you don\'t need the full power of date), such as:\n#include <stdio.h>\n#include <time.h>\n\nint main (void) {\n    // Get today, somewhere around midday (no DST issues).\n\n    time_t noonish = time (0);\n    struct tm *localtm = localtime (&noonish);\n    localtm->tm_hour = 12;\n\n    // Add one day (86,400 seconds).\n\n    noonish = mktime (localtm) + 86400;\n    localtm = localtime (&noonish);\n\n    // Output just day of month.\n\n    printf (""%d\\n"", localtm->tm_mday);\n\n    return 0;\n}\n\nand then use (assuming you\'ve called it tomdom for ""tomorrow\'s day of month""):\n55 23 28-31 * * [[ ""$(tomdom)"" == ""1"" ]] && myjob.sh\n\nThough you may want to consider adding error checking since both time() and mktime() can return -1 if something goes wrong. The code above, for reasons of simplicity, does not take that into account.\n', '\nThere\'s a slightly shorter method that can be used similar to one of the ones above. That is:\n[ $(date -d +1day +%d) -eq 1 ] && echo ""last day of month""\n\nAlso, the crontab entry could be update to only check on the 28th to 31st as it\'s pointless running it the other days of the month. Which would give you:\n0 23 28-31 * * [ $(date -d +1day +%d) -eq 1 ] && myscript.sh\n\n', '\nWhat about this one, after Wikipedia?\n55 23 L * * /full/path/to/command\n\n', '\nFor AWS Cloudwatch cron implementation (Scheduling Lambdas, etc..) this works:\n55 23 L * ? *\n\nRunning at 11:55pm on the last day of each month.\n', ""\nAdapting paxdiablo's solution, I run on the 28th and 29th of February.  The data from the 29th overwrites the 28th.\n# min  hr  date     month          dow\n  55   23  31     1,3,5,7,8,10,12   * /path/monthly_copy_data.sh\n  55   23  30     4,6,9,11          * /path/monthly_copy_data.sh\n  55   23  28,29  2                 * /path/monthly_copy_data.sh\n\n"", '\nYou could set up a cron job to run on every day of the month, and have it run a shell script like the following.  This script works out whether tomorrow\'s day number is less than today\'s (i.e. if tomorrow is a new month), and then does whatever you want.\nTODAY=`date +%d`\nTOMORROW=`date +%d -d ""1 day""`\n\n# See if tomorrow\'s day is less than today\'s\nif [ $TOMORROW -lt $TODAY ]; then\necho ""This is the last day of the month""\n# Do stuff...\nfi\n\n', '\nFor a safer method in a crontab based on @Indie solution (use absolute path to date + $() does not works on all crontab systems):\n0 23 28-31 * * [ `/bin/date -d +1day +\\%d` -eq 1 ] && myscript.sh\n\n', '\nSome cron implementations support the ""L"" flag to represent the last day of the month.\nIf you\'re lucky to be using one of those implementations, it\'s as simple as:\n0 55 23 L * ?\n\nThat will run at 11:55 pm on the last day of every month.\nhttp://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger\n', '\n#########################################################\n# Memory Aid \n# environment    HOME=$HOME SHELL=$SHELL LOGNAME=$LOGNAME PATH=$PATH\n#########################################################\n#\n# string         meaning\n# ------         -------\n# @reboot        Run once, at startup.\n# @yearly        Run once a year, ""0 0 1 1 *"".\n# @annually      (same as @yearly)\n# @monthly       Run once a month, ""0 0 1 * *"".\n# @weekly        Run once a week, ""0 0 * * 0"".\n# @daily         Run once a day, ""0 0 * * *"".\n# @midnight      (same as @daily)\n# @hourly        Run once an hour, ""0 * * * *"".\n#mm     hh      Mday    Mon     Dow     CMD # minute, hour, month-day month DayofW CMD\n#........................................Minute of the hour\n#|      .................................Hour in the day (0..23)\n#|      |       .........................Day of month, 1..31 (mon,tue,wed)\n#|      |       |       .................Month (1.12) Jan, Feb.. Dec\n#|      |       |       |        ........day of the week 0-6  7==0\n#|      |       |       |        |      |command to be executed\n#V      V       V       V        V      V\n*       *       28-31   *       *       [ `date -d +\'1 day\' +\\%d` -eq 1 ] && echo ""Tomorrow is the first today now is  `date`"" >> ~/message\n1       0       1       *       *       rm -f ~/message\n*       *       28-31   *       *       [ `date -d +\'1 day\' +\\%d` -eq 1 ] && echo ""HOME=$HOME LOGNAME=$LOGNAME SHELL = $SHELL PATH=$PATH"" \n\n', ""\nSet up a cron job to run on the first day of the month. Then change the system's clock to be one day ahead.\n"", ""\n00 23 * * * [[ $(date +'%d') -eq $(cal | awk '!/^$/{ print $NF }' | tail -1) ]] && job\n\nCheck out a related question on the unix.com forum.\n"", ""\nYou can just connect all answers in one cron line and use only date command.\nJust check the difference between day of the month which is today and will be tomorrow:\n0 23 * * * root [ $(expr $(date +\\%d -d '1 days') - $(date +\\%d)  ) -le 0 ]  && echo true\n\nIf these difference is below 0 it means that we change the month and there is last day of the month.\n"", '\n55 23 28-31 * * echo ""[ $(date -d +1day +%d) -eq 1 ] && my.sh"" | /bin/bash \n\n', '\nI found out solution (On the last day of the month) like below from this site.\n 0 0 0 L * ? *\n\nCRON details:\nSeconds Minutes Hours   Day Of Month    Month   Day Of Week  Year\n0       0       0       L               *       ?            *\n\nTo cross verify above expression,  click here which gives output like below.\n2021-12-31 Fri 00:00:00\n2022-01-31 Mon 00:00:00\n2022-02-28 Mon 00:00:00\n2022-03-31 Thu 00:00:00\n2022-04-30 Sat 00:00:00\n\n', ""\nWhat about this? \nedit user's .bashprofile adding: \nexport LAST_DAY_OF_MONTH=$(cal | awk '!/^$/{ print $NF }' | tail -1)\n\nThen add this entry to crontab: \nmm hh * * 1-7 [[ $(date +'%d') -eq $LAST_DAY_OF_MONTH ]] && /absolutepath/myscript.sh\n\n"", '\nThe last day of month can be 28-31 depending on what month it is (Feb, March etc). However in either of these cases, the next day is always 1st of next month. So we can use that to make sure we run some job always on the last day of a month using the code below:\n0 8 28-31 * * [ ""$(date +%d -d tomorrow)"" = ""01"" ] && /your/script.sh\n\n', ""\nIn tools like Jenkins, where usually there is no support for L nor tools similar to date, a cool trick might be setting up the timezone correctly. E.g. Pacific/Kiritimati is GMT+14:00, so if you're in Europe or in the US, this might do the trick.\nTZ=Pacific/Kiritimati \\n H 0 1 * * \n\nResult: Would last have run at Saturday, April 30, 2022 10:54:53 AM GMT; would next run at Tuesday, May 31, 2022 10:54:53 AM GMT.\n"", ""\nUse the below code to run cron on the last day of the month in PHP\n$commands = '30 23 '.date('t').' '.date('n').' *';\n\n"", '\nNot sure of other languages but in javascript it is possible.\nIf you need your job to be completed before first day of month node-cron will allow you to set timezone - you have to set UTC+12:00 and if job is not too long most of the world will have results before start of their month.\n', '\nIf the day-of-the-month field could accept day zero that would very simply solve this problem. Eg. astronomers use day zero to express the last day of the previous month. So\n00 08 00 * * /usr/local/sbin/backup\n\nwould do the job in simple and easy way.\n', '\nBetter way to schedule cron on every next month of 1st day\nThis will run the command foo at 12:00AM.\n0 0 1 * * /usr/bin/foo\n', '\nBe cautious with ""yesterday"", ""today"", ""1day"" in the \'date\' program if running between midnight and 1am, because often those really mean ""24 hours"" which will be two days when daylight saving time change causes a 23 hour day.  I use ""date -d \'1am -12 hour\' ""\n']"
How can I login to a website with Python?,"
How can I do it? 
I was trying to enter some specified link (with urllib), but to do it, I need to log in.
I have this source from the site:
<form id=""login-form"" action=""auth/login"" method=""post"">
    <div>
    <!--label for=""rememberme"">Remember me</label><input type=""checkbox"" class=""remember"" checked=""checked"" name=""remember me"" /-->
    <label for=""email"" id=""email-label"" class=""no-js"">Email</label>
    <input id=""email-email"" type=""text"" name=""handle"" value="""" autocomplete=""off"" />
    <label for=""combination"" id=""combo-label"" class=""no-js"">Combination</label>
    <input id=""password-clear"" type=""text"" value=""Combination"" autocomplete=""off"" />
    <input id=""password-password"" type=""password"" name=""password"" value="""" autocomplete=""off"" />
    <input id=""sumbitLogin"" class=""signin"" type=""submit"" value=""Sign In"" />

Is this possible?
",373k,"
            105
        ","['\nMaybe you want to use twill. It\'s quite easy to use and should be able to do what you want.\nIt will look like the following:\nfrom twill.commands import *\ngo(\'http://example.org\')\n\nfv(""1"", ""email-email"", ""blabla.com"")\nfv(""1"", ""password-clear"", ""testpass"")\n\nsubmit(\'0\')\n\nYou can use showforms() to list all forms once you used go… to browse to the site you want to login. Just try it from the python interpreter.\n', '\nLet me try to make it simple, suppose URL of the site is www.example.com and you need to sign up by filling username and password, so we go to the login page say http://www.example.com/login.php now and view it\'s source code and search for the action URL it will be in form tag something like \n <form name=""loginform"" method=""post"" action=""userinfo.php"">\n\nnow take userinfo.php to make absolute URL which will be \'http://example.com/userinfo.php\', now run a simple python script \nimport requests\nurl = \'http://example.com/userinfo.php\'\nvalues = {\'username\': \'user\',\n          \'password\': \'pass\'}\n\nr = requests.post(url, data=values)\nprint r.content\n\nI Hope that this helps someone somewhere someday.\n', '\nTypically you\'ll need cookies to log into a site, which means cookielib, urllib and urllib2. Here\'s a class which I wrote back when I was playing Facebook web games:\nimport cookielib\nimport urllib\nimport urllib2\n\n# set these to whatever your fb account is\nfb_username = ""your@facebook.login""\nfb_password = ""secretpassword""\n\nclass WebGamePlayer(object):\n\n    def __init__(self, login, password):\n        """""" Start up... """"""\n        self.login = login\n        self.password = password\n\n        self.cj = cookielib.CookieJar()\n        self.opener = urllib2.build_opener(\n            urllib2.HTTPRedirectHandler(),\n            urllib2.HTTPHandler(debuglevel=0),\n            urllib2.HTTPSHandler(debuglevel=0),\n            urllib2.HTTPCookieProcessor(self.cj)\n        )\n        self.opener.addheaders = [\n            (\'User-agent\', (\'Mozilla/4.0 (compatible; MSIE 6.0; \'\n                           \'Windows NT 5.2; .NET CLR 1.1.4322)\'))\n        ]\n\n        # need this twice - once to set cookies, once to log in...\n        self.loginToFacebook()\n        self.loginToFacebook()\n\n    def loginToFacebook(self):\n        """"""\n        Handle login. This should populate our cookie jar.\n        """"""\n        login_data = urllib.urlencode({\n            \'email\' : self.login,\n            \'pass\' : self.password,\n        })\n        response = self.opener.open(""https://login.facebook.com/login.php"", login_data)\n        return \'\'.join(response.readlines())\n\nYou won\'t necessarily need the HTTPS or Redirect handlers, but they don\'t hurt, and it makes the opener much more robust. You also might not need cookies, but it\'s hard to tell just from the form that you\'ve posted. I suspect that you might, purely from the \'Remember me\' input that\'s been commented out.\n', '\nWeb page automation ? Definitely ""webbot""\nwebbot even works web pages which have dynamically changing id and classnames and has more methods and features than selenium or mechanize.\n\nHere\'s a snippet :)\n\nfrom webbot import Browser \nweb = Browser()\nweb.go_to(\'google.com\') \nweb.click(\'Sign in\')\nweb.type(\'mymail@gmail.com\' , into=\'Email\')\nweb.click(\'NEXT\' , tag=\'span\')\nweb.type(\'mypassword\' , into=\'Password\' , id=\'passwordFieldId\') # specific selection\nweb.click(\'NEXT\' , tag=\'span\') # you are logged in ^_^\n\nThe docs are also pretty straight forward and simple to  use : https://webbot.readthedocs.io\n', ""\nimport cookielib\nimport urllib\nimport urllib2\n\nurl = 'http://www.someserver.com/auth/login'\nvalues = {'email-email' : 'john@example.com',\n          'password-clear' : 'Combination',\n          'password-password' : 'mypassword' }\n\ndata = urllib.urlencode(values)\ncookies = cookielib.CookieJar()\n\nopener = urllib2.build_opener(\n    urllib2.HTTPRedirectHandler(),\n    urllib2.HTTPHandler(debuglevel=0),\n    urllib2.HTTPSHandler(debuglevel=0),\n    urllib2.HTTPCookieProcessor(cookies))\n\nresponse = opener.open(url, data)\nthe_page = response.read()\nhttp_headers = response.info()\n# The login cookies should be contained in the cookies variable\n\nFor more information visit: https://docs.python.org/2/library/urllib2.html\n"", '\nWebsites in general can check authorization in many different ways, but the one you\'re targeting seems to make it reasonably easy for you.\nAll you need is to POST to the auth/login URL a form-encoded blob with the various fields you see there (forget the labels for, they\'re decoration for human visitors).  handle=whatever&password-clear=pwd and so on, as long as you know the values for the handle (AKA email) and password you should be fine.\nPresumably that POST will redirect you to some ""you\'ve successfully logged in"" page with a Set-Cookie header validating your session (be sure to save that cookie and send it back on further interaction along the session!).\n', '\nFor HTTP things, the current choice should be: Requests- HTTP for Humans\n']"
How to use Selenium with Python?,"
How do I set up Selenium to work with Python? I just want to write/export scripts in Python, and then run them. Are there any resources for that? I tried googling, but the stuff I found was either referring to an outdated version of Selenium (RC), or an outdated version of Python.
",115k,"
            51
        ","['\nYou mean Selenium WebDriver? \nHuh....\nPrerequisite: Install Python based on your OS\nInstall with following command \npip install -U selenium\n\nAnd use this module in your code \nfrom selenium import webdriver\n\nYou can also use many of the following as required \nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import Select\nfrom selenium.common.exceptions import NoSuchElementException\n\nHere is an updated answer\nI would recommend you to run script without IDE... Here is my approach\n\nUSE IDE to find xpath of object / element\nAnd use find_element_by_xpath().click() \n\nAn example below shows login page automation \n#ScriptName : Login.py\n#---------------------\nfrom selenium import webdriver\n\n#Following are optional required\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import Select\nfrom selenium.common.exceptions import NoSuchElementException\n\nbaseurl = ""http://www.mywebsite.com/login.php""\nusername = ""admin""\npassword = ""admin""\n\nxpaths = { \'usernameTxtBox\' : ""//input[@name=\'username\']"",\n           \'passwordTxtBox\' : ""//input[@name=\'password\']"",\n           \'submitButton\' :   ""//input[@name=\'login\']""\n         }\n\nmydriver = webdriver.Firefox()\nmydriver.get(baseurl)\nmydriver.maximize_window()\n\n#Clear Username TextBox if already allowed ""Remember Me"" \nmydriver.find_element_by_xpath(xpaths[\'usernameTxtBox\']).clear()\n\n#Write Username in Username TextBox\nmydriver.find_element_by_xpath(xpaths[\'usernameTxtBox\']).send_keys(username)\n\n#Clear Password TextBox if already allowed ""Remember Me"" \nmydriver.find_element_by_xpath(xpaths[\'passwordTxtBox\']).clear()\n\n#Write Password in password TextBox\nmydriver.find_element_by_xpath(xpaths[\'passwordTxtBox\']).send_keys(password)\n\n#Click Login button\nmydriver.find_element_by_xpath(xpaths[\'submitButton\']).click()\n\nThere is an another way that you can find xpath of any object -\n\nInstall Firebug and Firepath addons in firefox\nOpen URL in Firefox\nPress F12 to open Firepath developer instance \nSelect Firepath in below browser pane and chose select by ""xpath"" \nMove cursor of the mouse to element on webpage\nin the xpath textbox you will get xpath of an object/element.\nCopy Paste xpath to the script.\n\nRun script -\npython Login.py\n\nYou can also use a CSS selector instead of xpath. CSS selectors are slightly faster than xpath in most cases, and are usually preferred over xpath (if there isn\'t an ID attribute on the elements you\'re interacting with).\nFirepath can also capture the object\'s locator as a CSS selector if you move your cursor to the object. You\'ll have to update your code to use the equivalent find by CSS selector method instead -\nfind_element_by_css_selector(css_selector) \n\n', ""\nThere are a lot of sources for selenium - here is good one for simple use Selenium, and here is a example snippet too Selenium Examples\nYou can find a lot of good sources to use selenium, it's not too hard to get it set up and start using it.\n"", '\nYou just need to get selenium package imported, that you can do from command prompt using the command\npip install selenium\n\nWhen you have to use it in any IDE just import this package, no other documentation required to be imported\nFor Eg :\nimport selenium \nprint(selenium.__filepath__)\n\nThis is just a general command you may use in starting to check the filepath of selenium\n']"
How to put the WebBrowser control into IE9 into standards?,"
i am using automation (i.e. COM automation) to display some HTML in Internet Explorer (9):
ie = CoInternetExplorer.Create;
ie.Navigate2(""about:blank"");
webDocument = ie.Document;
webDocument.Write(szSourceHTML);
webDocument.Close();
ie.Visible = True;

Internet Explorer appears, showing my html, which starts off as:
<!DOCTYPE html>
<HTML>
<HEAD>
   ...


Note: the html5 standards-mode opt-in doctype html

Except that the document is not in ie9 standards mode; it's in ie8 standards mode:


If i save the html to my computer first:

and then view that html document, IE is put into standards mode:

My question is how update my SpawnIEWithSource(String html) function to throw the browser into standards mode?
void SpawnIEWithSource(String html)
{
   Variant ie = CoInternetExplorer.Create();
   ie.Navigate2(""about:blank"");
   webDocument = ie.Document;
   webDocument.Write(html);
   webDocument.Close();
   ie.Visible = true;
}


Edit: A more verbose, less understandable or readable code sample, that doesn't help further the question might be:
IWebBrowser2 ie;
CoCreateInstance(CLASS_InternetExplorer, null, CLSCTX_INPROC_SERVER | CLSCTX_LOCAL_SERVER, IID_WebBrowser2, ie);
ie.AddRef();
ie.Navigate2(""about:blank"");

IHtmlDocument doc;
dispDoc = ie.Document;
dispDoc.AddRef();
dispDoc.QueryInterface(IHTMLDocument2, doc);
dispDoc.Release()
doc.Write(html); 
doc.Close();
doc.Release();
ie.Visible = true;
ie.Release();


Update
Commenter asked on the ieblog entry Testing sites with Browser Mode vs. Doc Mode:

Can we get a description of how the document mode is determined when the HTML content is within an embedded webcontrol? Seems to be that the document mode is choosen differently - maybe for compatibility reasons?

MarkSil [MSFT] responded:

@Thomas: Thanks for raising that question. The WebBrowser Control determines the doc mode the same way that IE does because it contains the same web platform (e.g. there is one shared mshtml.dll across IE and WebBrowser Control hosts). The WebBrowser Control does default to the Compatibility View browser mode, which means that the default doc mode is IE7. Here is a blog post with more detail on this: blogs.msdn.com/.../more-ie8-extensibility-improvements.aspx.

To which Thomas responded:

@MarcSil (re: WebBrowser Control)
The problem with using registry entries to select document mode for WebControl is that it applies to the application as a whole. I write plugins for Google SketchUp where you have WebDialog windows to create UIs - it's just a WebBrowser control in a window. But that leads to problems as I want to force a document mode for my instance of the WebBrowser control, not for all of SU's WebBrowser controls as a whole.
So, my question is: how do you control the document mode per instance for a WebBrowser control?

",29k,"
            27
        ","['\nHave you tried setting in your html the\n<meta http-equiv=""X-UA-Compatible"" content=""IE=9"" />\n\nor\n<meta http-equiv=""X-UA-Compatible"" content=""IE=edge"" />\n\nwhich means latest version\n', '\nThe IE9 ""version"" of the WebBrowser control, like the IE8 version, is actually several browsers in one. Unlike the IE8 version, you do have a little more control over the rendering mode inside the page by changing the doctype. Of course, to change the browser mode you have to set your registry like the earlier answer. Here is the location of FEATURE_BROWSER_EMULATION:\nHKEY_LOCAL_MACHINE (or HKEY_CURRENT_USER)\n     SOFTWARE\n          Microsoft\n               Internet Explorer\n                    Main\n                         FeatureControl\n                              FEATURE_BROWSER_EMULATION\n                                   contoso.exe = (DWORD) 000090000\n\nHere is the complete set of codes:\n\n9999 (0x270F) - Internet Explorer 9.\nWebpages are displayed in IE9\nStandards mode, regardless of the\n!DOCTYPE directive. \n9000 (0x2328) - Internet Explorer 9. Webpages containing standards-based !DOCTYPE\ndirectives are displayed in IE9 mode.   \n8888 (0x22B8) -Webpages are\ndisplayed in IE8 Standards mode,\nregardless of the !DOCTYPE directive.\n8000 (0x1F40) - Webpages containing\nstandards-based !DOCTYPE directives\nare displayed in IE8 mode.\n7000 (0x1B58) - Webpages containing\nstandards-based !DOCTYPE directives\nare displayed in IE7 Standards mode.\n\nThe full docs:\nhttp://msdn.microsoft.com/en-us/library/ee330730%28VS.85%29.aspx#browser_emulation\n', '\nFEATURE_BROWSER_EMULATION does not works with CoInternetSetFeatureEnabled. The documentation of INTERNETFEATURELIST is not updated since IE7.\nSince the feature setting is under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl you may be able to override the value in your process via a registry API hook. \n']"
"C# WebBrowser Control - Form Submit Not Working using InvokeMember(""Click"")","
I am working on automated testing script and am using the WebBrowser control. I am trying to submit the following HTML and testing when the user accepts the terms of service:
    <form action=""http://post.dev.dealerconnextion/k/6hRbDTwn4xGVl2MHITQsBw/hrshq"" method=""post"">
        <input name=""StepCheck"" value=""U2FsdGVkX18zMTk5MzE5OUgFyFgD3V5yf5Rwbtfhf3gjdH4KSx4hqj4vkrw7K6e-"" type=""hidden"">
        <button type=""submit"" name=""continue"" value=""y"">ACCEPT the terms of use</button>
        <button type=""submit"" name=""continue"" value=""n"">DECLINE the terms of use</button>
    </form>

    // Terms of Use Information

    <form action=""http://post.dev.dealerconnextion/k/6hRbDTwn4xGVl2MHITQsBw/hrshq"" method=""post"">
        <input name=""StepCheck"" value=""U2FsdGVkX18zMTk5MzE5OUgFyFgD3V5yf5Rwbtfhf3gjdH4KSx4hqj4vkrw7K6e-"" type=""hidden"">
        <button type=""submit"" name=""continue"" value=""y"">ACCEPT the terms of use</button>
        <button type=""submit"" name=""continue"" value=""n"">DECLINE the terms of use</button>
    </form>

Here is the code in C#, but does not submit the form.
            HtmlElementCollection el = webBrowser.Document.GetElementsByTagName(""button"");
            foreach (HtmlElement btn in el)
            {
                if (btn.InnerText == ""ACCEPT the terms of use"")
                {
                    btn.InvokeMember(""Click"");
                }
            }

Any help would be much appreciated. Thanks.
",16k,"
            5
        ","['\nThe following code works for me, using the live form action URL from the question comments, tested with IE10. Try it as is. If it works for you as well, feel free to use it as a template for your web automation tasks. A couple of points:\n\nFEATURE_BROWSER_EMULATION is used to make sure the WebBrowser behaves in the same way as standalone IE browser (or as close as possible). This is a must for almost any WebBrowser-based project. I believe that\'s what should help to solve the original problem on your side.  \nAsynchronous code is used to improve the automation logic reliability, add support timeouts and cancellation and promote natural linear code flow (using async/await).\n\nC#:\nusing Microsoft.Win32;\nusing System;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\n\nnamespace WebAutomation\n{\n    // http://stackoverflow.com/q/19044659/1768303\n\n    public partial class MainForm : Form\n    {\n        WebBrowser webBrowser;\n\n        // non-deterministic delay to let AJAX code run\n        const int AJAX_DELAY = 1000;\n\n        // keep track of the main automation task\n        CancellationTokenSource mainCts;\n        Task mainTask = null;\n\n        public MainForm()\n        {\n            SetBrowserFeatureControl(); // set FEATURE_BROWSER_EMULATION first\n\n            InitializeComponent();\n\n            InitBrowser();\n\n            this.Load += (s, e) =>\n            {\n                // start the automation when form is loaded\n                // timeout the whole automation task in 30s\n                mainCts = new CancellationTokenSource(30000);\n                mainTask = DoAutomationAsync(mainCts.Token).ContinueWith((completedTask) =>\n                {\n                    Trace.WriteLine(String.Format(""Automation task status: {0}"", completedTask.Status.ToString()));\n                }, TaskScheduler.FromCurrentSynchronizationContext());\n            };\n\n            this.FormClosing += (s, e) =>\n            {\n                // cancel the automation if form closes\n                if (this.mainTask != null && !this.mainTask.IsCompleted)\n                    mainCts.Cancel();\n            };\n        }\n\n        // create a WebBrowser instance (could use an existing one)\n        void InitBrowser()\n        {\n            this.webBrowser = new WebBrowser();\n            this.webBrowser.Dock = DockStyle.Fill;\n            this.Controls.Add(this.webBrowser);\n            this.webBrowser.Visible = true;\n        }\n\n        // the main automation logic\n        async Task DoAutomationAsync(CancellationToken ct)\n        {\n            await NavigateAsync(ct, () => this.webBrowser.Navigate(""http://localhost:81/test.html""), 10000); // timeout in 10s\n            // page loaded, log the page\'s HTML\n            Trace.WriteLine(GetBrowserDocumentHtml());\n\n            // do the DOM automation\n            HtmlElementCollection all = webBrowser.Document.GetElementsByTagName(""button"");\n            // throw if none or more than one element found\n            HtmlElement btn = all.Cast<HtmlElement>().Single(\n                el => el.InnerHtml == ""ACCEPT the terms of use"");\n\n            ct.ThrowIfCancellationRequested();\n\n            // simulate a click which causes navigation\n            await NavigateAsync(ct, () => btn.InvokeMember(""click""), 10000); // timeout in 10s\n\n            // form submitted and new page loaded, log the page\'s HTML\n            Trace.WriteLine(GetBrowserDocumentHtml());\n\n            // could continue with another NavigateAsync\n            // othrwise, the automation session completed\n        }\n\n        // Get the full HTML content of the document\n        string GetBrowserDocumentHtml()\n        {\n            return this.webBrowser.Document.GetElementsByTagName(""html"")[0].OuterHtml;\n        }\n\n        // Async navigation\n        async Task NavigateAsync(CancellationToken ct, Action startNavigation, int timeout = Timeout.Infinite)\n        {\n            var onloadTcs = new TaskCompletionSource<bool>();\n            EventHandler onloadEventHandler = null;\n\n            WebBrowserDocumentCompletedEventHandler documentCompletedHandler = delegate\n            {\n                // DocumentCompleted may be called several time for the same page,\n                // beacuse of frames\n                if (onloadEventHandler != null || onloadTcs == null || onloadTcs.Task.IsCompleted)\n                    return;\n\n                // handle DOM onload event to make sure the document is fully loaded\n                onloadEventHandler = (s, e) =>\n                    onloadTcs.TrySetResult(true);\n                this.webBrowser.Document.Window.AttachEventHandler(""onload"", onloadEventHandler);\n            };\n\n            using (var cts = CancellationTokenSource.CreateLinkedTokenSource(ct))\n            {\n                if (timeout != Timeout.Infinite)\n                    cts.CancelAfter(Timeout.Infinite);\n\n                using (cts.Token.Register(() => onloadTcs.TrySetCanceled(), useSynchronizationContext: true)) \n                {\n                    this.webBrowser.DocumentCompleted += documentCompletedHandler;\n                    try \n                    {\n                        startNavigation();\n                        // wait for DOM onload, throw if cancelled\n                        await onloadTcs.Task;\n                        ct.ThrowIfCancellationRequested();\n                        // let AJAX code run, throw if cancelled\n                        await Task.Delay(AJAX_DELAY, ct);\n                    }\n                    finally \n                    {\n                        this.webBrowser.DocumentCompleted -= documentCompletedHandler;\n                        if (onloadEventHandler != null)\n                            this.webBrowser.Document.Window.DetachEventHandler(""onload"", onloadEventHandler);\n                    }\n                }\n            }\n        }\n\n        // Browser feature conntrol\n        void SetBrowserFeatureControl()\n        {\n            // http://msdn.microsoft.com/en-us/library/ee330720(v=vs.85).aspx\n\n            // FeatureControl settings are per-process\n            var fileName = System.IO.Path.GetFileName(Process.GetCurrentProcess().MainModule.FileName);\n\n            // make the control is not running inside Visual Studio Designer\n            if (String.Compare(fileName, ""devenv.exe"", true) == 0 || String.Compare(fileName, ""XDesProc.exe"", true) == 0)\n                return;\n\n            SetBrowserFeatureControlKey(""FEATURE_BROWSER_EMULATION"", fileName, GetBrowserEmulationMode()); // Webpages containing standards-based !DOCTYPE directives are displayed in IE10 Standards mode.\n        }\n\n        void SetBrowserFeatureControlKey(string feature, string appName, uint value)\n        {\n            using (var key = Registry.CurrentUser.CreateSubKey(\n                String.Concat(@""Software\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\"", feature),\n                RegistryKeyPermissionCheck.ReadWriteSubTree))\n            {\n                key.SetValue(appName, (UInt32)value, RegistryValueKind.DWord);\n            }\n        }\n\n        UInt32 GetBrowserEmulationMode()\n        {\n            int browserVersion = 7;\n            using (var ieKey = Registry.LocalMachine.OpenSubKey(@""SOFTWARE\\Microsoft\\Internet Explorer"",\n                RegistryKeyPermissionCheck.ReadSubTree,\n                System.Security.AccessControl.RegistryRights.QueryValues))\n            {\n                var version = ieKey.GetValue(""svcVersion"");\n                if (null == version)\n                {\n                    version = ieKey.GetValue(""Version"");\n                    if (null == version)\n                        throw new ApplicationException(""Microsoft Internet Explorer is required!"");\n                }\n                int.TryParse(version.ToString().Split(\'.\')[0], out browserVersion);\n            }\n\n            UInt32 mode = 10000; // Internet Explorer 10. Webpages containing standards-based !DOCTYPE directives are displayed in IE10 Standards mode. Default value for Internet Explorer 10.\n            switch (browserVersion)\n            {\n                case 7:\n                    mode = 7000; // Webpages containing standards-based !DOCTYPE directives are displayed in IE7 Standards mode. Default value for applications hosting the WebBrowser Control.\n                    break;\n                case 8:\n                    mode = 8000; // Webpages containing standards-based !DOCTYPE directives are displayed in IE8 mode. Default value for Internet Explorer 8\n                    break;\n                case 9:\n                    mode = 9000; // Internet Explorer 9. Webpages containing standards-based !DOCTYPE directives are displayed in IE9 mode. Default value for Internet Explorer 9.\n                    break;\n                default:\n                    // use IE10 mode by default\n                    break;\n            }\n\n            return mode;\n        }\n    }\n}\n\nThe content of http://localhost:81/test.html:\n<!DOCTYPE html>\n<head>\n<meta http-equiv=""X-UA-Compatible"" content=""IE=edge""/>\n</head>\n<body>\n    <form action=""<the URL from OP\'s comments>"" method=""post"">\n        <input name=""StepCheck"" value=""U2FsdGVkX18zMTk5MzE5OUgFyFgD3V5yf5Rwbtfhf3gjdH4KSx4hqj4vkrw7K6e-"" type=""hidden"">\n        <button type=""submit"" name=""continue"" value=""y"">ACCEPT the terms of use</button>\n        <button type=""submit"" name=""continue"" value=""n"">DECLINE the terms of use</button>\n    </form>\n</body>\n\n', '\nThis works for me as follow. may that would be useful for someone.\nFirst I create an event handler for the button element when got focus. Once all the other form element are filled up with the appropriate values, You should give the focus to the button as follow:\nHtmlElement xUsername = xDoc.GetElementById(""username_txt"");\nHtmlElement xPassword = xDoc.GetElementById(""password_txt"");\nHtmlElement btnSubmit = xDoc.GetElementById(""btnSubmit"");\nif (xUsername != null && xPassword != null && btnSubmit != null)\n{\n    xUsername.SetAttribute(""value"", ""testUserName"");\n    xPassword.SetAttribute(""value"", ""123456789"");\n    btnSubmit.GotFocus += BtnSubmit_GotFocus;\n    btnSubmit.Focus();\n}\n\nThen event handler implementation would be like this:\nprivate void BtnSubmit_GotFocus(object sender, HtmlElementEventArgs e)\n{\n    var btnSubmit = sender as HtmlElement;\n    btnSubmit.RaiseEvent(""onclick"");\n    btnSubmit.InvokeMember(""click"");\n}\n\n', '\nIn my case I also couldn\'t get element clicked by simply invoking Click method of the found element.\nWhat worked is similar solution that Ali Tabandeh listed in his answer above:\n\nfind the needed html element\ndefine proper GotFocus event handler\nthen invoke Focus method of the found element.\n\nEvent handler for GotFocus should\n\nRaiseEvent ""onclick""\nInvoke ""click"" method\n\nThe problem was that this worked in my case from 3rd time (3 times needed to call htmlelement.Focus()).\n']"
webdriver.FirefoxProfile(): Is it possible to use a profile without making a copy of it?,"
As the documentation states, you can call webdriver.FirefoxProfile() with the optional argument of profile_directory to point to the directory of a specific profile you want the browser to use. I noticed it was taking a long time to run this command, so when I looked into the code, it looked like it was copying the specified profile Problem is, it takes an extremely long time for the profile to copy (something like >30 minutes, didn't have the patience to wait for it to finish.)
I'm using a hybrid of userscripts and selenium to do some automation for me, so to setup a new profile every single time I want to test out my code would be burdensome.
Is the only way to change this behaviour to edit the firefox_profile.py itself (if so, what would be the best way to go about it?)?
",10k,"
            6
        ","['\nAs per the current implementation of GeckoDriver with Firefox using the FirefoxProfile() works as follows :\n\nIf case of initiating a Browsing Session through a new Firefox Profile as follows :\nfrom selenium import webdriver\n\nmyprofile = webdriver.FirefoxProfile()\ndriver = webdriver.Firefox(firefox_profile=myprofile, executable_path=r\'C:\\Utility\\BrowserDrivers\\geckodriver.exe\')\ndriver.get(\'https://www.google.co.in\')\nprint(""Page Title is : %s"" %driver.title)\ndriver.quit()\n\nA new rust_mozprofile gets created on the run as follows :\n1521446301607   mozrunner::runner   INFO    Running command: ""C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe"" ""-marionette"" ""-profile"" ""C:\\\\Users\\\\ATECHM~1\\\\AppData\\\\Local\\\\Temp\\\\rust_mozprofile.xFayqKkZrOB8""\n\nOf-coarse on a successful closure (i.e. successful invocation of driver.quit()) the temporary rust_mozprofile.xFayqKkZrOB8 gets deleted/destroyed completely.\nAgain in case of initiating a Browsing Session through an existing Firefox Profile() as follows :\nfrom selenium import webdriver\n\nmyprofile = webdriver.FirefoxProfile(r\'C:\\Users\\AtechM_03\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\moskcpdq.SeleniumTest\')\ndriver = webdriver.Firefox(firefox_profile=myprofile, executable_path=r\'C:\\Utility\\BrowserDrivers\\geckodriver.exe\')\ndriver.get(\'https://www.google.co.in\')\nprint(""Page Title is : %s"" %driver.title)\ndriver.quit()\n\nSimilarly a new rust_mozprofile gets created on the run as follows :\n1521447102321   mozrunner::runner   INFO    Running command: ""C:\\\\Program Files\\\\Mozilla Firefox\\\\firefox.exe"" ""-marionette"" ""-profile"" ""C:\\\\Users\\\\ATECHM~1\\\\AppData\\\\Local\\\\Temp\\\\rust_mozprofile.2oSwrQwQoby9""\n\nSimilarly in this case as well on a successful closure (i.e. successful invocation of driver.quit()) the temporary rust_mozprofile.2oSwrQwQoby9 gets deleted/destroyed completely.\nSo the timespan you are observing is the time needed for a FirefoxProfile() to scoop out a new rust_mozprofile.\n\nPerhaps as per your question timespan for profile to copy (something like >30 minutes) is a pure overhead. So it won\'t be possible to use a Firefox Profile without making a copy of rust_mozprofile.\n\nSolution\n\nUpgrade Selenium Client to  current levels Version 3.11.0.\nUpgrade GeckoDriver to  current GeckoDriver v0.20.0 level.\nUpgrade Firefox version to Firefox Quantum v59.0.1 levels.\nClean your Project Workspace through your IDE and Rebuild your project with required dependencies only.\nUse CCleaner tool to wipe off all the OS chores before and after the execution of your test Suite.\nIf your base Firefox base version is too old, then uninstall it through Revo Uninstaller and install a recent GA and released version of Firefox Quantum.\nExecute your @Test.\n\n']"
Matlab: Running an m-file from command-line,"
Suppose that;
I have an m-file at location:
C:\M1\M2\M3\mfile.m
And exe file of the matlab is at this location:
C:\E1\E2\E3\matlab.exe
I want to run this m-file with Matlab, from command-line, for example inside a .bat file. How can I do this, is there a way to do it?
",214k,"
            124
        ","['\nA command like this runs the m-file successfully:\n""C:\\<a long path here>\\matlab.exe"" -nodisplay -nosplash -nodesktop -r ""run(\'C:\\<a long path here>\\mfile.m\'); exit;""\n', '\nI think that one important point that was not mentioned in the previous answers is that, if not explicitly indicated, the matlab interpreter will remain open.\nTherefore, to the answer of @hkBattousai I will add the exit command:\n""C:\\<a long path here>\\matlab.exe"" -nodisplay -nosplash -nodesktop -r ""run(\'C:\\<a long path here>\\mfile.m\');exit;""\n', '\nHere is what I would use instead, to gracefully handle errors from the script:\n""C:\\<a long path here>\\matlab.exe"" -nodisplay -nosplash -nodesktop -r ""try, run(\'C:\\<a long path here>\\mfile.m\'), catch, exit, end, exit""\n\nIf you want more verbosity:\n""C:\\<a long path here>\\matlab.exe"" -nodisplay -nosplash -nodesktop -r ""try, run(\'C:\\<a long path here>\\mfile.m\'), catch me, fprintf(\'%s / %s\\n\',me.identifier,me.message), end, exit""\n\nI found the original reference here. Since original link is now gone, here is the link to an alternate newreader still alive today:\n\nexit matlab when running batch m file\n\n', '\nOn Linux you can do the same and you can actually send back to the shell a custom error code, like the following:\n#!/bin/bash\nmatlab -nodisplay -nojvm -nosplash -nodesktop -r \\ \n      ""try, run(\'/foo/bar/my_script.m\'), catch, exit(1), end, exit(0);""\necho ""matlab exit code: $?""\n\nit prints matlab exit code: 1 if the script throws an exception, matlab exit code: 0 otherwise.\n', '\nHere are the steps:\n\nStart the command line.\nEnter the folder containing the .m file with cd C:\\M1\\M2\\M3\nRun the following: C:\\E1\\E2\\E3\\matlab.exe -r mfile\n\nWindows systems will use your current folder as the location for MATLAB to search for .m files, and the -r option tries to start the given .m file as soon as startup occurs.\n', '\nSince R2019b, there is a new command line option, -batch. It replaces -r, which is no longer recommended. It also unifies the syntax across platforms. See for example the documentation for Windows, for the other platforms the description is identical.\nmatlab -batch ""statement to run""\n\nThis starts MATLAB without the desktop or splash screen, logs all output to stdout and stderr, exits automatically when the statement completes, and provides an exit code reporting success or error.\nIt is thus no longer necessary to use try/catch around the code to run, and it is no longer necessary to add an exit statement.\n', '\ncat 1.m | matlab -nodesktop -nosplash\n\nAnd I use Ubuntu\n', ""\nThanks to malat. Your comment helped me. \nBut I want to add my try-catch block, as I found the MExeption method getReport() that returns the whole error message and prints it to the matlab console.\nAdditionally I printed the filename as this compilation is part of a batch script that calls matlab.\ntry\n    some_code\n    ...\ncatch message\n    display(['ERROR in file: ' message.stack.file])\n    display(['ERROR: ' getReport(message)])\nend;\n\nFor a false model name passed to legacy code generation method, the output would look like:\nERROR in file: C:\\..\\..\\..\nERROR: Undefined function or variable 'modelname'.\n\nError in sub-m-file (line 63)\nlegacy_code( 'slblock_generate', specs, modelname);\n\nError in m-file (line 11)\nsub-m-file\n\nError in run (line 63)\nevalin('caller', [script ';']);\n\nFinally, to display the output at the windows command prompt window, just log the matlab console to a file with -logfile logfile.txt (use additionally -wait) and call the batch command type logfile.txt\n"", '\nI run this command within a bash script, in particular to submit SGE jobs and batch process things:\n/Path_to_matlab -nodisplay -nosplash -nodesktop < m_file.m\n\n', ""\nSince none of the answers has information about feeding input argument, it is important to \nadd it here. After some research, I found this link\nFeeding the arguments is very similar to how we run a Matlab function. \nmatlab -r 'try myfunction(argument1,argument2); catch; end; quit'\n\nIf you are somehow getting an argument from bash/terminal, you simply need to insert that into the bash command as: \nmatlab -r 'try myfunction($MY_BASH_ARG,argument2); catch; end; quit'\n\n(This is after a couple of trial and error)\n""]"
Handling Browser Authentication using Selenium,"
Does anyone know about handling Browser Authentication using Selenium or any other tool during automation? 
",87k,"
            19
        ","[""\nEDIT in 2015:\nThis answer is outdated. WebDriver nowadays supports authentication! See How to handle authentication popup with Selenium WebDriver using Java\n\nOriginal answer:\nThis is not handled very well by Selenium.\n\nYou can try using http://username:password@example.com/yourpage\ninstead of just http://example.com/yourpage\nHowever, as far as I know, Firefox will still pop up a browser dialog requesting a confirmation.\n\nYou can try Robot if you're using Java (or any similar tool like AutoIt).\n\nYou could use driver.manage().addCookie() if you're using WebDriver.\n\nOr a custom FirefoxProfile that has already passed the authentication once.\n"", ""\nI spent days on this - literally.\nTrying to get past browser level authentication within my company network to hit an application.\nThe solution was to use the 'unsername:password@' component within the URL, BUT to add a forward slash at the end of the login URL.\nSo total login URL looks like this (note the '/' after yourpage):\nhttp://username:password@example.com/yourpage/\nWorks with Watir, Capybara and Selenium Webdriver.\n"", '\nEverything I have read on the Web didn\'t help me. So before making a request, like this:\ndriver.get(url);\n\nyou have to run a new thread like this:\nRunScript runScript = new RunScript();\nrunScript.start();\n\nIn this case you are free to input login and password on another thread of follwing class\npublic class RunScript extends Thread {\n\n@Override\npublic void run() {\n    try {\n        File file = new File(""D:\\\\jacob-1.18-x86.dll"");\n        System.setProperty(LibraryLoader.JACOB_DLL_PATH, file.getAbsolutePath());\n        AutoItX autoIt = new AutoItX();\n        Thread.sleep(2000);\n        autoIt.winActivate(""yourWindowName"", """");\n        autoIt.winWaitActive(""yourWindowName"");\n        if (autoIt.winExists(""yourWindowName"")) {\n            autoIt.send(""username{TAB}"", false);\n            autoIt.send(""password{Enter}"", false);\n            }\n        }\n    } catch (InterruptedException ex) {\n        //\n    }\n}\n}\n\n', '\nAll the hacks via auto-it, sikuli, etc. just wasting your time when you\'ll run it in your CI solution, using several browser types / OS / Version / Resolutions etc.\nThe way to do it correctly is to identify the authentication actual method and perform a login using Rest protocol for instance.\nI used it to get the JSESIONID cookie and insert it to the selenium driver.\nhint on that: go to a non-exiting url of the domian first, then set the cookie, then go to the required url - you are logged-in.\nuse: rest client authentication to get the JSESSION ID \nand With this information:\nbrowser().navigate(foo.getUrl()+""non-exiting-url"");\n\n//the information got from the rest client login:\nCookie cookie = new Cookie(name, value, domain, path, expiry, isSecure, isHttpOnly);\n\ntry {\n    driver.manage().addCookie(cookie);\n} catch (Exception e) {\n    System.out.println(e.toString());\n}\n\nbrowser().navigate(foo.getUrl());\n\n', '\nyou can use auto IT script to handle this problem\nWinWaitActive(""[CLASS:Chrome_WidgetWin_1]"", """", time)\nSend(""user"")\nSend(""{TAB}"")\nSend(""pass"")\nSend(""{ENTER}"")\n\n', '\nwith Chrome 70 and other versions :\nhttp://username:password@example.com/yourpage\n\n', '\nYou can use Java Robot class with Selenium 2 /Selenium WebDriver using Firefox\nWebDriver driver = new FirefoxDriver();\n    driver.get(""http://localhost:9990"");\n\n    WebElement myDynamicElement = driver.findElement(By.id(""app""));\n\n    Alert alert = driver.switchTo().alert();\n\n\n    try {\n        Robot robot = new Robot();\n        alert.sendKeys(""username"");\n\n        robot.keyPress(KeyEvent.VK_TAB);//go to password feild\n\n        robot.keyPress(KeyEvent.VK_P);\n        robot.keyPress(KeyEvent.VK_A);\n        robot.keyPress(KeyEvent.VK_S);\n        robot.keyPress(KeyEvent.VK_S);\n\n        robot.keyPress(KeyEvent.VK_ENTER);\n\n\n        } catch (AWTException e) {\n        e.printStackTrace();\n        }\n\n    }\n\nUsing Selenium with Robot\nhttp://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Robot.html\n']"
How to get the range of occupied cells in excel sheet,"
I use C# to automate an excel file. I was able to get the workbook and the sheets it contains.
If for example I have in sheet1 two cols and 5 rows. I wanted o get the range for the occupied cells as A1:B5. I tried the following code but it did not give the correct result.
the columns # and row # were much bigger and the cells were empty as well. 
     Excel.Range xlRange = excelWorksheet.UsedRange;
     int col = xlRange.Columns.Count;
     int row = xlRange.Rows.Count;

Is there another way I can use to get that range?
",117k,"
            35
        ","['\nI had a very similar issue as you had. What actually worked is this:\niTotalColumns = xlWorkSheet.UsedRange.Columns.Count;\niTotalRows = xlWorkSheet.UsedRange.Rows.Count;\n\n//These two lines do the magic.\nxlWorkSheet.Columns.ClearFormats();\nxlWorkSheet.Rows.ClearFormats();\n\niTotalColumns = xlWorkSheet.UsedRange.Columns.Count;\niTotalRows = xlWorkSheet.UsedRange.Rows.Count;\n\nIMHO what happens is that when you delete data from Excel, it keeps on thinking that there is data in those cells, though they are blank. When I cleared the formats, it removes the blank cells and hence returns actual counts.\n', '\nExcel.Range last = sheet.Cells.SpecialCells(Excel.XlCellType.xlCellTypeLastCell, Type.Missing);\nExcel.Range range = sheet.get_Range(""A1"", last);\n\n""range"" will now be the occupied cell range\n', '\nSee the Range.SpecialCells method. For example, to get cells with constant values or formulas use:\n_xlWorksheet.UsedRange.SpecialCells(\n        Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeConstants |\n        Microsoft.Office.Interop.Excel.XlCellType.xlCellTypeFormulas)\n\n', '\nThe only way I could get it to work in ALL scenarios (except Protected sheets) (based on Farham\'s Answer):\nIt supports:\n\nScanning Hidden Row / Columns\nIgnores formatted cells with no data / formula\n\nCode:\n// Unhide All Cells and clear formats\nsheet.Columns.ClearFormats();\nsheet.Rows.ClearFormats();\n\n// Detect Last used Row - Ignore cells that contains formulas that result in blank values\nint lastRowIgnoreFormulas = sheet.Cells.Find(\n                ""*"",\n                System.Reflection.Missing.Value,\n                InteropExcel.XlFindLookIn.xlValues,\n                InteropExcel.XlLookAt.xlWhole,\n                InteropExcel.XlSearchOrder.xlByRows,\n                InteropExcel.XlSearchDirection.xlPrevious,\n                false,\n                System.Reflection.Missing.Value,\n                System.Reflection.Missing.Value).Row;\n// Detect Last Used Column  - Ignore cells that contains formulas that result in blank values\nint lastColIgnoreFormulas = sheet.Cells.Find(\n                ""*"",\n                System.Reflection.Missing.Value,\n                System.Reflection.Missing.Value,\n                System.Reflection.Missing.Value,\n                InteropExcel.XlSearchOrder.xlByColumns,\n                InteropExcel.XlSearchDirection.xlPrevious,\n                false,\n                System.Reflection.Missing.Value,\n                System.Reflection.Missing.Value).Column;\n\n// Detect Last used Row / Column - Including cells that contains formulas that result in blank values\nint lastColIncludeFormulas = sheet.UsedRange.Columns.Count;\nint lastColIncludeFormulas = sheet.UsedRange.Rows.Count;\n\n', '\ndim lastRow as long   \'in VBA it\'s a long \nlastrow = wks.range(""A65000"").end(xlup).row\n\n', '\nBit old question now, but if somebody is looking for solution this works for me.\nusing Excel = Microsoft.Office.Interop.Excel;\n\nExcel.ApplicationClass excel = new Excel.ApplicationClass();\nExcel.Application app = excel.Application;\nExcel.Range all = app.get_Range(""A1:H10"", Type.Missing);\n\n', ""\nThese two lines on their own wasnt working for me:\nxlWorkSheet.Columns.ClearFormats();\nxlWorkSheet.Rows.ClearFormats();\n\nYou can test by hitting ctrl+end in the sheet and seeing which cell is selected. \nI found that adding this line after the first two solved the problem in all instances I've encountered:\nExcel.Range xlActiveRange = WorkSheet.UsedRange;\n\n"", '\nYou should try the currentRegion property, if you know from where you are to find the range. This will give you the boundaries of your used range.\n', '\nThis is tailored to finding formulas but you should be able to expand it to general content by altering how you test the starting cells.  You\'ll have to handle single cell ranges outside of this.\n    public static Range GetUsedPartOfRange(this Range range)\n    {\n        Excel.Range beginCell = range.Cells[1, 1];\n        Excel.Range endCell = range.Cells[range.Rows.Count, range.Columns.Count];\n\n        if (!beginCell.HasFormula)\n        {\n            var beginCellRow = range.Find(\n                ""*"",\n                beginCell,\n                XlFindLookIn.xlFormulas,\n                XlLookAt.xlPart,\n                XlSearchOrder.xlByRows,\n                XlSearchDirection.xlNext,\n                false);\n\n            var beginCellCol = range.Find(\n                ""*"",\n                beginCell,\n                XlFindLookIn.xlFormulas,\n                XlLookAt.xlPart,\n                XlSearchOrder.xlByColumns,\n                XlSearchDirection.xlNext,\n                false);\n\n            if (null == beginCellRow || null == beginCellCol)\n                return null;\n\n            beginCell = range.Worksheet.Cells[beginCellRow.Row, beginCellCol.Column];\n        }\n\n        if (!endCell.HasFormula)\n        {\n            var endCellRow = range.Find(\n            ""*"",\n            endCell,\n            XlFindLookIn.xlFormulas,\n            XlLookAt.xlPart,\n            XlSearchOrder.xlByRows,         \n            XlSearchDirection.xlPrevious,\n            false);\n\n            var endCellCol = range.Find(\n                ""*"",\n                endCell,\n                XlFindLookIn.xlFormulas,\n                XlLookAt.xlPart,\n                XlSearchOrder.xlByColumns,\n                XlSearchDirection.xlPrevious,\n                false);\n\n            if (null == endCellRow || null == endCellCol)\n                return null;\n\n            endCell = range.Worksheet.Cells[endCellRow.Row, endCellCol.Column];\n        }\n\n        if (null == endCell || null == beginCell)\n            return null;\n\n        Excel.Range finalRng = range.Worksheet.Range[beginCell, endCell];\n\n        return finalRng;\n    }\n}\n\n', '\nYou should not delete the data in box by pressing ""delete"", i think thats the problem , because excel will still detected the box as """" <- still have value, u should delete by right click the box and click delete.\n']"
Selenium Webdriver + Java - Eclipse: java.lang.NoClassDefFoundError,"
I installed JDK from here: http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html
(This version for windows x64: Java SE Development Kit 8u151)
I downloaded eclipse from here:
http://www.eclipse.org/downloads/packages/eclipse-ide-java-developers/oxygenr
(Windows 64-bit)
I opened a new project in eclipse: File->New->Java Project
Then I downloaded Selenium Java Jars from here:
http://www.seleniumhq.org/download/ ---> java language
Then in eclipse I click on my project -> properties ->Java Build Path -> Libraries tab -> Add External JARs... -> I go to ""SeleniumDrivers\Java"" library (there I saved all the JARS that I downloaded) -> I checked all the files there:
these files
I clicked on ""ok"" and created a new class in eclipse
Then I downloaded chromedriver from here: http://www.seleniumhq.org/download
I unzipped it and saved it here: C:\Selenium\Drivers
This is my script:
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;

public class MainClass {

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        System.out.println(""hi there\n"");

        System.setProperty(""webdriver.chrome.driver"", 
        ""C:/Selenium/Drivers/chromedriver.exe"");
        WebDriver driver = new ChromeDriver();
        driver.get(""https://www.facebook.com"");
    }

}

As you can see, this is a very basic script which opens chrome browser and navigate to facebook.
I run this script and got this error:
Exception in thread ""main"" java.lang.NoClassDefFoundError: org/apache/http/config/RegistryBuilder
    at org.openqa.selenium.remote.internal.HttpClientFactory.getClientConnectionManager(HttpClientFactory.java:69)
    at org.openqa.selenium.remote.internal.HttpClientFactory.<init>(HttpClientFactory.java:57)
    at org.openqa.selenium.remote.internal.HttpClientFactory.<init>(HttpClientFactory.java:60)
    at org.openqa.selenium.remote.internal.ApacheHttpClient$Factory.getDefaultHttpClientFactory(ApacheHttpClient.java:242)
    at org.openqa.selenium.remote.internal.ApacheHttpClient$Factory.<init>(ApacheHttpClient.java:219)
    at org.openqa.selenium.remote.HttpCommandExecutor.getDefaultClientFactory(HttpCommandExecutor.java:93)
    at org.openqa.selenium.remote.HttpCommandExecutor.<init>(HttpCommandExecutor.java:72)
    at org.openqa.selenium.remote.service.DriverCommandExecutor.<init>(DriverCommandExecutor.java:63)
    at org.openqa.selenium.chrome.ChromeDriverCommandExecutor.<init>(ChromeDriverCommandExecutor.java:36)
    at org.openqa.selenium.chrome.ChromeDriver.<init>(ChromeDriver.java:181)
    at org.openqa.selenium.chrome.ChromeDriver.<init>(ChromeDriver.java:168)
    at org.openqa.selenium.chrome.ChromeDriver.<init>(ChromeDriver.java:123)
    at MainClass.main(MainClass.java:11)
Caused by: java.lang.ClassNotFoundException: org.apache.http.config.RegistryBuilder
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    ... 13 more

I don't know how to resolve this issue, can you please help to solve it so that I will be able to run my basic script?
",18k,"
            0
        ","[""\njava.lang.NoClassDefFoundError is observed when the JRE can't find a Class.\nIn simple words the required imports or jar files are not available. From the snapshot you have shared its pretty much evident that you have tried to add the Java Client related jars.\nIn this case you need to follow the following steps:\n\nRemove all the jars referring to previous versions of Selenium standalone server & Selenium Java client\nImport only the selenium-server-standalone-3.7.0.\nIn your IDE within Project menu, select the option Build Automatically and execute the Clean option for all of your Projects.\nExecute your Test.\n\n"", ""\nSeems like the latest (v3.7) Selenium-Java zip file contains lesser jars in the lib folder. v3.6 contained 10 lib jars but v3.7 contains only 7 jars. \nThe missing jar which is causing all the issue for the op is 'httpcore-4.4.6.jar'. I am not sure whether the removal of jar is intentional or not. Maybe chromedriver has catch up with Selenium java 3.7seeing that .\nI the mean time use Selenium Java 3.6. Don't forget to add the /lib folder as well.\nhttp://selenium-release.storage.googleapis.com/3.6/selenium-java-3.6.0.zip\n"", ""\ni've added the three missing jars from version 3.6 and fixed everything.\nhttp://selenium-release.storage.googleapis.com/3.6/selenium-java-3.6.0.zip\n"", '\nupdate the the appium java-client to 7.3.0 and selenium-java to 3.141.59 this resolved my issue hope it helps.\n', ""\nI faced the same issue. For me, it didn't found the WebDriver. It seemed to happen as I imported the libraries the location other than classpath. Then I opened up a new project, went to the Properties>Java Build Path>Libraries. This time I imported the libraries under classpath. Now it works fine.\n"", ""\nFor those who are using Appium java client with Selenium, don't try to import Java client and selenium dependencies together in your pom.xml, you have already selenium dependencies imported with the java client dependency, you only have to import Java client dependency in your pom.xml and it should work.\nReference: https://mvnrepository.com/artifact/io.appium/java-client/7.6.0\n"", ""\nFor me, the issue was solved by adding the external jars (selenium-java jar files) to 'Classpath', instead of to 'Modulepath'\n\n""]"
Automating running command on Linux from Windows using PuTTY,"
I have a scenario where I need to run a linux shell command frequently (with different filenames) from windows. I am using PuTTY and WinSCP to do that (requires login name and password).  The file is copied to a predefined folder in the linux machine through WinSCP and then the command is run from PuTTY. Is there a way by which I can automate this through a program. Ideally I would like to right click the file from windows and issue the command which would copy the file to remote machine and run the predefined command (in PuTTy) with the filename as argument.
",267k,"
            71
        ","['\nPutty usually comes with the ""plink"" utility.\nThis is essentially the ""ssh"" command line command implemented as a windows .exe.\nIt pretty well documented in the putty manual under ""Using the command line tool plink"".\nYou just need to wrap a command like:\nplink root@myserver /etc/backups/do-backup.sh\n\nin a .bat script.\nYou can also use common shell constructs, like semicolons to execute multiple commands. e.g:\nplink read@myhost ls -lrt /home/read/files;/etc/backups/do-backup.sh\n\n', '\nThere could be security issues with common methods for auto-login. \nOne of the most easiest ways is documented below:\n\nRunning Putty from the Windows Command Line\n\nAnd as for the part the executes the command\nIn putty UI, Connection>SSH>  there\'s a field for remote command.\n\n4.17 The SSH panel\nThe SSH panel allows you to configure\n  options that only apply to SSH\n  sessions.\n4.17.1 Executing a specific command on the server\nIn SSH, you don\'t have to run a\n  general shell session on the server.\n  Instead, you can choose to run a\n  single specific command (such as a\n  mail user agent, for example). If you\n  want to do this, enter the command in\n  the ""Remote command"" box.\n  http://the.earth.li/~sgtatham/putty/0.53/htmldoc/Chapter4.html\n\nin short, your answers might just as well be similar to the text below:  \n\nlet Putty run command in remote server\n\n', '\nYou can write a TCL script and establish SSH session to that Linux machine and issue commands automatically. Check http://wiki.tcl.tk/11542 for a short tutorial.\n', '\nYou can create a putty session, and auto load the script on the server, when starting the session:\nputty -load ""sessionName"" \n\nAt remote command, point to the remote script.\n', '\nYou can do both tasks (the upload and the command execution) using WinSCP. Use WinSCP script like:\noption batch abort\noption confirm off\nopen your_session\nput %1%\ncall script.sh\nexit\n\nReference for the call command:\nhttps://winscp.net/eng/docs/scriptcommand_call\nReference for the %1% syntax:\nhttps://winscp.net/eng/docs/scripting#syntax\nYou can then run the script like:\nwinscp.exe /console /script=script_path\\upload.txt /parameter file_to_upload.dat\n\nActually, you can put a shortcut to the above command to the Windows Explorer\'s Send To menu, so that you can then just right-click any file and go to the Send To > Upload using WinSCP and Execute Remote Command (=name of the shortcut).\nFor that, go to the folder %USERPROFILE%\\SendTo and create a shortcut with the following target:\nwinscp_path\\winscp.exe /console /script=script_path\\upload.txt /parameter %1\n\nSee Creating entry in Explorer\'s ""Send To"" menu.\n', '\nHere is a totally out of the box solution.\n\nInstall AutoHotKey (ahk)\nMap the script to a key (e.g. F9)\nIn the ahk script,\na) Ftp the commands (.ksh) file to the linux machine\nb) Use plink like below. Plink should be installed if you have putty.\n\n\nplink sessionname -l username -pw password test.ksh\n\nor\n\nplink -ssh example.com -l username -pw password test.ksh\n\nAll the steps will be performed in sequence whenever you press F9 in windows.\n', '\nCode:\nusing System;\nusing System.Diagnostics;\nnamespace playSound\n{\n    class Program\n    {\n        public static void Main(string[] args)\n        {\n            Console.WriteLine(args[0]);\n\n            Process amixerMediaProcess = new Process();\n            amixerMediaProcess.StartInfo.CreateNoWindow = false;\n            amixerMediaProcess.StartInfo.UseShellExecute = false;\n            amixerMediaProcess.StartInfo.ErrorDialog = false;\n            amixerMediaProcess.StartInfo.RedirectStandardOutput = false;\n            amixerMediaProcess.StartInfo.RedirectStandardInput = false;\n            amixerMediaProcess.StartInfo.RedirectStandardError = false;\n            amixerMediaProcess.EnableRaisingEvents = true;\n\n            amixerMediaProcess.StartInfo.Arguments = string.Format(""{0}"",""-ssh username@""+args[0]+"" -pw password -m commands.txt"");\n            amixerMediaProcess.StartInfo.FileName = ""plink.exe"";\n            amixerMediaProcess.Start();\n\n\n            Console.Write(""Presskey to continue . . . "");\n            Console.ReadKey(true);\n    }\n}\n\n}\nSample commands.txt:\nps\nLink: https://huseyincakir.wordpress.com/2015/08/27/send-commands-to-a-remote-device-over-puttyssh-putty-send-command-from-command-line/\n', '\nTry MtPutty,\nyou can automate the ssh login in it. Its a great tool especially if you need to login to multiple servers many times. Try it here\nAnother tool worth trying is TeraTerm. Its really easy to use for the ssh automation stuff. You can get it here. But my favorite one is always MtPutty.\n', '\nIn case you are using Key based authentication, using saved Putty session seems to work great, for example to run a shell script on a remote server(In my case an ec2).Saved configuration will take care of authentication.\nC:\\Users> plink saved_putty_session_name path_to_shell_file/filename.sh\nPlease remember if you save your session with name like(user@hostname), this command would not work as it will be treated as part of the remote command.\n']"
Disposing of Microsoft.Office.Interop.Word.Application,"
(Somewhat of a follow on from the post (which remains unanswered): https://stackoverflow.com/q/6197829/314661)
Using the following code
Application app = new Application();
_Document doc = app.Documents.Open(""myDocPath.docx"", false, false, false);
doc.PrintOut(false);
doc.Close();

I am attempting to open and print a file programmatically.
The problem is each time I run the above code a new WINWORD.exe process is started and obviously this quickly eats up all the memory.
The application class doesn't seem to contain a dispose/close or similar method.
After a bit of research I (realized) and changed the code to the following.
 Application app = new Application();
 _Document doc = app.Documents.Open(fullFilePath + "".doc"", false, false, false);
 doc.PrintOut(false);
 doc.Close();
 int res = System.Runtime.InteropServices.Marshal.ReleaseComObject(doc);
 int res1 = System.Runtime.InteropServices.Marshal.ReleaseComObject(app);

And I can see the remaining reference count is zero but the processes remain? 
PS: I'm using Version 14 of the Microsoft.Office.Interop library.
",77k,"
            42
        ","['\nDo you not need to call Quit?\napp.Quit();\n\n', '\nPerhaps try setting doc = null and calling GC.Collect()\nEdit, not really my own code I forget where I got it but this is what I use to dispose of Excel, and it does the job maybe you can glean something from this:\npublic void DisposeExcelInstance()\n{\n    app.DisplayAlerts = false;\n    workBook.Close(null, null, null);\n    app.Workbooks.Close();\n    app.Quit();\n    if (workSheet != null)\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(workSheet);\n    if (workBook != null)\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(workBook);\n    if (app != null)\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(app);\n    workSheet = null;\n    workBook = null;\n    app = null;\n    GC.Collect(); // force final cleanup!\n}\n\n', '\nI think the main issue, which nobody seems to have picked up on, is that you shouldn\'t be creating a new Application object in the first place if Word is already open.\nThose of us who have been coding since the days of COM and/or VB6 will remember GetActiveObject. Fortunately .Net only requires a ProgID.\nThe recommended way of doing this is as follows:\ntry\n{\n    wordApp = (word.Application) Marshal.GetActiveObject(""Word.Application"");\n}\ncatch(COMException ex) when (ex.HResult == -2147221021)\n{\n    wordApp = new word.Application();\n}\n\n', '\nThe best solution.. last:\ntry {\n\n    Microsoft.Office.Interop.Word.Application appWord = new Microsoft.Office.Interop.Word.Application();\n    appWord.Visible = false;\n    Microsoft.Office.Interop.Word.Document doc = null;\n    wordDocument = appWord.Documents.Open((INP), ReadOnly: true);\n\n    wordDocument.ExportAsFixedFormat(OUTP, Microsoft.Office.Interop.Word.WdExportFormat.wdExportFormatPDF);\n\n    // doc.Close(false); // Close the Word Document.\n    appWord.Quit(false); // Close Word Application.\n} catch (Exception ex) {\n    Console.WriteLine(ex.Message + ""     "" + ex.InnerException);\n}\n\n', '\nYou need to calls app.Quit() to close the application. I used below code & it worked like a charm for me - \ntry\n{\n   Microsoft.Office.Interop.Word.Application wordApp = new Microsoft.Office.Interop.Word.Application();\n   wordApp.Visible = false;\n   Microsoft.Office.Interop.Word.Document doc = null;\n\n   //Your code here...\n\n   doc.Close(false); // Close the Word Document.\n   wordApp.Quit(false); // Close Word Application.\n}\ncatch (Exception ex)\n{\n   MessageBox.Show(ex.Message + ""     "" + ex.InnerException);\n}\nfinally\n{\n   // Release all Interop objects.\n   if (doc != null)\n      System.Runtime.InteropServices.Marshal.ReleaseComObject(doc);\n   if (wordApp != null)\n      System.Runtime.InteropServices.Marshal.ReleaseComObject(wordApp);\n   doc = null;\n   wordApp = null;\n   GC.Collect();\n}\n\n', ""\nAgreed with other posters that GC.Collect() and Marshal.ReleaseComObject() is not needed. If the process still exists after running app.Quit(false), it might be because you're running the app invisible, and there is a prompt that is preventing the application from closing, such as a Document Recovery dialog. If that's the case, you need to add this when creating your application.\napp.DisplayAlerts = false;\n\n"", '\nI close the document, then the application, that works for me, then force garbage collection.\n// Document\nobject saveOptionsObject = saveDocument ? Word.WdSaveOptions.wdSaveChanges : Word.WdSaveOptions.wdDoNotSaveChanges;\nthis.WordDocument.Close(ref saveOptionsObject, ref Missing.Value, ref Missing.Value);\n\n// Application\nobject saveOptionsObject = Word.WdSaveOptions.wdDoNotSaveChanges;\nthis.WordApplication.Quit(ref saveOptionsObject, ref Missing.Value, ref Missing.Value); \n\nGC.Collect();\nGC.WaitForPendingFinalizers();\n\n', '\nTry this..\ndoc.Close(false);\napp.Quit(false);\nif (doc != null)\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(doc);\nif (app != null)\n    System.Runtime.InteropServices.Marshal.ReleaseComObject(app);\ndoc = null;\napp = null;\nGC.Collect();\n\n']"
How can I pass an argument to a PowerShell script?,"
There's a PowerShell script named itunesForward.ps1 that makes iTunes fast forward 30 seconds:
$iTunes = New-Object -ComObject iTunes.Application

if ($iTunes.playerstate -eq 1)
{
  $iTunes.PlayerPosition = $iTunes.PlayerPosition + 30
}

It is executed with a prompt line command:
powershell.exe itunesForward.ps1

Is it possible to pass an argument from the command line and have it applied in the script instead of the hardcoded 30 seconds value?
",846k,"
            551
        ","['\nTested as working:\n#Must be the first statement in your script (not counting comments)\nparam([Int32]$step=30) \n\n$iTunes = New-Object -ComObject iTunes.Application\n\nif ($iTunes.playerstate -eq 1)\n{\n  $iTunes.PlayerPosition = $iTunes.PlayerPosition + $step\n}\n\nCall it with\npowershell.exe -file itunesForward.ps1 -step 15\n\nMultiple parameters syntax (comments are optional, but allowed):\n<#\n    Script description.\n\n    Some notes.\n#>\nparam (\n    # height of largest column without top bar\n    [int]$h = 4000,\n    \n    # name of the output image\n    [string]$image = \'out.png\'\n)\n\nAnd some example for advanced parameters, e.g. Mandatory:\n<#\n    Script description.\n\n    Some notes.\n#>\nparam (\n    # height of largest column without top bar\n    [Parameter(Mandatory=$true)]\n    [int]$h,\n    \n    # name of the output image\n    [string]$image = \'out.png\'\n)\n\nWrite-Host ""$image $h""\n\nA default value will not work with a mandatory parameter. You can omit the =$true for advanced parameters of type boolean [Parameter(Mandatory)].\n', ""\nYou can use also the $args variable (that's like position parameters):\n$step = $args[0]\n\n$iTunes = New-Object -ComObject iTunes.Application\n\nif ($iTunes.playerstate -eq 1)\n{\n  $iTunes.PlayerPosition = $iTunes.PlayerPosition + $step\n}\n\nThen it can be called like:\npowershell.exe -file itunersforward.ps1 15\n\n"", '\nCall the script from a batch file (*.bat) or CMD\nPowerShell Core\npwsh.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 -Param1 Hello -Param2 World""\n\npwsh.exe -NoLogo -ExecutionPolicy Bypass -Command ""path-to-script/Script.ps1 -Param1 Hello -Param2 World""\n\npwsh.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 Hello -Param2 World""\n\npwsh.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 Hello World""\n\npwsh.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 -Param2 World Hello""\n\nPowerShell\npowershell.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 -Param1 Hello -Param2 World""\n\npowershell.exe -NoLogo -ExecutionPolicy Bypass -Command ""path-to-script/Script.ps1 -Param1 Hello -Param2 World""\n\npowershell.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 Hello -Param2 World""\n\npowershell.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 Hello World""\n\npowershell.exe -NoLogo -ExecutionPolicy Bypass -Command ""./Script.ps1 -Param2 World Hello""\n\n\nCall from PowerShell\nPowerShell Core or Windows PowerShell\n& path-to-script/Script.ps1 -Param1 Hello -Param2 World\n& ./Script.ps1 -Param1 Hello -Param2 World\n\n\nScript.ps1 - Script Code\nparam(\n    [Parameter(Mandatory=$True, Position=0, ValueFromPipeline=$false)]\n    [System.String]\n    $Param1,\n\n    [Parameter(Mandatory=$True, Position=1, ValueFromPipeline=$false)]\n    [System.String]\n    $Param2\n)\n\nWrite-Host $Param1\nWrite-Host $Param2\n\n', ""\nLet PowerShell analyze and decide the data type. It internally uses a 'Variant' for this.\nAnd generally it does a good job...\nparam($x)\n$iTunes = New-Object -ComObject iTunes.Application\nif ($iTunes.playerstate -eq 1)\n{\n    $iTunes.PlayerPosition = $iTunes.PlayerPosition + $x\n}\n\nOr if you need to pass multiple parameters:\nparam($x1, $x2)\n$iTunes = New-Object -ComObject iTunes.Application\nif ($iTunes.playerstate -eq 1)\n{\n    $iTunes.PlayerPosition = $iTunes.PlayerPosition + $x1\n    $iTunes.<AnyProperty>  = $x2\n}\n\n"", '\n# ENTRY POINT MAIN()\nParam(\n    [Parameter(Mandatory=$True)]\n    [String] $site,\n    [Parameter(Mandatory=$True)]\n    [String] $application,\n    [Parameter(Mandatory=$True)]\n    [String] $dir,\n    [Parameter(Mandatory=$True)]\n    [String] $applicationPool\n)\n\n# Create Web IIS Application\nfunction ValidateWebSite ([String] $webSiteName)\n{\n    $iisWebSite = Get-Website -Name $webSiteName\n    if($Null -eq $iisWebSite)\n    {\n        Write-Error -Message ""Error: Web Site Name: $($webSiteName) not exists.""  -Category ObjectNotFound\n    }\n    else\n    {\n        return 1\n    }\n}\n\n# Get full path from IIS WebSite\nfunction GetWebSiteDir ([String] $webSiteName)\n{\n    $iisWebSite = Get-Website -Name $webSiteName\n    if($Null -eq $iisWebSite)\n    {\n        Write-Error -Message ""Error: Web Site Name: $($webSiteName) not exists.""  -Category ObjectNotFound\n    }\n    else\n    {\n        return $iisWebSite.PhysicalPath\n    }\n}\n\n# Create Directory\nfunction CreateDirectory([string]$fullPath)\n{\n    $existEvaluation = Test-Path $fullPath -PathType Any\n    if($existEvaluation -eq $false)\n    {\n        new-item $fullPath -itemtype directory\n    }\n    return 1\n}\n\nfunction CreateApplicationWeb\n{\n    Param(\n        [String] $WebSite,\n        [String] $WebSitePath,\n        [String] $application,\n        [String] $applicationPath,\n        [String] $applicationPool\n        )\n    $fullDir = ""$($WebSitePath)\\$($applicationPath)""\n    CreateDirectory($fullDir)\n    New-WebApplication -Site $WebSite -Name $application -PhysicalPath $fullDir -ApplicationPool $applicationPool -Force\n}\n\n$fullWebSiteDir = GetWebSiteDir($Site)f($null -ne $fullWebSiteDir)\n{\n    CreateApplicationWeb -WebSite $Site -WebSitePath $fullWebSiteDir -application $application  -applicationPath $dir -applicationPool $applicationPool\n}\n\n', ""\nCreate a PowerShell script with the following code in the file.\nparam([string]$path)\nGet-ChildItem $path | Where-Object {$_.LinkType -eq 'SymbolicLink'} | select name, target\n\nThis creates a script with a path parameter. It will list all symbolic links within the path provided as well as the specified target of the symbolic link.\n"", ""\nYou can also define a variable directly in the PowerShell command line and then execute the script. The variable will be defined there, too. This helped me in a case where I couldn't modify a signed script.\nExample:\n PS C:\\temp> $stepsize = 30\n PS C:\\temp> .\\itunesForward.ps1\n\nwith iTunesForward.ps1 being\n$iTunes = New-Object -ComObject iTunes.Application\n\nif ($iTunes.playerstate -eq 1)\n{\n  $iTunes.PlayerPosition = $iTunes.PlayerPosition + $stepsize\n}\n\n""]"
"How can I automate the ""generate scripts"" task in SQL Server Management Studio 2008?","
I'd like to automate the script generation in SQL Server Management Studio 2008.
Right now what I do is :

Right click on my database, Tasks, ""Generate Scripts...""
manually select all the export options I need, and hit select all on the ""select object"" tab
Select the export folder
Eventually hit the ""Finish"" button

Is there a way to automate this task?
Edit : I want to generate creation scripts, not change scripts.
",97k,"
            111
        ","['\nSqlPubwiz has very limited options compared to the script generation in SSMS. By contrast the options available with SMO almost exactly match those in SSMS, suggesting it is probably even the same code. (I would hope MS didn\'t write it twice!) There are several examples on MSDN like this one that show scripting tables as individual objects. However if you want everything to script correctly with a \'full\' schema that includes \'DRI\' (Declarative Referential Integrity) objects like foreign keys then scripting tables individually doesn\'t work the dependencies out correctly. I found it is neccessary to collect all the URNs and hand them to the scripter as an array. This code, modified from the example, works for me (though I daresay you could tidy it up and comment it a bit more):\n    using Microsoft.SqlServer.Management.Smo;\n    using Microsoft.SqlServer.Management.Sdk.Sfc;\n    // etc...\n\n    // Connect to the local, default instance of SQL Server. \n    Server srv = new Server();\n\n    // Reference the database.  \n    Database db = srv.Databases[""YOURDBHERE""];\n\n    Scripter scrp = new Scripter(srv);\n    scrp.Options.ScriptDrops = false;\n    scrp.Options.WithDependencies = true;\n    scrp.Options.Indexes = true;   // To include indexes\n    scrp.Options.DriAllConstraints = true;   // to include referential constraints in the script\n    scrp.Options.Triggers = true;\n    scrp.Options.FullTextIndexes = true;\n    scrp.Options.NoCollation = false;\n    scrp.Options.Bindings = true;\n    scrp.Options.IncludeIfNotExists = false;\n    scrp.Options.ScriptBatchTerminator = true;\n    scrp.Options.ExtendedProperties = true;\n\n    scrp.PrefetchObjects = true; // some sources suggest this may speed things up\n\n    var urns = new List<Urn>();\n\n    // Iterate through the tables in database and script each one   \n    foreach (Table tb in db.Tables)\n    {\n        // check if the table is not a system table\n        if (tb.IsSystemObject == false)\n        {\n            urns.Add(tb.Urn);\n        }\n    }\n\n    // Iterate through the views in database and script each one. Display the script.   \n    foreach (View view in db.Views)\n    {\n        // check if the view is not a system object\n        if (view.IsSystemObject == false)\n        {\n            urns.Add(view.Urn);\n        }\n    }\n\n    // Iterate through the stored procedures in database and script each one. Display the script.   \n    foreach (StoredProcedure sp in db.StoredProcedures)\n    {\n        // check if the procedure is not a system object\n        if (sp.IsSystemObject == false)\n        {\n            urns.Add(sp.Urn);\n        }\n    }\n\n    StringBuilder builder = new StringBuilder();\n    System.Collections.Specialized.StringCollection sc = scrp.Script(urns.ToArray());\n    foreach (string st in sc)\n    {\n        // It seems each string is a sensible batch, and putting GO after it makes it work in tools like SSMS.\n        // Wrapping each string in an \'exec\' statement would work better if using SqlCommand to run the script.\n        builder.AppendLine(st);\n        builder.AppendLine(""GO"");\n    }\n\n    return builder.ToString();\n\n', ""\nWhat Brann is mentioning from the Visual Studio 2008 SP1 Team Suite is version 1.4 of the Database Publishing Wizard. It's installed with sql server 2008 (maybe only professional?) to \\Program Files\\Microsoft SQL Server\\90\\Tools\\Publishing\\1.4. The VS call from server explorer is simply calling this. You can achieve the same functionality via the command line like:\nsqlpubwiz help script\n\nI don't know if v1.4 has the same troubles that v1.1 did (users are converted to roles, constraints are not created in the right order), but it is not a solution for me because it doesn't script objects to different files like the Tasks->Generate Scripts option in SSMS does. I'm currently using a modified version of Scriptio (uses the MS SMO API) to act as an improved replacement for the database publishing wizard (sqlpubwiz.exe). It's not currently scriptable from the command line, I might add that contribution in the future.\nScriptio was originally posted on Bill Graziano's blog, but has subsequently been released to CodePlex by Bill and updated by others. Read the discussion to see how to compile for use with SQL Server 2008.\nhttp://scriptio.codeplex.com/\nEDIT: I've since started using RedGate's SQL Compare product to do this. It's a very nice replacement for all that sql publishing wizard should have been. You choose a database, backup, or snapshot as the source, and a folder as the output location and it dumps everything nicely into a folder structure. It happens to be the same format that their other product, SQL Source Control, uses.\n"", ""\nI wrote an open source command line utility named SchemaZen that does this. It's much faster than scripting from management studio and it's output is more version control friendly. It supports scripting both schema and data. \nTo generate scripts run:\nschemazen.exe script --server localhost --database db --scriptDir c:\\somedir\nThen to recreate the database from scripts run:\nschemazen.exe create --server localhost --database db --scriptDir c:\\somedir\n"", '\nYou can use SQL Server Management Object (SMO) to automate SQL Server 2005 management tasks including generating scripts: http://msdn.microsoft.com/en-us/library/ms162169.aspx.\n', ""\nIf you're a developer, definitely go with SMO.  Here's a link to the Scripter class, which is your starting point:\nScripter Class\n"", ""\nI don't see powershell with SQLPSX mentioned in any of these answers... I personally haven't played with it but it looks beautifully simple to use and ideally suited to this type of automation tasks, with tasks like:\nGet-SqlDatabase -dbname test -sqlserver server | Get-SqlTable | Get-SqlScripter | Set-Content -Path C:\\script.sql\nGet-SqlDatabase -dbname test -sqlserver server | Get-SqlStoredProcedure | Get-SqlScripter\nGet-SqlDatabase -dbname test -sqlserver server | Get-SqlView | Get-SqlScripter\n\n(ref: http://www.sqlservercentral.com/Forums/Topic1167710-1550-1.aspx#bm1168100)\nProject page: http://sqlpsx.codeplex.com/\nThe main advantage of this approach is that it combines the configurablity / customizability of using SMO directly, with the convenience and maintainability of using a simple existing tool like the Database Publishing Wizard.\n"", ""\nIn Tools > Options > Designers > Table and Database Designers there's an option for 'Auto generate change scripts' that will generate one for every change you make at the time you save it.\n"", '\nYou can do it with T-SQL code using the INFORMATION_SCHEMA tables.\nThere are also third-party tools - I like Apex SQL Script for precisely the use you are talking about.  I run it completely from the command-line.\n', '\nIf you want to a Microsoft solution you can try: Microsoft SQL Server Database Publishing Wizard 1.1\nhttp://www.microsoft.com/downloads/details.aspx?FamilyId=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en\nIt create a batch process you can run anytime you need to rebuild the scripts.\n', '\nTry new SQL Server command line tools to generate T-SQL scripts and monitor Dynamic Management Views.\nWorked for me like charm. It is a new python based tool from Microsoft that runs from command line.\nEverything works like described on the Microsoft page (see link below)\nWorked for me with SQL 2012 server.\nYou install it with pip:\n\n$pip install mssql-scripter\n\nCommand parameter overview as usual with h for help:\n\nmssql-scripter -h\n\nHint:\nIf you log in to SQL-Server via Windows authentication, just leave away Username and password.\nhttps://cloudblogs.microsoft.com/sqlserver/2017/05/17/try-new-sql-server-command-line-tools-to-generate-t-sql-scripts-and-monitor-dynamic-management-views/\n', ""\nI've been using DB Comparer - Its free and no fuss script entire DB and can compare to another DB and also produce a Diff script . Excellent for Development to Production change scripts. \nhttp://www.dbcomparer.com/\n"", '\nFrom Visual Studio 2008 SP1 TeamSuite :\nIn the Server Explorer / Data Connections tab, there\'s a publish to provider tool which does the same as ""Microsoft SQL Server Database Publishing Wizard"", but which is compatible with MS Sql Server 2008.\n', '\nThere is also this simple command line tool I build for my needs.\nhttp://mycodepad.wordpress.com/2013/11/18/export-ms-sql-database-schema-with-c/\nIt can export an entire db, and it tries to export encrypted objects. Everything is stored in folders and separate sql files for easy file comparison. \nCode is also available on github.\n', '\nI am using VS 2012(for DBs on MSSQL Server 2008) compare database has an option to save it, the comparison and options. This is essentially  what are your settings for delivery. After that you can do update or generate script.\nI just find it it a little bit awkward to load it from file later(drag and drop from windows explorer) as I do not see the file in solution explorer.\n']"
How to use ADB to send touch events to device using sendevent command?,"
I am trying to send touch events to a device using AndroidDebugBridge, so that I can do some basic automation for UI tests. I have followed the discussion in LINK. I am able to use sendevent to simulate touch on emulators, but unable to do the same on a device. 
Like in above link the emulator seems to send out 6 events for each touch ( xcoord, ycoord, 2 for press,2 for release) and it was easy to use this information to sendevents, but a getevent for the touchscreen for a device seems to generate far too many events.
Has somebody managed to send touch from ADB to a device? Could you please share the solution.
",201k,"
            103
        ","[""\nAndroid comes with an input command-line tool that can simulate miscellaneous input events. To simulate tapping, it's:\ninput tap x y\n\nYou can use the adb shell ( > 2.3.5) to run the command remotely:\nadb shell input tap x y\n\n"", '\nIn order to do a particular action (for example to open the web browser), you need to first figure out where to tap.  To do that, you can first run:\nadb shell getevent -l\n\nOnce you press on the device, at the location that you want, you will see this output:\n<...>\n/dev/input/event3: EV_KEY       BTN_TOUCH            DOWN\n/dev/input/event3: EV_ABS       ABS_MT_POSITION_X    000002f5\n/dev/input/event3: EV_ABS       ABS_MT_POSITION_Y    0000069e\n\nadb is telling you that a key was pressed (button down) at position 2f5, 69e in hex which is 757 and 1694 in decimal.\nIf you now want to generate the same event, you can use the input tap command at the same position:\nadb shell input tap 757 1694\n\nMore info can be found at:\nhttps://source.android.com/devices/input/touch-devices.html\nhttp://source.android.com/devices/input/getevent.html\n', '\n2.3.5 did not have input tap, just input keyevent and input text\nYou can use the monkeyrunner for it: (this is a copy of the answer at https://stackoverflow.com/a/18959385/1587329):\n\nYou might want to use monkeyrunner like this:\n\n$ monkeyrunner\n>>> from com.android.monkeyrunner import MonkeyRunner, MonkeyDevice\n>>> device = MonkeyRunner.waitForConnection()\n>>> device.touch(200, 400, MonkeyDevice.DOWN_AND_UP)\n\n\nYou can also do a drag, start activies etc.\n  Have a look at the api for MonkeyDevice.\n\n', ""\nYou don't need to use \n\nadb shell getevent -l\n\ncommand, you just need to enable in Developer Options on the device [Show Touch data] to get X and Y. \nSome more information can be found in my article here: https://mobileqablog.wordpress.com/2016/08/20/android-automatic-touchscreen-taps-adb-shell-input-touchscreen-tap/\n"", '\nBuilding on top of Tomas\'s answer, this is the best approach of finding the location tap position as an integer I found:\nadb shell getevent -l | grep ABS_MT_POSITION --line-buffered | awk \'{a = substr($0,54,8); sub(/^0+/, """", a); b = sprintf(""0x%s"",a); printf(""%d\\n"",strtonum(b))}\'\n\nUse adb shell getevent -l to get a list of events, the using grep for ABS_MT_POSITION (gets the line with touch events in hex) and finally use awk to get the relevant hex values, strip them of zeros and convert hex to integer. This continuously prints the x and y coordinates in the terminal only when you press on the device.\nYou can then use this adb shell command to send the command:\nadb shell input tap x y\n\n', ""\nConsider using Android's uiautomator, with adb shell uiautomator [...] or directly using the .jar that comes with the SDK.\n""]"
Fastest way to interface between live (unsaved) Excel data and C# objects,"
I want to know what the fastest way is of reading and writing data to and from an open Excel workbook to c# objects.   The background is that I want to develop a c# application that is used from Excel and uses data held in excel.  
The business logic will reside in the c# application but the data will reside in an Excel workbook.  The user will be using Excel and will click a button (or do something similar) on the excel workbook to initiate the c# application.  The c# application will then read data off the excel workbook, process the data, and then write data back to the excel workbook.
There may be numerous blocks of data that are required to be read off and written back to the excel workbook but they will normally be of a relatively small size, say 10 rows and 20 columns.  Occasionally a large list of data may need to be processed, of the order of 50,000 rows and 40 columns.
I know that this is relatively easy to do say using VSTO but I want to know what the fastest (but still robust and elegant) solution is and get an idea of the speed.   I don't mind if the solution recommends using third party products or uses C++.
The obvious solution is using VSTO or interop but I don't know what the performance is like versus VBA which I'm currently using to read in the data, or if there are any other solutions.
This was posted on experts exchange saying that VSTO was dramatically slower than VBA but that was a couple of years ago and I don't know if the performance has improved.
http://www.experts-exchange.com/Microsoft/Development/VSTO/Q_23635459.html
Thanks.
",22k,"
            32
        ","['\nI\'ll take this as a challenge, and will bet the fastest way to shuffle your data between Excel and C# is to use Excel-DNA - http://excel-dna.net.\n(Disclaimer: I develop Excel-DNA. But it\'s still true...)\nBecause it uses the native .xll interface it skips all the COM integration overhead that you\'d have with VSTO or another COM-based add-in approach. With Excel-DNA you could make a macro that is hooked up to a menu or ribbon button which reads a range, processes it, and writes it back to a range in Excel. All using the native Excel interface from C# - not a COM object in sight.\nI\'ve made a small test function that takes the current selection into an array, squares every number in the array, and writes the result into Sheet 2 starting from cell A1. You just need to add the (free) Excel-DNA runtime which you can download from http://excel-dna.net.\nI read into C#, process and write back to Excel a million-cell range in under a second. Is this fast enough for you?\nMy function looks like this:\nusing ExcelDna.Integration;\npublic static class RangeTools {\n\n[ExcelCommand(MenuName=""Range Tools"", MenuText=""Square Selection"")]\npublic static void SquareRange()\n{\n    object[,] result;\n    \n    // Get a reference to the current selection\n    ExcelReference selection = (ExcelReference)XlCall.Excel(XlCall.xlfSelection);\n    // Get the value of the selection\n    object selectionContent = selection.GetValue();\n    if (selectionContent is object[,])\n    {\n        object[,] values = (object[,])selectionContent;\n        int rows = values.GetLength(0);\n        int cols = values.GetLength(1);\n        result = new object[rows,cols];\n        \n        // Process the values\n        for (int i = 0; i < rows; i++)\n        {\n            for (int j = 0; j < cols; j++)\n            {\n                if (values[i,j] is double)\n                {\n                    double val = (double)values[i,j];\n                    result[i,j] = val * val;\n                }\n                else\n                {\n                    result[i,j] = values[i,j];\n                }\n            }\n        }\n    }\n    else if (selectionContent is double)\n    {\n        double value = (double)selectionContent;\n        result = new object[,] {{value * value}}; \n    }\n    else\n    {\n        result = new object[,] {{""Selection was not a range or a number, but "" + selectionContent.ToString()}};\n    }\n    \n    // Now create the target reference that will refer to Sheet 2, getting a reference that contains the SheetId first\n    ExcelReference sheet2 = (ExcelReference)XlCall.Excel(XlCall.xlSheetId, ""Sheet2""); // Throws exception if no Sheet2 exists\n    // ... then creating the reference with the right size as new ExcelReference(RowFirst, RowLast, ColFirst, ColLast, SheetId)\n    int resultRows = result.GetLength(0);\n    int resultCols = result.GetLength(1);\n    ExcelReference target = new ExcelReference(0, resultRows-1, 0, resultCols-1, sheet2.SheetId);\n    // Finally setting the result into the target range.\n    target.SetValue(result);\n}\n}\n\n', '\nIf the C# application is a stand-alone application, then you will always have cross-process marshaling involved that will overwhelm any optimizations you can do by switching languages from, say, C# to C++. Stick to your most preferred language in this situation, which sounds like is C#. \nIf you are willing to make an add-in that runs within Excel, however, then your operations will avoid cross-process calls and run about 50x faster.\nIf you run within Excel as an add-in, then VBA is among the fastest options, but it does still involve COM and so C++ calls using an XLL add-in would be fastest. But VBA is still quite fast in terms of calls to the Excel object model. As for actual calculation speed, however, VBA runs as pcode, not as fully compiled code, and so executes about 2-3x slower than native code. This sounds very bad, but it isn\'t because the vast majority of the execution time taken with a typical Excel add-in or application involves calls to the Excel object model, so VBA vs. a fully compiled COM add-in, say using natively compiled VB 6.0, would only be about 5-15% slower, which is not noticeable.\nVB 6.0 is a compiled COM approach, and runs 2-3x faster than VBA for non-Excel related calls, but VB 6.0 is about 12 years old at this point and won\'t run in 64 bit mode, say if installing Office 2010, which can be installed to run 32 bit or 64 bit. Usage of 64 bit Excel is tiny at the moment, but will grow in usage, and so I would avoid VB 6.0 for this reason.\nC#, if running in-process as an Excel add-in would execute calls to the Excel object model as fast as VBA, and execute non-Excel calls 2-3x faster than VBA -- if running unshimmed. The approach recommended by Microsoft, however, is to run fully shimmed, for example, by making use of the COM Shim Wizard. By being shimmed, Excel is protected from your code (if it\'s faulty) and your code is fully protected from other 3rd party add-ins that could otherwise potentially cause problems. The down-side to this, however, is that a shimmed solution runs within a separate AppDomain, which requires cross-AppDomain marshaling that incurrs an execution speed penalty of about 40x -- which is very noticeable in many contexts.\nAdd-ins using Visual Studio Tools for Office (VSTO) are automatically loaded within a shim and executes within a separate AppDomain. There is no avoiding this if using VSTO. Therefore, calls to the Excel object model would also incur an approximately 40x execution speed degradation. VSTO is a gorgeous system for making very rich Excel add-ins, but execution speed is its weakness for applications such as yours.\nExcelDna is a free, open source project that allows you to use C# code, which is then converted for you to an XLL add-in that uses C++ code. That is, ExcelDna parses your C# code and creates the required C++ code for you. I\'ve not used it myself, but I am familiar with the process and it\'s very impressive. ExcelDna gets very good reviews from those that use it. [Edit: Note the following correction as per Govert\'s comments below: ""Hi Mike - I want add a small correction to clarify the Excel-Dna implementation: all the managed-to-Excel glue works at runtime from your managed assembly using reflection - there is no extra pre-compilation step or C++ code generation. Also, even though Excel-Dna uses .NET, there need not be any COM interop involved when talking to Excel - as an .xll the native interface can be used directly from .NET (though you can also use COM if you want). This makes high-performance UDFs and macros possible."" – Govert]\nYou also might want to look at Add-in Express. It\'s not free, but it would allow you to code in C# and although it shims your solution into a separate AppDomain, I believe that it\'s execution speed is outstanding. If I am understanding its execution speed correctly, then I\'m not sure how Add-in Express doing this, but it might be taking advantage of something called FastPath AppDomain marshaling. Don\'t quote me on any of this, however, as I\'m not very familiar with Add-in Express. You should check it out though and do your own research. [Edit: Reading Charles Williams\' answer, it looks like Add-in Express enables both COM and C API access. And Govert states that Excel DNA also enables both COM and the fastrer C API access. So you\'d probably want to check out both and compare them to ExcelDna.]\nMy advice would be to research Add-in Express and ExcelDna. Both approaches would allow you to code using C#, which you seem most familiar with.\nThe other main issue is how you make your calls. For example, Excel is very fast when handling an entire range of data passed back-and-forth as an array. This is vastly more efficient than looping through the cells individually. For example, the following code makes use of the Excel.Range.set_Value accessor method to assign a 10 x 10 array of values to a 10 x 10 range of cells in one shot:\nvoid AssignArrayToRange()\n{\n    // Create the array.\n    object[,] myArray = new object[10, 10];\n\n    // Initialize the array.\n    for (int i = 0; i < myArray.GetLength(0); i++)\n    {\n        for (int j = 0; j < myArray.GetLength(1); j++)\n        {\n            myArray[i, j] = i + j;\n        }\n    }\n\n    // Create a Range of the correct size:\n    int rows = myArray.GetLength(0);\n    int columns = myArray.GetLength(1);\n    Excel.Range range = myWorksheet.get_Range(""A1"", Type.Missing);\n    range = range.get_Resize(rows, columns);\n\n    // Assign the Array to the Range in one shot:\n    range.set_Value(Type.Missing, myArray);\n}\n\nOne can similarly make use of the Excel.Range.get_Value accessor method to read an array of values from a range in one step. Doing this and then looping through the values within the array is vastly faster than looping trough the values within the cells of the range individually.\n', ""\nFurther to Mike Rosenblum's comments on the use of arrays, I'd like to add that I've been using the very approach (VSTO + arrays) and when I measured it, the actual read speed itself was within milliseconds. Just remember to disable event handling and screen updating prior to the read/write, and remember to re-enable after the operation is complete.\nUsing C#, you can create 1-based arrays exactly the same as Excel VBA itself does.  This is pretty useful, especially because even in VSTO, when you extract the array from an Excel.Range object, the array is 1-based, so keeping the Excel-oriented arrays 1-based helps you avoid needing to always check for whether the array is one-based or zero-based. \n  (If the column position in the array has significance to you, having to deal with 0-based and 1-based arrays can be a real pain).\nGenerally reading the Excel.Range into an array would look something like this:\nvar myArray = (object[,])range.Value2;\n\n\nMy variation of Mike Rosenblum's array-write uses a 1-based array like this:\nint[] lowerBounds = new int[]{ 1, 1 };\nint[] lengths = new int[] { rowCount, columnCount };  \nvar myArray = \n    (object[,])Array.CreateInstance(typeof(object), lengths, lowerBounds);\n\nvar dataRange = GetRangeFromMySources();\n\n// this example is a bit too atomic; you probably want to disable \n// screen updates and events a bit higher up in the call stack...\ndataRange.Application.ScreenUpdating = false;\ndataRange.Application.EnableEvents = false;\n\ndataRange = dataRange.get_Resize(rowCount, columnCount);\ndataRange.set_Value(Excel.XlRangeValueDataType.xlRangeValueDefault, myArray);\n\ndataRange.Application.ScreenUpdating = true;\ndataRange.Application.EnableEvents = true;\n\n"", '\nThe fastest interface to Excel data is the C API. There are a number of products out there that link .NET to Excel using this interface.\n2 products I like that do this are Excel DNA (which is free and open source) and Addin Express (which is a commercial product and has both the C API and COM interface available).\n', '\nFirst off, your solution cannot be an Excel UDF (user-defined function). In our manuals, we give the following definition: ""Excel UDFs are used to build custom functions in Excel for the end user to use them in formulas."" I wouldn\'t mind if you suggest a better definition :) \nThat definition shows that a UDF cannot add a button to the UI (I know that XLLs can modify the CommandBar UI) or intercept keyboard shortcuts as well as Excel events. \nThat is, ExcelDNA is out of scope because it is purposed for developing XLL add-ins. The same applies to Excel-targeted functionality of Add-in Express since it allows developing XLL add-ins and Excel Automation add-ins. \nBecause you need to handle Excel events, your solution can be a standalone application but there are obvious limitations of such approach. The only real way is to create a COM add-in; it allows handling Excel events and adding custom things to the Excel UI. You have three possibilities:\n\nVSTO\nAdd-in Express (COM add-in functionality)\nShared Add-in (see the corresponding item in the New Project dialog in VS)\n\nIf talking about developing an Excel COM add-in, the 3 tools above provide different features: visual designers, shimming, etc. But I don\'t think they differ in the speed of accessing the Excel Object Model. Say, I don\'t know (and cannot imagine) why getting a COM object from the Default AppDomain should differ from getting the same COM object from another AppDomain. BTW, you can check if shimming influences the speed of operation by creating a shared add-in and then using the COM Shim Wizard to shim it. \nSpeed II. As I wrote to you yesterday: ""The best way to speed up reading and writing to a range of cells is to create a variable of the Excel.Range type referring to that range and then read/write an array from/to the Value property of the variable."" But contrary to what Francesco says, I don\'t attribute this to VSTO; this is a feature of the Excel object model.\nSpeed III. The fastest Excel UDFs are written in native C++, not in any .NET language. I haven\'t compared the speed of an XLL add-in produced by ExcelDNA and Add-in Express; I don\'t think you\'ll find any substantial difference here.\nTo sum up. I am convinced you are on a wrong way: COM add-ins based on Add-in Express, VSTO or Shared Add-in should read and write Excel cells at the same speed. I will be glad (sincerely) if someone disproves this statement.\nNow on your other questions. VSTO doesn\'t allow developing a COM add-in supporting Office 2000-2010. It requires three different codebases and at least two versions of Visual Studio to completely support Office 2003-2010; you need to have strong nerves and a portion of good luck to deploy a VSTO-based add-in for Excel 2003. With Add-in Express, you create a COM add-in for all Office versions with a single codebase; Add-in Express provides you with a setup project, which is ready to install your add-in in Excel 2000-2010 (32-bit and 64-bit); ClickOnce deployment is on board too. \nVSTO beats Add-in Express in one area: it allows creating so-called document-level add-ins. Imagine a workbook or template with some .NET code behind it; I wouldn\'t be surprised, however, if deployment of such things is a nightmare.\nOn Excel events. All Excel events are listed in MSDN, for instance, see Excel 2007 events\nRegards from Belarus (GMT+2),\nAndrei Smolin\nAdd-in Express Team Leader\n', ""\nI've used VBA code (macro) to gather & compact the data, and get this data in one call to C#, and vice versa. This will probably be the most performant approach.\nUsing C#, you will always need to use some marshalling. Using VSTO or COM Interop, the underlaying communication layer (marshalling overhead) is the same.\nIn VBA (Visual Basic For Application) you work directly on the objects in Excel. So the access to this data will always be faster.\nBut.... Once you have the data in C#, the manipulation of this data can be a lot faster.\nIf you are using VB6 or C++, you also go through a COM interface, and you will also be facing cross process marshalling.\nSo you are looking for a method to minimize cross process calls and marshalling.\n""]"
Selenium Webdriver: How to Download a PDF File with Python?,"
I am using selenium webdriver to automate downloading several PDF files. I get the PDF preview window (see below), and now I would like to download the file. How can I accomplish this using Google Chrome as the browser?  

",53k,"
            17
        ","['\nTry this code, it worked for me.\noptions = webdriver.ChromeOptions()\noptions.add_experimental_option(\'prefs\', {\n""download.default_directory"": ""C:/Users/XXXX/Desktop"", #Change default directory for downloads\n""download.prompt_for_download"": False, #To auto download the file\n""download.directory_upgrade"": True,\n""plugins.always_open_pdf_externally"": True #It will not show PDF directly in chrome\n})\nself.driver = webdriver.Chrome(options=options)\n\n', '\nI found this piece of code somewhere on Stackoverflow itself and it serves the purpose for me without having to use selenium at all.\nimport urllib.request\n\nresponse = urllib.request.urlopen(URL)    \nfile = open(""FILENAME.pdf"", \'wb\')\nfile.write(response.read())\nfile.close()\n\n', '\nYou can download the pdf (Embeded pdf & Normal pdf) from web using selenium.\nfrom selenium import webdriver\n\ndownload_dir = ""C:\\\\Users\\\\omprakashpk\\\\Documents"" # for linux/*nix, download_dir=""/usr/Public""\noptions = webdriver.ChromeOptions()\n\nprofile = {""plugins.plugins_list"": [{""enabled"": False, ""name"": ""Chrome PDF Viewer""}], # Disable Chrome\'s PDF Viewer\n               ""download.default_directory"": download_dir , ""download.extensions_to_open"": ""applications/pdf""}\noptions.add_experimental_option(""prefs"", profile)\ndriver = webdriver.Chrome(\'C:\\\\chromedriver\\\\chromedriver_2_32.exe\', chrome_options=options)  # Optional argument, if not specified will search path.\n\ndriver.get(`pdf_url`)\n\nIt will download and save the pdf in directory specified. Change the download_dir location and chrome driver location as per your convenience. \nYou can download chrome driver from here.\nHope it helps!\n', '\nI did it and it worked, don\'t ask me how :)\noptions = webdriver.ChromeOptions()\noptions.add_experimental_option(\'prefs\', {\n#""download.default_directory"": ""C:/Users/517/Download"", #Change default directory for downloads\n#""download.prompt_for_download"": False, #To auto download the file\n#""download.directory_upgrade"": True,\n""plugins.always_open_pdf_externally"": True #It will not show PDF directly in chrome \n})\ndriver = webdriver.Chrome(options=options)\n\n', '\nIn My case it worked without any code modification,Just need to disabled the Chrome pdf viewer\nHere are the steps to disable it\n\nGo into Chrome Settings\nScroll to the bottom click on Advanced\nUnder Privacy And Security - Click on ""Site Settings""\nScroll to PDF Documents\nEnable ""Download PDF files instead of automatically opening them in Chrome""\n\n']"
R command for setting working directory to source file location in Rstudio,"
I am working out some tutorials in R. Each R code is contained in a specific folder. There are data files and other files in there. I want to open the .r file and source it such that I do not have to change the working directory in Rstudio as shown below:

Is there a way to specify my working directory automatically in R.
",182k,"
            177
        ","['\nTo get the location of a script being sourced, you can use utils::getSrcDirectory or utils::getSrcFilename. These require a function as an input. Create a script with the following lines, and source it to see their usage:\nprint(utils::getSrcDirectory(function(){}))\nprint(utils::getSrcFilename(function(){}, full.names = TRUE))\n\nChanging the working directory to that of the current file can be done with:\nsetwd(getSrcDirectory(function(){})[1])\n\nThis does not work in RStudio if you Run the code rather than Sourceing it.  For that, you need to use rstudioapi::getActiveDocumentContext.\nsetwd(dirname(rstudioapi::getActiveDocumentContext()$path))\n\nThis second solution requires that you are using RStudio as your IDE, of course.\n', ""\nI know this question is outdated, but I was searching for a solution for that as well and Google lists this at the very top:\nthis.dir <- dirname(parent.frame(2)$ofile)\nsetwd(this.dir)\n\nput that somewhere into the file (best would be the beginning, though), so that the wd is changed according to that file.\nAccording to the comments, this might not necessarily work on every platform (Windows seems to work, Linux/Mac for some).\nKeep in mind that this solution is for 'sourcing' the files, not necessarily for running chunks in that file.\nsee also get filename and path of `source`d file\n"", ""\nFor rstudio, you can automatically set your working directory to the script directory using rstudioapi like that:\nlibrary(rstudioapi)\n\n# Getting the path of your current open file\ncurrent_path = rstudioapi::getActiveDocumentContext()$path \nsetwd(dirname(current_path ))\nprint( getwd() )\n\nThis works when Running or Sourceing your file.\nYou need to install the package rstudioapi first.\nNotice I print the path to be 100% sure I'm at the right place, but this is optional.\n"", '\ndirname(rstudioapi::getActiveDocumentContext()$path)\n\nworks for me but if you don\'t want to use rstudioapi and you are not in a proyect, you can use the symbol ~ in your path. The symbol ~ refers to the default RStudio working directory (at least on Windows).\n\nIf your RStudio working directory is ""D:/Documents"", setwd(""~/proyect1"") is the same as setwd(""D:/Documents/proyect1"").\nOnce you set that, you can navigate to a subdirectory: read.csv(""DATA/mydata.csv""). Is the same as read.csv(""D:/Documents/proyect1/DATA/mydata.csv"").\nIf you want to navigate to a parent folder, you can use ""../"". \nFor example: read.csv(""../olddata/DATA/mydata.csv"") which is the same as read.csv(""D:/Documents/oldata/DATA/mydata.csv"")\nThis is the best way for me to code scripts, no matter what computer you are using.\n', '\nI realize that this is an old thread, but I had a similar problem with needing to set the working directory and couldn\'t get any of the solutions to work for me. Here\'s what did work, in case anyone else stumbles across this later on:\n# SET WORKING DIRECTORY TO CURRENT DIRECTORY:\nsystem(""pwd=`pwd`; $pwd 2> dummyfile.txt"")\ndir <- fread(""dummyfile.txt"")\nn<- colnames(dir)[2]\nn2 <- substr(n, 1, nchar(n)-1)\nsetwd(n2)\n\nIt\'s a bit convoluted, but basically this uses system commands to get the working directory and save it to dummyfile.txt, then R reads that file using data.table::fread. The rest is just cleaning up what got printed to the file so that I\'m left with just the directory path.\nI needed to run R on a cluster, so there was no way to know what directory I\'d end up in (jobs get assigned a number and a compute node). This did the trick for me.\n', '\nThis answer can help:\nscript.dir <- dirname(sys.frame(1)$ofile)\n\n\nNote: script must be sourced in order to return correct path\n\nI found it in: https://support.rstudio.com/hc/communities/public/questions/200895567-can-user-obtain-the-path-of-current-Project-s-directory-\nThe BumbleBee´s answer (with parent.frame instead sys.frame) didn´t work to me, I always get an error.\n', '\nThe solution \ndirname(parent.frame(2)$ofile)\n\nnot working for me.\nI\'m using a brute force algorithm, but works:\nFile <- ""filename""\nFiles <- list.files(path=file.path(""~""),recursive=T,include.dirs=T)\nPath.file <- names(unlist(sapply(Files,grep,pattern=File))[1])\nDir.wd <- dirname(Path.file)\n\nMore easy when searching a directory:\nDirname <- ""subdir_name""\nDirs <- list.dirs(path=file.path(""~""),recursive=T)\ndir_wd <- names(unlist(sapply(Dirs,grep,pattern=Dirname))[1])\n\n', '\nIf you work on Linux you can try this:\nsetwd(system(""pwd"", intern = T) )\nIt works for me.\n', ""\nThe here package provides the here() function, which returns your project root directory based on some heuristics. \nNot the perfect solution, since it doesn't find the location of the script, but it suffices for some purposes so I thought I'd put it here.\n"", '\nI understand this is outdated, but I couldn\'t get the former answers to work very satisfactorily, so I wanted to contribute my method in case any one else encounters the same error mentioned in the comments to BumbleBee\'s answer.\nMine is based on a simple system command. All you feed the function is the name of your script:\nextractRootDir <- function(x) {\n    abs <- suppressWarnings(system(paste(""find ./ -name"",x), wait=T, intern=T, ignore.stderr=T))[1];\n    path <- paste(""~"",substr(abs, 3, length(strsplit(abs,"""")[[1]])),sep="""");\n    ret <- gsub(x, """", path);\n    return(ret);\n}\n\nsetwd(extractRootDir(""myScript.R""));\n\nThe output from the function would look like ""/Users/you/Path/To/Script"". Hope this helps anyone else who may have gotten stuck.\n', '\nsetwd(this.path::here())\n\nworks both for sourced and ""active"" scripts.\n', '\nI was just looking for a solution to this problem, came to this page. I know its dated but the previous solutions where unsatisfying or didn\'t work for me. Here is my work around if interested.\nfilename = ""your_file.R""\nfilepath = file.choose()  # browse and select your_file.R in the window\ndir = substr(filepath, 1, nchar(filepath)-nchar(filename))\nsetwd(dir)\n\n', '\nI feel like a mocking bird, but I\'m going to say it: I know this post is old, but...\nI just recently learned you cannot call the api when running the script from Task Scheduler and a .bat file. I learned this the hard way. Thought those of you who were using any of the rstudioapi:: methods might like to know that. We run lots of script this way overnight. Just recently changed our path to include the api called so we could ""dynamically"" set the working directory. Then, when the first one we tried with failed when triggered from Task Scheduler, investigation brought that information about.\nThis is the actual code that brought this issue to light: setwd(dirname(rstudioapi::getActiveDocumentContext()$path))\nWorks beautifully if you\'re running the script though!\nJust adding my two cents as I know people still pull these threads up, thought it might be helpful.\n', '\nIn case you use UTF-8 encoding:\npath <- rstudioapi::getActiveDocumentContext()$path\nEncoding(path) <- ""UTF-8""\nsetwd(dirname(path))\n\nYou need to install the package rstudioapi if you haven\'t done it yet.\n', '\nMost GUIs assume that if you are in a directory and ""open"", double-click, or otherwise attempt to execute an .R file, that the directory in which it resides will be the working directory unless otherwise specified. The Mac GUI provides a method to change that default behavior which is changeable in the Startup panel of Preferences that you set in a running session and become effective at the next ""startup"". You should be also looking at:\n?Startup\n\nThe RStudio documentation says:\n""When launched through a file association, RStudio automatically sets the working directory to the directory of the opened file.""  The default setup is for RStudio to be register as a handler for .R files, although there is also mention of ability to set a default ""association"" with RStudio for .Rdata and .R extensions. Whether having \'handler\' status and \'association\' status are the same on Linux, I cannot tell.\nhttp://www.rstudio.com/ide/docs/using/workspaces\n', ""\ndirname(parent.frame(2)$ofile)  \n\ndoesn't work for me either, but the following (as suggested in https://stackoverflow.com/a/35842176/992088) works for me in ubuntu 14.04\ndirname(rstudioapi::getActiveDocumentContext()$path)\n\n"", ""\nHere is another way to do it: \nset2 <- function(name=NULL) {\n  wd <- rstudioapi::getSourceEditorContext()$path\n  if (!is.null(name)) {\n    if (substr(name, nchar(name) - 1, nchar(name)) != '.R') \n      name <- paste0(name, '.R')\n  }\n  else {\n    name <- stringr::word(wd, -1, sep='/')\n  }\n  wd <- gsub(wd, pattern=paste0('/', name), replacement = '')\n  no_print <- eval(expr=setwd(wd), envir = .GlobalEnv)\n}\nset2()\n\n""]"
Karate- Need help to assert a single dimension array for date range,"
I am trying to assert the values inside a single dimensional array. I have tried using match but it looks like the date ranges cannot be asserted. 
Below is the object array:
[
""2019-04-24T17:41:28"",
""2019-04-24T17:41:27.975"",
""2019-04-24T17:41:27.954"",
""2019-04-24T17:41:27.93"",
""2019-04-24T17:41:27.907"",
""2019-04-24T17:41:27.886"",
""2019-04-24T17:41:27.862"",
""2019-04-24T17:41:27.84"",
""2019-04-24T17:41:27.816"",
""2019-04-24T17:41:27.792""
]

I am trying to assert each values between the following date ranges:
MinDate:2019-04-24T17:25:00.000000+00:00
MaxDate:2019-04-24T17:50:00.000000+00:00

I have tried the following but none works:
* match dateCreated == '#[]? _.value >= fromDate'
 * eval for(var i = 0; i < responseJson.response.data.TotalItemCount; i++) dateCreated.add(responseJson.response.data.Items[i].DateCreated)  karate.assert(dateCreated[i] >= fromDate)

Any hint/tip on how to go about it.
",1k,"
            2
        ","['\nHere you go:\n* def dateToLong =\n""""""\nfunction(s) {\n  var SimpleDateFormat = Java.type(\'java.text.SimpleDateFormat\');\n  var sdf = new SimpleDateFormat(""yyyy-MM-dd\'T\'HH:mm:ss.SSS"");\n  return sdf.parse(s).time;\n} \n""""""\n* def min = dateToLong(\'2019-04-24T17:25:00.000\')\n* def max = dateToLong(\'2019-04-24T17:50:00.000\')\n* def isValid = function(x){ var temp = dateToLong(x); return temp >= min && temp <= max }\n\n* def response =\n""""""\n[\n""2019-04-24T17:41:27.975"",\n""2019-04-24T17:41:27.954"",\n""2019-04-24T17:41:27.93"",\n""2019-04-24T17:41:27.907"",\n""2019-04-24T17:41:27.886"",\n""2019-04-24T17:41:27.862"",\n""2019-04-24T17:41:27.84"",\n""2019-04-24T17:41:27.816"",\n""2019-04-24T17:41:27.792""\n]\n""""""\n* match each response == \'#? isValid(_)\'\n\nPlease refer the docs if you have doubts about any of the keywords. I removed the first date in the list because it was not consistent, but you have enough info to handle it if needed - you may need some conditional logic somewhere.\nAlso see:\nhttps://stackoverflow.com/a/54114432/143475\nhttps://stackoverflow.com/a/52892797/143475\n']"
Automating telnet session using Bash scripts,"
I am working on automating some telnet related tasks, using Bash scripts.
Once automated, there will be no interaction of the user with telnet (that is, the script will be totally automated).
The scripts looks something like this:
# execute some commands on the local system
# access a remote system with an IP address: 10.1.1.1 (for example)

telnet 10.1.1.1

# execute some commands on the remote system
# log all the activity (in a file) on the local system
# exit telnet
# continue with executing the rest of the script

There are two problems I am facing here:

How to execute the commands on the remote system from the script (without human interaction)?
From my experience with some test code, I was able to deduce that when telnet 10.1.1.1 is executed, telnet goes into an interactive session and the subsequent lines of code in the script are executed on the local system. How can I run the lines of code on the remote system rather than on the local one?

I am unable to get a log file for the activity in the telnet session on the local system. The stdout redirect I used makes a copy on the remote system (I do not want to perform a copy operation to copy the log to the local system). How can I achieve this functionality?


",327k,"
            89
        ","['\nWhile I\'d suggest using expect, too, for non-interactive use the normal shell commands might suffice. telnet accepts its command on stdin, so you just need to pipe or write the commands into it through heredoc:\ntelnet 10.1.1.1 <<EOF\nremotecommand 1\nremotecommand 2\nEOF\n\n(Edit: Judging from the comments, the remote command needs some time to process the inputs or the early SIGHUP is not taken gracefully by telnet. In these cases, you might try a short sleep on the input:)\n{ echo ""remotecommand 1""; echo ""remotecommand 2""; sleep 1; } | telnet 10.1.1.1\n\nIn any case, if it\'s getting interactive or anything, use expect.\n', '\nWrite an expect script.\nHere is an example:\n#!/usr/bin/expect\n\n#If it all goes pear shaped the script will timeout after 20 seconds.\nset timeout 20\n#First argument is assigned to the variable name\nset name [lindex $argv 0]\n#Second argument is assigned to the variable user\nset user [lindex $argv 1]\n#Third argument is assigned to the variable password\nset password [lindex $argv 2]\n#This spawns the telnet program and connects it to the variable name\nspawn telnet $name \n#The script expects login\nexpect ""login:"" \n#The script sends the user variable\nsend ""$user ""\n#The script expects Password\nexpect ""Password:""\n#The script sends the password variable\nsend ""$password ""\n#This hands control of the keyboard over to you (Nice expect feature!)\ninteract\n\nTo run:\n./myscript.expect name user password\n\n', '\nTelnet is often used when you learn the HTTP protocol. I used to use that script as a part of my web scraper:\necho ""open www.example.com 80""\nsleep 2\necho ""GET /index.html HTTP/1.1""\necho ""Host: www.example.com""\necho\necho\nsleep 2\n\nLet\'s say the name of the script is get-page.sh, then this will give you an HTML document:\nget-page.sh | telnet\n\nI hope this will be helpful to someone ;)\n', '\nThis worked for me.. \nI was trying to automate multiple telnet logins which require a username and password. The telnet session needs to run in the background indefinitely since I am saving logs from different servers to my machine.\ntelnet.sh automates telnet login using the \'expect\' command. More info can be found here: http://osix.net/modules/article/?id=30\ntelnet.sh\n#!/usr/bin/expect\nset timeout 20\nset hostName [lindex $argv 0]\nset userName [lindex $argv 1]\nset password [lindex $argv 2]\n\nspawn telnet $hostName\n\nexpect ""User Access Verification""\nexpect ""Username:""\nsend ""$userName\\r""\nexpect ""Password:""\nsend ""$password\\r"";\ninteract\n\nsample_script.sh is used to create a background process for each of the telnet sessions by running telnet.sh. More information can be found in the comments section of the code.\nsample_script.sh\n#!/bin/bash\n#start screen in detached mode with session-name \'default_session\' \nscreen -dmS default_session -t screen_name \n#save the generated logs in a log file \'abc.log\' \nscreen -S default_session -p screen_name -X stuff ""script -f /tmp/abc.log $(printf \\\\r)""\n#start the telnet session and generate logs\nscreen -S default_session -p screen_name -X stuff ""expect telnet.sh hostname username password $(printf \\\\r)""\n\n\nMake sure there is no screen running in the backgroud by using the\ncommand \'screen -ls\'. \nRead\nhttp://www.gnu.org/software/screen/manual/screen.html#Stuff to read\nmore about screen and its options. \n\'-p\' option in sample_script.sh\npreselects and reattaches to a specific window to send a command via\nthe ‘-X’ option otherwise you get a \'No screen session found\' error.\n\n', '\nYou can use expect scripts instaed of bash.\nBelow example show how to telnex into an embedded board having no password\n#!/usr/bin/expect\n\nset ip ""<ip>""\n\nspawn ""/bin/bash""\nsend ""telnet $ip\\r""\nexpect ""\'^]\'.""\nsend ""\\r""\nexpect ""#""\nsleep 2\n\nsend ""ls\\r""\nexpect ""#""\n\nsleep 2\nsend -- ""^]\\r""\nexpect ""telnet>""\nsend  ""quit\\r""\nexpect eof\n\n', '\nFollowing is working for me...\nput all of your IPs you want to telnet in IP_sheet.txt\nwhile true\nread a\ndo\n{\n    sleep 3\n    echo df -kh\n    sleep 3\n    echo exit\n} | telnet $a\ndone<IP_sheet.txt\n\n', ""\nThe answer by @thiton was helpful but I wanted to avoid the sleep command. Also telnet didn't exit the interactive mode, so my script got stuck.\nI solved that by sending telnet command with curl (which seems to wait for the response) and by explicitly telling telnet to quit like this:\ncurl telnet://10.1.1.1:23 <<EOF\nremotecommand 1\nremotecommand 2\nquit\nEOF\n\n"", '\n#!/bin/bash\nping_count=""4""\navg_max_limit=""1500""\nrouter=""sagemcom-fast-2804-v2""\nadress=""192.168.1.1""\nuser=""admin""\npass=""admin""\n\nVAR=$(\nexpect -c "" \n        set timeout 3\n        spawn telnet ""$adress""\n        expect \\""Login:\\"" \n        send \\""$user\\n\\""\n        expect \\""Password:\\""\n        send \\""$pass\\n\\""\n        expect \\""commands.\\""\n        send \\""ping ya.ru -c $ping_count\\n\\""\n        set timeout 9\n        expect \\""transmitted\\""\n        send \\""exit\\""\n        "")\n\ncount_ping=$(echo ""$VAR"" | grep packets | cut -c 1)\navg_ms=$(echo ""$VAR"" | grep round-trip | cut -d \'/\' -f 4 | cut -d \'.\' -f 1)\n\necho ""1_____ping___$count_ping|||____$avg_ms""\necho ""$VAR""\n\n', '\nUse ssh for that purpose. Generate keys without using a password and place it to .authorized_keys at the remote machine. Create the script to be run remotely, copy it to the other machine and then just run it remotely using ssh.\nI used this approach many times with a big success. Also note that it is much more secure than telnet.\n', '\nHere is how to use telnet in bash shell/expect  \n#!/usr/bin/expect\n# just do a chmod 755 one the script\n# ./YOUR_SCRIPT_NAME.sh $YOUHOST $PORT\n# if you get ""Escape character is \'^]\'"" as the output it means got connected otherwise it has failed\n\nset ip [lindex $argv 0]\nset port [lindex $argv 1]\n\nset timeout 5\nspawn telnet $ip $port\nexpect ""\'^]\'.""\n\n', '\nScript for obtain version of CISCO-servers:\n#!/bin/sh\n\nservers=\'\n192.168.34.1\n192.168.34.3\n192.168.34.2\n192.168.34.3\n\'\nuser=\'cisco_login\'\npass=\'cisco_password\'\n\nshow_version() {\nhost=$1\nexpect << EOF\nset timeout 20\nset host $host\nset user $user\nset pass $pass\nspawn telnet $host\nexpect ""Username:""\nsend ""$user\\r""\nexpect ""Password:""\nsend ""$pass\\r""\nexpect -re "".*#""\nsend ""show version\\r""\nexpect -re "".*-More-.*""\nsend "" ""\nexpect -re "".*#""\nsend ""exit\\r""\nEOF\n}\n\nfor ip in $servers; do\n  echo \'---------------------------------------------\'\n  echo ""$ip""\n  show_version $ip | grep -A3 \'SW Version\'\ndone\n\n', '\nHere is a solution that will work with a list of extenders.  This only requires bash - some of the answers above require expect and you may not be able to count on expect being installed.\n#!/bin/bash\n\ndeclare -a  Extenders=(""192.168.1.48"" ""192.168.1.50"" ""192.168.1.51"") \n# ""192.168.1.52"" ""192.168.1.56"" ""192.168.1.58"" ""192.168.1.59"" ""192.168.1.143"")\nsleep 5\n# Iterate the string array using for loop\nfor val in ${Extenders[@]}; do\n   { sleep 0.2; echo ""root""; sleep 0.2; echo ""ls""; sleep 0.2; }  | telnet $val\ndone\n\n', '\nPlay with tcpdump or wireshark and see what commands are sent to the server itself\nTry this\nprintf (printf ""$username\\r\\n$password\\r\\nwhoami\\r\\nexit\\r\\n"") | ncat $target 23\n\nSome servers require a delay with the password as it does not hold lines on the stack\nprintf (printf ""$username\\r\\n"";sleep 1;printf ""$password\\r\\nwhoami\\r\\nexit\\r\\n"") | ncat $target 23**\n\n']"
What are the best ways to automate a GDB debugging session?,"
Does GDB have a built in scripting mechanism, should I code up an expect script, or is there an even better solution out there?  
I'll be sending the same sequence of commands every time and I'll be saving the output of each command to a file (most likely using GDB's built-in logging mechanism, unless someone has a better idea).
",106k,"
            87
        ","['\nBasically, in this example I wanted to get some variable values in particular places of the code; and have them output until the program crashes. So here is first a little program which is guaranteed to crash in a few steps, test.c:\n#include <stdio.h>\n#include <stdlib.h>\n\nint icount = 1; // default value\n\nmain(int argc, char *argv[])\n{\n  int i;\n\n  if (argc == 2) {\n    icount = atoi(argv[1]);\n  }\n\n  i = icount;\n  while (i > -1) {\n    int b = 5 / i;\n    printf("" 5 / %d = %d \\n"", i, b );\n    i = i - 1;\n  }\n\n  printf(""Finished\\n"");\n  return 0;\n}\n\nThe only reason the program accepts command-line arguments is to be able to choose the number of steps before crashing - and to show that gdb ignores --args in batch mode. This I compile with:\ngcc -g test.c -o test.exe\n\nThen, I prepare the following script - the main trick here is to assign a command to each breakpoint, which will eventually continue (see also Automate gdb: show backtrace at every call to function puts). This script I call test.gdb:\n# http://sourceware.org/gdb/wiki/FAQ: to disable the\n# ""---Type <return> to continue, or q <return> to quit---""\n# in batch mode:\nset width 0\nset height 0\nset verbose off\n\n# at entry point - cmd1\nb main\ncommands 1\n  print argc\n  continue\nend\n\n# printf line - cmd2\nb test.c:17\ncommands 2\n  p i\n  p b\n  continue\nend\n\n# int b = line - cmd3\nb test.c:16\ncommands 3\n  p i\n  p b\n  continue\nend\n\n# show arguments for program\nshow args\nprintf ""Note, however: in batch mode, arguments will be ignored!\\n""\n\n# note: even if arguments are shown;\n# must specify cmdline arg for ""run""\n# when running in batch mode! (then they are ignored)\n# below, we specify command line argument ""2"":\nrun 2     # run\n\n#start # alternative to run: runs to main, and stops\n#continue\n\nNote that, if you intend to use it in batch mode, you have to ""start up"" the script at the end, with run or start or something similar.\nWith this script in place, I can call gdb in batch mode - which will generate the following output in the terminal:\n$ gdb --batch --command=test.gdb --args ./test.exe 5\nBreakpoint 1 at 0x804844d: file test.c, line 10.\nBreakpoint 2 at 0x8048485: file test.c, line 17.\nBreakpoint 3 at 0x8048473: file test.c, line 16.\nArgument list to give program being debugged when it is started is ""5"".\nNote, however: in batch mode, arguments will be ignored!\n\nBreakpoint 1, main (argc=2, argv=0xbffff424) at test.c:10\n10    if (argc == 2) {\n$1 = 2\n\nBreakpoint 3, main (argc=2, argv=0xbffff424) at test.c:16\n16      int b = 5 / i;\n$2 = 2\n$3 = 134513899\n\nBreakpoint 2, main (argc=2, argv=0xbffff424) at test.c:17\n17      printf("" 5 / %d = %d \\n"", i, b );\n$4 = 2\n$5 = 2\n 5 / 2 = 2 \n\nBreakpoint 3, main (argc=2, argv=0xbffff424) at test.c:16\n16      int b = 5 / i;\n$6 = 1\n$7 = 2\n\nBreakpoint 2, main (argc=2, argv=0xbffff424) at test.c:17\n17      printf("" 5 / %d = %d \\n"", i, b );\n$8 = 1\n$9 = 5\n 5 / 1 = 5 \n\nBreakpoint 3, main (argc=2, argv=0xbffff424) at test.c:16\n16      int b = 5 / i;\n$10 = 0\n$11 = 5\n\nProgram received signal SIGFPE, Arithmetic exception.\n0x0804847d in main (argc=2, argv=0xbffff424) at test.c:16\n16      int b = 5 / i;\n\nNote that while we specify command line argument 5, the loop still spins only two times (as is the specification of run in the gdb script); if run didn\'t have any arguments, it spins only once (the default value of the program) confirming that --args ./test.exe 5 is ignored.\nHowever, since now this is output in a single call, and without any user interaction, the command line output can easily be captured in a text file using bash redirection, say:\ngdb --batch --command=test.gdb --args ./test.exe 5 > out.txt\n\nThere is also an example of using python for automating gdb in c - GDB auto stepping - automatic printout of lines, while free running?\n', '\ngdb executes file .gdbinit after running.\nSo you can add your commands to this file and see if it is OK for you.\nThis is an example of .gdbinit in order to print backtrace for all f() calls:\nset pagination off\nset logging file gdb.txt\nset logging on\nfile a.out\nb f\ncommands\nbt\ncontinue\nend\ninfo breakpoints\nr\nset logging off\nquit\n\n', '\nIf a -x with a file is too much for you, just use multiple -ex\'s.\nThis is an example to track a running program showing (and saving) the backtrace on crashes\nsudo gdb -p ""$(pidof my-app)"" -batch \\\n  -ex ""set logging on"" \\\n  -ex continue \\\n  -ex ""bt full"" \\\n  -ex quit\n\n']"
How to find the UpgradeCode and ProductCode of an installed application in Windows 7,"
I have an application installed on my machine. I also have its source code but somehow the ProductCode and UpgradeCode of this application were changed.
Now I want to get the UpgradeCode and ProductCode of this installed application.  I feel there must be some tool for this. 
Can anyone kindly let me know how to get the UpgradeCode and ProductCode of an installed application?
",188k,"
            44
        ","['\n\nIMPORTANT: It\'s been a while since this answer was originally posted, and smart people came up with wiser answers. Check How can I find the Upgrade Code for an installed MSI file? from @ Stein Åsmul if you need a solid and comprehensive approach.\n\nHere\'s another way (you don\'t need any tools):\n\nopen system registry and search for HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall key (if it\'s a 32-bit installer on a 64-bit machine, it might be under HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall instead).\nthe GUIDs listed under that key are the products installed on this machine\nfind the one you\'re talking about - just step one by one until you see its name on the right pane\n\nThis GUID you stopped on is the ProductCode.\nNow, if you\'re sure that reinstallation of this application will go fine, you can run the following command line:\n\nmsiexec /i {PRODUCT-CODE-GUID-HERE}\n  REINSTALL=ALL REINSTALLMODE=omus /l*v\n  log.txt\n\nThis will ""repair"" your application. Now look at the log file and search for ""UpgradeCode"". This value is dumped there.\nNOTE: you should only do this if you are sure that reinstall flow is implemented correctly and this won\'t break your installed application. \n', '\nIt takes some time to return results, easily many tens of seconds, but wmic works well and can be scripted:\nwmic product where ""Name like \'%Word%\'"" get Name,Version,IdentifyingNumber\n\nresult:\nIdentifyingNumber                       Name                                      Version\n{90140000-001B-0409-0000-0000000FF1CE}  Microsoft Office Word MUI (English) 2010  14.0.6029.1000\n\nThe IdentifingNumber is the ProductCode. I didn\'t see a property for UpgradeCode, but perhaps it might be buried under something else. See http://quux.wiki.zoho.com/WMIC-Snippets.html for many other examples, including uninstall:\nwmic path win32_product where ""name = \'HP Software Update\'"" call Uninstall\n\nFor UpgradeCode see the excellent and detailed answer to How can I find the Upgrade Code for an installed MSI file?\n', '\nTo everyone using:\nGet-WMIObject win32_product\n\nYou should be aware that this will run a self-heal on every single MSI application installed on the PC. If you were to check eventvwr it will say it has finished reconfiguring each product.\nIn this case i use the following (a mixture of Yan Sklyarenko\'s method):\n$Reg = @( ""HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*"", ""HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*"" )\n$InstalledApps = Get-ItemProperty $Reg -EA 0\n$WantedApp = $InstalledApps | Where { $_.DisplayName -like ""*<part of product>*"" }\n\nNow if you were to type:\n$WantedApp.PSChildName\n\nYou would be given the following:\nPS D:\\SCCM> $WantedApp.PSChildName\n{047904BA-C065-40D5-969A-C7D91CA93D62}\n\nIf your organization uses loads of MST\'s whilst installing applications you would want to avoid running self-heals encase they revert some crucial settings.\n\nNote - This will find your product code, then the upgrade can be found as Yan mentioned. I usually, though, just use either \'InstEd It!\' or \'Orca\' then go to the Property table of the MSI and it lists them right at the top.\n\n', ""\nIf you have msi installer open it with Orca (tool from Microsoft), table Property (rows UpgradeCode, ProductCode, Product version etc) or table Upgrade column Upgrade Code.\nTry to find instller via registry: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall find required subkey and watch value InstallSource. Maybe along the way you'll be able to find the MSI file.\n"", '\nPowershell handles tasks like this fairly handily:\n$productCode = (gwmi win32_product | `\n                ? { $_.Name -Like ""<PRODUCT NAME HERE>*"" } | `\n                % { $_.IdentifyingNumber } | `\n                Select-Object -First 1)\n\nYou can then use it to get the uninstall information as well:\n$wow = """"\n$is32BitInstaller = $True # or $False\n\nif($is32BitInstaller -and [System.Environment]::Is64BitOperatingSystem) \n{\n    $wow = ""\\Wow6432Node"" \n}\n\n$regPath = ""HKEY_LOCAL_MACHINE\\SOFTWARE$wow\\Microsoft\\Windows\\CurrentVersion\\Uninstall""\n\ndir ""HKLM:\\SOFTWARE$wow\\Microsoft\\Windows\\CurrentVersion\\Uninstall"" | `\n? { $_.Name -Like ""$regPath\\$productCode""  }\n\n', '\nYou can use the MsiEnumProductsEx and MsiGetProductInfoEx methods to enumerate all the installed applications on your system and match the data to your application\n', '\nIn Windows 10 preview build with PowerShell 5, I can see that you can do:\n$info = Get-Package -Name YourInstalledProduct\n$info.Metadata[""ProductCode""]\n\nNot familiar with even not sure if all products has UpgradeCode, but  according to this post you need to search UpgradeCode from this registry path:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UpgradeCodes\n\nUnfortunately, the registry key values are the ProductCode and the registry keys are the UpgradeCode.\n', '\nIf anyone wants to get installed application package code, just execute below command with your application name in the command prompt. You will be getting product code along with package code.\nwmic product where ""Name like \'%YOUR_APPLICATION_NAME%\'"" get IdentifyingNumber, PackageCode\n', '\nAnother way-too-complicated workaround, with the benefit of not having to re-install the application as the previous workaround required. This requires that you have access to the msi (or a setup.exe with the msi embedded).\nIf you have Visual Studio 2012 (or possibly other editions) and install the free ""InstallShield LE"", then you can create a new setup project using InstallShield.\nOne of the configuration options in the ""Organize your Setup"" step is called ""Upgrade Paths"".  Open the properties for Upgrade Paths, and in the left pane right click ""Upgrade Paths"" and select ""New Upgrade Path"" ... now browse to the msi (or setup.exe containing the msi) and click ""open"".  The upgrade code will be populated for you in the settings page in the right pane which you should now see.\n', '\nHadn\'t found any way of finding out the UpgradeCode from an installed application, before seeing Yan Sklyarenko\'s workaround (currently) above. But if you/anyone else would find a way of finding out (at least) both UpgradeCode and ProductCode from a MSI, read on.\nFrom http://www.dwarfsoft.com/blog/2010/06/22/msi-package-code-fun/, modified to allow (when launched with wscript.exe) one popup box of info per MSI (Trunicated at 1023 chars, due to wscript.echo limitation); able to input MSI(s) from the GUI as well as the CLI; some basic human input validation; removed debug code (\' Set oDatabase) and 1 bug fix (DB.OpenView).\n\'Created by:   Chris Bennett\n\'Created Date: 22/06/2010\n\'Description:\n\'   Opens up MSI file(s) Passed as Arguments & returns ProductName, ProductCode,\n\'   The HKCR key created from ProductCode (a Packed GUID of ProductCode), the \n\'   PackageCode and the UpgradeCode of the MSI. Much quicker than getting these\n\'   out of the MSI\'s the Manual Way.\n\nReferences:\nhttp://msdn.microsoft.com/en-us/library/aa369794%28VS.85%29.aspx\nhttp://www.eggheadcafe.com/forumarchives/platformsdkmsi/Jan2006/post25948124.asp\nif wscript.arguments.count = 0 then\n  MSIs = inputbox(""Enter in * delimited list of MSI\'s to query (Max 254 characters)"", ""MSI Product Details"")\n  MSIs = split(MSIs,""*"")\nelse\n  set MSIs = wscript.arguments\nend if\n\nset objFS = createobject(""scripting.filesystemobject"")\nFor Each MSIPath in MSIs\n  if objFS.fileexists(MSIPath) then\n    Set MSIDetails = EvaluateMSI(MSIPath)\n    MSIDetails = MSIPath & "": "" & vbcrlf & vbcrlf & ""Product Name: "" &_\n    MSIDetails(""ProductName"") & vbcrlf & ""Product Code: "" &_\n    MSIDetails(""ProductCode"") & vbcrlf & ""Product Key : "" &_\n    ""HKCR\\Installer\\Products\\"" & PackGUID(MSIDetails(""ProductCode"")) &_\n    vbcrlf & ""Package Code: "" & MSIDetails(""PackageCode"") & vbcrlf &_\n    ""Upgrade Code: "" & MSIDetails(""UpgradeCode"") & vbcrlf\n    WScript.Echo MSIDetails\n  else\n    wscript.echo ""Inaccessible; Non-existant; or Error in Path for:"" & vbcrlf & MSIPath & vbcrlf & ""... skipping""\n  end if\nNext\n\nFunction EvaluateMSI(MSIPath)\n  On Error Resume Next\n  \' create installer object\n  Set oInstaller = CreateObject(""WindowsInstaller.Installer"")\n  \' open msi in read-only mode\n  Set oDatabase = oInstaller.OpenDatabase(MSIPath, 0)\n  Set objDictionary = CreateObject(""Scripting.Dictionary"")\n  \' Get Package Code from Summary Information Stream   \n  Set streamobj = oDatabase.SummaryInformation(0) \'0 = read only\n  objDictionary(""PackageCode"") = streamobj.Property(9)\n  \' Get Product Name from MSI Database\n  Set View = oDatabase.OpenView(""Select `Value` From Property WHERE `Property`=\'ProductName\'"")\n  View.Execute\n  Set ProductName = View.Fetch\n  objDictionary(""ProductName"") = ProductName.StringData(1)\n\n  \' Get Product Code from MSI Database\n  Set View = oDatabase.OpenView(""Select `Value` From Property WHERE `Property`=\'ProductCode\'"")\n  View.Execute\n  Set ProductCode = View.Fetch\n  objDictionary(""ProductCode"") = ProductCode.StringData(1)\n\n  \' Get Upgrade Code from MSI Database\n  Set View = oDatabase.OpenView(""Select `Value` From Property WHERE `Property`=\'UpgradeCode\'"")\n  View.Execute\n  Set UpgradeCode = View.Fetch\n  objDictionary(""UpgradeCode"") = UpgradeCode.StringData(1)\n\n  Set EvaluateMSI = objDictionary\n  On Error Goto 0\nEnd Function\n\nFunction PackGUID(guid)  \n  PackGUID = """"  \n  \'*  \n  Dim temp  \n  temp = Mid(guid,2,Len(guid)-2)  \n  Dim part  \n  part = Split(temp,""-"")  \n  Dim pack  \n  pack = """"  \n  Dim i, j  \n  For i = LBound(part) To UBound(part)\n    Select Case i\n      Case LBound(part), LBound(part)+1, LBound(part)+2\n        For j = Len(part(i)) To 1 Step -1  \n          pack = pack & Mid(part(i),j,1)  \n        Next  \n      Case Else\n        For j = 1 To Len(part(i)) Step 2  \n          pack = pack & Mid(part(i),j+1,1) & Mid(part(i),j,1)  \n      Next  \n    End Select\n  Next  \n  \'*  \n  PackGUID = pack  \nEnd Function\n\nIf one needs to copy&paste any of the GUID\'s in the popup, I tend to find it easiest to use a subsequent inputbox, like inputbox """","""",MSIDetails\n', ""\nIf you don't have the msi and you need the upgrade code, rather than the product code then the answer is here: How can I find the upgrade code for an installed application in C#?\n""]"
How to print every executed line in GDB automatically until a given breakpoint is reached?,"
I would like to be able to set a breakpoint in GDB, and have it run to that point - and in the process, print out lines it has ""stepped through"".
Here is an example, based on this simple file with a main and a function, and two breakpoints for each: 
$ cat > test.c <<EOF
#include ""stdio.h""

int count=0;

void doFunction(void) {
  // two steps forward
  count += 2;
  // one step back
  count--;
}

int main(void) {
  // some pointless init commands;
  count = 1;
  count += 2;
  count = 0;
  //main loop
  while(1) {
    doFunction();
    printf(""%d\n"", count);
  }
}
EOF

$ gcc -g -Wall test.c -o test.exe
$ chmod +x test.exe
$ gdb -se test.exe
...
Reading symbols from /path/to/test.exe...done.
(gdb) b main
Breakpoint 1 at 0x80483ec: file test.c, line 14.
(gdb) b doFunction
Breakpoint 2 at 0x80483c7: file test.c, line 7.

To start the session, I need to run (r) the program, which will then stop at first breakpoint (main):
(gdb) r
Starting program: /path/to/test.exe 

Breakpoint 1, main () at test.c:14
14    count = 1;
(gdb) 

At this point - I can, for instance, hit continue (c); and the process will run through, not outputing anything, and break at the requested line: 
(gdb) c
Continuing.

Breakpoint 2, doFunction () at test.c:7
7     count += 2;
(gdb)

On the other hand, instead of continue - I can go line by line, either by using step (s) or next (n); for instance:
14    count = 1;
(gdb) n
15    count += 2;
(gdb) s
16    count = 0;
(gdb) s
19      doFunction();
(gdb) s

Breakpoint 2, doFunction () at test.c:7
7     count += 2;
(gdb) s
9     count--;
(gdb) s
10  }
(gdb) s
main () at test.c:20
20      printf(""%d\n"", count);
(gdb) s
...
(gdb) s
_IO_vfprintf_internal (s=Cannot access memory at address 0xe5853361
) at vfprintf.c:210
210 vfprintf.c: No such file or directory.
    in vfprintf.c
(gdb) s
245 in vfprintf.c
(gdb) s
210 in vfprintf.c
(gdb) n
245 in vfprintf.c
...
(gdb) n
2006    in vfprintf.c
(gdb) n
__printf (format=0x80484f0 ""%d\n"") at printf.c:39
39  printf.c: No such file or directory.
    in printf.c
(gdb) n
main () at test.c:21
21    }
(gdb) n
19      doFunction();
(gdb) n

Breakpoint 2, doFunction () at test.c:7
7     count += 2;
(gdb) 

Anyways, I am aware that I can keep Enter pressed, and the last entered command (step or next) will repeat (left a bit longer session in the second case, to show that 'next' remains on same level, 'step' steps inside the functions being called). However, as it can be seen, depending on whether step or next runs, it may take a while until a result is reached - and so, I don't want to sit for 10 minutes with my hand stuck on the Enter button :) 
So, my question is - can I somehow instruct gdb to run to 'breakpoint 2' without further user intervention - while printing out the lines it goes through, as if step (or next) was pressed?
",22k,"
            33
        ","['\nWell, this wasn\'t easy - but I think I somewhat got it :) I went through a bunch of failed attempts (posted here); relevant code is below.\nBasically, the problem in a ""next/step until breakpoint"" is how to determine whether you\'re ""on"" a breakpoint or not, if the debugger is stopped (at a step). Note also I use GDB 7.2-1ubuntu11 (current for Ubuntu 11.04). So, it went like this:\n\nI first found about Convenience Variables, and thought - given there are program counters and such available, there must be some GDB convenience variable that gives the ""breakpoint"" status, and can be used directly in a GDB script. After looking through GDB reference Index for a while, however, I simply cannot find any such variables (my attempts are in nub.gdb)\nIn lack of such a ""breakpoint status"" internal variable - the only thing left to do, is to capture the (\'stdout\') command line output of GDB (in response to commands) as a string, and parse it (looking for ""Breakpoint"")\nThen, I found out about Python API to GDB, and the gdb.execute(""CMDSTR"", toString=True) command - which is seemingly exactly what is needed to capture the output: ""By default, any output produced by command is sent to gdb\'s standard output. If the to_string parameter is True, then output will be collected by gdb.execute and returned as a string[1]""!\n\n\nSo, first I tried to make a script (pygdb-nub.py,gdbwrap) that would utilize gdb.execute in the recommended manner; failed here - because of this:\n\n\nBug 627506 – python: gdb.execute([...], to_string=True) partly prints to stdout/stderr\nBug 10808 – Allow GDB/Python API to capture and store GDB output\n\nThen, I thought I\'d use a python script to subprocess.Popen the GDB program, while replacing its stdin and stdout; and then proceed controlling GDB from there (pygdb-sub.py) - that failed too... (apparently, because I didn\'t redirect stdin/out right)\nThen, I thought I\'d use python scripts to be called from GDB (via source) which would internally fork into a pty whenever gdb.execute should be called, so as to capture its output (pygdb-fork.gdb,pygdb-fork.py)... This almost worked - as there are strings returned; however GDB notices something ain\'t right: ""[tcsetpgrp failed in terminal_inferior: Operation not permitted]"", and the subsequent return strings don\'t seem to change.\n\n\nAnd finally, the approach that worked is: temporarily redirecting the GDB output from a gdb.execute to a logfile in RAM (Linux: /dev/shm); and then reading it back, parsing it and printing it from python - python also handles a simple while loop that steps until a breakpoint is reached.\nThe irony is - most of these bugs, that caused this solution via redirecting the logfile, are actually recently fixed in SVN; meaning those will propagate to the distros in the near future, and one will be able to use gdb.execute(""CMDSTR"", toString=True) directly :/ Yet, as I cannot risk building GDB from source right now (and possibly bumping into possible new incompatibilites), this is good enough for me also :)\n\xa0\nHere are the relevant files (partially also in pygdb-fork.gdb,pygdb-fork.py):\npygdb-logg.gdb is:\n# gdb script: pygdb-logg.gdb\n# easier interface for pygdb-logg.py stuff\n# from within gdb: (gdb) source -v pygdb-logg.gdb\n# from cdmline: gdb -x pygdb-logg.gdb -se test.exe\n\n# first, ""include"" the python file:\nsource -v pygdb-logg.py\n\n# define shorthand for nextUntilBreakpoint():\ndefine nub\n  python nextUntilBreakpoint()\nend\n\n# set up breakpoints for test.exe:\nb main\nb doFunction\n\n# go to main breakpoint\nrun\n\npygdb-logg.py is:\n# gdb will \'recognize\' this as python\n#  upon \'source pygdb-logg.py\'\n# however, from gdb functions still have\n#  to be called like:\n#  (gdb) python print logExecCapture(""bt"")\n\nimport sys\nimport gdb\nimport os\n\ndef logExecCapture(instr):\n  # /dev/shm - save file in RAM\n  ltxname=""/dev/shm/c.log""\n\n  gdb.execute(""set logging file ""+ltxname) # lpfname\n  gdb.execute(""set logging redirect on"")\n  gdb.execute(""set logging overwrite on"")\n  gdb.execute(""set logging on"")\n  gdb.execute(instr)\n  gdb.execute(""set logging off"")\n\n  replyContents = open(ltxname, \'r\').read() # read entire file\n  return replyContents\n\n# next until breakpoint\ndef nextUntilBreakpoint():\n  isInBreakpoint = -1;\n  # as long as we don\'t find ""Breakpoint"" in report:\n  while isInBreakpoint == -1:\n    REP=logExecCapture(""n"")\n    isInBreakpoint = REP.find(""Breakpoint"")\n    print ""LOOP:: "", isInBreakpoint, ""\\n"", REP\n\n\xa0\nBasically, pygdb-logg.gdb loads the pygdb-logg.py python script, sets up the alias nub for nextUntilBreakpoint, and initializes the session - everything else is handled by the python script. And here is a sample session - in respect to the test source in OP:\n$ gdb -x pygdb-logg.gdb -se test.exe\n...\nReading symbols from /path/to/test.exe...done.\nBreakpoint 1 at 0x80483ec: file test.c, line 14.\nBreakpoint 2 at 0x80483c7: file test.c, line 7.\n\nBreakpoint 1, main () at test.c:14\n14    count = 1;\n(gdb) nub\nLOOP::  -1\n15    count += 2;\n\nLOOP::  -1\n16    count = 0;\n\nLOOP::  -1\n19      doFunction();\n\nLOOP::  1\n\nBreakpoint 2, doFunction () at test.c:7\n7     count += 2;\n\n(gdb) nub\nLOOP::  -1\n9     count--;\n\nLOOP::  -1\n10  }\n\nLOOP::  -1\nmain () at test.c:20\n20      printf(""%d\\n"", count);\n\n1\nLOOP::  -1\n21    }\n\nLOOP::  -1\n19      doFunction();\n\nLOOP::  1\n\nBreakpoint 2, doFunction () at test.c:7\n7     count += 2;\n\n(gdb)\n\n... just as I wanted it :P Just don\'t know how reliable it is (and whether it will be possible to use in avr-gdb, which is what I need this for :) EDIT: version of avr-gdb in Ubuntu 11.04 is currently 6.4, which doesn\'t recognize the python command :()\n\xa0\nWell, hope this helps someone,\nCheers!\n\xa0\nHere some references:\n\nGDB: error detected on stdin\nGDB has problems with getting commands piped to STDIN\nRe: [Gdb] How do i use GDB other input?\ngdb doesn\'t accept input on stdin\nUsing gdb in an IDE - comp.os.linux.development.apps | Google Groups\nrmathew: Terminal Sickness\n[TUTORIAL] Calling an external program in C (Linux) - GIDForums\nshell - how to use multiple arguments with a shebang (i.e. #!)? - Stack Overflow\nRedirecting/storing output of shell into GDB variable? - Stack Overflow\nCorey Goldberg: Python - Redirect or Turn Off STDOUT and STDERR\nThe Cliffs of Inanity › 9. Scripting gdb\ngdb python scripting: where has parse_and_eval gone? - Stack Overflow\nshell - Invoke gdb to automatically pass arguments to the program being debugged - Stack Overflow\nStoring Files/Directories In Memory With tmpfs | HowtoForge - Linux Howtos and Tutorials\nsimple way to touch a file if it does not exist | Python | Python\nos.fork() different in cgi-script? - Python\njava - Writing tests that use GDB - how to capture output? - Stack Overflow\nDebugging with GDB: How to create GDB Commands in Python - Wiki\nGDB reference card\n\n', '\nWhat about doing it like this in gdb, using a command file. Change file argument, and loop count as required.\ngdb -x run.gdb\n\nrun.gdb:\nset pagination off\nset logging file gdb.log\nset logging on\nset $i = 0\nfile main\nbreak main\nbreak WriteData\n# sadly, commands not getting executed on reaching breakpoint 2\ncommands 2\n  set $i=1000\n  print ""commands 2 : %d"",$i\nend\nrun\nwhile ( $i < 1000 )\n  step\n  # next\n  # continue\n  set $i = $i + 1\nend\n\n', ""\nBased on the link in @sdaau's answer (http://www.mail-archive.com/gdb@gnu.org/msg00031.html), I created my own script to simply keep sending 's' and reading the output of gdb continuously, while printing output to textfile and terminal, of course, my script can be modified to fit anyone else's needs, however, I hope that the modification I made should fit most people needs.\nhttp://www.codeground.net/coding/gdb-step-into-all-lines-to-get-full-application-flow/\nwget http://www.codeground.net/downloads/gdbwalkthrough.c\ngcc gdbwalkthrough.c -o gdbwalkthrough\n./gdbwalkthrough <application full path> [application arguments]\n\n"", '\nAs a new answer, since the previous is already hogged :) Basically, if the point is to observe execution of source (and/or assembly) code lines as the program as running - as the motivation is often for me when looking into ""automatic printout"" -- then, basically, a very quick way is to use GDB TUI mode; I quote:\nc - gdb behavior : value optimized out - Stack Overflow #1354762\n\nUse the GDB TUI mode. My copy of GDB enables it when I type the minus and Enter. Then type C-x 2 (that is hold down Control and press X, release both and then press 2). That will put it into split source and disassembly display. Then use stepi and nexti to move one machine instruction at a time. Use C-x o to switch between the TUI windows.\n\nThe trick here is that, even if you hit continue - this time source will be shown and indicated on the TUI; and followed as the program runs: \n \n... and this for me avoids many situations where I\'d have to script the breakpoints in ""auto-stepping context"" (although there are still such situations).. Docs about TUI: TUI - Debugging with GDB\nCheers!\n', '\nActually, I have a Github repo with a Python-GDB extension, which does exactly the same thing as You have described, but with some more functionality.\nYou can just clone the repo:\ngit clone https://github.com/Viaceslavus/gdb-debug-until.git\n\nand feed the python script to GDB with the following command inside GDB:\nsource gdb-debug-until/debug_until.py\n\n(Change python script path if necessary)\nAnd now you can use the following command to run through each line of your code until a breakpoint:\ndebug-until somefile.c:100 --args="""" --end=""somefile.c:200""\n\n""somefile.c:100"" here is a starting breakpoint, and ""somefile.c:200"" is the final breakpoint.\n""--args"" specifies a set of arguments to your program (you can omit it if there are no arguments).\nWith this extension you can also run few times through the code (with \'-r\' option) and even specify some events that should be handled while debugging. For more info see:\nhttps://github.com/Viaceslavus/gdb-debug-until\n', '\nThe currently accepted answer includes a lot of file io and does only stop on breakpoints, but watchpoints, signals and possibly even the program end is ignored.\nUsing the python api this can be handled nicely:\n\ndefine a user command (with additional argument to say how fast to auto-step)\noptional: define a parameter for the default (both variants below)\ndo the while loop within python, handle the ""expected"" keyboard interrupt of CTRL-C\nregister a stop event handler that checks for the stop reason and store the kind of step there\nadjust the while loop to stop for a ""not simple"" stop (breakpoint/watchpoint/signal/...)\n\nThe following code may be placed in a gdb-auto-step.py which can be made active with source gdb-auto-step.py whenever you want that (or include in the .gdbinit file to make it always available):\nimport gdb\nimport time\nimport traceback\n\nclass CmdAutoStep (gdb.Command):\n    """"""Auto-Step through the code until something happens or manually interrupted.\nAn argument says how fast auto stepping is done (1-19, default 5).""""""\n    def __init__(self):\n        print(\'Registering command auto-step\')\n        super(CmdAutoStep, self).__init__(""auto-step"", gdb.COMMAND_RUNNING)\n        gdb.events.stop.connect(stop_handler_auto_step)\n    def invoke(self, argument, from_tty):\n        # sanity check - are we even active, prevents a spurious ""no registers"" exception\n        try:\n            gdb.newest_frame()\n        except gdb.error:\n            raise gdb.GdbError(""The program is not being run."")\n\n        # calculate sleep time\n        if argument:\n            if not argument.isdigit():\n                raise gdb.GdbError(""argument must be a digit, not "" + argument)\n            number = int(argument)\n            if number == 0 or number > 19:\n                raise gdb.GdbError(""argument must be a digit between 1 and 19"")   \n        sleep_time = 3.0 / (1.4 ** number)\n\n        # activate GDB scrolling, otherwise we\'d auto-step only one page\n        pagination = gdb.parameter(""pagination"")\n        if pagination:\n            gdb.execute(""set pagination off"", False, False)\n\n        # recognize the kind of stop via stop_handler_auto_step \n        global last_stop_was_simple\n        last_stop_was_simple = True\n\n        # actual auto-stepping\n        try:\n            while last_stop_was_simple:\n                gdb.execute(""step"")\n                time.sleep(sleep_time)\n        # we just quit the loop as requested\n        # pass keyboard and user errors unchanged\n        except (KeyboardInterrupt, gdb.GdbError):\n            raise\n        # that exception is unexpected, but we never know...\n        except Exception:\n            traceback.print_exc()\n        # never leave without cleanup...\n        finally:\n            if pagination:\n                gdb.execute(""set pagination on"", False, False)\n\ndef stop_handler_auto_step(event):\n    # check the type of stop, the following is the common one after step/next,\n    # a more complex one would be a subclass (for example breakpoint or signal)\n    global last_stop_was_simple\n    last_stop_was_simple = type(event) is gdb.StopEvent\n\nCmdAutoStep()\n\n\nTo specify the default with a parameter (aka ""the gdb way"") add another parameter and use it (comes also with 0 = unlimited)\nimport gdb\nimport time\nimport traceback\n\nclass ParameterAutoStep (gdb.Parameter):\n    """"""auto-step default speed (0-19, default 5)""""""\n    def __init__(self):\n        self.set_doc = """"""Set speed for ""auto-step"", internally used to calculate sleep time between ""step""s.\nset ""auto-step 0"" causes there to be no sleeping.""""""\n        self.show_doc = ""Speed value for auto-step.""\n        super(ParameterAutoStep, self).__init__(""auto-step"", gdb.COMMAND_RUNNING, gdb.PARAM_UINTEGER)\n        self.value = 5\n        self.backup = self.value\n\n    def get_set_string (self):\n        try:\n            self.value = int(ParameterAutoStep.validate(self.value))\n        except gdb.GdbError:\n            self.value = int (self.backup)\n            raise\n        self.backup = self.value\n        return """"\n\n    @staticmethod\n    def validate (argument):\n        """"""validation for auto-step speed""""""\n        try:\n            speed = int(argument)\n            if speed < 0 or speed > 19:\n                raise ValueError()\n        except (TypeError, ValueError):\n            raise gdb.GdbError(""speed-argument must be an integer between 1 and 19, or 0"")\n        return speed\n\nclass CmdAutoStep (gdb.Command):\n    """"""Auto-Step through the code until something happens or manually interrupted.\nAn argument says how fast auto stepping is done (see parameter ""auto-step"").""""""\n    def __init__(self):\n        print(\'Registering command and parameter auto-step\')\n        super(CmdAutoStep, self).__init__(""auto-step"", gdb.COMMAND_RUNNING)\n        self.defaultSpeed = ParameterAutoStep()\n        gdb.events.stop.connect(stop_handler_auto_step)\n\n    def invoke(self, argument, from_tty):\n        # sanity check - are we even active, prevents a spurious ""no registers"" exception\n        try:\n            gdb.newest_frame()\n        except gdb.error:\n            raise gdb.GdbError(""The program is not being run."")\n\n        # calculate sleep time\n        if argument:\n            number = ParameterAutoStep.validate(argument) # raises an error if not valid\n        else:\n            number = self.defaultSpeed.value\n        if number:\n            sleep_time = 3.0 / (1.4 ** number)\n        else:\n            sleep_time = 0\n\n        # activate GDB scrolling, otherwise we\'d auto-step only one page\n        pagination = gdb.parameter(""pagination"")\n        if pagination:\n            gdb.execute(""set pagination off"", False, False)\n\n        # recognize the kind of stop via stop_handler_auto_step \n        global last_stop_was_simple\n        last_stop_was_simple = True\n\n        # actual auto-stepping\n        try:\n            while last_stop_was_simple:\n                gdb.execute(""step"")\n                time.sleep(sleep_time)\n        # we just quit the loop as requested\n        # pass keyboard and user errors unchanged\n        except (KeyboardInterrupt, gdb.GdbError):\n            raise\n        # that exception is unexpected, but we never know...\n        except Exception:\n            traceback.print_exc()\n        # never leave without cleanup...\n        finally:\n            if pagination:\n                gdb.execute(""set pagination on"", False, False)\n\ndef stop_handler_auto_step(event):\n    # check the type of stop, the following is the common one after step/next,\n    # a more complex one would be a subclass (for example breakpoint or signal)\n    global last_stop_was_simple\n    last_stop_was_simple = type(event) is gdb.StopEvent\n\nCmdAutoStep()\n\n\n']"
How to use WebBrowser control DocumentCompleted event in C#?,"
Before starting writing this question, i was trying to solve following
// 1. navigate to page
// 2. wait until page is downloaded
// 3. read and write some data from/to iframe 
// 4. submit (post) form

The problem was, that if a iframe exists on a web page, DocumentCompleted event would get fired more then once (after each document has been completed). It was highly likely that program would have tried to read data from DOM that was not completed and naturally - fail.
But suddenly while writing this question 'What if' monster inspired me, and i fix'ed the problem, that i was trying to solve. As i failed Google'ing this, i thought it would be nice to post it here.
    private int iframe_counter = 1; // needs to be 1, to pass DCF test
    public bool isLazyMan = default(bool);

    /// <summary>
    /// LOCK to stop inspecting DOM before DCF
    /// </summary>
    public void waitPolice() {
        while (isLazyMan) Application.DoEvents();
    }

    private void webBrowser1_Navigating(object sender, WebBrowserNavigatingEventArgs e) {
        if(!e.TargetFrameName.Equals(""""))
            iframe_counter --;
        isLazyMan = true;
    }

    private void webBrowser1_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e) {
        if (!((WebBrowser)sender).Document.Url.Equals(e.Url))
            iframe_counter++;
        if (((WebBrowser)sender).Document.Window.Frames.Count <= iframe_counter) {//DCF test
            DocumentCompletedFully((WebBrowser)sender,e);
            isLazyMan = false; 
        }
    }

    private void DocumentCompletedFully(WebBrowser sender, WebBrowserDocumentCompletedEventArgs e){
        //code here
    }

For now at least, my 5m hack seems to be working fine. 
Maybe i am really failing at querying google or MSDN, but i can not find:
""How to use webbrowser control DocumentCompleted event in C# ?""
Remark: After learning a lot about webcontrol, I found that it does FuNKY stuff. 
Even if you detect that the document has completed, in most cases it wont stay like that forever. Page update can be done in several ways - frame refresh, ajax like request or server side push (you need to have some control that supports asynchronous communication and has html or JavaScript interop). Also some iframes will never load, so it's not best idea to wait for them forever. 
I ended up using:
if (e.Url != wb.Url)

",52k,"
            14
        ","['\nYou might want to know the AJAX calls as well.\nConsider using this:\nprivate void webBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n{\n    string url = e.Url.ToString();\n    if (!(url.StartsWith(""http://"") || url.StartsWith(""https://"")))\n    {\n            // in AJAX\n    }\n\n    if (e.Url.AbsolutePath != this.webBrowser.Url.AbsolutePath)\n    {\n            // IFRAME \n    }\n    else\n    {\n            // REAL DOCUMENT COMPLETE\n    }\n}\n\n', '\nI have yet to find a working solution to this problem online. Hopefully this will make it to the top and save everyone the months of tweaking I spent trying to solve it, and the edge cases associated with it. I have fought over this issue over the years as Microsoft has changed the implementation/reliability of isBusy and document.readystate. With IE8, I had to resort to the following solution. It\'s similar to the question/answer from Margus with a few exceptions. My code will handle nested frames, javascript/ajax requests and meta-redirects. I have simplified the code for clarity sake, but I also use a timeout function (not included) to reset the webpage after if 5 minutes domAccess still equals false.\nprivate void m_WebBrowser_BeforeNavigate(object pDisp, ref object URL, ref object Flags, ref object TargetFrameName, ref object PostData, ref object Headers, ref bool Cancel)\n{\n    //Javascript Events Trigger a Before Navigate Twice, but the first event \n    //will contain javascript: in the URL so we can ignore it.\n    if (!URL.ToString().ToUpper().StartsWith(""JAVASCRIPT:""))\n    {\n        //indicate the dom is not available\n        this.domAccess = false;\n        this.activeRequests.Add(URL);\n    }\n}\n\nprivate void m_WebBrowser_DocumentComplete(object pDisp, ref object URL) \n{\n\n    this.activeRequests.RemoveAt(0);\n\n    //if pDisp Matches the main activex instance then we are done.\n    if (pDisp.Equals((SHDocVw.WebBrowser)m_WebBrowser.ActiveXInstance)) \n    {\n        //Top Window has finished rendering \n        //Since it will always render last, clear the active requests.\n        //This solves Meta Redirects causing out of sync request counts\n        this.activeRequests.Clear();\n    }\n    else if (m_WebBrowser.Document != null)\n    {\n        //Some iframe completed dom render\n    }\n\n    //Record the final complete URL for reference\n    if (this.activeRequests.Count == 0)\n    {\n        //Finished downloading page - dom access ready\n        this.domAccess = true;\n    }\n}\n\n', '\nUnlike Thorsten I didn\'t have to use ShDocVw, but what did make the difference for me was adding the loop checking ReadyState and using Application.DoEvents() while not ready.  Here is my code:\n        this.webBrowser.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(WebBrowser_DocumentCompleted);\n        foreach (var item in this.urlList) // This is a Dictionary<string, string>\n        {\n            this.webBrowser.Navigate(item.Value);\n            while (this.webBrowser1.ReadyState != WebBrowserReadyState.Complete)\n            {\n                Application.DoEvents();\n            }\n        }\n\nAnd I used Yuki\'s solution for checking the results of WebBrowser_DocumentCompleted, though with the last if/else swapped per user\'s comment:\n     private void WebBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n    {\n        string url = e.Url.ToString();\n        var browser = (WebBrowser)sender;\n\n        if (!(url.StartsWith(""http://"") || url.StartsWith(""https://"")))     \n        {             \n            // in AJAX     \n        }\n        if (e.Url.AbsolutePath != this.webBrowser.Url.AbsolutePath)     \n        {\n            // IFRAME           \n        }     \n        else     \n        {             \n            // REAL DOCUMENT COMPLETE\n            // Put my code here\n        }\n    }\n\nWorked like a charm :)\n', '\nI had to do something similar. What I do is use ShDocVw directly (adding a reference to all the necessary interop assemblies to my project). Then, I do not add the WebBrowser control to my form, but the AXShDocVw.AxWebBrowser control.\nTo navigate and wait I use to following method:\nprivate void GotoUrlAndWait(AxWebBrowser wb, string url)\n{\n    object dummy = null;\n    wb.Navigate(url, ref dummy, ref dummy, ref dummy, ref dummy);\n\n    // Wait for the control the be initialized and ready.\n    while (wb.ReadyState != SHDocVw.tagREADYSTATE.READYSTATE_COMPLETE)\n        Application.DoEvents();\n}\n\n', '\nJust thought to drop a line or two here about a small improvement which works in conjunction with the code of FeiBao. The idea is to inject a landmark (javascript) variable in the webpage and use that to detect which of the subsequent DocumentComplete events is the real deal. I doubt it\'s bulletproof but it has worked more reliably in general than the approach that lacks it. Any comments welcome. Here is the boilerplate code:\n void WebBrowser_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)\n    {\n        string url = e.Url.ToString();\n        var browser = (WebBrowser)sender;\n\n        if (!(url.StartsWith(""http://"") || url.StartsWith(""https://"")))\n        {\n            // in AJAX     \n        }\n        if (e.Url.AbsolutePath != this.webBrowser.Url.AbsolutePath)\n        {\n            // IFRAME           \n        }\n        else if (browser.Document != null && (bool)browser.Document.InvokeScript(""eval"", new object[] { @""typeof window.YourLandMarkJavascriptVariableHere === \'undefined\'"" }))\n        {\n            ((IHTMLWindow2)browser.Document.Window.DomWindow).execScript(""var window.YourLandMarkJavascriptVariableHere = true;"");\n\n            // REAL DOCUMENT COMPLETE\n            // Put my code here\n        }\n    }\n\n']"
Automate saveas dialogue for IE9 (vba),"
I am trying to download an excel sheet from a website. I have thus far achieved until clicking the download button automatically (web scraping). Now ie9 is popping a save as screen. How do i automate that?
",15k,"
            9
        ","['\nYou may try this as it is worked for me on IE9:\n\n\nCopy file C:\\Windows\\System32\\UIAutomationCore.dll file to users Documents i.e C:\\Users\\admin\\Documents then add reference UIAutomationClient to your macro file. \nPaste below code in your module: \n    Option Explicit\n    Dim ie As InternetExplorer\n    Dim h As LongPtr\n    Private Declare PtrSafe Function FindWindowEx Lib ""user32"" Alias ""FindWindowExA"" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n\nSub Download()\n    Dim o As IUIAutomation\n    Dim e As IUIAutomationElement\n    Set o = New CUIAutomation\n    h = ie.Hwnd\n    h = FindWindowEx(h, 0, ""Frame Notification Bar"", vbNullString)\n    If h = 0 Then Exit Sub\n\n    Set e = o.ElementFromHandle(ByVal h)\n    Dim iCnd As IUIAutomationCondition\n    Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, ""Save"")\n\n    Dim Button As IUIAutomationElement\n    Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n    Dim InvokePattern As IUIAutomationInvokePattern\n    Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n    InvokePattern.Invoke\nEnd Sub   \n\n\nTry at your end.\n', '\n\'This is a working code for vba in excel 2007 to open a file\n\'But you need to add the ""UIAutomationCore.dll"" to be copied \n\'from ""C:\\Windows\\System32\\UIAutomationCore.dll"" into the \n\'path ""C:\\Users\\admin\\Documents""    \n\'The path where to copy may be different and you can find it when you check on \n\'the box for UIAutomationClient - the location is given under it.\n\'Tools-references\n\nOption Explicit\n  Dim ie As InternetExplorer\n  Dim h As LONG_PTR\n  Private Declare Function FindWindowEx Lib ""user32"" Alias ""FindWindowExA"" (ByVal hWnd1 As LONG_PTR, ByVal hWnd2 As LONG_PTR, ByVal lpsz1 As String, ByVal lpsz2 As String) As LONG_PTR\n\n\nSub click_open()\n  Dim o As IUIAutomation\n  Dim e As IUIAutomationElement\n  Dim sh\n  Dim eachIE\n\nDo\n\n    Set sh = New Shell32.Shell\n     For Each eachIE In sh.Windows\n         \' Check if this is the desired URL\n\n    \' Here you can use your condition except .html\n    \' If you want to use your URL , then put the URL below in the code for condition check.\n    \' This code will reassign your IE object with the same reference for navigation and your issue will resolve.\n         If InStr(1, eachIE.LocationURL, ""<enter your page url>"") Then\n         Set ie = eachIE\n         Exit Do\n         End If\n     Next eachIE\n Loop\n\nSet o = New CUIAutomation\nh = ie.Hwnd\nh = FindWindowEx(h, 0, ""Frame Notification Bar"", vbNullString)\nIf h = 0 Then Exit Sub\n\nSet e = o.ElementFromHandle(ByVal h)\nDim iCnd As IUIAutomationCondition\nSet iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, ""Open"")\n\n\nDim Button As IUIAutomationElement\nSet Button = e.FindFirst(TreeScope_Subtree, iCnd)\nDim InvokePattern As IUIAutomationInvokePattern\nSet InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\nInvokePattern.Invoke\n\nEnd Sub\n\n', '\nI sent the shortcut keys to IE11.\nNote: the code will not run as you expect if IE is not the active window on your machine so it won\'t work while in debug mode. The shortcut keys and how to send them are below.\n\nShortcut key:Alt+S\nVBA: Application.SendKeys ""%{S}""\n\n']"
"NAnt or MSBuild, which one to choose and when?","
I am aware there are other NAnt and MSBuild related questions on Stack Overflow, but I could not find a direct comparison between the two and so here is the question.
When should one choose NAnt over MSBuild? Which one is better for what? Is NAnt more suitable for home/open source projects and MSBuild for work projects? What is the experience with any of the two?
",32k,"
            162
        ","['\nI\'ve done a similar investigation this week. Here\'s what I\'ve been able to determine:\nNAnt:\n\nCross-platform (supports Linux/Mono). It may be handy for installing a web site to multiple targets (that is,  Linux Apache and Windows IIS), for example.\n95% similar in syntax to Ant (easy for current Ant users or Java builders to pick up)\nIntegration with NUnit for running unit tests as part of the build, and with NDoc for producting documentation.\n\nMSBuild:\n\nBuilt-in to .NET.\nIntegrated with Visual Studio\nEasy to get started with MSBuild in Visual Studio - it\'s all behind the scenes. If you want to get deeper, you can hand edit the files.\n\nSubjective Differences: (YMMV)\n\nNAnt documentation is a little more straightforward. For example, the MSBuild Task Reference lists ""Csc Task - Describes the Csc task and its parameters. "" (thanks for the ""help""?), vs the NAnt Task Reference ""csc - Compiles C# programs."" UPDATE: I\'ve noticed the MSBuild documentation has been improved and is much better now (probably on par with NAnt).\nNot easy to figure out how to edit the build script source (*.*proj file) directly from within Visual Studio. With NAnt I just have Visual Studio treat the .build script as an XML file.\nApparently, in Visual Studio, Web Application Projects don\'t get a *.*proj file by default, so I had great difficulty figuring out how to even get MSBuild to run on mine to create a deployment script.\nNAnt is not built-in to Visual Studio and has to be added, either with an Add-In, or as an ""External Tool"". This is a bit of a pain to set up.\n(Edit:) One of my coworkers brought this up--if you want to set up a build machine using CruiseControl for continuous integration, CruiseControl integrates with NAnt nicely out of the box. UPDATE: CruiseControl also has an MSBuild task.\nPlease see comments below for full and up-to-date discussion of subjective differences.\n\n', '\nOne of the major draws of MSBuild for me (on Windows platforms) is that it comes as part of .NET itself. That means that any Windows machine that is up-to-date with Windows Update will have MSBuild available. Add to this the fact that C# compiler is also part of .NET itself and you have a platform that can build projects on clean machines. No need to install Visual Studio behemoth. NAnt, on the other hand, has to be explicitly installed  before a build can be triggered.\nJust for the record, I\'ve used NMake, Make, Ant, Rake, NAnt and MSBuild on non-trivial builds in the past (in that order). My favourite is MSBuild, hands down (and I do not favour it because ""that\'s what Visual Studio uses""). IMHO, it is a very under-appreciated build tool.\nI would compare NAnt vs. MSBuild to the difference between procedural and functional programming. NAnt is quite straightforward and you-get-what-you-see. MSBuild on the other hand requires a bit more thought. The learning curve is steeper. But once you ""get it"", you can do some amazing things with it.\nSo I would recommend looking at MSBuild if you also gravitate towards functional or logical style programming - if you are willing to invest a bit of time and effort before seeing tangible results (of course, I also strongly believe that the investment eventually pays off and you can do more powerful things more efficiently).\n', '\nPersonally, I use both - for the same project.\nMSBuild is great at building Visual Studio solutions and projects - that\'s what it\'s made for.\nNAnt is more easily hand-editable, in my opinion - particularly if you already know Ant. NAnt can call MSBuild very easily with NAntContrib. So, I hand-craft a NAnt script to do things like copying built files, cleaning up etc - and call MSBuild to do the actual ""turn my C# source code into assemblies"" part.\nIf you want an example of that, look at my Protocol Buffers build file. (I wouldn\'t claim it\'s a fabulous NAnt script, but it does the job.)\n', ""\nNAnt has more features out of the box, but MSBuild has a much better fundamental structure (item metadata rocks) which makes it much easier to build reusable MSBuild scripts.\nMSBuild takes a while to understand, but once you do it's very nice.\nLearning materials:\n\nInside the Microsoft Build Engine: Using MSBuild and Team Foundation Build\nby Sayed Ibrahim Hashimi (Jan, 2009)\nDeploying .NET Applications: Learning MSBuild and ClickOnce by Sayed\nby Y. Hashimi (Sep, 2008)\n\n"", ""\nKISS = Use MSBuild.\nWhy add something else into the mix when you have something that will do a reasonable job out of the box? When MSBuild arrived, NAnt died. And Mono will have an MSBuild implementation, (xbuild).\nDRY = Use MSBuild.\nAsk yourself what do you want out of a build system? I want a build system that is also used by my IDE rather than the maintaining two different configurations.\nPersonally, I'd love to hear some real arguments for NAnt, because I just can't think of any that really hold water.\n"", ""\nOne thing I noticed several posters mention was having to hand edit the .csproj (or .vbproj, etc.) files. \nMSBuild allows customization of these .*proj files through the use of .user files. If I have a project named MyCreativelyNamedProject.csproj and want to customize the MSBuild tasks inside of it, I can create a file named MyCreativelyNamedProject.csproj.user and use the CustomBeforeMicrosoftCommonTargets and CustomAfterMicrosoftCommonTargets to customize those files.\nAlso, both NAnt and MSBuild can be customized to the heart's content through custom MSBuild tasks and through NantContrib extensions.\nSo, using NAnt or MSBuild really comes down to familiarity:\n\nIf you are already familiar with Ant, use NAnt. The learning curve will be very easy.\nIf you are not familiar with either tool, MSBuild is integrated with Visual Studio already and requires no additional tools.\n\nIt is also worth adding that MSBuild is pretty much guaranteed to work with all new versions of .NET and Visual Studio as soon as they are released, whereas NAnt may have some lag.\n"", ""\nI use both in that my NAnt scripts call MSBuild. My main reason for staying with NAnt is isolation. Let me explain why I feel this is important:\n\nAdding dependencies to your project.\nThe NAnt build file is alien to Visual Studio (in my case I consider this a pro) so Visual Studio does not attempt to do anything with it. MSBuild tasks are embedded so part of the solution and can refer to other MSBuild tasks. I've received source code from someone else only to find out I could not build, because the MSBuild community tasks were not installed. What I find particularly frustrating is that Visual Studio just would not build and threw a bunch of errors that made me loose time debugging. This, despite the fact that the build being requested could have gone ahead (as a debug build for instance) without some of the extras of the MSBuild task. In short: I don't like adding dependencies to my project if I can avoid it.\nI don't trust Visual Studio as far as I could throw its development team. This stems back to the early days of Visual Studio when it would massacre my HTML. I still do not use the designer for instance (at a conference recently I found colleagues did the same). I have found that Visual Studio can screw up dependencies and version numbers in the DLL file (I cannot replicate this, but it did happen in a project consistently and caused a lot of grief and lost time). I have resorted to a build procedure that uses Visual Studio to build in debug mode only. For production, I use NAnt so that I control everything externally. Visual Studio just cannot interfere any longer if I build using NAnt.\n\nPS: I'm a web developer and do not do Windows Forms development.\n"", ""\nWhile I'm not very familiar with MsBuild, I'm under the impression that some of key differences on both sides can be supplemented by additions:\n\nMsBuildTasks\nNantContrib\n\nI recently had to build a Silverlight project in Nant. I discovered that life would be easier if I just did this with MsBuild - I ended up calling a MsBuild task from within a Nant script so I suppose it's not too out of the ordinary to mix and match the two.\nBeyond that, I suppose it's going to be a question of personal preference - obviously you can manage some/most of MsBuild's functionality from within Visual Studio, if that's your thing. Nant seems more flexible and better suited if you prefer to write scripts by hand, and if you come from the Java world you'll likely be right at home with it.\n"", ""\nI ended up using both. When redesigning our build system, I was facing a tricky problem. Namely, I couldn't get rid of .vcproj (and family) because we everybody was using VS to update the project files, settings, and configurations. So without a huge duplication and error prone process, we couldn't base our build system on a new set of files.\nFor this reason, I decided to keep the 'proj' files of VS and use MSBuild (they are MSBuild files, at least VS2005 and VS2008 use MSBuild project files). For everything else (custom configuration, unit testing, packaging, preparing documentation...) I used NAnt.\nFor continuous integration, I used CruiseControl. So we had CC scripts that triggered NAnt jobs, which for building used MSBuild.\nOne final note: MSBuild does NOT support Setup projects! So you're stuck with calling DevEnv.com or using Visual Studio directly. That's what I ended up doing, but I disabled the setup project by default from all solution configurations, since developers wouldn't normally need to build them, and if they do, they can manually select to build them.\n"", '\nI have switched from NAnt to MSBuild recently because of its ability to build VS solutions. I still use NAnt occasionally, though.\nYou may also want to check out MSBuild Community Tasks which is like NAntContrib.\n', ""\nThe documentation and tutorials available for NAnt make it easier to begin learning build scripts with NAnt. Once I got the hang of NAnt and creating build scripts I started translating that knowledge to MSBuild (I did X in NAnt, how do I do X in MSBuild?). Microsoft's documentation usually assumes a pretty high level of knowledge before it is useful.\nThe reason for switching from NAnt to MSBuild is because MSBuild is more current. Unfortunately the last release of NAnt was in December 8 2007, while MSBuild 4.0 (.NET 4.0) isn't far off. It looks like the NAnt project has died.\nIf you find good documentation for someone just beginning to learn creating build scripts using MSBuild, then skip NAnt and go straight for MSBuild. If NAnt ever comes out with a new release then I'd consider sticking with NAnt, but they're lagging behind now.\n"", '\nWe use both. NAnt is responsible for all ""scripting"" stuff, like copying, deploying on IIS, creating packages and MSBuild is responsible for building the solution. Then we can avoid problems with non-supported .NET 4.0 by a new version of NAnt.\nNAnt is also more scalable. If we want to migrate the deployment scripts to production servers, we only copy the build file and install a proper version of .NET - no Visual Studio problems with csproj files:)\n', '\nYDeliver by Manoj is a build framework built on top of PSake. It has a rich set of library functions, ability to define workflows, and we have used it to deliver over six enterprise projects to production.\nUse it in conjunction with TeamCity, CruiseControl, or anything that can run PowerShell.\n', '\nWe use FlubuCore. It\'s an open source C# library for building projects and executing deployment scripts using C# code.\nSimple example of how flubu is used:\nprotected override void ConfigureTargets(ITaskContext session)\n{           \n\n    var compile = session.CreateTarget(""compile"")\n        .SetDescription(""Compiles the solution."")\n        .AddTask(x => x.CompileSolutionTask())\n        .DependsOn(""generate.commonassinfo"");\n}\n\nYou can find more information about flubu and how to get started here:\nchoice-for-build-tool-msbuild-nant-or-something-else\n']"
Dead code detection in legacy C/C++ project [closed],"






Closed. This question does not meet Stack Overflow guidelines. It is not currently accepting answers.
                        
                    










 We don’t allow questions seeking recommendations for books, tools, software libraries, and more. You can edit the question so it can be answered with facts and citations.


Closed 6 years ago.







                        Improve this question
                    



How would you go about dead code detection in C/C++ code? I have a pretty large code base to work with and at least 10-15% is dead code. Is there any Unix based tool to identify this areas? Some pieces of code still use a lot of preprocessor, can automated process handle that?
",38k,"
            68
        ","[""\nYou could use a code coverage analysis tool for this and look for unused spots in your code.\nA popular tool for the gcc toolchain is gcov, together with the graphical frontend lcov (http://ltp.sourceforge.net/coverage/lcov.php).\nIf you use gcc, you can compile with gcov support, which is enabled by the '--coverage' flag. Next, run your application or run your test suite with this gcov enabled build.\nBasically gcc will emit some extra files during compilation and the application will also emit some coverage data while running. You have to collect all of these (.gcdo and .gcda files). I'm not going in full detail here, but you probably need to set two environment variables to collect the coverage data in a sane way: GCOV_PREFIX and GCOV_PREFIX_STRIP... \nAfter the run, you can put all the coverage data together and run it through the lcov toolsuite. Merging of all the coverage files from different test runs is also possible, albeit a bit involved.\nAnyhow, you end up with a nice set of webpages showing some coverage information, pointing out the pieces of code that have no coverage and hence, were not used.\nOff course, you need to double check if the portions of code are not used in any situation and a lot depends on how good your tests exercise the codebase.  But at least, this will give an idea about possible dead-code candidates...\n"", '\nCompile it under gcc with -Wunreachable-code. \nI think that the more recent the version, the better results you\'ll get, but I may be wrong in my impression that it\'s something they\'ve been actively working on. Note that this does flow analysis, but I don\'t believe it tells you about ""code"" which is already dead by the time it leaves the preprocessor, because that\'s never parsed by the compiler. It also won\'t detect e.g. exported functions which are never called, or special case handling code which just so happen to be impossible because nothing ever calls the function with that parameter - you need code coverage for that (and run the functional tests, not the unit tests. Unit tests are supposed to have 100% code coverage, and hence execute code paths which are \'dead\' as far as the application is concerned). Still, with these limitations in mind it\'s an easy way to get started finding the most completely bollixed routines in the code base.\nThis CERT advisory lists some other tools for static dead code detection\n', '\nFor C code only and assuming that the source code of the whole project\nis available, launch an analysis with the Open Source tool Frama-C.\nAny statement of the program that displays red in the GUI is\ndead code.\nIf you have ""dead code"" problems, you may also be interested in\nremoving ""spare code"", code that is executed but does not\ncontribute to the end result. This requires you to provide\nan accurate modelization of I/O functions (you wouldn\'t want\nto remove a computation that appears to be ""spare"" but\nthat is used as an argument to printf). Frama-C has an option for pointing out spare code.\n', ""\nYour approach depends on the availability (automated) tests. If you have a test suite that you trust to cover a sufficient amount of functionality, you can use a coverage analysis, as previous answers already suggested. \nIf you are not so fortunate, you might want to look into source code analysis tools like SciTools' Understand that can help you analyse your code using a lot of built in analysis reports. My experience with that tool dates from 2 years ago, so I can't give you much detail, but what I do remember is that they had an impressive support with very fast turnaround times of bug fixes and answers to questions.\nI found a page on static source code analysis that lists many other tools as well.\nIf that doesn't help you sufficiently either, and you're specifically interested in finding out the preprocessor-related dead code, I would recommend you post some more details about the code. For example, if it is mostly related to various combinations of #ifdef settings you could write scripts to determine the (combinations of) settings and find out which combinations are never actually built, etc.\n"", '\nBoth Mozilla and Open Office have home-grown solutions.\n', '\ng++ 4.01 -Wunreachable-code warns about code that is unreachable within a function, but does not warn about unused functions.\nint foo() { \n    return 21; // point a\n}\n\nint bar() {\n  int a = 7;\n  return a;\n  a += 9;  // point b\n  return a;\n}\n\nint main(int, char **) {\n    return bar();\n}\n\ng++ 4.01 will issue a warning about point b, but say nothing about foo() (point a) even though it is unreachable in this file.  This behavior is correct although disappointing, because a compiler cannot know that function foo() is not declared extern in some other compilation unit and invoked from there; only a linker can be sure.\n', ""\nDead code analysis like this requires a global analysis of your entire project. You can't get this information by analyzing translation units individually (well, you can detect dead entities if they are entirely within a single translation unit, but I don't think that's what you are really looking for).\nWe've used our DMS Software Reengineering Toolkit to implement exactly this for Java code, by parsing all the compilation-units involved at once, building symbol tables for everything and chasing down all the references. A top level definition with no references and no claim of being an external API item is dead. This tool also automatically strips out the dead code, and at the end you can choose what you want: the report of dead entities, or the code stripped of those entities.\nDMS also parses C++ in a variety of dialects (EDIT Feb 2014: including MS and GCC versions of C++14 [EDIT Nov 2017: now C++17]) and builds all the necessary symbol tables. Tracking down the dead references would be straightforward from that point. DMS could also be used to strip them out. See http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html\n"", '\nBullseye coverage tool would help. It is not free though.\n']"
Check if element is clickable in Selenium Java,"
I'm new to Selenium and need to check if element is clickable in Selenium Java, since element.click() passes both on link and label.
I tried using the following code, but it is not working:
WebDriverWait wait = new WebDriverWait(Scenario1Test.driver, 10);

if(wait.until(ExpectedConditions.elementToBeClickable(By.xpath(""(//div[@id='brandSlider']/div[1]/div/div/div/img)[50]"")))==null)

",215k,"
            29
        ","['\nelementToBeClickable is used for checking an element is visible and enabled such that you can click it. \nExpectedConditions.elementToBeClickable returns WebElement if expected condition is true otherwise it will throw TimeoutException, It never returns null.\nSo if your using ExpectedConditions.elementToBeClickable to find an element which will always gives you the clickable element, so no need to check for null condition, you should try as below :-\nWebDriverWait wait = new WebDriverWait(Scenario1Test.driver, 10); \nWebElement element = wait.until(ExpectedConditions.elementToBeClickable(By.xpath(""(//div[@id=\'brandSlider\']/div[1]/div/div/div/img)[50]"")));\nelement.click();\n\nAs you are saying element.click() passes both on link and label that\'s doesn\'t mean element is not clickable, it means returned element clicked but may be there is no event performs on element by click action.\nNote:- I\'m suggesting you always try first to find elements by id, name, className and other locator. if you faced some difficulty to find then use cssSelector and always give last priority to xpath locator because it is slower than other locator to locate an element.\nHope it helps you..:)\n', '\nThere are instances when element.isDisplayed() && element.isEnabled() will return true but still element will not be clickable, because it is hidden/overlapped by some other element. \nIn such case, Exception caught is: \n\norg.openqa.selenium.WebDriverException: unknown error: Element is not\n  clickable at point (781, 704). Other element would receive the click:\n  <div class=""footer"">...</div> \n\nUse this code instead:\nWebElement  element=driver.findElement(By.xpath"""");  \nJavascriptExecutor ex=(JavascriptExecutor)driver;\nex.executeScript(""arguments[0].click()"", element);\n\nIt will work.\n', ""\nwait.until(ExpectedConditions) won't return null, it will either meet the condition or throw TimeoutException.\nYou can check if the element is displayed and enabled\nWebElement element = driver.findElement(By.xpath);\nif (element.isDisplayed() && element.isEnabled()) {\n    element.click();\n}\n\n"", '\nThere are certain things you have to take care:\n\nWebDriverWait inconjunction with ExpectedConditions as elementToBeClickable() returns the WebElement once it is located and clickable i.e. visible and enabled.\nIn this process, WebDriverWait will ignore instances of NotFoundException that are encountered by default in the until condition.\nOnce the duration of the wait expires on the desired element not being located and clickable, will throw a timeout exception.\nThe different approach to address this issue are:\n\nTo invoke click() as soon as the element is returned, you can use:\nnew WebDriverWait(driver, 10).until(ExpectedConditions.elementToBeClickable(By.xpath(""(//div[@id=\'brandSlider\']/div[1]/div/div/div/img)[50]""))).click();\n\n\nTo simply validate if the element is located and clickable, wrap up the WebDriverWait in a try-catch{} block as follows:\ntry {\n       new WebDriverWait(driver, 10).until(ExpectedConditions.elementToBeClickable(By.xpath(""(//div[@id=\'brandSlider\']/div[1]/div/div/div/img)[50]"")));\n       System.out.println(""Element is clickable"");\n     }\ncatch(TimeoutException e) {\n       System.out.println(""Element isn\'t clickable"");\n    }\n\n\nIf WebDriverWait returns the located and clickable element but the element is still not clickable, you need to invoke executeScript() method as follows:\nWebElement element = new WebDriverWait(driver, 10).until(ExpectedConditions.elementToBeClickable(By.xpath(""(//div[@id=\'brandSlider\']/div[1]/div/div/div/img)[50]""))); \n((JavascriptExecutor)driver).executeScript(""arguments[0].click();"", element);\n\n\n\n\n\n', '\nFrom the source code you will be able to view that, ExpectedConditions.elementToBeClickable(), it will judge the element visible and enabled, so you can use isEnabled() together with isDisplayed(). Following is the source code.\n\n\npublic static ExpectedCondition<WebElement> elementToBeClickable(final WebElement element) {\r\n\t\treturn new ExpectedCondition() {\r\n\t\t\tpublic WebElement apply(WebDriver driver) {\r\n\t\t\t\tWebElement visibleElement = (WebElement) ExpectedConditions.visibilityOf(element).apply(driver);\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn visibleElement != null && visibleElement.isEnabled() ? visibleElement : null;\r\n\t\t\t\t} catch (StaleElementReferenceException arg3) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tpublic String toString() {\r\n\t\t\t\treturn ""element to be clickable: "" + element;\r\n\t\t\t}\r\n\t\t};\r\n\t}\n\n\n', '\nthe class attribute contains disabled when the element is not clickable.\nWebElement webElement = driver.findElement(By.id(""elementId""));\nif(!webElement.getAttribute(""class"").contains(""disabled"")){\n    webElement.click();\n}\n\n', '\nList<WebElement> wb=driver.findElements(By.xpath(newXpath));\n        for(WebElement we: wb){\n            if(we.isDisplayed() && we.isEnabled())\n            {\n                we.click();\n                break;\n            }\n        }\n    }\n\n']"
Interact with other programs using Python,"
I'm having the idea of writing a program using Python which shall find a lyric of a song whose name I provided. I think the whole process should boil down to couple of things below. These are what I want the program to do when I run it:

prompt me to enter a name of a song
copy that name
open a web browser (google chrome for example)
paste that name in the address bar and find information about the song
open a page that contains the lyrics
copy that lyrics
run a text editor (like Microsoft Word for instance)
paste the lyrics
save the new text file with the name of the song

I am not asking for code, of course. I just want to know the concepts or ideas about how to use python to interact with other programs
To be more specific, I think I want to know, fox example, just how we point out where is the address bar in Google Chrome and tell python to paste the name there. Or how we tell python how to copy the lyrics as well as paste it into the Microsof Word's sheet then save it.
I've been reading (I'm still reading) several books on Python: Byte of python, Learn python the hard way, Python for dummies, Beginning Game Development with Python and Pygame. However, I found out that it seems like I only (or almost only) learn to creat programs that work on itself (I can't tell my program to do things I want with other programs that are already installed on my computer)
I know that my question somehow sounds rather silly, but I really want to know how it works, the way we tell Python to regconize that this part of the Google chrome browser is the address bar and that it should paste the name of the song in it. The whole idea of making python interact with another program is really really vague to me and I just 
extremely want to grasp that.
Thank you everyone, whoever spend their time reading my so-long question.
ttriet204
",96k,"
            28
        ","['\nIf what you\'re really looking into is a good excuse to teach yourself how to interact with other apps, this may not be the best one. Web browsers are messy, the timing is going to be unpredictable, etc. So, you\'ve taken on a very hard task—and one that would be very easy if you did it the usual way (talk to the server directly, create the text file directly, etc., all without touching any other programs).\nBut if you do want to interact with other apps, there are a variety of different approaches, and which is appropriate depends on the kinds of apps you need to deal with.\n\nSome apps are designed to be automated from the outside. On Windows, this nearly always means they a COM interface, usually with an IDispatch interface, for which you can use pywin32\'s COM wrappers; on Mac, it means an AppleEvent interface, for which you use ScriptingBridge or appscript; on other platforms there is no universal standard. IE (but probably not Chrome) and Word both have such interfaces.\nSome apps have a non-GUI interface—whether that\'s a command line you can drive with popen, or a DLL/SO/DYLIB you can load up through ctypes. Or, ideally, someone else has already written Python bindings for you.\nSome apps have nothing but the GUI, and there\'s no way around doing GUI automation. You can do this at a low level, by crafting WM_ messages to send via pywin32 on Windows, using the accessibility APIs on Mac, etc., or at a somewhat higher level with libraries like pywinauto, or possibly at the very high level of selenium or similar tools built to automate specific apps.\n\nSo, you could do this with anything from selenium for Chrome and COM automation for Word, to crafting all the WM_ messages yourself. If this is meant to be a learning exercise, the question is which of those things you want to learn today.\n\nLet\'s start with COM automation. Using pywin32, you directly access the application\'s own scripting interfaces, without having to take control of the GUI from the user, figure out how to navigate menus and dialog boxes, etc. This is the modern version of writing ""Word macros""—the macros can be external scripts instead of inside Word, and they don\'t have to be written in VB, but they look pretty similar. The last part of your script would look something like this:\nword = win32com.client.dispatch(\'Word.Application\')\nword.Visible = True\ndoc = word.Documents.Add()\ndoc.Selection.TypeText(my_string)\ndoc.SaveAs(r\'C:\\TestFiles\\TestDoc.doc\')\n\nIf you look at Microsoft Word Scripts, you can see a bunch of examples. However, you may notice they\'re written in VBScript. And if you look around for tutorials, they\'re all written for VBScript (or older VB). And the documentation for most apps is written for VBScript (or VB, .NET, or even low-level COM). And all of the tutorials I know of for using COM automation from Python, like Quick Start to Client Side COM and Python, are written for people who already know about COM automation, and just want to know how to do it from Python. The fact that Microsoft keeps changing the name of everything makes it even harder to search for—how would you guess that googling for OLE automation, ActiveX scripting, Windows Scripting House, etc. would have anything to do with learning about COM automation? So, I\'m not sure what to recommend for getting started. I can promise that it\'s all as simple as it looks from that example above, once you do learn all the nonsense, but I don\'t know how to get past that initial hurdle. \nAnyway, not every application is automatable. And sometimes, even if it is, describing the GUI actions (what a user would click on the screen) is simpler than thinking in terms of the app\'s object model. ""Select the third paragraph"" is hard to describe in GUI terms, but ""select the whole document"" is easy—just hit control-A, or go to the Edit menu and Select All. GUI automation is much harder than COM automation, because you either have to send the app the same messages that Windows itself sends to represent your user actions (e.g., see ""Menu Notifications"") or, worse, craft mouse messages like ""go (32, 4) pixels from the top-left corner, click, mouse down 16 pixels, click again"" to say ""open the File menu, then click New"".\nFortunately, there are tools like pywinauto that wrap up both kinds of GUI automation stuff up to make it a lot simpler. And there are tools like swapy that can help you figure out what commands you want to send. If you\'re not wedded to Python, there are also tools like AutoIt and Actions that are even easier than using swapy and pywinauto, at least when you\'re getting started. Going this way, the last part of your script might look like:\nword.Activate()\nword.MenuSelect(\'File->New\')\nword.KeyStrokes(my_string)\nword.MenuSelect(\'File->Save As\')\nword.Dialogs[-1].FindTextField(\'Filename\').Select()\nword.KeyStrokes(r\'C:\\TestFiles\\TestDoc.doc\')\nword.Dialogs[-1].FindButton(\'OK\').Click()\n\nFinally, even with all of these tools, web browsers are very hard to automate, because each web page has its own menus, buttons, etc. that aren\'t Windows controls, but HTML. Unless you want to go all the way down to the level of ""move the mouse 12 pixels"", it\'s very hard to deal with these. That\'s where selenium comes in—it scripts web GUIs the same way that pywinauto scripts Windows GUIs.\n', '\nThe following script uses Automa to do exactly what you want (tested on Word 2010):\ndef find_lyrics():\n    print \'Please minimize all other open windows, then enter the song:\'\n    song = raw_input()\n    start(""Google Chrome"")\n    # Disable Google\'s autocompletion and set the language to English:\n    google_address = \'google.com/webhp?complete=0&hl=en\'\n    write(google_address, into=""Address"")\n    press(ENTER)\n    write(song + \' lyrics filetype:txt\')\n    click(""I\'m Feeling Lucky"")\n    press(CTRL + \'a\', CTRL + \'c\')\n    press(ALT + F4)\n    start(""Microsoft Word"")\n    press(CTRL + \'v\')\n    press(CTRL + \'s\')\n    click(""Desktop"")\n    write(song + \' lyrics\', into=""File name"")\n    click(""Save"")\n    press(ALT + F4)\n    print(""\\nThe lyrics have been saved in file \'%s lyrics\' ""\n          ""on your desktop."" % song)\n\nTo try it out for yourself, download Automa.zip from its Download page and unzip into, say, c:\\Program Files. You\'ll get a folder called Automa 1.1.2. Run Automa.exe in that folder. Copy the code above and paste it into Automa by right-clicking into the console window. Press Enter twice to get rid of the last ... in the window and arrive back at the prompt >>>. Close all other open windows and type\n>>> find_lyrics()\n\nThis performs the required steps. \nAutoma is a Python library: To use it as such, you have to add the line\nfrom automa.api import *\n\nto the top of your scripts and the file library.zip from Automa\'s installation directory to your environment variable PYTHONPATH. \nIf you have any other questions, just let me know :-)\n', '\nHere\'s an implementation in Python of @Matteo Italia\'s comment:\n\nYou are approaching the problem from a ""user perspective"" when you\n  should approach it from a ""programmer perspective""; you don\'t need to\n  open a browser, copy the text, open Word or whatever, you need to\n  perform the appropriate HTTP requests, parse the relevant HTML,\n  extract the text and write it to a file from inside your Python\n  script. All the tools to do this are available in Python (in\n  particular you\'ll need urllib2 and BeautifulSoup).\n\n#!/usr/bin/env python\nimport codecs\nimport json\nimport sys\nimport urllib\nimport urllib2\n\nimport bs4  # pip install beautifulsoup4\n\ndef extract_lyrics(page):\n    """"""Extract lyrics text from given lyrics.wikia.com html page.""""""\n    soup = bs4.BeautifulSoup(page)\n    result = []\n    for tag in soup.find(\'div\', \'lyricbox\'):\n        if isinstance(tag, bs4.NavigableString):\n            if not isinstance(tag, bs4.element.Comment):\n                result.append(tag)\n        elif tag.name == \'br\':\n            result.append(\'\\n\')\n    return """".join(result)\n\n# get artist, song to search\nartist = raw_input(""Enter artist:"")\nsong = raw_input(""Enter song:"")\n\n# make request\nquery = urllib.urlencode(dict(artist=artist, song=song, fmt=""realjson""))\nresponse = urllib2.urlopen(""http://lyrics.wikia.com/api.php?"" + query)\ndata = json.load(response)\n\nif data[\'lyrics\'] != \'Not found\':\n    # print short lyrics\n    print(data[\'lyrics\'])\n    # get full lyrics\n    lyrics = extract_lyrics(urllib2.urlopen(data[\'url\']))\n    # save to file\n    filename = ""[%s] [%s] lyrics.txt"" % (data[\'artist\'], data[\'song\'])\n    with codecs.open(filename, \'w\', encoding=\'utf-8\') as output_file:\n        output_file.write(lyrics)\n    print(""written \'%s\'"" % filename)\nelse:\n    sys.exit(\'not found\')\n\nExample\n$ printf ""Queen\\nWe are the Champions"" | python get-lyrics.py \n\nOutput\n\nI\'ve paid my dues\nTime after time\nI\'ve done my sentence\nBut committed no crime\n\nAnd bad mistakes\nI\'ve made a few\nI\'ve had my share of sand kicked [...]\nwritten \'[Queen] [We are the Champions] lyrics.txt\'\n\n', ""\nIf you really want to open a browser, etc, look at selenium. But that's overkill for your purposes. Selenium is used to simulate button clicks, etc for testing the appearance of websites on various browsers, etc. Mechanize is less of an overkill for this\nWhat you really want to do is understand how a browser (or any other program) works under the hood i.e. when you click on the mouse or type on the keyboard or hit Save, what does the program do behind the scenes? It is this behind-the-scenes work that you want your python code to do.\nSo, use urllib, urllib2 or requests (or heck, even scrapy) to request a web page (learn how to put together the url to a google search or the php GET request of a lyrics website). Google also has a search API that you can take advantage of, to perform a google search.\nOnce you have your results from your page request, parse it with xml, beautifulsoup, lxlml, etc and find the section of the request result that has the information you're after.\nNow that you have your lyrics, the simplest thing to do is open a text file and dump the lyrics in there and write to disk. But if you really want to do it with MS Word, then open a doc file in notepad or notepad++ and look at its structure. Now, use python to build a document with similar structure, wherein the content will be the downloaded lyrics.\nIf this method fails, you could look into pywinauto or such to automate the pasting of text into an MS Word doc and clicking on Save\nCitation: Matteo Italia, g.d.d.c from the comments on the OP\n"", '\nYou should look into a package called selenium for interacting with web browsers\n']"
JMeter : How to record HTTPS traffic?,"
I'm using Apache JMeter 2.3, which now supports ""attempt HTTPS spoofing"" under the Proxy Server element. 
I've tried this on several different servers, and have had no success. 
Has anyone been able to successfully record from an HTTPS source with this setting?
Or barring successfully recording, can anyone share a work-around? When available, I simply have HTTPS turned off at the server level, but this is not always feasible. Thoughts?
",34k,"
            13
        ","['\n\nStarting from JMeter 3.0 default port for the HTTP(S) Test Script Recorder is 8888\nThe easiest way to configure recording is using JMeter Templates feature. From JMeter\'s main menu select:\nFile -> Templates -> Recording -> Create\n\n\n\n\nDon\'t forget to start the recorder :\n\nIn JMeter < 4.0, Expand ""Workbench"", if >= 4.0, ignore this step\nSelect ""HTTP(S) Test Script Recorder""\nClick ""Start"" button\n\n\n\n\nYou will see a message regarding Root CA Certificate. Click OK:\n\n\n\nit is OK, it informs you JMeter has created a Root Certificate Authority that you need to import in your browser to be able to record correctly HTTPS traffic.\n\n\nTo Import this Root CA certificate in Firefox (it is located in jmeter/bin folder) for example:\n\n\n\n\n\n\n\n\nConfigure browser to use JMeter as proxy:\n\n\nIt is now Ok.\n\nYou can navigate to your application, samplers will be created under ""Recording Controller"" which is under ""Thread Group"" element\n\n', '\nWhile the JMeter proxy already has the ability to record HTTPS requests, a Chrome Extension that creates JMeter script came out recently:\nhttps://chrome.google.com/webstore/detail/blazemeter-the-load-testi/mbopgmdnpcbohhpnfglgohlbhfongabi?hl=en\nIt uses a BlazeMeter as the middleman (a commercial JMeter in the cloud service) but you can use their free service forever and still use the plugin to record a JMX script and download it locally to your own machine even if you never use any of the paid plans.\n', ""\nWhat I do is:\n\nGo to my website using my web server's IP-address (i.e. http://2.2.2.2/login.html)\nStart the recorder and run through my test case\nStop recording\nReplace all values of the IP address with the domain name (i.e. replace 2.2.2.2 with yoursite.com) from the HTTP Request Samplers\nSet the protocol to https in the HTTP Request Samplers\n\nIf you have more than a few pages, it's easiest to create an HTTP Request Defaults item, and set your domain name and protocol there.\nFYI, I'm using the latest stable build as of 2010-05-24: Jmeter 2.3.4 r785646.\n"", '\nThe newest version of Jmeter (2.4) now supports HTTPS recording.  Rejoice!\nMore details:\nhttp://wiki.apache.org/jmeter/JMeterFAQ#Can_JMeter_record_HTTPS_requests_using_the_recording_proxy.3F\n', '\nIs there any other way to record HTTPS than Bad boy and Https spoofing?\nYes--use a nightly build of JMeter, e.g. version r922204.\n', '\nHttps recording is successfully working in new version of Jmeter 2.9 as of today. I had to import proxy certificate and play around with Firefox to get this working.\nRefer this link for more information\nHttps recording using Jmeter\n', '\nYes, I have used it with ""attempt HTTPS spoofing"" on. Things are simple enough:\n\nTurn HTTPS Spoofing on (of course).\nMake sure that the browser sends Http request to Jmeter, so that Jmeter can record it and then send the encrypted request back to the server. So, the URL in the browser should start with http:// (and not with https://). The details could be found in my blog. \n\nPlease let me know if it works for you.\n', '\nI am using Webscarab to record https and ajax conversations.\nIt workd fine.  I extended the Webscarab with export function for Jmeter.\nBugzilla 48898.\n']"
Python - Control window with pywinauto while the window is minimized or hidden,"
What I'm trying to do:
I'm trying to create a script in python with pywinauto to automatically install notepad++ in the background (hidden or minimized), notepad++ is just an example since I will edit it to work with other software.
Problem:
The problem is that I want to do it while the installer is hidden or minimized, but if I move my mouse the script will stop working.
Question:
How can I execute this script and make it work, while the notepad++ installer is hidden or minimized.
This is my code so far:
import sys, os, pywinauto

pwa_app = pywinauto.application.Application()

app = pywinauto.Application().Start(r'npp.6.8.3.Installer.exe')

Wizard = app['Installer Language']

Wizard.NextButton.Click()

Wizard = app['Notepad++ v6.8.3 Setup']

Wizard.Wait('visible')

Wizard['Welcome to the Notepad++ v6.8.3 Setup'].Wait('ready')
Wizard.NextButton.Click()

Wizard['License Agreement'].Wait('ready')
Wizard['I &Agree'].Click()

Wizard['Choose Install Location'].Wait('ready')
Wizard.Button2.Click()

Wizard['Choose Components'].Wait('ready')
Wizard.Button2.Click()

Wizard['Create Shortcut on Desktop'].Wait('enabled').CheckByClick()
Wizard.Install.Click()

Wizard['Completing the Notepad++ v6.8.3 Setup'].Wait('ready', timeout=30)
Wizard['CheckBox'].Wait('enabled').Click()
Wizard.Finish.Click()
Wizard.WaitNot('visible')

",22k,"
            9
        ","['\nThe problem is here:\nWizard[\'Create Shortcut on Desktop\'].wait(\'enabled\').check_by_click()\n\ncheck_by_click() uses click_input() method that moves real mouse cursor and performs a realistic click.\nUse check() method instead.\n[EDIT] If the installer doesn\'t handle BM_SETCHECK properly the workaround may look so:\ncheckbox = Wizard[\'Create Shortcut on Desktop\'].wait(\'enabled\')\nif checkbox.get_check_state() != pywinauto.win32defines.BST_CHECKED:\n    checkbox.click()\n\nI will fix it in the next pywinauto release by creating methods check_by_click and check_by_click_input respectively.\n\n[EDIT 2]\nI tried your script with my fix and it works perfectly (and very fast) with and without mouse moves. Win7 x64, 32-bit Python 2.7, pywinauto 0.6.x, run as administrator.\nimport sys\nimport os\nfrom pywinauto import Application\n\napp = Application(backend=""win32"").start(r\'npp.6.8.3.Installer.exe\')\n\nWizard = app[\'Installer Language\']\n\nWizard.minimize()\nWizard.NextButton.click()\n\nWizard = app[\'Notepad++ v6.8.3 Setup\']\n\nWizard.wait(\'visible\')\nWizard.minimize()\n\nWizard[\'Welcome to the Notepad++ v6.8.3 Setup\'].wait(\'ready\')\nWizard.NextButton.click()\n\nWizard.minimize()\nWizard[\'License Agreement\'].wait(\'ready\')\nWizard[\'I &Agree\'].click()\n\nWizard.minimize()\nWizard[\'Choose Install Location\'].wait(\'ready\')\nWizard.Button2.click()\n\nWizard.minimize()\nWizard[\'Choose Components\'].wait(\'ready\')\nWizard.Button2.click()\n\nWizard.minimize()\ncheckbox = Wizard[\'Create Shortcut on Desktop\'].wait(\'enabled\')\nif checkbox.get_check_state() != pywinauto.win32defines.BST_CHECKED:\n    checkbox.click()\nWizard.Install.click()\n\nWizard[\'Completing the Notepad++ v6.8.3 Setup\'].wait(\'ready\', timeout=30)\nWizard.minimize()\nWizard[\'CheckBox\'].wait(\'enabled\').click()\nWizard.Finish.click()\nWizard.wait_not(\'visible\')\n\n']"
Schedule automatic daily upload with FileZilla [closed],"






Closed. This question does not meet Stack Overflow guidelines. It is not currently accepting answers.
                        
                    










 This question does not appear to be about a specific programming problem, a software algorithm, or software tools primarily used by programmers. If you believe the question would be on-topic on another Stack Exchange site, you can leave a comment to explain where the question may be able to be answered.


Closed 7 years ago.


The community reviewed whether to reopen this question 1 year ago and left it closed:

Original close reason(s) were not resolved






                        Improve this question
                    



I would like to use FileZilla to automatically upload PDFs to my GoDaddy hosted site daily, replacing the previous day's sheets. Is there any way to do this? I read online that batch files might work, could someone post a sample version of a batch file that would do the trick?
",137k,"
            19
        ","['\nFileZilla does not have any command line arguments (nor any other way) that allow an automatic transfer.\nSome references:\n\nFileZilla Client command-line arguments\nhttps://trac.filezilla-project.org/ticket/2317\nHow do I send a file with FileZilla from the command line?\n\n\nThough you can use any other client that allows automation.\nYou have not specified, what protocol you are using. FTP or SFTP? You will definitely be able to use WinSCP, as it supports all protocols that the free version of FileZilla does (and more).\nCombine WinSCP scripting capabilities with Windows Scheduler:\n\nAutomate file transfers to FTP server or SFTP server;\nSchedule file transfers to FTP/SFTP server\n\nA typical WinSCP script for upload (with SFTP) looks like:\nopen sftp://user:password@example.com/ -hostkey=""ssh-rsa 2048 xxxxxxxxxxx...=""\nput c:\\mypdfs\\*.pdf /home/user/\nclose\n\nWith FTP, just replace the sftp:// with the ftp:// and remove the -hostkey=""..."" switch.\n\nSimilarly for download: How to schedule an automatic FTP download on Windows?\n\nWinSCP can even generate a script from an imported FileZilla session.\nFor details, see the guide to FileZilla automation.\n(I\'m the author of WinSCP)\n\nAnother option, if you are using SFTP, is the psftp.exe client from PuTTY suite.\n']"
Executing a PHP script with a CRON Job [closed],"









                        It's difficult to tell what is being asked here. This question is ambiguous, vague, incomplete, overly broad, or rhetorical and  cannot be reasonably answered in its current form. For help clarifying this question so that it can be reopened,  visit the help center.
                        
                    


Closed 9 years ago.



I would like to run a PHP script every day at midnight. After research on how to do this, it appears that the best way to achieve this is to use a CRON job.
If my php script was located at http://example.com/scripts/scriptExample.php, can somebody be able to show the most simple example of what this CRON command would look like?
I have looked through numerous posts but I cannot find a simple enough example for me to learn and build upon.
",94k,"
            24
        ","['\nCrontab needs the full path on your server.\n0 0 * * * php /var/www/vhosts/domain.com/httpdocs/scripts/example.php\n\nThis will execute every day at midnight.\n', '\nSo something like this:\n00 * * * * /usr/local/bin/php /home/john/myscript.php\n\nThe 00 * * * * means hourly \n/usr/local/bin/php - where php main engine is in\n/home/john/myscript.php - the script to run (physical path)\nYou can use also @hourly special key:\n@hourly /usr/local/bin/php /home/john/myscript.php\n\n', '\nIf You have a sudo access to your linux server :-\nThen do the following\nsudo crontab -e\n\nThis will open the cron tab for you on your server.\nNext thing is you have to do a cron entry for the file which you want to execute\n00 00 * * * /usr/local/bin/php ""path of the php file which you want to execute""\n\n00 00 * * * this will run your cron at midnight daily, means at 0hrs and 0mins\n', '\nAre you using a company to host your website? \nAs you should have a icon  in your c panel called cron jobs from there you can tell it what script to execute and when.\n']"
"Creating, opening and printing a word file from C++","
I have three related questions. 
I want to create a word file with a name from C++. I want to be able to sent the printing command to this file, so that the file is being printed without the user having to open the document and do it manually and I want to be able to open the document. Opening the document should just open word which then opens the file.
",47k,"
            16
        ","['\nYou can use Office Automation for this task. You can find answers to frequently asked questions about Office Automation with C++ at http://support.microsoft.com/kb/196776 and http://support.microsoft.com/kb/238972 .\nKeep in mind that to do Office Automation with C++, you need to understand how to use COM.\nHere are some examples of how to perform various tasks in word usign C++:\n\nhttp://support.microsoft.com/kb/220911/en-us\nhttp://support.microsoft.com/kb/238393/en-us\nhttp://support.microsoft.com/kb/238611/en-us\n\nMost of these samples show how to do it using MFC, but the concepts of using COM to manipulate Word are the same, even if you use ATL or COM directly.\n', '\nAs posted as an answer to a similar question, I advise you to look at this page where the author explains what solution he took to generate Word documents on a server, without MsWord being available, without automation or thirdparty libraries.\n', '\nWhen you have the file and just want to print it, then look at this entry at Raymond Chen\'s blog. You can use the verb ""print"" for printing.\nSee the shellexecute msdn entry for details.\n', '\nYou can use automation to open MS Word (in background or foreground) and then send the needed commands.\nA good starting place is the knowledge base article Office Automation Using Visual C++\nSome C source code is available in How To Use Visual C++ to Access DocumentProperties with Automation (the title says C++, but it is plain C)\n', '\nI have no experience from integrating with Microsoft Office, but I guess there are some APIs around that you can use for this.\nHowever, if what you want to accomplish is a rudimentary way of printing formatted output and exporting it to a file that can be handled in Word, you might want to look into the RTF format. The format is quite simple to learn, and is supported by the RtfTextBox (or is it RichTextBox?), which also has some printing capabilities. The rtf format is the same format as is used by Windows Wordpad (write.exe).\nThis also has the benefit of not depending on MS Office in order to work.\n', '\nMy solution to this is to use the following command:\nstart /min winword <filename> /q /n /f /mFilePrint /mFileExit\n\nThis allows the user to specify a printer, no. of copies, etc.\nReplace <filename> with the filename. It must be enclosed in double-quotation marks if it contains spaces. (e.g. file.rtf, ""A File.docx"")\nIt can be placed within a system call as in:\nsystem(""start /min winword <filename> /q /n /f /mFilePrint /mFileExit"");\n\nHere is a C++ header file with functions that handle this so you don\'t have to remember all of the switches if you use it frequently:\n/*winword.h\n *Includes functions to print Word files more easily\n */\n\n#ifndef WINWORD_H_\n#define WINWORD_H_\n\n#include <string.h>\n#include <stdlib.h>\n\n//Opens Word minimized, shows the user a dialog box to allow them to\n//select the printer, number of copies, etc., and then closes Word\nvoid wordprint(char* filename){\n   char* command = new char[64 + strlen(filename)];\n   strcpy(command, ""start /min winword \\"""");\n   strcat(command, filename);\n   strcat(command, ""\\"" /q /n /f /mFilePrint /mFileExit"");\n   system(command);\n   delete command;\n}\n\n//Opens the document in Word\nvoid wordopen(char* filename){\n   char* command = new char[64 + strlen(filename)];\n   strcpy(command, ""start /max winword \\"""");\n   strcat(command, filename);\n   strcat(command, ""\\"" /q /n"");\n   system(command);\n   delete command;\n}\n\n//Opens a copy of the document in Word so the user can save a copy\n//without seeing or modifying the original\nvoid wordduplicate(char* filename){\n   char* command = new char[64 + strlen(filename)];\n   strcpy(command, ""start /max winword \\"""");\n   strcat(command, filename);\n   strcat(command, ""\\"" /q /n /f"");\n   system(command);\n   delete command;\n}\n\n#endif\n\n']"
Programmatically add trusted sites to Internet Explorer,"
I'm doing an IE automation project using WatiN. 
When a file to be downloaded is clicked, I get the following in the Internet Explorer Information bar:

To help protect your security,
  Internet Explorer has blocked this
  site from downloading files to you
  computer.

In order to download the report, I can manually add the site to Internet Explorer's list of trusted sites, but I would prefer to check programmatically in .NET to see if the site is trusted and add it to the list if it is not. 
FYI, I'm currently using IE7.
",36k,"
            14
        ","['\nHave a look at this\nBasically it looks as if all you have to do is create registry key in \nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\DOMAINNAME\n\nthen a REG_DWORD value named ""http"" with value==2\n', '\nHere\'s the implementation that I came up with for writing the registry keys in .NET.\nThanks for setting me in the right direction, Ben.\nusing System;\nusing System.Collections.Generic;\nusing Microsoft.Win32;\n\n\nnamespace ReportManagement\n{\n    class ReportDownloader\n    {\n        [STAThread]\n        static void Main(string[] args)\n        {\n\n            const string domainsKeyLocation = @""Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains"";\n            const string domain = @""newsite.com"";\n            const int trustedSiteZone = 0x2;\n\n            var subdomains = new Dictionary<string, string>\n                                 {\n                                     {""www"", ""https""},\n                                     {""www"", ""http""},\n                                     {""blog"", ""https""},\n                                     {""blog"", ""http""}\n                                 };\n\n            RegistryKey currentUserKey = Registry.CurrentUser;\n\n            currentUserKey.GetOrCreateSubKey(domainsKeyLocation, domain, false);\n\n            foreach (var subdomain in subdomains)\n            {\n                CreateSubdomainKeyAndValue(currentUserKey, domainsKeyLocation, domain, subdomain, trustedSiteZone);\n            }\n\n            //automation code\n        }\n\n        private static void CreateSubdomainKeyAndValue(RegistryKey currentUserKey, string domainsKeyLocation, \n            string domain, KeyValuePair<string, string> subdomain, int zone)\n        {\n            RegistryKey subdomainRegistryKey = currentUserKey.GetOrCreateSubKey(\n                string.Format(@""{0}\\{1}"", domainsKeyLocation, domain), \n                subdomain.Key, true);\n\n            object objSubDomainValue = subdomainRegistryKey.GetValue(subdomain.Value);\n\n            if (objSubDomainValue == null || Convert.ToInt32(objSubDomainValue) != zone)\n            {\n                subdomainRegistryKey.SetValue(subdomain.Value, zone, RegistryValueKind.DWord);\n            }\n        }\n    }\n\n    public static class RegistryKeyExtensionMethods\n    {\n        public static RegistryKey GetOrCreateSubKey(this RegistryKey registryKey, string parentKeyLocation, \n            string key, bool writable)\n        {\n            string keyLocation = string.Format(@""{0}\\{1}"", parentKeyLocation, key);\n\n            RegistryKey foundRegistryKey = registryKey.OpenSubKey(keyLocation, writable);\n\n            return foundRegistryKey ?? registryKey.CreateSubKey(parentKeyLocation, key);\n        }\n\n        public static RegistryKey CreateSubKey(this RegistryKey registryKey, string parentKeyLocation, string key)\n        {\n            RegistryKey parentKey = registryKey.OpenSubKey(parentKeyLocation, true); //must be writable == true\n            if (parentKey == null) { throw new NullReferenceException(string.Format(""Missing parent key: {0}"", parentKeyLocation)); }\n\n            RegistryKey createdKey = parentKey.CreateSubKey(key);\n            if (createdKey == null) { throw new Exception(string.Format(""Key not created: {0}"", key)); }\n\n            return createdKey;\n        }\n    }\n}\n\n', '\nGlad I came across your postings. The only thing I can add to the excellent contributions already is that a different registry key is used whenever the URI contains an IP address i.e. the address isn\'t a fully qualified domain name.\nIn this instance you have to use an alternative approach:\nImagine I wish to add an IP address to the trusted sites: say 10.0.1.13 and I don\'t care what protocol.\n\nUnder HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Ranges, I create a key e.g. ""Range1"" and the inside that create the following values:\nA DWORD with name ""*"" and value 0x2  (for all protocols(*) and trusted site(2))\n    A string with name "":Range"" with value ""10.0.1.13""\n\n', '\nUsing powershell it is quite easy.\n#Setting IExplorer settings\nWrite-Verbose ""Now configuring IE""\n#Add http://website.com as a trusted Site/Domain\n#Navigate to the domains folder in the registry\nset-location ""HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings""\nset-location ZoneMap\\Domains\n\n#Create a new folder with the website name\nnew-item website/ -Force\nset-location website/\nnew-itemproperty . -Name * -Value 2 -Type DWORD -Force\nnew-itemproperty . -Name http -Value 2 -Type DWORD -Force\nnew-itemproperty . -Name https -Value 2 -Type DWORD -Force\n\n', '\nIn addition to adding the domain to the Trusted Sites list, you may also need to change the setting ""Automatically prompt for file downloads"" for the Trusted Sites zone. To do so programatically, you modify the key/value:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\n  Settings\\Zones\\2@2200\n\nChange the value from 3 (Disable) to 0 (Enable). Here\'s some C# code to do that:\npublic void DisableForTrustedSitesZone()\n{\n    const string ZonesLocation = @""Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones"";\n    const int TrustedSiteZone = 2;\n\n    const string AutoPromptForFileDownloadsValueName = @""2200"";\n    const int AutoPromptForFileDownloadsValueEnable = 0x00;     // Bypass security bar prompt\n\n    using (RegistryKey currentUserKey = Registry.CurrentUser)\n    {\n        RegistryKey trustedSiteZoneKey = currentUserKey.OpenSubKey(string.Format(@""{0}\\{1:d}"", ZonesLocation, TrustedSiteZone), true);\n        trustedSiteZoneKey.SetValue(AutoPromptForFileDownloadsValueName, AutoPromptForFileDownloadsValueEnable, RegistryValueKind.DWord);\n    }\n}\n\n', '\nHere is the implementation of adding trusted sites programmatically to IE - based on Even Mien\'s code. It supports domain name and IP address as well. The limitation is no specific protocol could be defined, instead it simply uses ""*"" for all protocols.\n//  Source : http://support.microsoft.com/kb/182569\nstatic class IeTrustedSite\n{\n    const string DOMAINS_KEY = @""Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains"";\n    const string RANGES_KEY = @""Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Ranges"";\n\n    const int TRUSTED_SITE_CODE = 0x2;\n    const string ALL_PROTOCOL = ""*"";\n    const string RANGE_ADDRESS = "":Range"";\n\n    public static void AddSite(string address)\n    {\n        string[] segmentList = address.Split(new string[] {"".""}, StringSplitOptions.None);\n        if (segmentList.Length == 4)\n            AddIpAddress(segmentList);\n        else\n            AddDomainName(segmentList);\n    }\n\n    static void AddIpAddress(string[] segmentList)\n    {\n        string ipAddress = segmentList[0] + ""."" + segmentList[1] + ""."" + segmentList[2] + ""."" + segmentList[3];\n        RegistryKey rangeKey = GetRangeKey(ipAddress);\n\n        rangeKey.SetValue(ALL_PROTOCOL, TRUSTED_SITE_CODE, RegistryValueKind.DWord);\n        rangeKey.SetValue(RANGE_ADDRESS, ipAddress, RegistryValueKind.String);\n    }\n\n    static RegistryKey GetRangeKey(string ipAddress)\n    {\n        RegistryKey currentUserKey = Registry.CurrentUser;\n        for (int i = 1; i < int.MaxValue; i++)\n        {\n            RegistryKey rangeKey = currentUserKey.GetOrCreateSubKey(RANGES_KEY, ""Range"" + i.ToString());\n\n            object addressValue = rangeKey.GetValue(RANGE_ADDRESS);\n            if (addressValue == null)\n            {\n                return rangeKey;\n            }\n            else\n            {\n                if (Convert.ToString(addressValue) == ipAddress)\n                    return rangeKey;\n            }\n        }\n        throw new Exception(""No range slot can be used."");\n    }\n\n    static void AddDomainName(string[] segmentList)\n    {\n        if (segmentList.Length == 2)\n        {\n            AddTwoSegmentDomainName(segmentList);\n        }\n        else if (segmentList.Length == 3)\n        {\n            AddThreeSegmentDomainName(segmentList);\n        }\n        else\n        {\n            throw new Exception(""Un-supported server address."");\n        }\n    }\n\n    static void AddTwoSegmentDomainName(string[] segmentList)\n    {\n        RegistryKey currentUserKey = Registry.CurrentUser;\n\n        string domain = segmentList[0] + ""."" + segmentList[1];\n        RegistryKey trustedSiteKey = currentUserKey.GetOrCreateSubKey(DOMAINS_KEY, domain);\n\n        SetDomainNameValue(trustedSiteKey);\n    }\n\n    static void AddThreeSegmentDomainName(string[] segmentList)\n    {\n        RegistryKey currentUserKey = Registry.CurrentUser;\n\n        string domain = segmentList[1] + ""."" + segmentList[2];\n        currentUserKey.GetOrCreateSubKey(DOMAINS_KEY, domain);\n\n        string serviceName = segmentList[0];\n        RegistryKey trustedSiteKey = currentUserKey.GetOrCreateSubKey(DOMAINS_KEY + @""\\"" + domain, serviceName);\n\n        SetDomainNameValue(trustedSiteKey);\n    }\n\n    static void SetDomainNameValue(RegistryKey subDomainRegistryKey)\n    {\n        object securityValue = subDomainRegistryKey.GetValue(ALL_PROTOCOL);\n        if (securityValue == null || Convert.ToInt32(securityValue) != TRUSTED_SITE_CODE)\n        {\n            subDomainRegistryKey.SetValue(ALL_PROTOCOL, TRUSTED_SITE_CODE, RegistryValueKind.DWord);\n        }\n    }\n}\n\nstatic class RegistryKeyExtension\n{\n    public static RegistryKey GetOrCreateSubKey(this RegistryKey registryKey, string parentString, string subString)\n    {\n        RegistryKey subKey = registryKey.OpenSubKey(parentString + @""\\"" + subString, true);\n        if (subKey == null)\n            subKey = registryKey.CreateSubKey(parentString, subString);\n\n        return subKey;\n    }\n\n    public static RegistryKey CreateSubKey(this RegistryKey registryKey, string parentString, string subString)\n    {\n        RegistryKey parentKey = registryKey.OpenSubKey(parentString, true);\n        if (parentKey == null)\n            throw new Exception(""BUG : parent key "" + parentString + "" is not exist.""); \n\n        return parentKey.CreateSubKey(subString);\n    }\n}\n\n', ""\n\nIf a website could add itself to the trusted sites, now that would be bad. \n\nI don't quite agree- as long as the browser asks the user for permission, the ability of a site to add itself to trusted sites can greatly simplify the user experience, where the user trusts the domain and wants correct page display. \nThe alternative is the user must manually go into internet options to add the domain, which is, for my users, not viable. \ni'm looking for a php or javascript method for the site to add itself, either through some IE api, or through the registry as you've so helpfully explained above!\nhave found these possible solutions so far:\n\nphp via shell\nothers i'm not allowed to list here because i don't have enough points\n\n""]"
How to delete mysql row after time passes?,"
I have no idea where to start with this one:
I have a database that stores postID and Date.
What I want to do is have my website auto delete all rows where Date is less than today. This script can't have any user input at all.  No button clicks, nothing. The script must run every day at midnight.
I've been looking all over the place for something that does this and I've found absolutely nothing.
",31k,"
            14
        ","['\nYou can use PHP script and use cron job on your cpanel. \nExample:\ncronjobcommand.php\n<?php \n include \'your_db_connection\';\n mysql_query(""DELETE FROM your_table_name WHERE Date < NOW()"");\n?>\n\nI have attached a screenshot below for your more reference.\n\n', ""\nFor those out there who are on a shared hosting, like 1and1's, and can't use cron, here are 2 alternatives :\n\nmysql events enable you to place a time trigger on mysql, which will execute when you'll want, without having to be fired by any kind of user input\nif you cannot create mysql events because you're on 1and1 :(, an alternative is to use webcron\n\nYou just need to tell webcron the url of the php script you'd like to be run, and they'll trigger it for you at the intervals you want\n"", ""\nWhy using cronjobs everyday?? Why not filter data on output. For example in your select check if post date equals today with adding a simple where:\nSELECT * FROM `posts`\nWHERE (DATE(`post_date`) = DATE(NOW()));\n\nThis way you're not required to do your database managements/cronjobs on any special time and it will be used just for database managements. Afterwards you can delete unnecessary data at any time using by mysql command like:\nDELETE FROM `posts` WHERE (\n    DATE(`post_date`) < DATE(NOW())\n)\n\n"", ""\nMost hosts provide a cron(8) service that can execute commands at specific times. You use the crontab(1) program to manage the crontab(5) file the describes when to run which commands.\nThere's a lot of functionality available to you, but if you write a program (shell script, php script, C program, whatever) that runs the appropriate MySQL commands, you can call the program via cron(8) in an entirely hands-off fashion.\nRun crontab -e to edit your current crontab(5) file. If none exists, hopefully you'll get one with a helpful header. If not, copy this:\n# m h  dom mon dow   command\n\nThe columns indicate the minute, hour, day of month, month, and day of week to execute commands. All the numbers in the columns are essentially ANDed together to decide when to run commands.\nThus, midnight every night would look like this:\n0 0 * * * /path/to/executable\n\nIt's remarkably flexible, so put some time into the documentation, and you'll find many uses for it.\n"", '\nYou should set cron job (scheduled tack.) for it. \nA cron job is an automated program setup for Linux and Unix operating systems. It allows the user to execute several commands or functions at a specific time and date.\nyou have cron Job in your cpanel setup. first you need to make a php script with your logic for delete record after each date. take date from server and write script for delete.\nthen go to cron tab in your cpanel and do settings for time interval to run cron and give path of your php script file.\n', ""\nMySQL doesn't have a task scheduler. So you have to use the task scheduler of your Operating System (CRON under Linux), or to lunch a basic task checker sub-script during the script of the main page (on another page that is supposed to display the changing data).\n""]"
How to make the Java.awt.Robot type unicode characters? (Is it possible?),"
We have a user provided string that may contain unicode characters, and we want the robot to type that string.
How do you convert a string into keyCodes that the robot will use?
How do you do it so it is also java version independant (1.3 -> 1.6)?
What we have working for ""ascii"" chars is
//char c = nextChar();
//char c = 'a'; // this works, and so does 'A'
char c = 'á'; // this doesn't, and neither does 'Ă'
Robot robot = new Robot();
KeyStroke key = KeyStroke.getKeyStroke(""pressed "" + Character.toUpperCase(c) );
if( null != key ) {
  // should only have to worry about case with standard characters
  if (Character.isUpperCase(c))
  {
    robot.keyPress(KeyEvent.VK_SHIFT);
  }

  robot.keyPress(key.getKeyCode());
  robot.keyRelease(key.getKeyCode());

  if (Character.isUpperCase(c))
  {
    robot.keyRelease(KeyEvent.VK_SHIFT);
  }
}

",16k,"
            12
        ","[""\nBased on javamonkey79's code I've created the following snippet which should work for all Unicode values...\npublic static void pressUnicode(Robot r, int key_code)\n{\n    r.keyPress(KeyEvent.VK_ALT);\n\n    for(int i = 3; i >= 0; --i)\n    {\n        // extracts a single decade of the key-code and adds\n        // an offset to get the required VK_NUMPAD key-code\n        int numpad_kc = key_code / (int) (Math.pow(10, i)) % 10 + KeyEvent.VK_NUMPAD0;\n\n        r.keyPress(numpad_kc);\n        r.keyRelease(numpad_kc);\n    }\n\n    r.keyRelease(KeyEvent.VK_ALT);\n}\n\nThis automatically goes through each decade of the unicode key-code, maps it to the corresponding VK_NUMPAD equivalent and presses/releases the keys accordingly.\n"", ""\nThe KeyEvent Class does not have direct mappings for many unicode classes in JRE 1.5. If you are running this on a Windows box what you may have to do is write a custom handler that does something like this:\nRobot robot = new Robot();\nchar curChar = 'Ã';\n\n// -- isUnicode( char ) should be pretty easy to figure out\nif ( isUnicode( curChar ) ) {\n   // -- this is an example, exact key combinations will vary\n   robot.keyPress( KeyEvent.VK_ALT );\n\n   robot.keyPress( KeyEvent.VK_NUMBER_SIGN );\n   robot.keyRelease( KeyEvent.VK_NUMBER_SIGN );\n\n   // -- have to apply some logic to know what sequence\n   robot.keyPress( KeyEvent.VK_0 );\n   robot.keyRelease( KeyEvent.VK_0 );\n   robot.keyPress( KeyEvent.VK_1 );\n   robot.keyRelease( KeyEvent.VK_1 );\n   robot.keyPress( KeyEvent.VK_9 );\n   robot.keyRelease( KeyEvent.VK_9 );\n   robot.keyPress( KeyEvent.VK_5 );\n   robot.keyRelease( KeyEvent.VK_5 );\n\n   robot.keyRelease( KeyEvent.VK_ALT );\n}\n\ne.g. Figure out what they key combinations are, and then map them to some sort of Object (maybe a HashMap?) for later lookup and execution.\nHope this helps :)\n"", '\ni think this is a bit late but... \nRobot robot = new Robot();\n\n   robot.keyPress( KeyEvent.VK_DEAD_ACUTE);\n\n   robot.keyPress( KeyEvent.VK_A );\n   robot.keyRelease( KeyEvent.VK_A );\n\n   robot.keyRelease( KeyEvent.VK_DEAD_ACUTE );\n\nthat just type an ""á""\n', '\nThe best way that i find when solve simulare problem\nimport java.awt.AWTException;\nimport java.awt.Robot;\n\npublic class MyRobot {\n\n    public static void typeString(String s)\n        {\n            try {\n            Robot robik = new Robot();\n            byte[] bytes = s.getBytes();\n            for (byte b : bytes)\n            {\n                int code = b;\n                // keycode only handles [A-Z] (which is ASCII decimal [65-90])\n                if (code > 96 && code < 123) code = code - 32;\n                robik.delay(40);\n                robik.keyPress(code);\n                robik.keyRelease(code);\n            }\n        } catch (AWTException e){\n\n    }\n  }\n\n}\n\nhttp://www.devdaily.com/java/java-robot-class-example-mouse-keystroke\\\n']"
Is there a Python equivalent to Java's AWT Robot class? [closed],"






Closed. This question does not meet Stack Overflow guidelines. It is not currently accepting answers.
                        
                    










 Questions asking us to recommend or find a tool, library or favorite off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam. Instead, describe the problem and what has been done so far to solve it.


Closed 9 years ago.







                        Improve this question
                    



Does anyone know of a Python class similar to Java Robot? 
Specifically I would like to perform a screen grab in Ubuntu, and eventually track mouse clicks and keyboard presses (although that's a slightly different question).
",12k,"
            12
        ","['\nIf you have GTK, then you can use the gtk.gdk.Display class to do most of the work. It controls the keyboard/mouse pointer grabs a set of gtk.gdk.Screen objects.\n', '\nCheck out GNU LDTP:\n\nGNU/Linux Desktop Testing Project (GNU\n  LDTP) is aimed at producing high\n  quality test automation framework\n  [...]\n\nEspecially Writing LDTP test scripts in Python scripting language\n', '\nAs far as the screen grab, see this answer.  That worked for me.  Other answers to the same question might be of interest as well.\n', '\nCheck out the RobotFramework. I do not know if it will do the same things as JavaRobot, or if it will do more. But it is easy and very flexible to use.\n']"
Why should I ever use CSS selectors as opposed to XPath for automated testing?,"
Please help me understand why using CSS selectors are even an option for automated testing.  I've been using the tool Ghost Inspector some in my workplace for creating lots of automated tests for our stuff.  This tool gives you the option of using CSS selectors intead of XPath. Why?
XPath is SO much more durable than CSS.  The CSS on any given UI is subject to change almost weekly on some projects/features.  This make the tests extremely brittle and prone to being broken regularly.
Is it because most new test writers don't want to learn about anything XPath and wish to stick to the basics? CSS selectors look prettier than XPath syntax? Please convince me. thanks.
",5k,"
            8
        ","['\nJeffC\'s answer here does plenty to sum up the pros and cons of each locator strategy. But I\'ll address your points specifically.\nFirst off, there is no need for anyone to convince you that selectors are better, because from a purely functional standpoint, they simply aren\'t (and I\'m saying this as someone with a gold css-selectors tag badge and almost 1000 answers to questions with that tag, so you know I\'m not biased). If you\'re more comfortable with XPath, use it — in terms of features and what you can do, XPath is vastly superior, there really is no contest there. And, as you correctly state, performance is no longer an issue (if it ever was).\nSelectors are there for quick and simple use cases and for users coming from HTML and CSS codebases, such as web developers, who want to get started with automated tests without having to learn another DSL. If you\'re responsible for the CSS of your own site you can also easily copy selectors from your stylesheet into your tests depending on what exactly you\'re testing.\nIf on the other hand you\'re coming from an XML/XSLT/XPath background, wonderful, you get to keep using the XPath you know and love1!\n\nYes, Xpath is way more durable than CSS because it can invoke specific content contains functionality.\n\nHaving a content contains feature doesn\'t make XPath more ""durable"" — it makes it more versatile. If you rely solely on an element\'s content and that content can potentially change or move around, your XPath becomes no less brittle than a selector that relies solely on an element\'s attributes or its position in the DOM tree.\nYou can do any of a number of things to make your XPath or selector more or less brittle, but that\'s an indicator of how versatile the DSL is, not how brittle it inherently is.\n\n1 Depending on what version of XPath you\'re used to.\n', ""\nOne of the most common conversation in the Selenium Community is which Locator Strategy is better among the two - Css or XPath with respect to performance. Supporters of CSS say that it is more readable and faster while those in favor of XPath says it's ability to transverse the HTML DOM (while CSS cannot). With such a divide based on different perspective it is hard to determine the best performing approach for you and your tests as a beginner. Here are some excerts from the industry experts :\n\nDave Haeffner who maintains Elemental Selenium carried out a test on a page with two HTML data tables, one table is written without helpful attributes (ID and Class), and the other with them. \n\n\nResults with Finding Elements By ID and Class :\nBrowser                 | CSS           | XPath\n----------------------------------------------------\nInternet Explorer 8     | 23 seconds    | 22 seconds\nChrome 31               | 17 seconds    | 16 seconds\nFirefox 26              | 22 seconds    | 22 seconds\nOpera 12                | 17 seconds    | 20 seconds\nSafari 5                | 18 seconds    | 18 seconds\n\nFinding Elements By Traversing :\nBrowser                 | CSS           | XPath\n----------------------------------------------------\nInternet Explorer 8     | not supported | 29 seconds\nChrome 31               | 24 seconds    | 26 seconds\nFirefox 26              | 27 seconds    | 27 seconds\nOpera 12                | 25 seconds    | 25 seconds\nSafari 5                | 23 seconds    | 22 seconds\n\nThe following were the takeaways :\n\nFor starters there is no dramatic difference in performance between XPath and CSS.\nTraversing the DOM in older browsers like IE8 does not work with CSS but is fine with XPath. And XPath can walk up the DOM (e.g. from child to parent), whereas CSS can only traverse down the DOM (e.g. from parent to child). However not being able to traverse the DOM with CSS in older browsers isn't necessarily a bad thing as it is more of an indicator that your page has poor design and could benefit from some helpful markup.\nAn argument in favor of CSS is that they are more readable, brief, and concise while it is a subjective call.\n\nBen Burton mentions you should use CSS because that's how applications are built. This makes the tests easier to write, talk about, and have others help maintain.\nAdam Goucher says to adopt a more hybrid approach -- focusing first on IDs, then CSS, and leveraging XPath only when you need it (e.g. walking up the DOM) and that XPath will always be more powerful for advanced locators.\n\n\nConclusion\nSo it appears to be a tough call to make. Especially now that we are aware with the knowledge that the choice is not as reliant on performance as it once was. The choice is not as permanent as choosing a programming language, and if you are using helpful abstraction (e.g. Page Objects) then leveraging a hybrid approach is simple to implement.\nTrivia\n\nCss Vs. X Path\nCss Vs. X Path, Under a Microscope\nCss Vs. X Path, Under a Microscope (Part 2)\n\n""]"
python-pptx - How to replace keyword across multiple runs?,"
I have two PPTs (File1.pptx and File2.pptx) in which I have the below 2 lines
XX NOV 2021, Time: xx:xx – xx:xx hrs (90mins)
FY21/22 / FY22/23

I wish to replace like below
a) NOV 2021 as NOV 2022.
b) FY21/22 / FY22/23 as FY21/22 or FY22/23.
But the problem is my replacement works in File1.pptx but it doesn't work in File2.pptx.
When I printed the run text, I was able to see that they are represented differently in two slides.
def replace_text(replacements:dict,shapes:list):
    for shape in shapes:
        for match, replacement in replacements.items():
            if shape.has_text_frame:
                if (shape.text.find(match)) != -1:
                    text_frame = shape.text_frame
                    for paragraph in text_frame.paragraphs:
                        for run in paragraph.runs:
                            cur_text = run.text
                            print(cur_text)
                            print(""---"")
                            new_text = cur_text.replace(str(match), str(replacement))
                            run.text = new_text

In File1.pptx, the cur_text looks like below (for 1st keyword). So, my replace works (as it contains the keyword that I am looking for)

But in File2.pptx, the cur_text looks like below (for 1st keyword). So, replace doesn't work (because the cur_text doesn't match with my search term)

The same issue happens for 2nd keyword as well which is FY21/22 / FY22/23.
The problem is the split keyword could be in previous or next run from current run (with no pattern). So, we should be able to compare a search term with previous run term (along with current term as well). Then a match can be found (like Nov 2021) and be replaced.
This issue happens for only 10% of the search terms (and not for all of my search terms) but scary to live with this issue because if the % increases, we may have to do a lot of manual work. How do we avoid this and code correctly?
How do we get/extract/find/identify the word that we are looking for across multiple runs (when they are indeed present) like CTRL+F and replace it with desired keyword?
Any help please?
UPDATE - Incorrect replacements based on matching
Before replacement

After replacement

My replacement keywords can be found below
replacements = { 'How are you?': ""I'm fine!"",
                'FY21/22':'FY22/23',
                'FY_2021':'FY21/22',
                'FY20/21':'FY21/22',
                'GB2021':'GB2022',
                'GB2020':'GB2022',
                'SEP-2022':'SEP-2023',
                'SEP-2021':'SEP-2022',
                'OCT-2021':'OCT-2022',
                'OCT-2020':'OCT-2021',
                'OCT 2021':'OCT 2022',
                'NOV 2021':'NOV 2022',
                'FY2122':'FY22/23',
                'FY2021':'FY21/22',
                'FY1920':'FY20/21',
                'FY_2122':'FY22/23',
                'FY21/22 / FY22/23':'FY21/22 or FY22/23',
                'F21Y22':'FY22/23',
                'your FY20 POS FCST':'your FY22/23 POS FCST',
                'your FY21/22 POS FCST':'your FY22/23 POS FCST',
                'Q2/FY22/23':'Q2-FY22/23',
                'JAN-22':'JAN-23',
                'solution for FY21/22':'solution for FY22/23',
                'achievement in FY20/21':'achievement in FY21/22',
                'FY19/20':'FY20/21'}

",502,"
            4
        ","['\nAs one can find in python-pptx\'s documentation at https://python-pptx.readthedocs.io/en/latest/api/text.html\n\na text frame is made up of paragraphs and\na paragraph is made up of runs and specifies a font configuration that is used as the default for it\'s runs.\nruns specify part of the paragraph\'s text with a certain font configuration - possibly different from the default font configuration in the paragraph\n\nAll three have a field called text:\n\nThe text frame\'s text contains all the text from all it\'s paragraphs concatenated together with the appropriate line-feeds in between the paragraphs.\nThe paragraphs\'s text contains all the texts from all of it\'s runs concatenated to a long string with a vertical tab character (\\v) put wherever there was a so-called soft-break in any of the run\'s text (a soft break is like a line-feed but without terminating the paragraph).\nThe run\'s text contains text that is to be rendered with a certain font configuration (font family, font size, italic/bold/underlined, color etc. pp). It is the lowest level of the font configuration for any text.\n\nNow if you specify a line of text in a text-frame in a PowerPoint presentation, this text-frame will very likely only have one paragraph and that paragraph will have just one run.\nLet\'s say that line says: Hi there! How are you? What is your name? and is all normal (neither italic nor bold) and in size 10.\nNow if you go ahead in PowerPoint and make the questions How are you? What is your name? stand out by making them italic, you will end up with 2 runs in our paragraph:\n\nHello there!  with the default font configuration from the paragraph\nHow are you? What is you name? with the font configuration specifying the additional italic attribute.\n\nNow imagine, we want the How are you? stand out even more by making it bold and italic. We end up with 3 runs:\n\nHello there!  with the default font configuration from the paragraph.\nHow are you? with the font configuration specifying the BOLD and ITALIC attribute\n What is your name? with the font configuration specifying the ITALIC attribute.\n\nOne step further, making the are in How are you? bigger. We get 5 runs:\n\nHello there!  with the default font configuration from the paragraph.\nHow  with the font configuration specifying the BOLD and ITALIC attribute\nare with the font configuration specifying the BOLD and ITALIC attribute and font size 16\n you? with the font configuration specifying the BOLD and ITALIC attribute\n What is your name? with the font configuration specifying the ITALIC attribute.\n\nSo if you try to replace the How are you? with I\'m fine! with the code from your question, you won\'t succeed, because the text How are you? is actually distributed across 3 runs.\nYou can go one level higher and look at the paragraph\'s text, that still says Hello there! How are you? What is your name? since it is the concatenation of all its run\'s texts.\nBut if you go ahead and do the replacement of the paragraph\'s text, it will erase all runs and create one new run with the text Hello there! I\'m fine! What is your name? all the while deleting all the formatting that we put on the What is your name?.\nTherefore, changing text in a paragraph without affecting formatting of the other text in the paragraph is pretty involved. And even if the text you are looking for has all the same formatting, that is no guarantee for it to be within one run. Because if you - in our example above - make the are smaller again, the 5 runs will very likely remain, the runs 2 to 4 just having the same font configuration now.\nHere is the code to produce a test presentation with a text box containing the exact paragraph runs as given in my example above:\nfrom pptx import Presentation\nfrom pptx.chart.data import CategoryChartData\nfrom pptx.enum.chart import XL_CHART_TYPE,XL_LABEL_POSITION\nfrom pptx.util import Inches, Pt\nfrom pptx.dml.color import RGBColor\nfrom pptx.enum.dml import MSO_THEME_COLOR\n\n# create presentation with 1 slide ------\nprs = Presentation()\nslide = prs.slides.add_slide(prs.slide_layouts[5])\ntextbox_shape = slide.shapes.add_textbox(Pt(200),Pt(200),Pt(30),Pt(240))\ntext_frame = textbox_shape.text_frame\np = text_frame.paragraphs[0]\nfont = p.font\nfont.name = \'Arial\'\nfont.size = Pt(10)\nfont.bold = False\nfont.italic = False\nfont.color.rgb = RGBColor(0,0,0)\n\nrun = p.add_run()\nrun.text = \'Hello there! \'\n\nrun = p.add_run()\nrun.text = \'How \'\nfont = run.font\nfont.italic = True\nfont.bold = True\n\nrun = p.add_run()\nrun.text = \'are\'\nfont = run.font\nfont.italic = True\nfont.bold = True\nfont.size = Pt(16)\n\nrun = p.add_run()\nrun.text = \' you?\'\nfont = run.font\nfont.italic = True\nfont.bold = True\n\nrun = p.add_run()\nrun.text = \' What is your name?\'\nrun.font.italic = True\n\nprs.save(\'text-01.pptx\')\n\nAnd this is what it looks like, if you open it in PowerPoint:\n\nNow if you install the python code from my GitHub repository at https://github.com/fschaeck/python-pptx-text-replacer by running the command\npython -m pip install python-pptx-text-replacer\n\nand after successful installation run the command\npython-pptx-text-replacer -m ""How are you?"" -r ""I\'m fine!"" -i text-01.pptx -o text-02.pptx\n\nthe resulting presentation text-02.pptx will look like this:\n\nAs you can see, it mapped the replacement string exactly onto the existing font-configurations, thus if your match and it\'s replacement have the same length, the replacement string will retain the exact format of the match.\nBut - as an important side-note - if the text-frame has auto-size or fit-frame switched on, even all that work won\'t save you from screwing up the formatting, if the text after the replacement needs more or less space!\nIf you got issues with this code, please use the possibly improved version from GitHub first. If your problem remains, use the GitHub issue tracker to report it. The discussion of this question and answer is already getting out of hand. ;-)\n']"
Gluing (Imposition) PDF documents,"
I have several A4 PDF documents which I would like (two into one) ""glue"" together into A3 format PDF document. So I will get from 2PDFs A4 a single one sided PDF A3.
I have found the excellent utility PDFToolkit and some others but none of them can be used to ""glue"" side by side two documents. 
",24k,"
            20
        ","['\nI just came across a nice tool on superuser.com called PDFjam that can do all of the above in a single command:\npdfjam --nup 2x1 file1.pdf file2.pdf --outfile DONESKI.pdf\n\nIt has other standard features like page size plus a nice syntax for more sophisticated collations of pages (the tricky page re-ordering necessary for true booklet-style page imposition).\nIt\'s built on top of TeX which is, whatever it is. Installing is a breeze on Ubuntu: you can just apt-get install pdfjam. On Mac OS, I recommend getting BasicTeX (google ""mactex basictex""; SO thinks I\'m a spammer and won\'t let me post the link).\nThis is a lot easier and more maintanable than installing both pdftk and Multivalent (on both Mac OS for dev and Ubuntu for deploy), which wasn\'t going so well for me anyway...!\n', '\nFound the following (free and open-source) tool for doing Imposition called Impose (thanks danio for the tip). This solved my problem perfectly. \nEDIT:\nHere is how it\'s done:\nUse PDF Toolkit to joint two PDF files into one (two A4)\npdftk File1.pdf File2.pdf cat output OutputFile.pdf\n\nCreate from this a single page (one A3):\njava -cp Multivalent.jar tool.pdf.Impose -dim 2x1 -verbose -paper-size ""42.2x29.9cm"" -layout ""1,2"" OutputFile.pdf\n\n', ""\nI would like to advertise my pdftools\nIt's written in Python so should run on any platform. It's a wrapper to Latex (the pdfpages packages)  but can do lot of things with a single command line: merge pdf files, nup them (multiple input pages per output page) and number the pages of the output file (you specify the location and the format of the number)\nIt still needs some work but I think it's quite stable to be usable right now :)\n"", '\nThis puts two landscape letter pages onto a single portrait letter sheet, to be ""bound"" (i.e., folded) along the top.\npdftops $1 - | \npsbook | \npstops -w11in -h8.5in \'4:1@.65(.5in,0in)+0@.65(.5in,5.5in),2U@.65(8in,5.5in)+3@.65U(8in,11in)\' | \nps2pdf - $(basename $1 .pdf).psbook.pdf\n\nBy the way, I do this often, so I\'ll probably submit more ""answers"" to this question just to keep track of successful pstops pagespecs. Let me know if this is an inappropriate use of SO.\n', ""\nA nice, powerful, open-source imposition tool is included\nin the PoDoFo package:\n  http://podofo.sourceforge.net/\nIt works for me.  Some imposition plans can be found at:\n  http://www.av8n.com/computer/prepress/\nPoDoFo can do lots of other stuff, not just imposition.\nAnother useful imposition tool is Bookbinder (on the\nquantumelephant site).  It has a GUI that appeals to non-experts.\nIt is not as flexible or powerful as PoDoFo, but it can do\nimposition.\npdftk is more-or-less essential to have, but it will not\ndo imposition.\npdfjam is useless to me, because there are a wide range of\nvalid pdf files that it cannot handle.\nI've never been able to get multivalent to work, either.\n"", '\nWhat you want to do is imposition.  There are commercial tools to impose PDFs such as ARTS crackerjack and Quite imposing but they are pretty expensive (US$500), require a copy of acrobat professional and are overkill for imposing 2 A4 pages to an A3 sheet.\n', ""\nOn the Postscript side, a tool named pstops is able to rearrange pages of a Postscript file in any way you could imagine. I've not heard of such a tool for PDF. But pdf2ps and ps2pdf exist. So a not-so-ideal solution may be a combination of pdf2ps, pstops and ps2pdf.\n"", '\nI would combine the two A4 pages into one 2-page PDF using pdftk.  Then Print to PDF using something like PrimoPDF, and tell it to print to A3 format, two pages per side.\nI just tested this printing some slides from PowerPoint.  It worked great.  I selected A3 as my paper size in PowerPoint, and then chose to print 2 pages per side.  Printed to Primo and voila, I have two A4 slides per A3.\n', '\nYou can put multiple input pages on one output page using BookletImposer.\nAnd you can change page orders and combine multiple pdf files using PDF Mod.\nWith these two tools, you can do almost everything you want with pdf files (except editing their content).\n', '\nI had a similar problem. I tried Impose but it was giving me an\nException in thread ""main"" java.lang.NoClassDefFoundError: tool/pdf/Impose\nCaused by: java.lang.ClassNotFoundException: tool.pdf.Impose\n(...)\nCould not find the main class: tool.pdf.Impose.  Program will exit.\n\nI then tried PDF Snake which isn\'t free or open source, but has a completely unrestricted 30-day trial version. It worked perfectly, after tweaking the parameters to achieve what I wanted. It\'s a great tool. I would definitely buy it if it wasn\'t so expensive! Anyway, I thought I\'d leave my 2 cents in case anyone had the same problem I had with Impose.\n', '\nlook at this\nhttp://sourceforge.net/projects/proposition/\nIt needs laTex to run,\nbut when it does, works really fine\nRegards\n']"
How to get Sikuli working in headless mode,"
If we have a headless test server running sikuli (both ubuntu and windows configurations needed), how to get it work without a physical monitor and preferably for as many screen resolutions as possible.
",23k,"
            19
        ","['\nI successfully got sikuli running in headless mode (no physical monitor connected)\nUbuntu: check Xvfb.\nWindows: install display driver on the machine (to be headless) from virtualbox guest additions display drivers and use TightVNC to remotely set resolution from another machine.\nDetailed steps for windows 7\nAssume that:\n\nMachine A: to be headless machine, windows 7, with vnc server ready (e.g. TightVNC server installed and waiting for connections).\nMachine B: will be used to remotely setup the virtual display driver on machine A.\n\nsteps:\n\nDownload virtualbox guest additions iso file on Machine A from here (for latest version check latest version here and download VBoxGuestAdditions_x.y.z.iso)\n\nExtract iso file (possibly with winrar) into a directory (let us call it folder D)\n\nusing command prompt cd to D folder\nDriver extraction \n-To extract the 32-bit drivers to ""C:\\Drivers"", do the following:\n\nVBoxWindowsAdditions-x86 /extract /D=C:\\Drivers\n\n-For the 64-bit drivers:\n\nVBoxWindowsAdditions-amd64 /extract /D=C:\\Drivers\n\n\nGoto device manager\n\nadd hardware\n\n\n\n\n\n\n\n\n\nRestart and connect with VNC viewer, now you should be able to change screen resolution \n\n\nother valuable info on launchpad.\n', '\nI got SikuliX working in a true headless mode in GCE with a Windows 2016 client system. It takes some duct tape and other Rube Goldberg contraptions to work, but it can be done.\nThe issue is that, for GCE (and probably AWS and other cloud environment Windows clients), you don\'t have a virtual video adapter and display, so, unless there\'s an open RDP connection to the client, it doesn\'t have a screen, and SikuliX/OpenCV will get a 1024x768 black desktop, and fail. \nSo, the question is, how to create an RDP connection without having an actual screen anywhere. I did this using Xvfb (X Windows virtual frame buffer). This does require a second VM, though. Xvfb runs on Linux. The other piece of the puzzle is xfreerdp 2.0. The 2.x version is required for compatibility with recent versions of Windows. 1.x is included with some Linux distros; 2.x may need to be built from sources, depending on what flavor Linux you\'re using. I\'m using CentOS, which did require me to build my own.\nThe commands to establish the headless RDP session, once the pieces are in place, look something like this:\n/usr/bin/Xvfb :0 -screen 0 1920x1080x24 &\nexport DISPLAY=:0.0\n/usr/local/bin/xfreerdp /size:1920x1080 /u:[WindowsUser] /p:""[WindowsPassword]"" /v:[WindowsTarget]\n\nIn our environment we automated this as part of the build job kicked off by Jenkins. For this to work under the Jenkins slave, it was also necessary to run the Jenkins slave as a user process, rather than a service... this can be accomplished by enabling auto admin login and setting the slave launch script as a run (on logon) command.\n', '\nFor those looking to automate on ec2 windows machines, this worked for me: http://www.allianceglobalservices.com/blog/executing-automation-suite-on-disconnectedlocked-machines\nIn summary, I used RDC to connect, put the following code in a batch file on remote desktop, double clicked it, and sikulix  started working remotely (kicking me out of RDC at the same time).  Note that ec2 windows machines default to 1024x768 when tscon takes over which may be too small so TightVnc can be used to increase the resolution to 1280x1024 before running. \ntscon.exe 0 /dest:console\ntscon.exe 1 /dest:console\ntscon.exe 2 /dest:console\ntscon.exe 3 /dest:console\nSTART /DC:\\Sikulix /WAIT /B C:\\Sikulix\\runsikulix.cmd -d 3 -r C:\\test.sikuli -f C:\\Sikulix\\log.txt -d C:\\Sikulix\\userlog.txt\n\n', '\nI just figure out a way to resolve similar issue.\nMy env:\nlocal: windows pc\nremote (for running sikulix + app I would like to test): windows ec2 instance\nMy way:\n1.create a .bat file, its contents:\nping 127.0.0.1 -n 15 > nul\n\nfor /f ""skip=1 tokens=3"" %%s in (\'query user %USERNAME%\') do (\n  %windir%\\System32\\tscon.exe %%s /dest:console\n)\n\ncd ""\\path\\to\\sikulix""\njava -jar sikulixide-2.0.5.jar -r /path/to/sikulix -c > logfile.log\n\n\nprepare your app\nrun the bat (right click > run as administrator)\nping will give your 10s, so that you can bring your app back to front\nyou will be disconnnected from rdp connection\n\nExplanation:\n\nping is like ""sleep""\nfor loop: kick out current user & keep session alive\n\n']"
"VBA Internet Explorer Automation - How to Select ""Open"" When Downloading a File","
This is my first question ever here on stackoverflow!
I've been searching for a solution to this problem for a while and haven't found any help. I may just be using the wrong keywords in my searches, but so far I've had no luck. Here's the question:
In VBA, how can I select the ""Open"" option from the file download dialog in Internet Explorer?
Just for extra clarification, I'm talking about the yellow-orange bar that pops up across the bottom of the screen in IE9 when a file is downloaded.
I'm doing some VBA automation to download hundreds of PDFs from the web using Internet Explorer, but there is an intermediate step where a .fdf file has to be opened before I get to the actual PDF. So I first need to select the ""Open"" option so that I can move on to the next step of the automation. Like I said earlier, I've done a lot of searching and had no luck so far.
I've tried using SendKeys in hopes that hitting Enter would work, and that was a last ditch effort that didn't work.
Thanks in advance for the help!
",48k,"
            14
        ","[""\nI have covered this extensively here.\nTopic: VBA/VB.Net/VB6–Click Open/Save/Cancel Button on IE Download window – PART I\nLink: http://www.siddharthrout.com/2011/10/23/vbavb-netvb6click-opensavecancel-button-on-ie-download-window/\nand\n\nEDIT (IMP) If you are using IE 9 Do not forget to read PART 2 as it includes and covers the window structure of IE 9 download window\n\nTopic: VBA/VB.Net/VB6–Click Open/Save/Cancel Button on IE Download window – PART II\nLink: http://www.siddharthrout.com/2012/02/02/vbavb-netvb6click-opensavecancel-button-on-ie-download-window-part-ii/\nThe above links discuss on how to use use the API's to achieve what you want.\nFrom the 1st link...\n\nLike you and me, we both have names, similarly windows have “handles” (hWnd), Class etc. Once you know what that hWnd is, it is easier to interact with that window.\nFindwindow API finds the hWnd of a particular window by using the class name and the caption of the window (“File Download”) in this case. The “Open“, “Save” and “Cancel” buttons are windows in itself but they are child windows of the main window which is “File Download“. That means each one of those will also have a hWnd :) To find the child windows, we don’t use FindWindow but use FindWindowEx. All the three buttons “Open“, “Save” and “Cancel” have the same class which is “ Button”.\n\n"", '\nSimilar post: link\n    Option Explicit\n    Dim ie As InternetExplorer\n    Dim h As LongPtr\n    Private Declare PtrSafe Function FindWindowEx Lib ""user32"" Alias ""FindWindowExA"" (ByVal hWnd1 As LongPtr, ByVal hWnd2 As LongPtr, ByVal lpsz1 As String, ByVal lpsz2 As String) As LongPtr\n\nSub Download()\n    Dim o As IUIAutomation\n    Dim e As IUIAutomationElement\n    Set o = New CUIAutomation\n    h = ie.Hwnd\n    h = FindWindowEx(h, 0, ""Frame Notification Bar"", vbNullString)\n    If h = 0 Then Exit Sub\n\n    Set e = o.ElementFromHandle(ByVal h)\n    Dim iCnd As IUIAutomationCondition\n    Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, ""Open"")\n\n    Dim Button As IUIAutomationElement\n    Set Button = e.FindFirst(TreeScope_Subtree, iCnd)\n    Dim InvokePattern As IUIAutomationInvokePattern\n    Set InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\n    InvokePattern.Invoke\nEnd Sub \n\n', '\nI sent the shortcut keys to the application. Here they are for IE11. Sorry I could not test in IE9. If you hold down Alt, it may show you the other key to the combo as IE11 does. \nNote: the code will not run as you expect if IE is not the active window on your machine so it won\'t work while in debug mode.\n\nShortcut key:Alt+O\nVBA: Application.SendKeys ""%{O}""\n\n']"
Accessing Excel Custom Document Properties programmatically,"
I'm trying to add custom properties to a workbook I have created programmatically.  I have a method in place for getting and setting properties, but the problem is the workbook is returning null for the CustomDocumentProperties property.  I cannot figure out how to initialize this property so that I can add and retrieve properties from the workbook.  Microsoft.Office.Core.DocumentProperties is an interface, so I cant go and do the following
if(workbook.CustomDocumentProperties == null)
    workbook.CustomDocumentProperties = new DocumentProperties;

Here is the code I have to get and set the properties:
     private object GetDocumentProperty(string propertyName, MsoDocProperties type)
    {
        object returnVal = null;

        Microsoft.Office.Core.DocumentProperties properties;
        properties = (Microsoft.Office.Core.DocumentProperties)workBk.CustomDocumentProperties;

        foreach (Microsoft.Office.Core.DocumentProperty property in properties)
        {
            if (property.Name == propertyName && property.Type == type)
            {
                returnVal = property.Value;
            }
            DisposeComObject(property);
        }

        DisposeComObject(properties);

        return returnVal;
    }

    protected void SetDocumentProperty(string propertyName, string propertyValue)
    {
        DocumentProperties properties;
        properties = workBk.CustomDocumentProperties as DocumentProperties;

        bool propertyExists = false;
        foreach (DocumentProperty prop in properties)
        {
            if (prop.Name == propertyName)
            {
                prop.Value = propertyValue;
                propertyExists = true;
            }
            DisposeComObject(prop);

            if(propertyExists) break;
        }

        if (!propertyExists)
        {
            properties.Add(propertyName, false, MsoDocProperties.msoPropertyTypeString, propertyValue, Type.Missing);
        }

        DisposeComObject(propertyExists);

    }

The line
    properties = workBk.CustomDocumentProperties as DocumentProperties;
always set properties to null.
This is using Microsoft.Office.Core v12.0.0.0 and Microsoft.Office.Interop.Excell v12.0.0.0 (Office 2007)
",21k,"
            13
        ","['\nIf you are targetting .NET 4.0, you can use the dynamic key word for late binding\n Document doc = GetActiveDocument();\n if ( doc != null )\n {\n     dynamic properties = doc.CustomDocumentProperties;\n     foreach (dynamic p in properties)\n     {\n         Console.WriteLine( p.Name + "" "" + p.Value);\n     }\n }\n\n', '\nI looked at my own code and can see that I access the properties using late binding. I can\'t remember why, but I\'ll post some code in case it helps.\nobject properties = workBk.GetType().InvokeMember(""CustomDocumentProperties"", BindingFlags.Default | BindingFlags.GetProperty, null, workBk, null);\n\nobject property = properties.GetType().InvokeMember(""Item"", BindingFlags.Default | BindingFlags.GetProperty, null, properties, new object[] { propertyIndex });\n\nobject propertyValue = property.GetType().InvokeMember(""Value"", BindingFlags.Default | BindingFlags.GetProperty, null, propertyWrapper.Object, null);\n\nEDIT: ah, now I remember why. :-)\nEDIT 2: Jimbojones\' answer - to use the dynamic keyword - is a better solution (if you value ease-of-use over the performance overhead of using dynamic).\n', '\nI found the solution here.\nHere is the code I ended up with:\n    public void SetDocumentProperty(string propertyName, string propertyValue)\n    {\n        object oDocCustomProps = workBk.CustomDocumentProperties;\n        Type typeDocCustomProps = oDocCustomProps.GetType();\n\n        object[] oArgs = {propertyName,false,\n                 MsoDocProperties.msoPropertyTypeString,\n                 propertyValue};\n\n        typeDocCustomProps.InvokeMember(""Add"", BindingFlags.Default |\n                                   BindingFlags.InvokeMethod, null,\n                                   oDocCustomProps, oArgs);\n\n    }\n\n    private object GetDocumentProperty(string propertyName, MsoDocProperties type)\n    {\n        object returnVal = null;\n\n        object oDocCustomProps = workBk.CustomDocumentProperties;\n        Type typeDocCustomProps = oDocCustomProps.GetType();\n\n\n        object returned = typeDocCustomProps.InvokeMember(""Item"", \n                                    BindingFlags.Default |\n                                   BindingFlags.GetProperty, null,\n                                   oDocCustomProps, new object[] { propertyName });\n\n        Type typeDocAuthorProp = returned.GetType();\n        returnVal = typeDocAuthorProp.InvokeMember(""Value"",\n                                   BindingFlags.Default |\n                                   BindingFlags.GetProperty,\n                                   null, returned,\n                                   new object[] { }).ToString();\n\n        return returnVal;\n    }\n\nSome exception handling is necessary to hand if the property doesnt exist when retrieved\n', '\nLate answer to this question, but I worked out a simpler method for adding custom DocumentProperties that might be of use to someone in the future.\nMy problem was that calling the Add() method with the System type supplied by System.String.GetType() triggered a COMException: Type mismatch. Referring to the link in the previous answers it\'s clear that this method expects an Office-specific type, so the code that ended up working for me was:\nvar custProps = (Office.DocumentProperties)this.CustomDocumentProperties;\ncustProps.Add( ""AProperty"", false, MsoDocProperties.msoPropertyTypeString, ""AStringProperty"" );\n\nBecause it\'s a CustomDocumentProperty Office will add the custom property without difficulty, but if you need to check for existence or validate the value when the CustomDocumentProperty might not exist you\'ll have to catch a System.ArgumentException.\nEDIT\nAs pointed out in Oliver Bock\'s comment, this is an Office 2007 and up only solution, as far as I know.\n']"
How to access Microsoft Word existing instance using late binding,"
i am developing some code in c# where i will be interacting with Microsoft Word. I want to be able to have the option of re-using an existing instance or as an alternative creating a new instance.
Keeping in mind i want to do all of this using LATE BINDING... it is safe to say i have figured out how to get things working when creating a new instance.. i just call Activator.CreateInstance etc..
The problem i am having is how do i reuse an existing instance, for example, Word is already open and i want to use that instance.
Is there an Activator.UseExistingInstance? or something similar??
Thanks!
",11k,"
            5
        ","['\nYou\'re looking for Marshal.GetActiveObject.\nobject word;\ntry\n{\n    word = System.Runtime.InteropServices.Marshal.GetActiveObject(""Word.Application"");\n}\ncatch (COMException)\n{\n    Type type = Type.GetTypeFromProgID(""Word.Application"");\n    word = System.Activator.CreateInstance(type);\n}\n\n', '\nYou might want to have a look at the AccessibleObjectFromWindow api function defined in Oleacc.dll. Andrew Whitechapel has some articles on how to use it. Based on his articles I wrote an answer to a very similar question (about Excel, not Word), which you can find here:\n\nHow to use use late binding to get Excel instance?\n\nThere you will find an example how to connect to an already running Excel instance and then automating this instance using late binding. \nUpdate: \nHere is a short sample adapted to Word:\nusing System;\nusing System.Reflection;\nusing System.Runtime.InteropServices;\nusing System.Text;\n\nnamespace WordLateBindingSample\n{\n    [ComImport, InterfaceType(ComInterfaceType.InterfaceIsIUnknown), Guid(""00020400-0000-0000-C000-000000000046"")]\n    public interface IDispatch\n    {\n    }\n\n    class Program\n    {\n        [DllImport(""user32.dll"", SetLastError = true)]\n        static extern IntPtr FindWindow(string lpClassName, string lpWindowName);\n\n        [DllImport(""Oleacc.dll"")]\n        static extern int AccessibleObjectFromWindow(int hwnd, uint dwObjectID, byte[] riid, out IDispatch ptr);\n\n        public delegate bool EnumChildCallback(int hwnd, ref int lParam);\n\n        [DllImport(""User32.dll"")]\n        public static extern bool EnumChildWindows(int hWndParent, EnumChildCallback lpEnumFunc, ref int lParam);\n\n        [DllImport(""User32.dll"")]\n        public static extern int GetClassName(int hWnd, StringBuilder lpClassName, int nMaxCount);\n\n        public static bool EnumChildProc(int hwndChild, ref int lParam)\n        {\n            StringBuilder buf = new StringBuilder(128);\n            GetClassName(hwndChild, buf, 128);\n            if (buf.ToString() == ""_WwG"")\n            {\n                lParam = hwndChild;\n                return false;\n            }\n            return true;\n        }\n\n        static void Main(string[] args)\n        {\n            // Use the window class name (""OpusApp"") to retrieve a handle to Word\'s main window.\n            // Alternatively you can get the window handle via the process id:\n            // int hwnd = (int)Process.GetProcessById(wordPid).MainWindowHandle;\n            //\n            int hwnd = (int)FindWindow(""OpusApp"", null);\n\n            if (hwnd != 0)\n            {\n                int hwndChild = 0;\n\n                // Search the accessible child window (it has class name ""_WwG"") \n                // as described in http://msdn.microsoft.com/en-us/library/dd317978%28VS.85%29.aspx\n                //\n                EnumChildCallback cb = new EnumChildCallback(EnumChildProc);\n                EnumChildWindows(hwnd, cb, ref hwndChild);\n\n                if (hwndChild != 0)\n                {\n                    // We call AccessibleObjectFromWindow, passing the constant OBJID_NATIVEOM (defined in winuser.h) \n                    // and IID_IDispatch - we want an IDispatch pointer into the native object model.\n                    //\n                    const uint OBJID_NATIVEOM = 0xFFFFFFF0;\n                    Guid IID_IDispatch = new Guid(""{00020400-0000-0000-C000-000000000046}"");\n                    IDispatch ptr;\n\n                    int hr = AccessibleObjectFromWindow(hwndChild, OBJID_NATIVEOM, IID_IDispatch.ToByteArray(), out ptr);\n\n                    if (hr >= 0)\n                    {\n                        object wordApp = ptr.GetType().InvokeMember(""Application"", BindingFlags.GetProperty, null, ptr, null);\n\n                        object version = wordApp.GetType().InvokeMember(""Version"", BindingFlags.GetField | BindingFlags.InvokeMethod | BindingFlags.GetProperty, null, wordApp, null);\n                        Console.WriteLine(string.Format(""Word version is: {0}"", version));\n                    }\n                }\n            }\n        }\n    }\n}\n\n']"
Selenium can't open a second page,"
I am using Selenium to open different pages of a site. Have tried multiple times but the browser does not open a second webpage after the initial GET call. Have tried on both Chrome and Safari. Here is my code:
driver = webdriver.Chrome()
driver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-2"")
driver.set_page_load_timeout(30)
driver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-3"")

Here is the error I get for the second call:

The info from Network logs is Error 504, but I have verified that it works perfectly when done on another window of the browser, without automation
",3k,"
            1
        ","['\nA bit of more information about your usecase would have helped to construct a more canonical answer. However I was able to access the Page 2 of justdial.com/Chennai/Hr-Consultancy-Services with a minimized code block as follows:\n\nCode Block:\nfrom selenium import webdriver\n\noptions = webdriver.ChromeOptions() \noptions.add_argument(""start-maximized"")\ndriver = webdriver.Chrome(options=options, executable_path=r\'C:\\WebDrivers\\chromedriver.exe\')\ndriver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-2"")\n\n\nBrowser Snapshot:\n\n\n\nBut while sending multiple get() one after another:\ndriver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-2"")\ndriver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-3"")\n\nIt seems ChromeDriver initiated Chrome Browser gets detected and the following error is shown:\nAn error occurred while processing your request.\nReference #97.e5732c31.1612205693.6fd2708\n\n\nSolution\nTo avoid the detection you can add the following option:\n--disable-blink-features=AutomationControlled\n\n\nExample\nfrom selenium import webdriver\n\noptions = webdriver.ChromeOptions() \noptions.add_argument(""start-maximized"")\noptions.add_argument(\'--disable-blink-features=AutomationControlled\')\ndriver = webdriver.Chrome(options=options, executable_path=r\'C:\\WebDrivers\\chromedriver.exe\')\ndriver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-2"")\ndriver.get(""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-3"")\n\n', '\noptions.add_experimental_option(\n    ""excludeSwitches"", [\'enable-automation\'])\n\noptions.add_argument(\n    ""user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36"")\noptions.add_argument(""--remote-debugging-port=9222"")\n\ndriver = webdriver.Chrome(options=options)\ndriver.get(\n    ""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-2"")\ndriver.set_page_load_timeout(30)\ndriver.get(\n    ""https://www.justdial.com/Chennai/Hr-Consultancy-Services/nct-10258625/page-3"")\n\nthe website is detecting automation use above code :)\nYou can also do this in single line\nJust add below argument:\noptions.add_argument(\'--disable-blink-features=AutomationControlled\')\n\ndisabling enable-automation , or disabling automation controller disables webdriver.navigator which few websites uses to detect automation scripts\n']"
Puppeteer wait for all images to load then take screenshot,"
I am using Puppeteer to try to take a screenshot of a website after all images have loaded but can't get it to work.
Here is the code I've got so far, I am using https://www.digg.com as the example website:
const puppeteer = require('puppeteer');

(async () => {
    const browser = await puppeteer.launch();
    const page = await browser.newPage();
    await page.goto('https://www.digg.com/');

    await page.setViewport({width: 1640, height: 800});

    await page.evaluate(() => {
        return Promise.resolve(window.scrollTo(0,document.body.scrollHeight));
    });

    await page.waitFor(1000);

    await page.evaluate(() => {
        var images = document.querySelectorAll('img');

        function preLoad() {

            var promises = [];

            function loadImage(img) {
                return new Promise(function(resolve,reject) {
                    if (img.complete) {
                        resolve(img)
                    }
                    img.onload = function() {
                        resolve(img);
                    };
                    img.onerror = function(e) {
                        resolve(img);
                    };
                })
            }

            for (var i = 0; i < images.length; i++)
            {
                promises.push(loadImage(images[i]));
            }

            return Promise.all(promises);
        }

        return preLoad();
    });

    await page.screenshot({path: 'digg.png', fullPage: true});

    browser.close();
})();

",56k,"
            58
        ","['\nThere is a built-in option for that:\nawait page.goto(\'https://www.digg.com/\', {""waitUntil"" : ""networkidle0""});\n\n\nnetworkidle0 - consider navigation to be finished when there are no more than 0 network connections for at least 500 ms\n\n\nnetworkidle2 - consider navigation to be finished when there are no more than 2 network connections for at least 500 ms.\n\nOf course it won\'t work if you\'re working with endless-scrolling-single-page-applications like Twitter.\nPuppeteer GitHub issue #1552 provides explanation for the motivation behind networkidle2.\n', '\nAnother option, actually evaluate to get callback when all images were loaded\nThis option will also work with setContent that doesn\'t support the wait networkidle0 option\nawait page.evaluate(async () => {\n  const selectors = Array.from(document.querySelectorAll(""img""));\n  await Promise.all(selectors.map(img => {\n    if (img.complete) return;\n    return new Promise((resolve, reject) => {\n      img.addEventListener(\'load\', resolve);\n      img.addEventListener(\'error\', reject);\n    });\n  }));\n})\n\n', ""\nWait for Lazy Loading Images\nYou may want to consider scrolling down first using a method such as Element.scrollIntoView() to account for lazy loading images:\nawait page.goto('https://www.digg.com/', {\n  waitUntil: 'networkidle0', // Wait for all non-lazy loaded images to load\n});\n\nawait page.evaluate(async () => {\n  // Scroll down to bottom of page to activate lazy loading images\n  document.body.scrollIntoView(false);\n\n  // Wait for all remaining lazy loading images to load\n  await Promise.all(Array.from(document.getElementsByTagName('img'), image => {\n    if (image.complete) {\n      return;\n    }\n\n    return new Promise((resolve, reject) => {\n      image.addEventListener('load', resolve);\n      image.addEventListener('error', reject);\n    });\n  }));\n});\n\n"", ""\nI'm facing the exact same issue.\nI have a feeling the solution will involve using:\nawait page.setRequestInterceptionEnabled(true);\n\npage.on('request', interceptedRequest => {\n    //some code here that adds this request to ...\n    //a list and checks whether all list items have ...\n    //been successfully completed!\n});\n\nhttps://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagesetrequestinterceptionenabledvalue\n"", ""\nI found a solution which is applicable to multiple sites using the page.setViewPort(...) method as given below:\nconst puppeteer = require('puppeteer');\n\nasync(() => {\n    const browser = await puppeteer.launch({\n        headless: true, // Set to false while development\n        defaultViewport: null,\n        args: [\n            '--no-sandbox',\n            '--start-maximized', // Start in maximized state\n        ],\n    });\n\n    const page = await = browser.newPage();\n    await page.goto('https://www.digg.com/', {\n        waitUntil: 'networkidle0', timeout: 0\n    });\n\n    // Get scroll width and height of the rendered page and set viewport\n    const bodyWidth = await page.evaluate(() => document.body.scrollWidth);\n    const bodyHeight = await page.evaluate(() => document.body.scrollHeight);\n    await page.setViewport({ width: bodyWidth, height: bodyHeight });\n\n    await page.waitFor(1000);\n    await page.screenshot({path: 'digg-example.png' });\n})();\n\n""]"
Android – multiple custom versions of the same app,"
Whats the best way to deploy several customized versions of a Android application? 
Currently I have a script to exchange the resource folder for getting a customized version of my app. It works great, but all custom versions still have the same package name in the AndroidManifest.xml. Therefore it is not possible to install two customized versions of the app at the same time.
This is one solution for this problem, but that has to be done by hand
Can you think of a more easy solution, or how this could be built into a skript?
(btw: it is not for a porn/spam/whatever app, not even a paid one)
",28k,"
            47
        ","['\nPerhaps the built-in Android ""library"" concept was not fully baked at the time of the original post, but it may be the preferred method as of 2011.  Follow these steps for an ant build:\nStarting from a working app (let\'s call it directory ""myOrigApp"", package com.foo.myapp), just add this line to ""default.properties"" to make it a library:\nandroid.library=true\n\nNow create a new app in a sibling directory in any way you prefer (let\'s call it directory ""sibling"", package com.foo.myVariant).  Using Intellij Idea, for example, create a project \'from scratch\' with directory \'sibling\' and it will create all the files/directories you would normally need.\nIn that new, sibling directory edit ""default.properties"" to add the dependency:\nandroid.library.reference.1=../myOrigApp\n\nCopy over the Manifest from the original dir:\ncd sibling\ncp ../myOrigApp/AndroidManifest.xml  ../myOrigApp/local.properties ../myOrigApp/build.properties  .\n\nEdit that copied Manifest file to change its package name to your new variant, ""com.foo.myVarient""; that\'s the only change.\nIf you just run the ant build scripts, you may be done. (I had to just set up signing keys.)\nIf you want to set up an IDE like Idea to have the library project as a dependent of the variant project, follow these steps to add a library project to the variant project (assumes you already have a project set up for both):\n\nOpen the original project, bring up Project Settings, select your Facet and check ""Is Library Project"" and save.\nOpen the variant project, bring up Project Settings, select Modules\nAdd a module\nSelect “Import existing module”\nBrowse to the Original directory (myOrigApp) and select its .iml file (IntelliJ project source file)\nClick ""Finish."" (The library project is added as a module within the variant project.)\nIn the modules list click over the Variant project to select it.\nOn the right hand side select the ""Dependencies"" tab.\nClick ""Add…""\nChoose ""Module dependency…"" (A list should appear that includes the name of the module/library you previously added to the project--perhaps the only entry in the list). \nSelect the library project you added and press OK. (It will be added to the list of dependencies of your project.)\nPress OK to finish configuring the project. (You should see 2 modules, with the library\'s resources and classes available and recognized in the Variant project.)\n\n', '\nWhat I did for something similar to this is to just use an antlib task and then go through all java and xml files to replace my old package string to the new package string. It didn\'t matter if the files were not in the correct src paths according to the package. Just doing a regex replace for all the files was enough for me to get this working...\nFor example to replace it in all your java files under the src directory:\n <replaceregexp flags=""g"" byline=""false"">\n    <regexp pattern=""old.package.string"" /> \n    <substitution expression=""new.package.string"" />\n    <fileset dir=""src"" includes=""**/*.java"" /> \n </replaceregexp>\n\n', ""\nYou definitely want to use Gradle flavors that comes natively, encouraged even, on Android Studio.\nIt seems to explain all the basics really well. I just finished converting to Gradle today, and it works great. Custom app icons, names, and strings, etc.\nAs the website explains, part of the purpose behind this design was to make it more dynamic and more easily allow multiple APKs to be created with essentially the same code, which sounds similar what you're doing.\nI probably didn't explain it the best, but that website does a pretty good job.\n"", '\nThe linked-to solution does not have to be done by hand. Bear in mind that the package attribute in the <manifest> element does not have to be where the code resides, so long as you spell out the fully-qualified classes elsewhere in the manifest (e.g., activity android:name=""com.commonsware.android.MyActivity"" rather than activity android:name="".MyActivity""). Script your manifest change and use Ant to build a new APK. AFAIK, that should work.\n', '\nSupport Multiple Partners \nPrepare config.xml\n\n\n     Build project for different partner \n<!--partner.dir, pkg.name, ver.code, ver.name are input from command line when execute \'ant\' -->\n\n<!-- set global properties for this build -->\n<property name=""build.bin"" location=""bin""/>\n<property name=""build.gen"" location=""gen""/>\n<property name=""src"" location=""src""/>\n<property name=""res"" location=""res""/>\n\n<target name=""preparefiles"" description=""Prepare files for different partner"" >\n    <delete dir=""${build.bin}"" />\n    <delete dir=""${build.gen}"" />\n\n    <copy todir=""${res}"" overwrite=""true"" />\n        <fileset dir=""${partner.dir}/res"" /> \n    </copy>\n\n    <!-- change the import in all Java source files -->\n    <replaceregexp file=""AndroidManifest.xml""\n        match=\'android.versionCode=""(.*)""\'\n        replace=\'android.versionCode=""${ver.code}""\'\n        byline=""false"">\n\n    <replaceregexp file=""AndroidManifest.xml""\n        match=\'android.versionName=""(.*)""\'\n        replace=\'android.versionName=""${ver.name}""\'\n        byline=""false"">\n\n    <replaceregexp file=""AndroidManifest.xml""\n        match=\'package=""(.*)""\'\n        replace=\'package=""${pkg.name}""\'\n        byline=""false"">\n\n    <!-- change the package name in AndroidManifest -->\n    <replaceregexp flags=""g"" byline=""false"">\n        <regexp pattern=""import(.*)com.myproject.com.R;"" /> \n        <substitution expression=""import com.${pkg.name}.R;"" />\n        <fileset dir=""${src}"" includes=""**/*.java"" /> \n    </replaceregexp>\n\n    <replaceregexp flags=""g"" byline=""false"">\n        <regexp pattern=""(package com.myproject.com;)"" /> \n        <substitution expression=""\\1&#10;import com.${pkg.name}.R;"" />\n        <fileset dir=""${src}"" includes=""**/*.java"" /> \n    </replaceregexp>\n</target>\n\n\nPrepare Files\n$ ant -f config.xml -Dpartner.dir=""xxx"" -Dpkg.name=""xxx"" -Dver.code=""xxx"" -Dver.name=""xxx"" preparefiles\nCreate build.xml\nBuild\n$ ant debug\nor\n$ ant release\n', ""\nI'm using the maven-android-plugin to achieve this. Specify one AndroidManifest.xml for the generated-sources goal and another AndroidManifest.xml for the final apk goal. That way the source code project retains the actual source code package name during generation of the R class and the build phase, while the market adapted manifest package name is in the second AndroidManifest.xml which is included in the final apk file.\n"", '\nI wound up with a script that patches the sources; patching the source sounds risky, but in presence of version control the risk is acceptable.\nSo I made one version, committed the source, made the other version, committed the source, and looking at diffs wrote a patching script in Python.\nI am not sure if it is the best solution. (And the code misses some os.path.joins)\nThe heart of the script is the following function:\n# In the file \'fname\',\n# find the text matching ""before oldtext after"" (all occurrences) and\n# replace \'oldtext\' with \'newtext\' (all occurrences).\n# If \'mandatory\' is true, raise an exception if no replacements were made.\ndef fileReplace(fname,before,newtext,after,mandatory=True):\n    with open(fname, \'r+\') as f:\n    read_data = f.read()\n    pattern = r""(""+re.escape(before)+r"")\\w+(""+re.escape(after)+r"")""\n    replacement = r""\\1""+newtext+r""\\2""\n    new_data,replacements_made = re.subn(pattern,replacement,read_data,flags=re.MULTILINE)\n    if replacements_made and really:\n        f.seek(0)\n        f.truncate()\n        f.write(new_data)\n        if verbose:\n            print ""patching "",fname,"" ("",replacements_made,"" occurrence"", ""s"" if 1!=replacements_made else """","")""\n    elif replacements_made:\n        print fname,"":""\n        print new_data\n    elif mandatory:\n        raise Exception(""cannot patch the file: ""+fname)\n\nAnd you may find the following one of use:\n# Change the application resource package name everywhere in the src/ tree.\n# Yes, this changes the java files. We hope that if something goes wrong,\n# the version control will save us.\ndef patchResourcePackageNameInSrc(pname):\n    for root, dirs, files in os.walk(\'src\'):\n    if \'.svn\' in dirs:\n        dirs.remove(\'.svn\')\n    for fname in files:\n        fileReplace(os.path.join(root,fname),""import com.xyz."",pname,"".R;"",mandatory=False)\n\nThere is also a function that copies assets from x-assets-cfgname to assets (earlier it turned out that for me it is more convenient to have a subdirectory in assets).\ndef copyAssets(vname,force=False):\n    assets_source = ""x-assets-""+vname+""/xxx""\n    assets_target = ""assets/xxx""\n    if not os.path.exists(assets_source):\n        raise Exception(""Invalid variant name: ""+vname+"" (the assets directory ""+assets_source+"" does not exist)"")\n    if os.path.exists(assets_target+""/.svn""):\n        raise Exception(""The assets directory must not be under version control! ""+assets_target+""/.svn exists!"")\n    if os.path.exists(assets_target):\n        shutil.rmtree(assets_target)\n    shutil.copytree(assets_source, assets_target, ignore=shutil.ignore_patterns(\'.svn\'))\n\nWell, you get the idea. Now you can write your own script.\n', ""\nI think the best way is to create a new project and copy the stuff. steps,\n- create new android project without a class\n- create package (package name should be corresponding to the one in the manifest file), or just copy the package name in the 'gen' folder\n- copy the java files\n- copy the drawable folders\n- copy the layout files\n- copy any other file(s) used in ur project\n- copy manifest file's data\nthis has been simpler for me for the task\n""]"
Upload file to SFTP using PowerShell,"
We were asked to set up an automated upload from one of our servers to an SFTP site. There will be a file that is exported from a database to a filer every Monday morning and they want the file to be uploaded to SFTP on Tuesday. The current authentication method we are using is username and password (I believe there was an option to have key file as well but username/password option was chosen).
The way I am envisioning this is to have a script sitting on a server that will be triggered by Windows Task scheduler to run at a specific time (Tuesday) that will grab the file in question upload it to the SFTP and then move it to a different location for backup purposes.
For example:

Local Directory: C:\FileDump
SFTP Directory: /Outbox/
Backup Directory: C:\Backup

I tried few things at this point WinSCP being one of them as well as SFTP PowerShell Snap-In but nothing has worked for me so far. 
This will be running on Windows Server 2012R2.
When I run Get-Host my console host version is 4.0.
Thanks.
",169k,"
            44
        ","['\nYou didn\'t tell us what particular problem do you have with the WinSCP, so I can really only repeat what\'s in WinSCP documentation.\n\nDownload WinSCP .NET assembly.\nThe latest package as of now is WinSCP-5.21.6-Automation.zip;\n\nExtract the .zip archive along your script;\n\nUse a code like this (based on the official PowerShell upload example):\n# Load WinSCP .NET assembly\nAdd-Type -Path ""WinSCPnet.dll""\n\n# Setup session options\n$sessionOptions = New-Object WinSCP.SessionOptions -Property @{\n    Protocol = [WinSCP.Protocol]::Sftp\n    HostName = ""example.com""\n    UserName = ""user""\n    Password = ""mypassword""\n    SshHostKeyFingerprint = ""ssh-rsa 2048 xxxxxxxxxxx...=""\n}\n\n$session = New-Object WinSCP.Session\n\ntry\n{\n    # Connect\n    $session.Open($sessionOptions)\n\n    # Upload\n    $session.PutFiles(""C:\\FileDump\\export.txt"", ""/Outbox/"").Check()\n}\nfinally\n{\n    # Disconnect, clean up\n    $session.Dispose()\n}\n\n\n\n\nYou can have WinSCP generate the PowerShell script for the upload for you:\n\nLogin to your server with WinSCP GUI;\nNavigate to the target directory in the remote file panel;\nSelect the file for upload in the local file panel;\nInvoke the Upload command;\nOn the Transfer options dialog, go to Transfer Settings > Generate Code;\nOn the Generate transfer code dialog, select the .NET assembly code tab;\nChoose PowerShell language.\n\nYou will get a code like above with all session and transfer settings filled in.\n\n(I\'m the author of WinSCP)\n', '\nThere isn\'t currently a built-in PowerShell method for doing the SFTP part. You\'ll have to use something like psftp.exe or a PowerShell module like Posh-SSH.\nHere is an example using Posh-SSH:\n# Set the credentials\n$Password = ConvertTo-SecureString \'Password1\' -AsPlainText -Force\n$Credential = New-Object System.Management.Automation.PSCredential (\'root\', $Password)\n\n# Set local file path, SFTP path, and the backup location path which I assume is an SMB path\n$FilePath = ""C:\\FileDump\\test.txt""\n$SftpPath = \'/Outbox\'\n$SmbPath = \'\\\\filer01\\Backup\'\n\n# Set the IP of the SFTP server\n$SftpIp = \'10.209.26.105\'\n\n# Load the Posh-SSH module\nImport-Module C:\\Temp\\Posh-SSH\n\n# Establish the SFTP connection\n$ThisSession = New-SFTPSession -ComputerName $SftpIp -Credential $Credential\n\n# Upload the file to the SFTP path\nSet-SFTPFile -SessionId ($ThisSession).SessionId -LocalFile $FilePath -RemotePath $SftpPath\n\n#Disconnect all SFTP Sessions\nGet-SFTPSession | % { Remove-SFTPSession -SessionId ($_.SessionId) }\n\n# Copy the file to the SMB location\nCopy-Item -Path $FilePath -Destination $SmbPath\n\nSome additional notes:\n\nYou\'ll have to download the Posh-SSH module which you can install to your user module directory (e.g. C:\\Users\\jon_dechiro\\Documents\\WindowsPowerShell\\Modules) and just load using the name or put it anywhere and load it like I have in the code above.\nIf having the credentials in the script is not acceptable you\'ll have to use a credential file. If you need help with that I can update with some details or point you to some links.\nChange the paths, IPs, etc. as needed.\n\nThat should give you a decent starting point.\n', ""\nI am able to sftp using PowerShell as below:\nPS C:\\Users\\user\\Desktop> sftp user@aa.bb.cc.dd                                                     \nuser@aa.bb.cc.dd's password:\nConnected to user@aa.bb.cc.dd.\nsftp> ls\ntestFolder\nsftp> cd testFolder\nsftp> ls\ntaj_mahal.jpeg\nsftp> put taj_mahal_1.jpeg\nUploading taj_mahal_1.jpeg to /home/user/testFolder/taj_mahal_1.jpeg\ntaj_mahal_1.jpeg                                                                      100%   11KB  35.6KB/s   00:00\nsftp> ls\ntaj_mahal.jpeg      taj_mahal_1.jpeg\nsftp>\n\nI do not have installed Posh-SSH or anything like that. I am using Windows 10 Pro PowerShell. No additional modules installed.\n"", ""\nUsing PuTTY's pscp.exe (which I have in an $env:path directory):\npscp -sftp -pw passwd c:\\filedump\\* user@host:/Outbox/\nmv c:\\filedump\\* c:\\backup\\*\n\n"", '\n$FilePath = ""C:\\Backup\\xxx.zip""\n$SftpPath = \'/Cloud_Deployment/Backup\'\n$SftpIp = \'mercury.xxx.xx.uk\' #Or IP\n$Password = \'password\'\n$userroot = \'username\'\n$Password = ConvertTo-SecureString $Password -AsPlainText -Force\n$Credential = New-Object System.Management.Automation.PSCredential ($userroot, $Password)\nInstall-Module -Name Posh-SSH  #rus as Admin \n$SFTPSession = New-SFTPSession -ComputerName $SftpIp -Credential $Credential\n#Download file\n#Get-SFTPItem -SessionId $SFTPSession.SessionId -Path $SftpPath/test.txt -Destination c:\\temp\n#Upload file\nSet-SFTPItem -SessionId $SFTPSession.SessionId -Path $FilePath -Destination $SftpPath\n#Disconnect all SFTP Sessions\nRemove-SFTPSession -SFTPSession $SFTPSession\n#or \nGet-SFTPSession | % { Remove-SFTPSession -SessionId ($_.SessionId) }\nRef : powershell-sftp\nIf any how you face error ""PackageManagement\\Install-Package : No match was found for the specified search criteria and module name \'Posh-SSH\'""\nThen please visit Here\n', '\nWell, while using powershell 7, we can simply upload files using sftp with following command\necho ""put localpath/file.txt destinationpath/file.txt"" | sftp username@server\n\nmake sure to add these double quotes.\n']"
How to programmatically fill input elements built with React?,"
I'm tasked with crawling website built with React. I'm trying to fill in input fields and submitting the form using javascript injects to the page (either selenium or webview in mobile). This works like a charm on every other site + technology but React seems to be a real pain.
so here is a sample code 
var email = document.getElementById( 'email' );
email.value = 'example@mail.com';

I the value changes on the DOM input element, but the React does not trigger the change event.
I've been trying plethora of different ways to get the React to update the state.
var event = new Event('change', { bubbles: true });
email.dispatchEvent( event );

no avail
var event = new Event('input', { bubbles: true });
email.dispatchEvent( event );

not working
email.onChange( event );

not working
I cannot believe interacting with React has been made so difficult. I would greatly appreciate any help. 
Thank you
",23k,"
            37
        ","[""\nThis accepted solution appears not to work in React > 15.6 (including React 16) as a result of changes to de-dupe input and change events.\nYou can see the React discussion here: https://github.com/facebook/react/issues/10135\nAnd the suggested workaround here:\nhttps://github.com/facebook/react/issues/10135#issuecomment-314441175\nReproduced here for convenience:\nInstead of\ninput.value = 'foo';\ninput.dispatchEvent(new Event('input', {bubbles: true}));\n\nYou would use\nfunction setNativeValue(element, value) {\n  const valueSetter = Object.getOwnPropertyDescriptor(element, 'value').set;\n  const prototype = Object.getPrototypeOf(element);\n  const prototypeValueSetter = Object.getOwnPropertyDescriptor(prototype, 'value').set;\n\n  if (valueSetter && valueSetter !== prototypeValueSetter) {\n    prototypeValueSetter.call(element, value);\n  } else {\n    valueSetter.call(element, value);\n  }\n}\n\nand then\nsetNativeValue(input, 'foo');\ninput.dispatchEvent(new Event('input', { bubbles: true }));\n\n"", '\nReact is listening for the input event of text fields.\nYou can change the value and manually trigger an input event, and react\'s onChange handler will trigger:\n\n\nclass Form extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {value: \'\'}\r\n  }\r\n  \r\n  handleChange(e) {\r\n    this.setState({value: e.target.value})\r\n    console.log(\'State updated to \', e.target.value);\r\n  }\r\n  \r\n  render() {\r\n    return (\r\n      <div>\r\n        <input\r\n          id=\'textfield\'\r\n          value={this.state.value}\r\n          onChange={this.handleChange.bind(this)}\r\n        />\r\n        <p>{this.state.value}</p>\r\n      </div>      \r\n    )\r\n  }\r\n}\r\n\r\nReactDOM.render(\r\n  <Form />,\r\n  document.getElementById(\'app\')\r\n)\r\n\r\ndocument.getElementById(\'textfield\').value = \'foo\'\r\nconst event = new Event(\'input\', { bubbles: true })\r\ndocument.getElementById(\'textfield\').dispatchEvent(event)\n<script src=""https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react.min.js""></script>\r\n<script src=""https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react-dom.min.js""></script>\r\n\r\n<div id=\'app\'></div>\n\n\n', ""\nHere is the cleanest possible solution for inputs, selects, checkboxes, etc. (works not only for react inputs)\n/**\n * See [Modify React Component's State using jQuery/Plain Javascript from Chrome Extension](https://stackoverflow.com/q/41166005)\n * See https://github.com/facebook/react/issues/11488#issuecomment-347775628\n * See [How to programmatically fill input elements built with React?](https://stackoverflow.com/q/40894637)\n * See https://github.com/facebook/react/issues/10135#issuecomment-401496776\n *\n * @param {HTMLInputElement | HTMLSelectElement} el\n * @param {string} value\n */\nfunction setNativeValue(el, value) {\n  const previousValue = el.value;\n\n  if (el.type === 'checkbox' || el.type === 'radio') {\n    if ((!!value && !el.checked) || (!!!value && el.checked)) {\n      el.click();\n    }\n  } else el.value = value;\n\n  const tracker = el._valueTracker;\n  if (tracker) {\n    tracker.setValue(previousValue);\n  }\n\n  // 'change' instead of 'input', see https://github.com/facebook/react/issues/11488#issuecomment-381590324\n  el.dispatchEvent(new Event('change', { bubbles: true }));\n}\n\nUsage:\nsetNativeValue(document.getElementById('name'), 'Your name');\ndocument.getElementById('radio').click(); // or setNativeValue(document.getElementById('radio'), true)\ndocument.getElementById('checkbox').click(); // or setNativeValue(document.getElementById('checkbox'), true)\n\n"", '\nI noticed the input element had some property with a name along the lines of __reactEventHandlers$..., which had some functions including an onChange.\nThis worked for finding that function and triggering it\nlet getReactEventHandlers = (element) => {\n    // the name of the attribute changes, so we find it using a match.\n    // It\'s something like `element.__reactEventHandlers$...`\n    let reactEventHandlersName = Object.keys(element)\n       .filter(key => key.match(\'reactEventHandler\'));\n    return element[reactEventHandlersName];\n}\n\nlet triggerReactOnChangeEvent = (element) => {\n    let ev = new Event(\'change\');\n    // workaround to set the event target, because `ev.target = element` doesn\'t work\n    Object.defineProperty(ev, \'target\', {writable: false, value: element});\n    getReactEventHandlers(element).onChange(ev);\n}\n\ninput.value = ""some value"";\ntriggerReactOnChangeEvent(input);\n\n', '\nWithout element ids:\nexport default function SomeComponent() {\n    const inputRef = useRef();\n    const [address, setAddress] = useState("""");\n    const onAddressChange = (e) => {\n        setAddress(e.target.value);\n    }\n    const setAddressProgrammatically = (newValue) => {\n        const event = new Event(\'change\', { bubbles: true });\n        const input = inputRef.current;\n        if (input) {\n            setAddress(newValue);\n            input.value = newValue;\n            input.dispatchEvent(event);\n        }\n    }\n    return (\n        ...\n        <input ref={inputRef} type=""text"" value={address} onChange={onAddressChange}/>\n        ...\n    );\n}\n\n', '\nReact 17 works with fibers:\nfunction findReact(dom) {\n    let key = Object.keys(dom).find(key => key.startsWith(""__reactFiber$""));\n    let internalInstance = dom[key];\n    if (internalInstance == null) return ""internalInstance is null: "" + key;\n\n    if (internalInstance.return) { // react 16+\n        return internalInstance._debugOwner\n            ? internalInstance._debugOwner.stateNode\n           : internalInstance.return.stateNode;\n    } else { // react <16\n        return internalInstance._currentElement._owner._instance;\n   }\n}\n\nthen:\nfindReact(domElement).onChangeWrapper(""New value"");\n\nthe domElement in this is the tr with the data-param-name of the field you are trying to change:\nvar domElement = ?.querySelectorAll(\'tr[data-param-name=""<my field name>""]\')\n\n']"
Using conditional statements inside 'expect',"
I need to automate logging into a TELNET session using expect, but I need to take care of multiple passwords for the same username.
Here's the flow I need to create:

Open TELNET session to an IP
Send user-name
Send password
Wrong password? Send the same user-name again, then a different password
Should have successfully logged-in at this point...

For what it's worth, here's what I've got so far:
#!/usr/bin/expect
spawn telnet 192.168.40.100
expect ""login:""
send ""spongebob\r""
expect ""password:""
send ""squarepants\r""
expect ""login incorrect"" {
  expect ""login:""
  send ""spongebob\r""
  expect ""password:""
  send ""rhombuspants\r""
}
expect ""prompt\>"" {
  send_user ""success!\r""
}
send ""blah...blah...blah\r""

Needless to say this doesn't work, and nor does it look very pretty. From my adventures with Google expect seems to be something of a dark-art. Thanks in advance to anyone for assistance in the matter!
",77k,"
            33
        ","['\nHave to recomment the Exploring Expect book for all expect programmers -- invaluable.\nI\'ve rewritten your code: (untested)\nproc login {user pass} {\n    expect ""login:""\n    send ""$user\\r""\n    expect ""password:""\n    send ""$pass\\r""\n}\n\nset username spongebob \nset passwords {squarepants rhombuspants}\nset index 0\n\nspawn telnet 192.168.40.100\nlogin $username [lindex $passwords $index]\nexpect {\n    ""login incorrect"" {\n        send_user ""failed with $username:[lindex $passwords $index]\\n""\n        incr index\n        if {$index == [llength $passwords]} {\n            error ""ran out of possible passwords""\n        }\n        login $username [lindex $passwords $index]\n        exp_continue\n    }\n    ""prompt>"" \n}\nsend_user ""success!\\n""\n# ...\n\nexp_continue loops back to the beginning of the expect block -- it\'s like a ""redo"" statement.\nNote that send_user ends with \\n not \\r\nYou don\'t have to escape the > character in your prompt: it\'s not special for Tcl.\n', '\nWith a bit of bashing I found a solution. Turns out that expect uses a TCL syntax that I\'m not at all familiar with:\n#!/usr/bin/expect\nset pass(0) ""squarepants""\nset pass(1) ""rhombuspants""\nset pass(2) ""trapezoidpants""\nset count 0\nset prompt ""> ""\nspawn telnet 192.168.40.100\nexpect {\n  ""$prompt"" {\n    send_user ""successfully logged in!\\r""\n  }\n  ""password:"" {\n    send ""$pass($count)\\r""\n    exp_continue\n  }\n  ""login incorrect"" {\n    incr count\n    exp_continue\n  }\n  ""username:"" {\n    send ""spongebob\\r""\n    exp_continue\n  }\n}\nsend ""command1\\r""\nexpect ""$prompt""\nsend ""command2\\r""\nexpect ""$prompt""\nsend ""exit\\r""\nexpect eof\nexit\n\nHopefully this will be useful to others.\n', ""\nIf you know the user ids and passwords, then you ought also to know which userid/password pairs are aligned with which systems.  I think you'd be better off maintaining a map of which userid/password pair goes with which system then extracting that information and simply use the correct one.\nSo -- since you obviously don't like my advice, then I suggest you look at the wikipedia page and implement a procedure that returns 0 if successful and 1 if the expectation times out.  That will allow you to detect when the password supplied failed -- the prompt expectation times out -- and retry.  If this is helpful, you can remove your downvote now that I've edited it.\nIn retrospect, you'd probably want to do this in conjunction with the map anyway since you'd want to detect a failed login if the password was changed.\n""]"
How can I use persisted cookies from a file using phantomjs,"
I have some authentication requried to hit a particular url. In browser I need to login only once, as for other related urls which can use the session id from the cookie need not required to go to the login page. 
Similarly, can I use the cookie generated in the cookie file using --cookies-file=cookies.txt in the commandline in phantomjs to open other page which requires the same cookie detail.
Please suggest.
",23k,"
            25
        ","['\nPhantom JS and cookies\n--cookies-file=cookies.txt will only store non-session cookies in the cookie jar. Login and authentication is more commonly based on session cookies.\nWhat about session cookies?\nTo save these is quite simple, but you should consider that they will likely expire quickly.\nYou need to write your program logic to consider this. For example\n\nLoad cookies from the cookiejar\nHit a URL to check if the user is logged in\nIf not logged in\nLog in, Save cookies to cookiejar\ncontinue with processing\n\nExample\nvar fs = require(\'fs\');\nvar CookieJar = ""cookiejar.json"";\nvar pageResponses = {};\npage.onResourceReceived = function(response) {\n    pageResponses[response.url] = response.status;\n    fs.write(CookieJar, JSON.stringify(phantom.cookies), ""w"");\n};\nif(fs.isFile(CookieJar))\n    Array.prototype.forEach.call(JSON.parse(fs.read(CookieJar)), function(x){\n        phantom.addCookie(x);\n    });\n\npage.open(LoginCheckURL, function(status){\n // this assumes that when you are not logged in, the server replies with a 303\n if(pageResponses[LoginCheckURL] == 303)\n {  \n    //attempt login\n    //assuming a resourceRequested event is fired the cookies will be written to the jar and on your next load of the script they will be found and used\n }\n\n\n});\n\n', '\nThe file created by the option --cookies-file=cookies.txt is serialized from CookieJar: there are extra characters and it\'s sometimes difficult to parse.\nIt may looks like:\n[General]\ncookies=""@Variant(\\0\\0\\0\\x7f\\0\\0\\0\\x16QList<QNetworkCookie>\\0\\0\\0\\0\\x1\\0\\0\\0\\v\\0\\0\\0{__cfduid=da7fda1ef6dd8b38450c6ad5632...\n\nI used in the past phantom.cookies. This array will be pre-populated by any existing Cookie data stored in the cookie file specified in the PhantomJS startup config/command-line options, if any. But you can also add dynamic cookie by using phantom.addCookie.\nA basic example is \nphantom.addCookie({\n    \'name\':     \'Valid-Cookie-Name\',   /* required property */\n    \'value\':    \'Valid-Cookie-Value\',  /* required property */\n    \'domain\':   \'localhost\',           /* required property */\n    \'path\':     \'/foo\',\n    \'httponly\': true,\n    \'secure\':   false,\n    \'expires\':  (new Date()).getTime() + (1000 * 60 * 60)   /* <-- expires in 1 hour */\n});\n\nWith these methods, it\'s not so difficult to implement your own cookie management logic.\n']"
c# and excel automation - ending the running instance,"
I'm attempting Excel automation through C#. I have followed all the instructions from Microsoft on how to go about this, but I'm still struggling to discard the final reference(s) to Excel for it to close and to enable the GC to collect it.
A code sample follows. When I comment out the code block that contains lines similar to:
Sheet.Cells[iRowCount, 1] = data[""fullname""].ToString();

then the file saves and Excel quits. Otherwise the file saves but Excel is left running as a process. The next time this code runs it creates a new instance and they eventually build up.
Any help is appreciated. Thanks.
This is the barebones of my code:
        Excel.Application xl = null;
        Excel._Workbook wBook = null;
        Excel._Worksheet wSheet = null;
        Excel.Range range = null;

        object m_objOpt = System.Reflection.Missing.Value;

        try
        {
            // open the template
            xl = new Excel.Application();
            wBook = (Excel._Workbook)xl.Workbooks.Open(excelTemplatePath + _report.ExcelTemplate, false, false, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt);
            wSheet = (Excel._Worksheet)wBook.ActiveSheet;

            int iRowCount = 2;

            // enumerate and drop the values straight into the Excel file
            while (data.Read())
            {

                wSheet.Cells[iRowCount, 1] = data[""fullname""].ToString();
                wSheet.Cells[iRowCount, 2] = data[""brand""].ToString();
                wSheet.Cells[iRowCount, 3] = data[""agency""].ToString();
                wSheet.Cells[iRowCount, 4] = data[""advertiser""].ToString();
                wSheet.Cells[iRowCount, 5] = data[""product""].ToString();
                wSheet.Cells[iRowCount, 6] = data[""comment""].ToString();
                wSheet.Cells[iRowCount, 7] = data[""brief""].ToString();
                wSheet.Cells[iRowCount, 8] = data[""responseDate""].ToString();
                wSheet.Cells[iRowCount, 9] = data[""share""].ToString();
                wSheet.Cells[iRowCount, 10] = data[""status""].ToString();
                wSheet.Cells[iRowCount, 11] = data[""startDate""].ToString();
                wSheet.Cells[iRowCount, 12] = data[""value""].ToString();

                iRowCount++;
            }

            DirectoryInfo saveTo = Directory.CreateDirectory(excelTemplatePath + _report.FolderGuid.ToString() + ""\\"");
            _report.ReportLocation = saveTo.FullName + _report.ExcelTemplate;
            wBook.Close(true, _report.ReportLocation, m_objOpt);
            wBook = null;

        }
        catch (Exception ex)
        {
            LogException.HandleException(ex);
        }
        finally
        {
            NAR(wSheet);
            if (wBook != null)
                wBook.Close(false, m_objOpt, m_objOpt);
            NAR(wBook);
            xl.Quit();
            NAR(xl);
            GC.Collect();
        }

private void NAR(object o)
{
    try
    {
        System.Runtime.InteropServices.Marshal.ReleaseComObject(o);
    }
    catch { }
    finally
    {
        o = null;
    }
}


Update
No matter what I try, the 'clean' method or the 'ugly' method (see answers below), the excel instance still hangs around as soon as this line is hit:
wSheet.Cells[iRowCount, 1] = data[""fullname""].ToString();

If I comment that line out (and the other similar ones below it, obviously) the Excel app exits gracefully. As soon as one line per above is uncommented, Excel sticks around.
I think I'm going to have to check if there's a running instance prior to assigning the xl variable and hook into that instead. I forgot to mention that this is a windows service, but that shouldn't matter, should it?

",22k,"
            14
        ","['\nUPDATE (November 2016)\nI\'ve just read a convincing argument by Hans Passant that using GC.Collect is actually the right way to go. I no longer work with Office (thank goodness), but if I did I\'d probably want to give this another try - it would certainly simplify a lot of the (thousands of lines) of code I wrote trying to do things the ""right"" way (as I saw it then).\nI\'ll leave my original answer for posterity...\n\nAs Mike says in his answer, there is an easy way and a hard way to deal with this. Mike suggests using the easy way because... it\'s easier. I don\'t personally believe that\'s a good enough reason, and I don\'t believe it\'s the right way. It smacks of ""turn it off and on again"" to me.\nI have several years experience of developing an Office automation application in .NET, and these COM interop problems plagued me for the first few weeks & months when I first ran into the issue, not least because Microsoft are very coy about admitting there\'s a problem in the first place, and at the time good advice was hard to find on the web.\nI have a way of working that I now use virtually without thinking about it, and it\'s years since I had a problem. It\'s still important to be alive to all the hidden objects that you might be creating - and yes, if you miss one, you might have a leak that only becomes apparent much later. But it\'s no worse than things used to be in the bad old days of malloc/free.\nI do think there\'s something to be said for cleaning up after yourself as you go, rather than at the end. If you\'re only starting Excel to fill in a few cells, then maybe it doesn\'t matter - but if you\'re going to be doing some heavy lifting, then that\'s a different matter.\nAnyway, the technique I use is to use a wrapper class that implements IDisposable, and which in its Dispose method calls ReleaseComObject. That way I can use using statements to ensure that the object is disposed (and the COM object released) as soon as I\'m finished with it.\nCrucially, it\'ll get disposed/released even if my function returns early, or there\'s an Exception, etc. Also, it\'ll only get disposed/released if it was actually created in the first place - call me a pedant but the suggested code that attempts to release objects that may not actually have been created looks to me like sloppy code. I have a similar objection to using FinalReleaseComObject - you should know how many times you caused the creation of a COM reference, and should therefore be able to release it the same number of times.\nA typical snippet of my code might look like this (or it would, if I was using C# v2 and could use generics :-)):\nusing (ComWrapper<Excel.Application> application = new ComWrapper<Excel.Application>(new Excel.Application()))\n{\n  try\n  {\n    using (ComWrapper<Excel.Workbooks> workbooks = new ComWrapper<Excel.Workbooks>(application.ComObject.Workbooks))\n    {\n      using (ComWrapper<Excel.Workbook> workbook = new ComWrapper<Excel.Workbook>(workbooks.ComObject.Open(...)))\n      {\n        using (ComWrapper<Excel.Worksheet> worksheet = new ComWrapper<Excel.Worksheet>(workbook.ComObject.ActiveSheet))\n        {\n          FillTheWorksheet(worksheet);\n        }\n        // Close the workbook here (see edit 2 below)\n      }\n    }\n  }\n  finally\n  {\n    application.ComObject.Quit();\n  }\n}\n\nNow, I\'m not about to pretend that that isn\'t wordy, and the indentation caused by object creation can get out of hand if you don\'t divide stuff into smaller methods. This example is something of a worst case, since all we\'re doing is creating objects. Normally there\'s a lot more going on between the braces and the overhead is much less.\nNote that as per the example above I would always pass the \'wrapped\' objects between methods, never a naked COM object, and it would be the responsibility of the caller to dispose of it (usually with a using statement). Similarly, I would always return a wrapped object, never a naked one, and again it would be the responsibility of the caller to release it. You could use a different protocol, but it\'s important to have clear rules, just as it was when we used to have to do our own memory management.\nThe ComWrapper<T> class used here hopefully requires little explanation. It simply stores a reference to the wrapped COM object, and releases it explicitly (using ReleaseComObject) in its Dispose method. The ComObject method simply returns a typed reference to the wrapped COM object.\nHope this helps!\nEDIT: I\'ve only now followed the link over to Mike\'s answer to another question, and I see that another answer to that question there has a link to a wrapper class, much as I suggest above.\nAlso, with regard to Mike\'s answer to that other question, I have to say I was very nearly seduced by the ""just use GC.Collect"" argument. However, I was mainly drawn to that on a false premise; it looked at first glance like there would be no need to worry about the COM references at all. However, as Mike says you do still need to explicitly release the COM objects associated with all your in-scope variables - and so all you\'ve done is reduce rather than remove the need for COM-object management. Personally, I\'d rather go the whole hog. \nI also note a tendency in lots of answers to write code where everything gets released at the end of a method, in a big block of ReleaseComObject calls. That\'s all very well if everything works as planned, but I would urge anyone writing serious code to consider what would happen if an exception were thrown, or if the method had several exit points (the code would not be executed, and thus the COM objects would not be released). This is why I favor the use of ""wrappers"" and usings. It\'s wordy, but it does make for bulletproof code.\nEDIT2: I\'ve updated the code above to indicate where the workbook should be closed with or without saving changes. Here\'s the code to save changes:\nobject saveChanges = Excel.XlSaveAction.xlSaveChanges;\n\nworkbook.ComObject.Close(saveChanges, Type.Missing, Type.Missing);\n\n...and to not save changes, simply change xlSaveChanges to xlDoNotSaveChanges.\n', '\nWhat is happening is that your call to:\nSheet.Cells[iRowCount, 1] = data[""fullname""].ToString();\n\nIs essentially the same as:\nExcel.Range cell = Sheet.Cells[iRowCount, 1];\ncell.Value = data[""fullname""].ToString();\n\nBy doing it this way, you can see that you are creating an Excel.Range object, and then assigning a value to it. This way also gives us a named reference to our range variable, the cell variable, that allows us to release it directly if we wanted. So you could clean up your objects one of two ways:\n(1) The difficult and ugly way:\nwhile (data.Read())\n{\n    Excel.Range cell = Sheet.Cells[iRowCount, 1];\n    cell.Value = data[""fullname""].ToString();\n    Marshal.FinalReleaseComObject(cell);\n\n    cell = Sheet.Cells[iRowCount, 2];\n    cell.Value = data[""brand""].ToString();\n    Marshal.FinalReleaseComObject(cell);\n\n    cell = Sheet.Cells[iRowCount, 3];\n    cell.Value = data[""agency""].ToString();\n    Marshal.FinalReleaseComObject(cell);\n\n    // etc...\n}\n\nIn the above, we are releasing each range object via a call to Marshal.FinalReleaseComObject(cell) as we go along.\n(2) The easy and clean way: \nLeave your code exactly as you currently have it, and then at the end you can clean up as follows:\nGC.Collect();\nGC.WaitForPendingFinalizers();\n\nif (wSheet != null)\n{\n    Marshal.FinalReleaseComObject(wSheet)\n}\nif (wBook != null)\n{\n    wBook.Close(false, m_objOpt, m_objOpt);\n    Marshal.FinalReleaseComObject(wBook);\n}\nxl.Quit();\nMarshal.FinalReleaseComObject(xl);\n\nIn short, your existing code is extremely close. If you just add calls to GC.Collect() and GC.WaitForPendingFinalizers() before your \'NAR\' calls, I think it should work for you. (In short, both Jamie\'s code and Ahmad\'s code are correct. Jamie\'s is cleaner, but Ahmad\'s code is an easier ""quick fix"" for you because you would only have to add the calls to calls to GC.Collect() and GC.WaitForPendingFinalizers() to your existing code.)\nJamie and Amhad also listed links to the .NET Automation Forum that I participate on (thanks guys!) Here are a couple of related posts that I\'ve made here on StackOverflow :\n(1) How to properly clean up Excel interop objects in C#\n(2) C# Automate PowerPoint Excel -- PowerPoint does not quit\nI hope this helps, Sean...\nMike\n', ""\nAdd the following before your call to xl.Quit():\nGC.Collect(); \nGC.WaitForPendingFinalizers(); \n\nYou can also use Marshal.FinalReleaseComObject() in your NAR method instead of ReleaseComObject. ReleaseComObject decrements the reference count by 1 while FinalReleaseComObject releases all references so the count is 0.\nSo your finally block would look like:\nfinally\n{\n    GC.Collect(); \n    GC.WaitForPendingFinalizers(); \n\n    NAR(wSheet);\n    if (wBook != null)\n        wBook.Close(false, m_objOpt, m_objOpt);\n    NAR(wBook);\n    xl.Quit();\n    NAR(xl);\n}\n\nUpdated NAR method:\nprivate void NAR(object o)\n{\n    try\n    {\n        System.Runtime.InteropServices.Marshal.FinalReleaseComObject(o);\n    }\n    catch { }\n    finally\n    {\n        o = null;\n    }\n}\n\nI had researched this awhile ago and in examples I found usually the GC related calls were at the end after closing the app. However, there's an MVP (Mike Rosenblum) that mentions that it ought to be called in the beginning. I've tried both ways and they've worked. I also tried it without the WaitForPendingFinalizers and it worked although it shouldn't hurt anything. YMMV.\nHere are the relevant links by the MVP I mentioned (they're in VB but it's not that different):\n\nhttp://www.xtremevbtalk.com/showthread.php?p=1157109#post1157109\nhttp://www.xtremevbtalk.com/showthread.php?s=bcdea222412c5cbfa7f02cfaf8f7b33f&p=1156479#post1156479\n\n"", '\nAs others have already covered InterOp i would suggest that if you deal with Excel files with XLSX extension you should use EPPlus which will make your Excel nightmares go away.\n', '\nI have just answered this question here:\nKilling excel process by its main window hWnd\n', '\nIts over 4 years since this was posted but I came across the same problem and was able to solve it.  Apparently just accessing the Cells array creates a COM object. So if you were to do:\n    wSheet = (Excel._Worksheet)wBook.ActiveSheet;\n    Microsoft.Office.Interop.Excel.Range cells = wSheet.Cells;\n\n    int iRowCount = 2;\n\n    // enumerate and drop the values straight into the Excel file\n    while (data.Read())\n    {\n        Microsoft.Office.Interop.Excel.Range cell = cells[iRowCount, 1];\n        cell  = data[""fullname""].ToString();\n        Marshal.FinalReleaseComObject(cell);\n    }\n    Marshal.FinalReleaseComObject(cells);\n\nand then the rest of your cleanup it should fix the problem.\n', '\nWhat I ended up doing to solve a similar problem was get the process Id and kill that as a last resort...\n[DllImport(""user32.dll"", SetLastError = true)]\n   static extern IntPtr GetWindowThreadProcessId(int hWnd, out IntPtr lpdwProcessId);\n\n...\n\nobjApp = new Excel.Application();\n\nIntPtr processID;\nGetWindowThreadProcessId(objApp.Hwnd, out processID);\nexcel = Process.GetProcessById(processID.ToInt32());\n\n...\n\nobjApp.Application.Quit();\nMarshal.FinalReleaseComObject(objApp);\n_excel.Kill();\n\n', ""\nHere's the contents of my hasn't-failed-yet finally block for cleaning up Excel automation. My application leaves Excel open so there's no Quit call. The reference in the comment was my source.\nfinally\n{\n    // Cleanup -- See http://www.xtremevbtalk.com/showthread.php?t=160433\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n    // Calls are needed to avoid memory leak\n    Marshal.FinalReleaseComObject(sheet);\n    Marshal.FinalReleaseComObject(book);\n    Marshal.FinalReleaseComObject(excel);\n}\n\n"", '\nHave you considered using a pure .NET solution such as SpreadsheetGear for .NET? Here is what your code might like like using SpreadsheetGear:\n// open the template            \nusing (IWorkbookSet workbookSet = SpreadsheetGear.Factory.GetWorkbookSet())\n{\n    IWorkbook wBook = workbookSet.Workbooks.Open(excelTemplatePath + _report.ExcelTemplate);\n    IWorksheet wSheet = wBook.ActiveWorksheet;\n    int iRowCount = 2;\n    // enumerate and drop the values straight into the Excel file            \n    while (data.Read())\n    {\n        wSheet.Cells[iRowCount, 1].Value = data[""fullname""].ToString();\n        wSheet.Cells[iRowCount, 2].Value = data[""brand""].ToString();\n        wSheet.Cells[iRowCount, 3].Value = data[""agency""].ToString();\n        wSheet.Cells[iRowCount, 4].Value = data[""advertiser""].ToString();\n        wSheet.Cells[iRowCount, 5].Value = data[""product""].ToString();\n        wSheet.Cells[iRowCount, 6].Value = data[""comment""].ToString();\n        wSheet.Cells[iRowCount, 7].Value = data[""brief""].ToString();\n        wSheet.Cells[iRowCount, 8].Value = data[""responseDate""].ToString();\n        wSheet.Cells[iRowCount, 9].Value = data[""share""].ToString();\n        wSheet.Cells[iRowCount, 10].Value = data[""status""].ToString();\n        wSheet.Cells[iRowCount, 11].Value = data[""startDate""].ToString();\n        wSheet.Cells[iRowCount, 12].Value = data[""value""].ToString();\n        iRowCount++;\n    }\n    DirectoryInfo saveTo = Directory.CreateDirectory(excelTemplatePath + _report.FolderGuid.ToString() + ""\\\\"");\n    _report.ReportLocation = saveTo.FullName + _report.ExcelTemplate;\n    wBook.SaveAs(_report.ReportLocation, FileFormat.OpenXMLWorkbook);\n}\n\nIf you have more than a few rows, you might be shocked at how much faster it runs. And you will never have to worry about a hanging instance of Excel.\nYou can download the free trial here and try it for yourself.\nDisclaimer: I own SpreadsheetGear LLC\n', '\nThe easiest way to paste code is through a question - this doesn\'t mean that I have answered my own question (unfortunately).\nApologies to those trying to help me - I was not able to get back to this until now. It still has me stumped...\nI have completely isolated the Excel code into one function as per\nprivate bool GenerateDailyProposalsReport(ScheduledReport report)\n{\n    // start of test\n\n    Excel.Application xl = null;\n    Excel._Workbook wBook = null;\n    Excel._Worksheet wSheet = null;\n    Excel.Range xlrange = null;\n    object m_objOpt = System.Reflection.Missing.Value;\n\n    xl = new Excel.Application();\n    wBook = (Excel._Workbook)xl.Workbooks.Open(@""E:\\Development\\Romain\\APN\\SalesLinkReportManager\\ExcelTemplates\\DailyProposalReport.xls"", false, false, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt);\n    wSheet = (Excel._Worksheet)wBook.ActiveSheet;\n    xlrange = wSheet.Cells[2, 1] as Excel.Range;\n\n    // PROBLEM LINE ************\n    xlrange.Value2 = ""fullname"";\n    //**************************\n\n    wBook.Close(true, @""c:\\temp\\DailyProposalReport.xls"", m_objOpt);\n    xl.Quit();\n\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n\n    Marshal.FinalReleaseComObject(xlrange);\n    Marshal.FinalReleaseComObject(wSheet);\n    Marshal.FinalReleaseComObject(wBook);\n    Marshal.FinalReleaseComObject(xl);\n\n    xlrange = null;\n    wSheet = null;\n    wBook = null;\n    xl = null;\n\n    // end of test\n    return true;\n\n}\n\nIf I comment out the PROBLEM LINE above, the instance of Excel is released from memory. As it stands, it does not.\nI\'d appreciate any further help on this as time is fleeting and a deadline looms (don\'t they all). \nPlease ask if you need more information.\nThanks in anticipation.\nAddendum\nA bit more information that may or may not shed more light on this. I have resorted to killing the process (stopgap measure) after a certain time lapse (5-10 seconds to give Excel time to finish it\'s processes). I have two reports scheduled - the first report is created and saved to disk and the Excel process is killed, then emailed. The second is created, saved to disk, the process is killed but suddenly there is an error when attempting the email. The error is:\n The process cannot access the file\'....\' etc\nSo even when the Excel app has been killed, the actual Excel file is still being held by the windows service. I have to kill the service to delete the file...\n', '\nI\'m afraid I am running out of ideas here Sean. :-(\nGary could have some thoughts, but although his wrapper approach is very solid, it won\'t actually help you in this case because you are already doing everything pretty much correctly.\nI\'ll list a few thoughts here. I don\'t see how any of them will actually work because your mystery line \nxlrange.Value2 = ""fullname"";\n\nwould not seem to be impacted by any of these ideas, but here goes:\n(1) Don\'t make use of the _Workbook and _Worksheet interfaces. Use Workbook and Worksheet instead. (For more on this see: Excel interop: _Worksheet or Worksheet?.)\n(2) Any time you have two dots (""."") on the same line when accessing an Excel object, break it up into two lines, assigning each object to a named variable. Then, within the cleanup section of your code, explicitly release each variable using Marshal.FinalReleaseComObject().\nFor example, your code here:\n wBook = (Excel._Workbook)xl.Workbooks.Open(@""E:\\Development\\Romain\\APN\\SalesLinkReportManager\\ExcelTemplates\\DailyProposalReport.xls"", false, false, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt, m_objOpt);\n\ncould be broken up to:\nExcel.Workbooks wBooks = xl.Workbooks;\nwBook = wBooks.Open(""@""E:\\Development\\...\\DailyProposalReport.xls"", etc...);\n\nAnd then later, within the cleanup section, you would have:\nMarshal.FinalReleaseComObject(xlrange);\nMarshal.FinalReleaseComObject(wSheet);\nMarshal.FinalReleaseComObject(wBook);\nMarshal.FinalReleaseComObject(wBooks); // <-- Added\nMarshal.FinalReleaseComObject(xl);\n\n(3) I am not sure what is going on with your Process.Kill approach. If you call wBook.Close() and then xl.Quit() before calling Process.Kill(), you should have no troubles. Workbook.Close() does not return execution to you until the workbook is closed, and Excel.Quit() will not return execution until Excel has finished shutting down (although it might still be hanging).  \nAfter calling Process.Kill(), you can check the Process.HasExited property in a loop, or, better, call the Process.WaitForExit() method which will pause until it has exited for you. I would guess that this will generally take well under a second to occur. It is better to wait less time and be certain than to wait 5 - 10 seconds and only be guessing.\n(4) You should try these cleanup ideas that I\'ve listed above, but I am starting to suspect that you might have an issue with other processes that might be working with Excel, such as an add-in or anti-virus program. These add-ins can cause Excel to hang if they are not done correctly. If this occurs, it can be very difficult or impossible to get Excel to release. You would need to figure out the offending program and then disable it. Another possibility is that operating as a Windows Service somehow is an issue. I don\'t see why it would be, but I do not have experience automating Excel via a Windows Service, so I can\'t say. If your problems are related to this, then using Process.Kill will likely be your only resort here.\nThis is all I can think of off-hand, Sean. I hope this helps. Let us know how it goes...\n-- Mike\n', '\nSean,\nI\'m going to re-post your code again with my changes (below). I\'ve avoided changing your code too much, so I haven\'t added any exception handling, etc. This code is not robust.\nprivate bool GenerateDailyProposalsReport(ScheduledReport report)\n{\n    Excel.Application xl = null;\n    Excel.Workbooks wBooks = null;\n    Excel.Workbook wBook = null;\n    Excel.Worksheet wSheet = null;\n    Excel.Range xlrange = null;\n    Excel.Range xlcell = null;\n\n    xl = new Excel.Application();\n\n    wBooks = xl.Workbooks;\n\n    wBook = wBooks.Open(@""DailyProposalReport.xls"", false, false, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);\n\n    wSheet = wBook.ActiveSheet;\n\n    xlrange = wSheet.Cells;\n\n    xlcell = xlrange[2, 1] as Excel.Range;\n\n    xlcell.Value2 = ""fullname"";\n\n    Marshal.ReleaseComObject(xlcell);\n    Marshal.ReleaseComObject(xlrange);\n    Marshal.ReleaseComObject(wSheet);\n\n    wBook.Close(true, @""c:\\temp\\DailyProposalReport.xls"", Type.Missing);\n\n    Marshal.ReleaseComObject(wBook);\n    Marshal.ReleaseComObject(wBooks);\n\n    xl.Quit();\n\n    Marshal.ReleaseComObject(xl);\n\n    return true;\n}\n\nPoints to note:\n\nThe Workbooks method of the\nApplication class creates a\nWorkbooks object which holds a\nreference to the corresponding COM\nobject, so we need to ensure we\nsubsequently release that reference,\nwhich is why I added the variable\nwBooks and the corresponding call to ReleaseComObject.\nSimilarly, the Cells method of the\nWorksheet object returns a Range\nobject with another COM reference,\nso we need to clean that up too.\nHence the need for 2 separate Range variables.\nI\'ve released the COM references\n(using ReleaseComObject) as soon\nas they\'re no longer needed, which I\nthink is good practice even if it\nisn\'t strictly necessary. Also, (and\nthis may be superstition) I\'ve\nreleased all the objects owned by\nthe workbook before closing the\nworkbook, and released the workbook\nbefore closing Excel.\nI\'m not calling GC.Collect etc.\nbecause it shouldn\'t be necessary.\nReally!\nI\'m using ReleaseComObject rather\nthan FinalReleaseComObject, because it should be perfectly sufficient.\nI\'m not null-ing the variables after\nuse; once again, it\'s not doing\nanything worthwhile.\nNot relevant\nhere, but I\'m using Type.Missing\ninstead of\nSystem.Reflection.Missing.Value for\nconvenience. Roll on C#v4 where\noptional parameters will be\nsupported by the compiler!\n\nI\'ve not been able to compile or run this code, but I\'m pretty confident it\'ll work. Good luck!\n', ""\nThere's no need to use the excel com objects from C#. You can use OleDb to modify the sheets.\nhttp://www.codeproject.com/KB/office/excel_using_oledb.aspx\n"", '\nI was having a similar problem.\nI removed _worksheet and _workbook and all was well.\n']"
"PsExec Throws Error Messages, but works without any problems","
So we are using PsExec a lot in our automations to install virtual machines, as we can't use ps remote sessions with our windows 2003 machines. Everything works great and there are no Problems, but PsExec keeps throwing errors, even every command is being carried out without correctly. 
For example:
D:\tools\pstools\psexec.exe $guestIP -u $global:default_user -p $global:default_pwd -d -i C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -command ""Enable-PSRemoting -Force""

Enables the PsRemoting on the guest, but also throws this error message:
psexec.exe : 
Bei D:\Scripts\VMware\VMware_Module5.ps1:489 Zeichen:29
+     D:\tools\pstools\psexec.exe <<<<  $guestIP -u $global:default_user -p $global:default_pwd -d -i C:\Windows\System32\WindowsPowerShell\
v1.0\powershell.exe -command ""Enable-PSRemoting -Force""
+ CategoryInfo          : NotSpecified: (:String) [], RemoteException
+ FullyQualifiedErrorId : NativeCommandError

PsExec v1.98 - Execute processes remotely
Copyright (C) 2001-2010 Mark Russinovich
Sysinternals - www.sysinternals.com


Connecting to 172.17.23.95...Starting PsExec service on 172.17.23.95...Connecting with PsExec service on 172.17.23.95...Starting C:\Windows\
System32\WindowsPowerShell\v1.0\powershell.exe on 172.17.23.95...
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe started on 172.17.23.95 with process ID 2600.

These kinds of error messages apear ALWAYS no matter how i use psexec, like with quotes, with vriables/fixed values, other flags, etc. Does anybody has an idea how i could fix this? It is not a real problem, but it makes finding errors a pain in the ass, because the ""errors"" are everywhere. Disabling the error messages of psexec at all would also help...
",21k,"
            11
        ","['\nThis is because PowerShell sometimes reports a NativeCommandError when a process writes to STDERR. PsExec writes the infoline\nPsExec v1.98 - Execute processes remotely\nCopyright (C) 2001-2010 Mark Russinovich\nSysinternals - www.sysinternals.com\n\nto STDERR which means it can cause this.\nFor more information, see these questions / answers:\n\nhttps://stackoverflow.com/a/1416933/478656\nhttps://stackoverflow.com/a/11826589/478656\nhttps://stackoverflow.com/a/10666208/478656\n\n', ""\nredirect stderr to null worked best for me. see below link\nError when calling 3rd party executable from Powershell when using an IDE\nHere's the relevant section from that link:\nTo avoid this you can redirect stderr to null e.g.:\ndu 2> $null\nEssentially the console host and ISE (as well as remoting) treat the stderr stream differently. On the console host it was important for PowerShell to support applications like edit.com to work along with other applications that write colored output and errors to the screen. If the I/O stream is not redirected on console host, PowerShell gives the native EXE a console handle to write to directly. This bypasses PowerShell so PowerShell can't see that there are errors written so it can't report the error via $error or by writing to PowerShell's stderr stream.\nISE and remoting don't need to support this scenario so they do see the errors on stderr and subsequently write the error and update $error.\n.\\PsExec.exe \\$hostname -u $script:userName -p $script:password /accepteula -h cmd /c $powerShellArgs 2> $null\n"", '\nI have created a psexec wrapper for powershell, which may be helpful to people browsing this question:\nfunction Return-CommandResultsUsingPsexec {\n    param(\n        [Parameter(Mandatory=$true)] [string] $command_str,\n        [Parameter(Mandatory=$true)] [string] $remote_computer,\n        [Parameter(Mandatory=$true)] [string] $psexec_path,\n        [switch] $include_blank_lines\n    )\n\n    begin {\n        $remote_computer_regex_escaped = [regex]::Escape($remote_computer)\n\n        # $ps_exec_header = ""`r`nPsExec v2.2 - Execute processes remotely`r`nCopyright (C) 2001-2016 Mark Russinovich`r`nSysinternals - www.sysinternals.com`r`n""\n\n        $ps_exec_regex_headers_array = @(\n            \'^\\s*PsExec v\\d+(?:\\.\\d+)? - Execute processes remotely\\s*$\',\n            \'^\\s*Copyright \\(C\\) \\d{4}(?:-\\d{4})? Mark Russinovich\\s*$\',\n            \'^\\s*Sysinternals - www\\.sysinternals\\.com\\s*$\'\n        )\n\n        $ps_exec_regex_info_array = @(\n            (\'^\\s*Connecting to \' + $remote_computer_regex_escaped + \'\\.{3}\\s*$\'),\n            (\'^\\s*Starting PSEXESVC service on \' + $remote_computer_regex_escaped + \'\\.{3}\\s*$\'),\n            (\'^\\s*Connecting with PsExec service on \' + $remote_computer_regex_escaped + \'\\.{3}\\s*$\'),\n            (\'^\\s*Starting .+ on \' + $remote_computer_regex_escaped + \'\\.{3}\\s*$\')\n        )\n\n        $bypass_regex_array = $ps_exec_regex_headers_array + $ps_exec_regex_info_array\n\n        $exit_code_regex_str = (\'^.+ exited on \' + $remote_computer_regex_escaped + \' with error code (\\d+)\\.\\s*$\')\n\n        $ps_exec_args_str = (\'""\\\\\' + $remote_computer + \'"" \' + $command_str)\n    }\n\n    process {\n        $return_dict = @{\n            \'std_out\' = (New-Object \'system.collections.generic.list[string]\');\n            \'std_err\' = (New-Object \'system.collections.generic.list[string]\');\n            \'exit_code\' = $null;\n            \'bypassed_std\' = (New-Object \'system.collections.generic.list[string]\');\n        }\n\n        $process_info = New-Object System.Diagnostics.ProcessStartInfo\n        $process_info.RedirectStandardError = $true\n        $process_info.RedirectStandardOutput = $true\n        $process_info.UseShellExecute = $false\n        $process_info.FileName = $psexec_path\n        $process_info.Arguments = $ps_exec_args_str\n\n        $process = New-Object System.Diagnostics.Process\n        $process.StartInfo = $process_info\n        $process.Start() | Out-Null\n\n        $std_dict = [ordered] @{\n            \'std_out\' = New-Object \'system.collections.generic.list[string]\';\n            \'std_err\' = New-Object \'system.collections.generic.list[string]\';\n        }\n\n        # $stdout_str = $process.StandardOutput.ReadToEnd()\n        while ($true) {\n            $line = $process.StandardOutput.ReadLine()\n            if ($line -eq $null) {\n                break\n            }\n            $std_dict[\'std_out\'].Add($line)\n        }\n\n        # $stderr_str = $process.StandardError.ReadToEnd()\n        while ($true) {\n            $line = $process.StandardError.ReadLine()\n            if ($line -eq $null) {\n                break\n            }\n            $std_dict[\'std_err\'].Add($line)\n        }\n\n        $process.WaitForExit()\n\n        ForEach ($std_type in $std_dict.Keys) {\n            ForEach ($line in $std_dict[$std_type]) {\n                if ((-not $include_blank_lines) -and ($line -match \'^\\s*$\')) {\n                    continue\n                }\n\n                $do_continue = $false\n                ForEach ($regex_str in $bypass_regex_array) {\n                    if ($line -match $regex_str) {\n                        $return_dict[\'bypassed_std\'].Add($line)\n                        $do_continue = $true\n                        break\n                    }\n                }\n                if ($do_continue) {\n                    continue\n                }\n\n                $exit_code_regex_match = [regex]::Match($line, $exit_code_regex_str)\n\n                if ($exit_code_regex_match.Success) {\n                    $return_dict[\'exit_code\'] = [int] $exit_code_regex_match.Groups[1].Value\n                } elseif ($std_type -eq \'std_out\') {\n                    $return_dict[\'std_out\'].Add($line)\n                } elseif ($std_type -eq \'std_err\') {\n                    $return_dict[\'std_err\'].Add($line)\n                } else {\n                    throw \'this conditional should never be true; if so, something was coded incorrectly\'\n                }\n            }\n        }\n\n        return $return_dict\n    }\n}\n\n']"
"IE9, Automation server can't create object error while using CertEnroll.dll","
In my web page, a JS block like this:
var classFactory = new ActiveXObject(""X509Enrollment.CX509EnrollmentWebClassFactory"");

// Other initialize CertEnroll Objects

It works fine in windows7(32bit or 64bit) with IE8(32bit), as long as I change the IE8 secure setting, enable Initializing and Script ActiveX controls not marked as safe.
But when use IE9(32bit), I try anything I can find on web, it reports error ""Automation server can't create object.""
I even created a static html file, save it in my hard disk, and then open it with IE9(32bit), it worked fine. Then I put the html file on my web site, visit the html file with url, then it came up with the error message again.
I have worked on this problem for 4 days, any suggestion would be appreciated.
3Q. I hope you can read my words as I'm not an native English speaker.
",99k,"
            11
        ","['\na) Go to Tools-->Internet Options\nb) Select security tab\nc) Click on Trusted Sites (or Local Intranet depending on whether your site is trusted or not)\nd) Click on Custom Level\ne) Ensure that ""Initialize and script active x controls is not marked safe for scripting""  is enabled - this comes under Activex controls and plug-ins section towards 1/4th of the scroll bar.\nClick OK, OK.\nOnce this is completed, clear the browser cookies and cache. Close all your browser sessions. Reopen the IE to launch your site. \nTry to disable the setting in step (e) to see if the problem comes back - that should give more insight to the problem.\n']"
How to send input to the console as if the user is typing?,"
This is my problem. I have a program that has to run in a TTY, cygwin provides this TTY. When I redirect stdIn the program fails because it does not have a TTY. I cannot modify this program, and need some way of automating it. 
How can I grab the cmd.exe window and send it data and make it think the user is typing it? 
I'm using C#, I believe there is a way to do it with java.awt.Robot but I have to use C# for other reasons.
",13k,"
            7
        ","['\nI have figured out how to send the input to the console.  I used what Jon Skeet said.  I am not 100% sure this is the correct way to implement this.\nIf there are any comments on to make this better I would love to here.  I did this just to see if I could figure it out.\nHere is the program I stared that waited for input form the user\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // This is needed to wait for the other process to wire up.\n        System.Threading.Thread.Sleep(2000);\n\n        Console.WriteLine(""Enter Pharse: "");\n\n        string pharse = Console.ReadLine();\n\n        Console.WriteLine(""The password is \'{0}\'"", pharse);\n\n\n        Console.WriteLine(""Press any key to exit. . ."");\n        string lastLine = Console.ReadLine();\n\n        Console.WriteLine(""Last Line is: \'{0}\'"", lastLine);\n    }\n}\n\nThis is the console app writing to the other one\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // Find the path of the Console to start\n        string readFilePath = System.IO.Path.GetFullPath(@""..\\..\\..\\ReadingConsole\\bin\\Debug\\ReadingConsole.exe"");\n\n        ProcessStartInfo startInfo = new ProcessStartInfo(readFilePath);\n\n        startInfo.RedirectStandardOutput = true;\n        startInfo.RedirectStandardInput = true;\n        startInfo.WindowStyle = ProcessWindowStyle.Hidden;\n        startInfo.CreateNoWindow = true;\n        startInfo.UseShellExecute = false;\n\n        Process readProcess = new Process();\n        readProcess.StartInfo = startInfo;\n\n        // This is the key to send data to the server that I found\n        readProcess.OutputDataReceived += new DataReceivedEventHandler(readProcess_OutputDataReceived);\n\n        // Start the process\n        readProcess.Start();\n\n        readProcess.BeginOutputReadLine();\n\n        // Wait for other process to spin up\n        System.Threading.Thread.Sleep(5000);\n\n        // Send Hello World\n        readProcess.StandardInput.WriteLine(""Hello World"");\n\n        readProcess.StandardInput.WriteLine(""Exit"");\n\n        readProcess.WaitForExit();\n    }\n\n    static void readProcess_OutputDataReceived(object sender, DataReceivedEventArgs e)\n    {\n        // Write what was sent in the event\n        Console.WriteLine(""Data Recieved at {1}: {0}"", e.Data, DateTime.UtcNow.Ticks);\n    }\n}\n\n', '\nThis sounds like a task for SendKeys(). It\'s not C#, but VBScript, but nontheless - you asked for some way of automating it:\nSet Shell = CreateObject(""WScript.Shell"")\n\nShell.Run ""cmd.exe /k title RemoteControlShell""\nWScript.Sleep 250\n\nShell.AppActivate ""RemoteControlShell""\nWScript.Sleep 250\n\nShell.SendKeys ""dir{ENTER}""\n\n', '\nCan you start the program (or cygwin) within your code, using ProcessStartInfo.RedirectStandardInput (and output/error) to control the data flow?\n', '\nI had similar problem some time ago, cygwin should write some useful information (exact cygwin function, error text and WINAPI error code) to error stream, you should redirect it somewhere and read what it writes.\n']"
IE11 Frame Notification Bar Save button,"
On a 64-bit system with MS Excel 2010 and IE11 I'm using this code to automate download process from a website:  
hWnd = FindWindowEx(IE.hWnd, 0, ""Frame Notification Bar"", vbNullString)

If hWnd Then
    hWnd = FindWindowEx(hWnd, 0&, ""Button"", ""Save"")
End If

If hWnd Then
    SetForegroundWindow (hWnd)
    Sleep 600
    SendMessage hWnd, BM_CLICK, 0, 0
End If

Everything goes OK until the Frame Notification Bar appears. I'm getting the HWND of this window, but can't get the HWND of the ""Save"" button, so that I can send click to it.
",10k,"
            4
        ","['\nIf somebody is still trying to find the solution, for IE11 it\'s here.\nOn the very first line of the code of Vahagn Sargsyan above, instead of ""Frame Notification Bar"" get the exact title of the dialog box, which might be in English ""View Downloads - Internet Explorer"". This allows you to grab the right hWnd.\nBecause in IE11 there no more button accelerator to Save files, follow the solution posted here by pmr.\nFrom pmr code, just get the following lines:\nSet e = o.ElementFromHandle(ByVal h)\nDim iCnd As IUIAutomationCondition\nSet iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, ""Save"")\n\nDim Button As IUIAutomationElement\nSet Button = e.FindFirst(TreeScope_Subtree, iCnd)\nDim InvokePattern As IUIAutomationInvokePattern\nSet InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\nInvokePattern.Invoke\n\nThis should solve your issue. This unlocked the situation for me with French localisation.\n', ""\nI'm assuming you're talking about that little frame that pops up at the bottom of IE giving you options to Open, Save or Cancel. If so, you might wanna check out another answer to a similar question asked here.\nA secondary solution would be a more complicated one (here), but works nonetheless. You'll have to import the modules from the workbook provided in this forum (you'll need to signup for membership though, but its free so just do it.) and that'll do basically what you need, albeit in a way that allows you more flexibility (choose filepath, filename, etc) and also a little more convoluted. \nEither way, hope I helped. \n""]"
VBA:IE-How to assign pathname to file input tag without popup file upload form?,"
I am currently doing automaiton for file uploading
Below is HTML tag for input file tag:
 <input name=""file"" title=""Type the path of the file or click the Browse button to find the file."" id=""file"" type=""file"" size=""20"">

And below is button HTML Tag:
<input name=""Attach"" title=""Attach File (New Window)"" class=""btn"" id=""Attach"" onclick=""javascript:setLastMousePosition(event); window.openPopup('/widg/uploadwaiting.jsp', 'uploadWaiting', 400, 130, 'width=400,height=130,resizable=no,toolbar=no,status=no,scrollbars=no,menubar=no,directories=no,location=no,dependant=no', true);"" type=""submit"" value=""Attach File"">

My VBA coding is:
Dim filee As Object
Set filee = mydoc.getElementById(""file"")
filee.Value = filenamepath

Set attach = mydoc.getElementsByName(""Attach"")
attach(0).Click

When I am running this coding, input filepath box not assign path name so i am getting chose file path.
Find attach screenshot.
 
Finally i have tried below code but that send key not executing  
Dim filee As Object
    Set filee = mydoc.getElementById(""file"")
    filee.Click

obj.SetText filename
obj.PutInClipboard
SendKeys ""^v""
SendKeys ""{ENTER}""

Set attach = mydoc.getElementsByName(""Attach"")
    attach(0).Click

Set finall = mydoc.getElementsByName(""cancel"")
    finall(0).Click

Kindly tell me the windows API program to assign my file name directory in fine name: input box on opened Choose File to Open explorer and click the open button. 
",7k,"
            2
        ","['\nI fixed this issue by running external VBScript contain file path to set it on \'Choose File to Upload\' pop up window using SendKeys method after send Enter Key to close this pop up, and this run successfully because the extranl VBScript run on another process so it will not stuck on VBA code.\nNotes:\n1- I dynamically create the external VBScript from VBA code and save it on Temp folder after that I run this script using WScript.Shell.Run to excute it on another thread\n1- At the begining of the external VBScript I set 1 sec delay to be sure the \'Choose File to Upload\' pop up window already opened from VBA.\nAnd here is the complete code:\n....\n....\n\nSet filee = mydoc.getElementById(""file"")\n\n    CompleteUploadThread MyFilePath\n    filee.Foucs\n    filee.Click\n\n....\n....\n\nPrivate Sub CompleteUploadThread(ByVal fName As String)\n    Dim strScript As String, sFileName As String, wsh As Object\n    Set wsh = VBA.CreateObject(""WScript.Shell"")\n    \'---Create VBscript String---\n    strScript = ""WScript.Sleep 1000"" & vbCrLf & _\n                ""Dim wsh"" & vbCrLf & _\n                ""Set wsh = CreateObject(""""WScript.Shell"""")"" & vbCrLf & _\n                ""wsh.SendKeys """""" & fName & """""""" & vbCrLf & _\n                ""wsh.SendKeys """"{ENTER}"""""" & vbCrLf & _\n                ""Set wsh = Nothing""\n    \'---Save the VBscript String to file---\n    sFileName = wsh.ExpandEnvironmentStrings(""%Temp%"") & ""\\zz_automation.vbs""\n    Open sFileName For Output As #1\n    Print #1, strScript\n    Close #1\n    \'---Execute the VBscript file asynchronously---\n    wsh.Run """""""" & sFileName & """"""""\n    Set wsh = Nothing\nEnd Sub\n\n', '\nAs setting the value of a file input element is disabled due to security reasons, the ""send keys"" method seems to be the only option for automating file uploads using the IE API.\nI just stumbled over the same problem that the code after the Click does not seem to be executed - that is, unless the dialog is closed. This indicates that the Click method is blocking, making it impossible to interact with the dialog from within the macro.\nI could solve that by using a different method to open the dialog: by setting the focus to the file element with Focus, and sending the space key with SendKeys.\nIn your case, replace\nfilee.Click\n\nwith\nfilee.Focus\nSendKeys "" ""\n\n', '\nleemes\'s method(Sending  key to the file selection button on IE) is an easy way to automate the file selection procedure.\nIn addition, if IEObject.Visible sometimes fails to give focus to the IE Window,\n we\'d better send the IE window to the top-most position using Windows API before using \'SendKeys\' like following:\n#If VBA7 Then\n    Declare PtrSafe Function SetForegroundWindow Lib ""user32"" (ByVal hwnd As LongPtr) As LongPtr\n    Declare PtrSafe Function FindWindow Lib ""user32"" Alias ""FindWindowA"" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As LongPtr\n#Else\n    Declare Function SetForegroundWindow Lib ""user32"" (ByVal hwnd As Long) As Long\n    Declare Function FindWindow Lib ""user32"" Alias ""FindWindowA"" (ByVal lpClassName As Any, ByVal lpWindowName As Any) As Long\n#End If\n\nSub Test()\n\n   \'first create or get IE object\n   Set IE= ...\n   ...\n\n   \'second, send IE window to the foreground\n   Dim TargetWnd\n   TargetWnd = FindWindow(""IEFrame"", vbNullString)  \'find IE window\n   If TargetWnd = 0 Then Debug.Print ""Window not found."" \'Else Debug.Print TargetWnd\n   SetForegroundWindow (TargetWnd)\n\n   \'sendkeys\n   set filee = getElement....\n   filee.Focus\n   SendKeys "" ""     \'send Space key instead of .Click method\n   SendKeys ""filePath""     \' ""C:\\path\\filename""  \' Type-in the filename \n   SendKeys ""{Enter}""    \'closes the file dialog\n\n   \'finally submit       \n   ...\n   ...\n\nend Sub\n\n']"
How can you automatically remove trailing whitespace in vim,"
I am getting 'trailing whitespace' errors trying to commit some files in Git.
I want to remove these trailing whitespace characters automatically right before I save Python files.
Can you configure Vim to do this? If so, how?
",75k,"
            219
        ","[""\nI found the answer here.\nAdding the following to my .vimrc file did the trick:\nautocmd BufWritePre *.py :%s/\\s\\+$//e\n\nThe e flag at the end means that the command doesn't issue an error message if the search pattern fails. See :h :s_flags for more.\n"", ""\nCompilation of above plus saving cursor position:\nfunction! <SID>StripTrailingWhitespaces()\n  if !&binary && &filetype != 'diff'\n    let l:save = winsaveview()\n    keeppatterns %s/\\s\\+$//e\n    call winrestview(l:save)\n  endif\nendfun\n\nautocmd FileType c,cpp,java,php,ruby,python autocmd BufWritePre <buffer> :call <SID>StripTrailingWhitespaces()\n\nIf you want to apply this on save to any file, leave out the second autocmd and use a wildcard *:\nautocmd BufWritePre,FileWritePre,FileAppendPre,FilterWritePre *\n  \\ :call <SID>StripTrailingWhitespaces()\n\n"", ""\nI also usually have a :\n\nmatch Todo /\\s\\+$/\n\nin my .vimrc file, so that end of line whitespace are hilighted.\nTodo being a syntax hilighting group-name that is used for hilighting keywords like TODO, FIXME or XXX. It has an annoyingly ugly yellowish background color, and I find it's the best to hilight things you don't want in your code :-)\n"", ""\nI both highlight existing trailing whitespace and also strip trailing whitespace.\nI configure my editor (vim) to show white space at the end, e.g.\n\nwith this at the bottom of my .vimrc:\n\nhighlight ExtraWhitespace ctermbg=red guibg=red\nmatch ExtraWhitespace /\\s\\+$/\nautocmd BufWinEnter * match ExtraWhitespace /\\s\\+$/\nautocmd InsertEnter * match ExtraWhitespace /\\s\\+\\%#\\@<!$/\nautocmd InsertLeave * match ExtraWhitespace /\\s\\+$/\nautocmd BufWinLeave * call clearmatches()\n\nand I 'auto-strip' it from files when saving them, in my case *.rb for ruby files, again in my ~/.vimrc\nfunction! TrimWhiteSpace()\n    %s/\\s\\+$//e\nendfunction\nautocmd BufWritePre     *.rb :call TrimWhiteSpace()\n\n"", ""\nHere's a way to filter by more than one FileType.\n\nautocmd FileType c,cpp,python,ruby,java autocmd BufWritePre <buffer> :%s/\\s\\+$//e\n\n"", '\nI saw this solution in a comment at \nVIM Wikia - Remove unwanted spaces\nI really liked it. Adds a . on the unwanted white spaces.\n\nPut this in your .vimrc\n"" Removes trailing spaces\nfunction TrimWhiteSpace()\n  %s/\\s*$//\n  \'\'\nendfunction\n\nset list listchars=trail:.,extends:>\nautocmd FileWritePre * call TrimWhiteSpace()\nautocmd FileAppendPre * call TrimWhiteSpace()\nautocmd FilterWritePre * call TrimWhiteSpace()\nautocmd BufWritePre * call TrimWhiteSpace()\n\n', '\nCopied and pasted from http://blog.kamil.dworakowski.name/2009/09/unobtrusive-highlighting-of-trailing.html (the link no longer works, but the bit you need is below)\n""This has the advantage of not highlighting each space you type at the end of the line, only when you open a file or leave insert mode. Very neat.""\n\nhighlight ExtraWhitespace ctermbg=red guibg=red\nau ColorScheme * highlight ExtraWhitespace guibg=red\nau BufEnter * match ExtraWhitespace /\\s\\+$/\nau InsertEnter * match ExtraWhitespace /\\s\\+\\%#\\@<!$/\nau InsertLeave * match ExtraWhiteSpace /\\s\\+$/\n\n', '\nThis is how I\'m doing it. I can\'t remember where I stole it from tbh.\n\nautocmd BufWritePre * :call <SID>StripWhite()\nfun! <SID>StripWhite()\n    %s/[ \\t]\\+$//ge\n    %s!^\\( \\+\\)\\t!\\=StrRepeat(""\\t"", 1 + strlen(submatch(1)) / 8)!ge\nendfun\n\n', ""\nA solution which simply strips trailing whitespace from the file is not acceptable in all circumstances. It will work in a project which has had this policy from the start, and so there are no such whitespace that you did not just add yourself in your upcoming commit.\nSuppose you wish merely not to add new instances of trailing whitespace, without affecting existing whitespace in lines that you didn't edit, in order to keep your commit free of changes which are irrelevant to your work.\nIn that case, with git, you can can use a script like this:\n#!/bin/sh\n\nset -e # bail on errors\n\ngit stash save commit-cleanup\ngit stash show -p | sed '/^\\+/s/ *$//' | git apply\ngit stash drop\n\nThat is to say, we stash the changes, and then filter all the + lines in the diff to remove their trailing whitespace as we re-apply the change to the working directory. If this command pipe is successful, we drop the stash.\n"", ""\nThe other approaches here somehow didn't work for me in MacVim when used in the .vimrc file. So here's one that does and highlights trailing spaces:\nset encoding=utf-8\nset listchars=trail:·\nset list\n\n"", '\nFor people who want to run it for specific file types (FileTypes are not always reliable):\nautocmd BufWritePre *.c,*.cpp,*.cc,*.h,*.hpp,*.py,*.m,*.mm :%s/\\s\\+$//e\n\nOr with vim7:\nautocmd BufWritePre *.{c,cpp,cc,h,hpp,py,m,mm} :%s/\\s\\+$//e\n\n', '\nIf you trim whitespace, you should only do it on files that are already clean.  ""When in Rome..."".  This is good etiquette when working on codebases where spurious changes are unwelcome.  \nThis function detects trailing whitespace and turns on trimming only if it was already clean.\nThe credit for this idea goes to a gem of a comment here:  https://github.com/atom/whitespace/issues/10  (longest bug ticket comment stream ever)\nautocmd BufNewFile,BufRead *.test call KarlDetectWhitespace()\n\nfun! KarlDetectWhitespace()\npython << endpython\nimport vim\nnr_unclean = 0\nfor line in vim.current.buffer:\n    if line.rstrip() != line:\n        nr_unclean += 1\n\nprint ""Unclean Lines: %d"" % nr_unclean\nprint ""Name: %s"" % vim.current.buffer.name\ncmd = ""autocmd BufWritePre <buffer> call KarlStripTrailingWhitespace()""\nif nr_unclean == 0:\n    print ""Enabling Whitespace Trimming on Save""\n    vim.command(cmd)\nelse:\n    print ""Whitespace Trimming Disabled""\nendpython\nendfun\n\nfun! KarlStripTrailingWhitespace()\n    let l = line(""."")\n    let c = col(""."")\n    %s/\\s\\+$//e\n    call cursor(l, c)\nendfun\n\n', ""\nautocmd BufWritePre *.py execute 'norm m`' | %s/\\s\\+$//e | norm g``\n\nThis will keep the cursor in the same position as it was just before saving\n"", ""\nautocmd BufWritePre * :%s/\\s\\+$//<CR>:let @/=''<CR>\n""]"
WatiN or Selenium? [closed],"









                        As it currently stands, this question is not a good fit for our Q&A format. We expect answers to be supported by facts, references,  or expertise, but this question will likely solicit debate, arguments, polling, or extended discussion. If you feel that this question  can be improved and possibly reopened, visit the help center for guidance.
                        
                    


Closed 10 years ago.



I'm going to start coding some automated tests of our presentation soon. It seems that everyone recommends WatiN and Selenium. Which do you prefer for automated testing of ASP.NET web forms? Which of these products work better for you?
As a side note, I noticed that WatiN 2.0 has been in CTP since March 2008, is that something to be concerned about?
",48k,"
            149
        ","[""\nI'm currently working hard on a beta release of WatiN 2.0 somewhere in Q1 of 2009. It will be a major upgrade to the current CTP 2.0 versions and will basically give you the same functionality to automate FireFox and IE as version 1.3.0 offers for automating IE.\nSo no concerns there.\nJeroen van Menen\nLead dev WatiN\n"", '\nIf you\'re looking to make a serious long-term investment in a framework that will continue to be improved and supported by the community, Selenium is probably your best bet. For example, I just came across this info on Matt Raible\'s blog:\n\nAs of Friday, Google has over 50 teams\n  running over 51K tests per day on\n  internal Selenium Farm. 96% of these\n  tests are handled by Selenium RC and\n  the Farm machines correctly. The other\n  4% are partly due to RC bugs, partly\n  to test errors, but isolating the\n  cause can be difficult. Selenium has\n  been adopted as the primary technology\n  for functional testing of web\n  applications within Google. That\'s the\n  good news.\n\nI also went to one of the Selenium meetups recently and learned that Google is putting serious resources into improving Selenium and integrating it with WebDriver, which is an automated testing tool developed by Simon Stewart. One of the major advantages of WebDriver is that it controls the browser itself rather than running inside the browser as a Javascript application, which means that major stumbling blocks like the ""same origin"" problem will no longer be an issue. \n', ""\nWe've tested both and decided to go with WaTiN.  As others have pointed out, Selenium does have some nice features not found in WaTiN, but we ran into issues getting Selenium working and once we did it was definitely slower when running tests than WaTiN. If I remember correctly, the setup issues we ran into stemmed from the fact that Selenium had a separate app to control the actual browser where WaTiN did everything in process.\n"", '\nI\'ve been trying \'em both out and here are my initial thoughts...\n\nWatiN\nThe Good\n\nFast execution.\nScript creation tools are independent projects; there are 2 that I know of: Wax (Excel based, hosted on CodePlex) and WatiN Test Record (hosted on SourceForge). Neither is as robust as Selenium IDE.\nVery good IE support.  Can attach and detach to/from running instances. Can access native window handles etc. (See script example below).\nNuGet packaged, easy to get running in .NET, Visual Studio style environments and keep updated.\n\nThe Bad\n\nGoogling WatiN (watin xyz) often causes Google to recommend ""watir xyz"" instead. Not that much documentation out there. \nWhat little there is (documentation), it is confusing; for example: at first blush it would appear that there is no native support for CSS selectors. Especially since there are extensions libraries like \'WatiNCssSelectorExtensions\' and many blog articles about alternative techniques (such as injecting jQuery/sizzle into the page). On Stack Overflow, I found a comment by Jeroen van Menen which suggests that there is native support. At least the lead-developer spends time on Stack Overflow :)\nNo native XPath support.\nNo out-of-the-box remote execution/grid based execution.\n\nScript Example (C#). You can\'t do this with Selenium (not that I know off, at least):\nclass IEManager\n{\n    IE _ie = null;\n    object _lock = new object();\n\n    IE GetInstance(string UrlFragment)\n    {\n        lock (_lock)\n        {\n            if (_ie == null)\n            {\n                var instances = new IECollection(true);  //Find all existing IE instances\n                var match = instances.FirstOrDefault(ie=>ie.Url.Contains(UrlFragment));\n                _ie = match ?? new IE();\n                if (match==null)  //we created a new instance, so we should clean it up when done!\n                    _ie.AutoClose = true;\n            }\n        }\n\n        return _ie;\n    }\n}\n\n\nSelenium\n\nSlower than WatiN (especially since a new process has to be created).\nBuilt-in CSS selectors/XPath support.\nSelenium IDE is good (can\'t say great, but it’s the best in class!).\nFeels more Java-ish than .NET-ish...but really, it\'s programming language agnostic; all commands are sent to an out-of-process \'Driver\'. The driver is really a \'host\' process for the browser instance. All communication must be serialised in/out across process boundaries, which might explain the speed issues relative to WatiN.\nDecoupled processes - ""Driver"" and ""Control""  mean more robustness, more complexity, etc., but also easier to create grids/distributed test environments. Would have really liked it if the ""distribution"" mechanism (i.e. the communication between Driver & Control) were across WebSphere or other existing, robust, message queue manager.\nSupport chrome and other browsers out of the box.\n\nDespite everything, I went with WatiN in the end; I mainly intend to write small screen-scraping applications and want to use LINQPad for development. Attaching to a remote IE instance (one that I did not spawn myself) is a big plus. I can fiddle around in an existing instance...then run a bit of script...then fiddle again etc. This is harder to do with Selenium, though I suppose ""pauses"" could be embedded in the script during which time I could fiddle directly with the browser.\n', ""\nThe biggest difference is that Selenium has support for different browsers (not just IE or FF, see http://seleniumhq.org/about/platforms.html#browsers.\nAlso, Selenium has a remote control server (http://seleniumhq.org/projects/remote-control/), which means that you don't need to run the browser on the same machine the test code is running. You can therefore test your Web app. on different OS platforms.\nIn general I would recommend using Selenium. I've used WatiN few years ago, but I wasn't satisfied with its stability (it has probably improved by now). The biggest plus for Selenium for me is the fact that you can test the Web app. on different browsers.\n"", '\nNeither. Use Coypu. It wraps Selenium. Much more durable. https://github.com/featurist/coypu\nUpdate\nYe Oliver you\'re right. Ok why\'s it better?\nPersonally I\'ve found the Selenium driver for IE in particular to be very fragile - there\'s a number of \'standard\' driver exceptions that I\'ve time again found when driving Selenium for Unit Tests on ajax heavy websites.\nDid I mention I want to write my scripts in c# as a Test Project ? Yes Acceptance Tests within a continous build deployment.\nWell Coypu deals with the above. It\'s a wrapper for Selenium that allows test fixtures such as,\nbrowser.Visit(""file:///C:/users/adiel/localstuff.htm"")\nbrowser.Select(""toyota"").From(""make"");\nbrowser.ClickButton(""Search"");\n\n... which will spin up a (configurable brand of) browser and run the script. It works great with scoped regions and is VERY extendable.\nThere\'s more examples at GitHub and as Olvier below mentions, Adrian\'s video is excellent. I think it\'s the best way to drive browser based tests in the .Net world and tries to follow it\'s Ruby namesake capybara\n', ""\nI've used both, they both seem to work ok.  My nod is for Selenium as it seemed to have better Ajax support.  I believe WaTiN has matured though since last I used it so it should have the same thing.\nThe biggest thing would be which development environment do you like to be in?  Selenium and Watin have recorders but Selenium is in the browser and watin is in visual studio. + and -'s to both of those.\n"", '\nUntil now we are a pure Microsoft Shop for delivering solutions for the enterprise and went with WatiN. This may change in the future.\nAs a more recent source:\nMicrosoft printed in MSDN Magazine 12/2010 a BDD-Primer with the combination of SpecFlow with WatiN (cool BDD-Behavior Driven Development). Its author Brandon Satrom (msft Developer Evangelist) has also posted in December 2010 a Video Webcast teaching in detail 1:1 his above findings.\nThere is a Whitepaper from 04/2011 on Supporting ATDD/BDD with SpecLog, SpecFlow and Team Foundation Server (Acceptance Test Driven Development/Behavior Driven Development) from Christian Hassa, whose team built SpecFlow.\n', ""\nI use Watin, but haven't used Selenium.  I can say I got up and running quickly on Watin and have had few to no problems.  I can't think of anything I have wanted to do that I couldn't figure out with it.  HTH\n"", '\nI generally use Selenium, mainly because I like the Selenium IDE plugin for FireFox for recording starting points for my tests.\n', ""\nI recommend WebAii since that's what I've had any success with and when using it my gripes were few. I never tried Selenium and I don't remember using WaTiN much, at least not to the point where I could get it to succesfully work. I don't know of any framework that deals with Windows dialogs gracefully, although WebAii has an interface for implementing your own dialog handlers.\n"", ""\nI considered using both. I used the recorder for Selenium to build some tests in FF. I tried to do the same in Watin and found that the Watin Recorder (2.0.9.1228) is completely worthless for our sites. It appeared to be rendering the site in IE6 -- making our site effectively unusable for recording. We don't support IE6. I couldn't find any way to change the browser it is using. I only found one Watin Recorder out there. If there's more than one, or one that is kept up to date, please comment. \nThe Selenium Recorder IDE for Firefox is simple to use and ports tests to C#. It isn't great at this. I couldn't get porting test suites to work, despite reading a blog post or two that had workarounds. So there's a bit of manipulation of the generated code. Still, it works 90% and that's better than the alternative. \nFor my money/time, Selenium is superior just for the ease of building new tests. IE doesn't have any good developer toolbars that are anywhere near as good as Firebug, so I'm doing my development in Firefox to begin with, so having a good working recorder in Firefox is a huge bonus. \nMy conclusion here was a lot like that democracy quote by Churchill: Selenium is the worst form of automated UI testing. Except for all the other ones. \n"", ""\nAt the risk of going off on a tangent, I'd recommend Axe/WatiN.  Axe allows tests to be written in Excel by 'Manual' Testers with no knowledge of the underlying test 'language'.  It does need a 'Technician' to write the bespoke actions (IE. Today I had to do a slightly complex Table lookup & cross-reference) but once written the actions can be used in tests by the non-techy testers.\nI also heard that the UK Government Gateway project (which I believe has 6K+ tests automated tests) recently ported all their tests from Axe/Winrunner to Axe/Watin within a week!! And many of the tests are pretty complex - I know as I worked on it a few years ago...\nI'm looking at Selenium at the moment, as a potential Client uses it.  But i do suggest a wee look at Axe as a layer above the 'work horse' tool.\n"", ""\nIf you have to access iframes, modal dialogs and cross domain iframes WatiN is a way to go.  Selenium couldn't handle the iframes it was throwing commandtimeout exceptions.  WatiN you could do lot more things especially if the website uses IE specific stuff like ShowModalDialog etc.. WatiN handles all of them very well.  I could even do cross domain iframe access.\n"", '\nYou will have to do both if you need to do IE and FF testing, but they are only going to work so well for presentation testing. They cant detect if one element is slightly off, just that the elements are present. I dont know of anything that can replace the human eye for UI / presentation testing, though you could do a few things to assist it (take screenshots of the pages at each step for users to review). \n']"
find and delete file or folder older than x days,"
I want to delete file and folder older than 7 days so I tried 
[17:07:14 root@client01.abc.com:~]# find /tmp/ -mindepth 1 -maxdepth 1 -ctime +7 -exec ls -l {} \;

So when I run find /tmp/ -mindepth 1 -maxdepth 1 -ctime +7 -exec ls -l {} \; it doesnt show any dir, but for find /tmp/ -mindepth 1 -maxdepth 2 -ctime +7 -exec ls -l {} \; it does show few files in subdir.
Whats is the right way to delete files/folders older than 7 days in one specific dir ?
",126k,"
            36
        ","['\nYou can make use of this piece of code\nfind /tmp/* -mtime +7 -exec rm {} \\;\n\nExplanation\n\nThe first argument is the path to the files. This can be a path, a directory, or a wildcard as in the example above. I would recommend using the full path, and make sure that you run the command without the exec rm to make sure you are getting the right results.\n\nThe second argument, -mtime, is used to specify the number of days old that the file is. If you enter +7, it will find files older than 7 days.\n\nThe third argument, -exec, allows you to pass in a command such as rm. The {} \\; at the end is required to end the command.\n\n\nSource : http://www.howtogeek.com/howto/ubuntu/delete-files-older-than-x-days-on-linux/\nFor deleting folders, after emptying inside of them you can rmdirinstad of rm in the piece of code, also if you only want to see directories you can add\n-type d\n\nto piece of code such as below:\nfind /tmp/*/* -mtime +7 -type d -exec rmdir {} \\;\n\n', '\nEasier to just do \nfind /tmp/* -mtime +7 -exec rm -rf {} \\; \n\nWhich will del files and dirs\n', '\nmy easy way:\nfind /tmp/* -daystart -mtime +7 -delete\n\nthe daystart option measure times from the beginning of today rather than from 24 hours ago\nref: official_doc\n', '\nfind /tmp/* -mtime +7 -type f -exec rm {} \\;\n\nRemove files.\nfind /tmp/ -empty -type d -delete\n\nRemove empty directories.\n']"
What is the best automated website UI testing framework [closed],"









                        As it currently stands, this question is not a good fit for our Q&A format. We expect answers to be supported by facts, references,  or expertise, but this question will likely solicit debate, arguments, polling, or extended discussion. If you feel that this question  can be improved and possibly reopened, visit the help center for guidance.
                        
                    


Closed 9 years ago.



What are the good automated web UI testing tools?
I want to be able to use it in the .Net world - but it doesn't have to written in .net.
Features such as a record mode, integration into build process\ continuous integration would be nice.
Im going to look at:

Watir
Selenium

Are there any others I should look at?
",22k,"
            34
        ","[""\nI definitively recommend Selenium, you can use it from .NET, supports different browsers, works in automatic builds and CI processes (we use it from CCNet). The code is stable. It has a few quirks, but after all they all do.\nWhichever tool you choose, I recommend making your own test facade class(es) around it. The facade should be designed to suite your concrete testing needs, without exposing too much the details of the testing tool's API. This will make the test code easier to write and maintain.\nUPDATE: if you use ASP.NET view state in your app, you could have problems using a pure HTTP test tool. This is where browser-controllers (like Selenium) are much better.\n"", '\nWatiN\nAutomates FF and IE\n[Test] \npublic void SearchForWatiNOnGoogle()\n{\n using (IE ie = new IE(""http://www.google.com""))\n {\n  ie.TextField(Find.ByName(""q"")).TypeText(""WatiN"");\n  ie.Button(Find.ByName(""btnG"")).Click();\n\n  Assert.IsTrue(ie.ContainsText(""WatiN""));\n }\n}\n\nhttp://watin.sourceforge.net/\n', '\nWatin is pretty unstable to use it in serious projects. It often fails with unexpected reasons like ""EI is busy"" or something like ""Error with COM object"". \nSelenium is much more stable and it already has a lot of supporting tools. For example Selenium GRID is a solution which allows significantly decrease run time of tests. (Our smoke tests on Watin takes 6 hours to run).\n', '\nCurrently in my job i use QTP and it so far atleast can handle pretty much anything we throw at it both on the UI and it has a special mode for testing non gui services allowing us to check both and help us narrow down where some problems occur when we change the system. It is in my opinion very configurable and the inclusion of vbscript as its language allows integration with lots and lots of things on windows to allow you  to do pretty much anything you want! For instance we use it to control the excel com object to make custom excel reports of success and failure so the format of the results is the same wether a test was run manually and also on another project used the adodb object to check that when a page submits information to the database that the database contains the correct data for that record!\nAs for integration into the build process i have not tried this myself but it is possible to launch qtp and  a test from a vbs file so i would assume this should be fairly trvial as ms tools tend to allow you to run vbs files pretty easily  from most tools.\nI would reccomend it to anyone assuming you can get someone to buy the license!\n', '\nYou can also try VSTT - http://blogs.msdn.com/b/slumley/archive/2009/05/28/vsts-2010-feature-enhancements-for-web-test-playback-ui.aspx\nTelerik Test Tools - http://www.telerik.com/automated-testing-tools.aspx\nVisual Studio UI Test Extensibility–Scenarios & Guiding Principles - http://blogs.msdn.com/b/mathew_aniyan/archive/2011/03/28/visual-studio-ui-test-extensibility-scenarios-amp-guiding-principles.aspx\nVSTS Web Test Step-by-Step Primer - http://blogs.msdn.com/b/jimmymay/archive/2009/02/23/vsts-web-test-step-by-step-primer-7-minute-video-by-microsoft-a-c-e-performance-engineer-chris-lundquist-with-copious-notes-screen-shots-from-your-humble-correspondent.aspx\n', ""\nyou might also be interested in taking a look at what the ASP.NET team cooked up itself: Lightweight Test Automation Framework.\nThere's also a dedicated forum for it.\n"", ""\nHaving used several different automated testing solutions (TestComplete, QTP, etc), I have to put a vote in for Telerik + Visual Studio.  Telerik has great support forums, and is very compatible with whatever testing framework you come up with.  Our Devs put unique IDs into their HTML code so that our scripts don't need to be rewritten even with pretty drastic UI refactors.  It's definitely more challenging than record and playback, but once you have your unique IDs in place, the automation code requires little or no maintenance.\n"", '\nTry httpunit\n', ""\nDepend on what you would like to achieve. \nYou can use web test built in the Visual Studio Tester Edition. It's quite good and easy to automate. You can use external data as a test data source and it integrates nicely with VS.\nThere is also test tool by Automated QA (forgot the name) which looks good but expensive.\nAnd there is Selenium. That's the one we are using in Symantec. The biggest advantage is that it actually uses a browser you want to test. VS mimic a browser by changing http request parameters only so you may not be able to test your site for cross-browser compatibility. Selenium on the other hand uses browser and automates it so you can actually test your site in IE, Firefox etc. It can be also integrated with VS unit tests so you can see test results in VS.\nSo I would recommend Selenium or VS.\n"", ""\nI've used Selenium. The features were good, and it was usable but it was buggy. \nThe IDE would often record events incorrectly (so tests would need to be manually changed), and test files occasionally became completely unusable for no apparent reason, which meant they would have to be recreated all over again. Also development on Selenium IDE seems to have stopped; there hasn't been any bug fixes and patches for a while, and bug reports seem to go unnoticed. \nMolybdenum is an alternative, built on Selenium that's worth looking into.\nhttp://www.molyb.org/\n"", ""\nJust to throw out another option (of which I haven't tried but I do like Telerik) is Telerik's new WebUI Testing Studio.  I will also echo Selenium up votes.\n"", '\nI forget one nice tools and can find link on it but find this ... http://weblogs.asp.net/bsimser/archive/2008/02/21/automated-ui-testing-with-project-white.aspx maybe can help.\n', '\nIf you are looking for simple, cross-browser tool with record and playback, multithreaded playback, intergration with build processes, powerful scripting, good reporting and excellent support, go for Sahi. It will be much easier for your testers/devs to learn and maintain.\n', '\nyou might want to take in consideration near Selenium also Rational Functional Tester ! whether you are familiar with coding in .Net or Java and want to just play around with record & replay or want to create more sophisticated programmatic testing I would recommend it.\n', '\nWebDriver is another possibility: http://code.google.com/p/webdriver\nThey are working on a .NET wrapper that may be interesting for you.\n', '\nTry QEngine. It has all the features of QTP.\n', '\nYou may want to look at RIATest for cross-platform cross-browser testing of web applications. \nIt works on Windows and Mac, supported browsers are Firefox, IE and Chrome. Automated testing scripts written on one platform/browser can be run against all other supported platforms/browsers.\nIt has the features that you want: user interaction recording mode and integration with CI servers (outputs results in JUnit format which can be consumed by CI servers such as Hudson).\n(Disclaimer: I am a RIATest team member).\n']"
What are the shortcut to Auto-generating toString Method in Eclipse?,"
Is it good or bad practice auto-generating toString methods for some simple classes?
I was thinking of generating something like below where it takes the variable names and produces a toString method that prints the name followed by its value.
private String name;
private int age;
private double height;

public String toString(){
   return String.format(""Name: %s Age: %d Height %f"", name, age, height);
}

",43k,"
            30
        ","[""\nEclipse 3.5.2 (and possibly earlier versions) already provides this feature. If you right-click within the editor, you'll find it under Source -> Generate toString()...\nTo answer your question about whether it's a bad practice to autogenerate toString(), my opinion is that it is not. If the generated code is very similar to the code you would have written yourself, then why bother typing it out?\n"", '\nI personally like to implement a toString method for all objects, as it helps in debugging.\nI would look into using the Apache Commons ToStringBuilder.\nYou can implement a simple toString method using reflection as follows:\npublic String toString() {\n   return ToStringBuilder.reflectionToString(this);\n}\n\nUsing this method, you will not have to update your toString method if/when fields are added.\n', ""\nIf you use lombok they have a @ToString annotation which will generate the toString for you.\nThe reason why this is much better to use instead of generating toString with eclipse for instance is that if you later add,remove or change attributes of the class, you will also have to regenerate the toString. If you use lombok you don't have to do that.\n"", '\nTo add to Steve\'s and Don\'s answers (+1 for them) :\nMake your toString() method simple, make sure it nevers triggers expections (especially be aware of fields that could be null). \nIf possible, don\'t call other methods of your class. At least, be sure that your toString() method doesn\'t modify your object. \nAnd be aware of silly exception-toString loops:\npublic class MyClass { \n       ... \n       public String toString() { \n          // BAD PRACTICE 1: this can throw NPE - just use field1\n            return "" field1="" + field1.toString() \n                + "" extraData="" + getExtraData();\n          // BAD PRACTICE 2: potential exception-toString loop\n       }\n\n       public MyExtraData getExtraData() {\n           try { \n           .... do something\n           } catch(Exception e) {\n              throw new RuntimeException(""error getting extradata - "" + this.toString(),e);\n           }\n\n       }\n\n}\n\n', ""\nIn IntelliJ Idea you can press alt+insert, the Generate popup will open; now select the fields and click the OK button; that's it.\n\n\n\nFurther tip: In the Generate toString dialog, it gives you a choice to select the template by clicking the drop down on the template combo box. Here you can select StringBuffer if you need to or any other template as required. Play with it to get accustomed. I like it :)\n"", '\n\nShortcut to generate toString() method\n\n\nPress Alt + Shift + S + S (double)\nRight click -> Source -> Generate toString() ...\nGo to Source menu -> Generate toString() ...\nGo to Windows menu -> Preferences -> General -> Keys (Write Generate toString on text field)\n\n', ""\nBe clear when adding toString() as to the audience of the generated text.  Some frameworks use the toString() method to generate end user visible text (e.g. certain web frameworks), whereas many people use toString() methods to generate debugging / developer information.  Either way, make sure that you have enough uniqueness in the toString implementation to satisfy your requirements.\nThe default JDK implementation of toString() generates developer info, so that's usually the pattern I recommend if possible, but if you are working on a project with a different idea / expectation you could wind up confused...\n"", '\nJust noticed -In NetBeans IDE you can generate toString() method by selecting fields you want to generate it for right click->insert code or use shortcut ALT+INSERT and then select toString().\nWay it looks is :\n@Override\npublic String toString() {\n    return ""ClassName{""+""fieldName=""+fieldName+\'}\';\n}\n\nIts great way to debug and no need for additional libs.\n', '\nConsidering some old answers including @Steve\'s, I\'d like to add answer as per latest library. \nAdd dependency\n        <dependency>\n            <groupId>org.apache.commons</groupId>\n            <artifactId>commons-lang3</artifactId>\n            <version>3.10</version>\n        </dependency>\n\nIn your class \nimport org.apache.commons.lang3.builder.ReflectionToStringBuilder;\n\npublic class User {\n     ... \n\n     @Override\n     public String toString() {\n          return ReflectionToStringBuilder.toString(this);\n     }\n}\n\nYou can exclude certain fields as below \n    ... \n    @Override\n    public String toString() {\n        return ReflectionToStringBuilder.toStringExclude(this, ""name""); // Name will be excluded from toString output \n    }\n\n']"
How to add application to Azure AD programmatically?,"
I want to automate the creation of my application in Azure AD and get back the client id generated by Azure AD.
Are there PowerShell commandlets to do this? Is there some other means, like an API of doing this besides the management console?
Can you point me to an example?
Thanks!
",22k,"
            29
        ","['\n', '\n', '\n', '\n']"
"Automation Google login with python and selenium shows """"This browser or app may be not secure""""","
I've tried login with Gmail or any Google services but it shows the following ""This browser or app may not be secure"" message:

I also tried to do options like enable less secure app in my acc but it didn't work.
then I made a new google account and it worked with me. but not with my old acc.

how can i solve this ? 
How can i open selenium in the normal chrome browser not the one controlled by automated software
?

This is my code

    from selenium.webdriver import Chrome
    from selenium.webdriver.chrome.options import Options


    browser = webdriver.Chrome()
    browser.get('https://accounts.google.com/servicelogin')
    search_form = browser.find_element_by_id(""identifierId"")
    search_form.send_keys('mygmail')
    nextButton = browser.find_elements_by_xpath('//*[@id =""identifierNext""]') 
    search_form.send_keys('password')
    nextButton[0].click() 

",26k,"
            23
        ","['\nFirst of all don\'t use chrome and chromedriver. You need to use Firefox.(if not installed) Download and install Firefox. Login to Google with normal Firefox.\nYou need to show the Google site that you are not a robot. You can use code like this:\nfrom selenium import webdriver\nimport geckodriver_autoinstaller\nfrom selenium.webdriver.common.desired_capabilities import DesiredCapabilities\n\ngeckodriver_autoinstaller.install()\n\nprofile = webdriver.FirefoxProfile(\n    \'/Users/<user name>/Library/Application Support/Firefox/Profiles/xxxxx.default-release\')\n\nprofile.set_preference(""dom.webdriver.enabled"", False)\nprofile.set_preference(\'useAutomationExtension\', False)\nprofile.update_preferences()\ndesired = DesiredCapabilities.FIREFOX\n\ndriver = webdriver.Firefox(firefox_profile=profile,\n                           desired_capabilities=desired)\n\nThis can help you find your profile location.\nBut, why Firefox?\nActually there is only one reason, chromedriver was coded by Google.\nThey can easily understand if it is a bot or not. But when we add user data with Firefox, they cannot understand if there is a bot or not.\nYou can fool Google like this. It worked for me too. I tried very hard to do this. Hope it will be resolved in you too.\n', '\nThis is working for me. I found the solution from GitHub.\n   from selenium import webdriver\n   from selenium_stealth import stealth\n\n   options = webdriver.ChromeOptions()\n   options.add_argument(""user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36"")\n   options.add_experimental_option(""excludeSwitches"", [""enable-automation""])\n   options.add_experimental_option(\'useAutomationExtension\', False)\n   options.add_argument(\'--disable-blink-features=AutomationControlled\')\n   driver = webdriver.Chrome(options=options)\n   stealth(driver,\n        languages=[""en-US"", ""en""],\n        vendor=""Google Inc."",\n        platform=""Win32"",\n        webgl_vendor=""Intel Inc."",\n        renderer=""Intel Iris OpenGL Engine"",\n        fix_hairline=True,\n        )\n   driver.get(""https://www.google.com"")\n\n', '\nYou can easily bypass the google bot detection with the undetected_chromedriver:\npip install undetected-chromedriver\npip install selenium\n\nCredits: https://github.com/xtekky/google-login-bypass/blob/main/login.py\nimport undetected_chromedriver as uc\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\n\nclass Main:\n  def __init_(self) -> None:\n    self.url    = \'https://accounts.google.com/ServiceLogin\'\n    self.driver = driver = uc.Chrome(use_subprocess=True)\n    self.time   = 10\n    \n  def login(self, email, password):\n    WebDriverWait(self.driver, 20).until(EC.visibility_of_element_located((By.NAME, \'identifier\'))).send_keys(f\'{email}\\n)\n    WebDriverWait(self.driver, 20).until(EC.visibility_of_element_located((By.NAME, \'password\'))).send_keys(f\'{password}\\n)\n                                                                                \n    self.code()\n                                                                                  \n  def code(self):\n    # [ ---------- paste your code here ---------- ]\n    time.sleep(self.time)                                                                                  \n                                                                                  \nif __name__ == ""__main__"":\n  #  ---------- EDIT ----------\n  email = \'email\' # replace email\n  password = \'password\' # replace password\n  #  ---------- EDIT ----------                                                                                                                                                         \n \n  driver = Main()\n  driver.login(email, password) \n\n', '\nFrom terminal pip install undetected-chromedriver\nthen do the following steps, as shown below.\nNOTE: indent your code inside if name == main, as i have done, only then the program will work\nimport undetected_chromedriver as uc\nfrom time import sleep\nfrom selenium.webdriver.common.by import By\n\n\nif __name__ == \'__main__\':\n    \n    driver = uc.Chrome()\n    driver.get(\'https://accounts.google.com/\')\n\n    # add email\n    driver.find_element(By.XPATH, \'//*[@id=""identifierId""]\').send_keys(YOUR EMAIL)\n    driver.find_element(By.XPATH, \'//*[@id=""identifierNext""]/div/button/span\').click()\n    sleep(3)\n    driver.find_element(By.XPATH, \'//*[@id=""password""]/div[1]/div/div[1]/input\').send_keys(YOUR PASSWORD)\n    driver.find_element(By.XPATH, \'//*[@id=""passwordNext""]/div/button/span\').click()\n    sleep(10)\n\n\n\n', '\nIf you\'d prefer Chrome over Firefox, the way to go around Googles automation detection is by using the undetected_chromedriver library.\nYou can install the package using pip install undetected-chromedriver.\nOnce your driver object is initiated you can simply use selenium to operate the driver afterwards.\n# initiate the driver with undetetcted_chromedriver\nimport undetected_chromedriver.v2 as uc\ndriver = uc.Chrome()\n\n# operate the driver as you would with selenium\ndriver.get(\'https://my-url.com\') \n\n# Example use of selenium imports to be used with the driver\nfrom selenium.common.exceptions import NoSuchElementException\nfrom selenium.webdriver.common.by import By\n\ntry:\n    driver.find_element(By.XPATH, \'//*[@id=""my-id""]\').click()\nexcept NoSuchElementException:\n    print(""No Such Element Exception"")\n\nNote: the login of Google is a popup, so don\'t forget to swap window handles to the popup to login and then afterwards to switch back to the main window.\n', '\nYou can use undetected-chromedriver from github\nimport undetected_chromedriver as uc\nfrom selenium import webdriver\n\noptions = uc.ChromeOptions()\noptions.add_argument(""--ignore-certificate-error"")\noptions.add_argument(""--ignore-ssl-errors"")\n# e.g. Chrome path in Mac =/Users/x/Library/xx/Chrome/Default/\noptions.add_argument( ""--user-data-dir=<Your chrome profile>"")\ndriver = uc.Chrome(options=options)\nurl=\'https://accounts.google.com/servicelogin\'\ndriver.get(url)\n\nYour first import need to be undetected Chrome driver.\n', '\nFirstly, I would ask you to use the undetected_chromedriver module\nI have found some issues with the original repo so I have forked a repo that supports user_data_dir and also allows you to provide custom chromedriver path as well.\nUninstall the old module and install this by using git clone and then go the folder and run python setup.py install\nForked repo link : https://github.com/anilabhadatta/undetected-chromedriver\nImport the latest undetected_chromdriver module:\nimport undetected_chromedriver.v2 as ucdriver\nFor using user_data_dir feature write:\noptions.user_data_dir = ""path_to _user-data-dir""\ninstead of using this\noptions.add_argument(f""user_data_dir={path_to _user-data-dir}"")\nprofile_directory name is the same as how we write in selenium\noptions.add_argument(f""--profile-directory=Default"")\nFor using custom chrome path,\noptions.binary_location = chrome_path\nFor using custom chromedriver path,\ndriver = ucdriver.Chrome(executable_path=f\'{path_to_chromedriver}\', options=options) \nRecently Google made some changes for which the authentication part didn\'t work.\nI have tested this in Python 3.9.0, there are reports that it may not work correctly in 3.10.0\nAnd this is tested in both Windows and Linux.\nFinal Code:\ndef load_chrome_driver(headless):\n    chrome_loc = ""/home/ubuntu/Downloads/chromium-browser/""\n    chrome_path = chrome_loc + ""chrome""\n    chromedriver_path = chrome_loc + ""chromedriver""\n    user_data_dir = ""/home/ubuntu/.config/chromium/custom_user""\n    options = webdriver.ChromeOptions()\n    if headless:\n        options.add_argument(\'headless\')\n    options.add_argument(\'--profile-directory=Default\')\n    options.add_argument(""--start-maximized"")\n    options.add_argument(\'--disable-gpu\')\n    options.add_argument(\'--no-sandbox\')\n    options.add_argument(""--disable-dev-shm-usage"")\n    options.add_argument(\'--log-level=3\')\n    options.binary_location = chrome_path\n    options.user_data_dir = user_data_dir\n    driver = ucdriver.Chrome(\n        executable_path=chromedriver_path, options=options)\n    driver.set_window_size(1920, 1080)\n    driver.set_window_position(0, 0)\n    return driver\n\n', '\nGoogle is detecting that you\'re using a bot. You must first of all add this snippet of config (convert it to python since i wrote it in java):\n    options.addArguments(""--no-sandbox"");\n            options.addArguments(""--disable-dev-shm-usage"");\n            options.addArguments(""--disable-blink-features"");\n            options.setExperimentalOption(""excludeSwitches"", Arrays.asList(""enable-automation""));\n            options.addArguments(""--disable-blink-features=AutomationControlled"");\n            options.addArguments(""--disable-infobars"");\n\n        options.addArguments(""--remote-debugging-port=9222"");\n\noptions.setCapability(CapabilityType.UNEXPECTED_ALERT_BEHAVIOUR, UnexpectedAlertBehaviour.IGNORE);\n\ndriver.executeScript(""Object.defineProperty(navigator, \'webdriver\', {get: () => undefined})"");\n\nThe last instruction is the key one, when you launch Selenium, the navigator var of Chrome is set to \'true\', that means that the browser is controlled by a bot, setting it with JS to undefined renders it a ""normal browser"" in view of Google.\nAnother important thing you should do is to change the HEX of the chromedriver binary, i can PM you my already modified one (ubuntu environment), if you trust me obv.\n']"
Programmatically building htpasswd,"
Is there a programmatic way to build htpasswd files, without depending on OS specific functions (i.e. exec(), passthru())?
",21k,"
            22
        ","[""\n.httpasswd files are just text files with a specific format depending on the hash function specified. If you are using MD5 they look like this:\nfoo:$apr1$y1cXxW5l$3vapv2yyCXaYz8zGoXj241\n\nThat's the login, a colon, ,$apr1$, the salt and 1000 times md5 encoded as base64. If you select SHA1 they look like this:\nfoo:{SHA}BW6v589SIg3i3zaEW47RcMZ+I+M=\n\nThat's the login, a colon, the string {SHA} and the SHA1 hash encoded with base64.\nIf your language has an implementation of either MD5 or SHA1 and base64 you can just create the file like this:\n<?php\n\n$login = 'foo';\n$pass = 'pass';\n$hash = base64_encode(sha1($pass, true));\n\n$contents = $login . ':{SHA}' . $hash;\n\nfile_put_contents('.htpasswd', $contents);\n\n?>\n\nHere's more information on the format:\nhttp://httpd.apache.org/docs/2.2/misc/password_encryptions.html\n"", ""\nFrom what it says on the PHP website, you can use crypt() in the following method:\n<?php\n\n// Set the password & username\n$username = 'user';\n$password = 'mypassword';\n\n// Get the hash, letting the salt be automatically generated\n$hash = crypt($password);\n\n// write to a file\nfile_set_contents('.htpasswd', $username ':' . $contents);\n\n?>\n\nPart of this example can be found: http://ca3.php.net/crypt\nThis will of course overwrite the entire existing file, so you'll want to do some kind of concatination.\nI'm not 100% sure this will work, but I'm pretty sure.\n"", ""\nTrac ships with a Python replacement for htpasswd, which I'm sure you could port to your language of choice: htpasswd.py.\n""]"
Create Outlook email draft using PowerShell,"
I'm creating a PowerShell script to automate a process at work.  This process requires an email to be filled in and sent to someone else.  The email will always roughly follow the same sort of template however it will probably never be the same every time so I want to create an email draft in Outlook and open the email window so the extra details can be filled in before sending.
I've done a bit of searching online but all I can find is some code to send email silently. The code is as follows:
$ol = New-Object -comObject Outlook.Application  
$mail = $ol.CreateItem(0)  
$Mail.Recipients.Add(""XXX@YYY.ZZZ"")  
$Mail.Subject = ""PS1 Script TestMail""  
$Mail.Body = ""  
Test Mail  
""  
$Mail.Send() 

In short, does anyone have any idea how to create and save a new Outlook email draft and immediately open that draft for editing?
",41k,"
            19
        ","['\nBased on the other answers, I have trimmed down the code a bit and use\n$ol = New-Object -comObject Outlook.Application\n\n$mail = $ol.CreateItem(0)\n$mail.Subject = ""<subject>""\n$mail.Body = ""<body>""\n$mail.save()\n\n$inspector = $mail.GetInspector\n$inspector.Display()\n\nThis removes the unnecessary step of retrieving the mail from the drafts folder.  Incidentally, it also removes an error that occurred in Shay Levy\'s code when two draft emails had the same subject.\n', '\n$olFolderDrafts = 16\n$ol = New-Object -comObject Outlook.Application \n$ns = $ol.GetNameSpace(""MAPI"")\n\n# call the save method yo dave the email in the drafts folder\n$mail = $ol.CreateItem(0)\n$null = $Mail.Recipients.Add(""XXX@YYY.ZZZ"")  \n$Mail.Subject = ""PS1 Script TestMail""  \n$Mail.Body = ""  Test Mail  ""\n$Mail.save()\n\n# get it back from drafts and update the body\n$drafts = $ns.GetDefaultFolder($olFolderDrafts)\n$draft = $drafts.Items | where {$_.subject -eq \'PS1 Script TestMail\'}\n$draft.body += ""`n foo bar""\n$draft.save()\n\n# send the message\n#$draft.Send()\n\n', ""\nI think Shay Levy's answer is almost there: the only bit missing is the display of the item.\nTo do this, all you need is to get the relevant inspector object and tell it to display itself, thus:\n$inspector = $draft.GetInspector  \n$inspector.Display()\n\nSee the MSDN help on GetInspector for fancier behaviour.\n"", '\nif you want to use HTML template please use HTMLbody instead of Body , please find sample code below:\n$ol = New-Object -comObject Outlook.Application\n$mail = $ol.CreateItem(0)\n$mail.Subject = ""Top demand apps-SOURCE CLARIFICATION""\n$mail.HTMLBody=""<html><head></head><body><b>Joseph</b></body></Html>""\n$mail.save()\n\n$inspector = $mail.GetInspector\n$inspector.Display()\n\n', '\nThought I would add in to this as well. There are a few steps you can save yourself if you know a lot of the basics (subject, recipients, or other aspects). First create the template of the email and save that, e.g. somewhere maybe with the code? \nAs to the code itself, it follows much the same that others have posted.  \nBorrowing from Jason:\n$ol = New-Object -comObject Outlook.Application\n$msg = $ol.CreateItemFromTemplate(<<Path to template file>>)\n\nModify as needed. Append fields or modify body. The message can still be viewed prior to sending the same way $msg.GetInspector.Display(). Then call $msg.send() to send away!   \n']"
GMail is blocking login via Automation (Selenium),"
I am using selenium to automate a mail verification process in a web application. I have a script already in place to login to gmail and read an activation mail received on the account. The script was perfectly working till yesterday but today I am facing a problem.

Additional Screenshot of issue

Gmail is not allowing sign in if the browser is launched with selenium. Says, 

You're using a browser that Google doesn't recognize or that's setup in a way that we don't support.


I have tried upgrading chromedriver version to 76.0.0 as I am using
chrome version 76.0.3809.100(64 bit). (Previously used chromedriver
2.45) Still, the problem persists.
Verified that this issue occurs even if I use Firefox instead of Chrome for automation.
Verified that Javascript is enabled in the browser
Gmail is not asking for any OTP or recovery mail. It is simply
blocking my attempt to login via automation. However I am able to
login to the same account manually.


Software used:  ""webdriverio"": ""^4.14.1"", ""wdio-cucumber-framework"":
  ""^2.2.8""

Any help is appreciated.
",38k,"
            18
        ","['\nAfter some trial and error, found out that this issue happens only in a scenario when multiple gmail accounts have already been created from the same App/IP/Device. Google somehow is marking those accounts and blocks them if they are launched by automation frameworks/extensions. \nTemporary Solutions:\n\nCreate a fresh GMail account using a\ndifferent mobile number from another device (Not recommended).\nWe should be using workarounds like nodemailer\nzeolearn.com/magazine/sending-and-receiving-emails-using-nodejs\n(as mentioned by Rahul L as a suggestion)\nAutomate temporary mail providers like Guerilla Mail or 10 Minute Mail if you are\nworried about only receiving mails\n\nMy humble opinion is to entirely avoid automating the UI of third party Mail applications as you cannot predict how their UI and elements will change. They might block you from launching for security purposes and they have every right to do so!\n', ""\nI just tried something out that worked for me after several hours of trial and error.\nAdding args: ['--disable-web-security', '--user-data-dir', '--allow-running-insecure-content' ] to my config resolved the issue.\nI realized later that this was not what helped me out as I tried with a different email and it didn't work. After some observations, I figured something else out and this has been tried and tested.\nUsing automation:\nGo to https://stackoverflow.com/users/login\nSelect Log in with Google Strategy\nEnter Google username and password\nLogin to Stackoverflow\nGo to https://gmail.com (or whatever Google app you want to access)\nAfter doing this consistently for like a whole day (about 24 hours), try automating your login directly to gmail (or whatever Google app you want to access) directly... I've had at least two other people do this with success.\nPS - You might want to continue with the stackoverflow login until you at least get a captcha request as we all went through that phase as well.\n"", '\nGo to Gmail --> Settings --> Search for ""Less secure app access"" --> Enable\nThis is not a suggested method because it allows access to less secure apps and it\'s easier to get into your account but if it\'s just a testing account and no important data is being transferred to or from, you can give this a try.\n', '\nYou need to open your editor and copy this code and paste them and save with this name as email.py and then open your terminal/cmd/powershell in that directory and type this python\xa0.\\email.py\nNote:\nMake sure your chrome driver in that directory where you save python file\nYou need to copy this code and paste in your editor\nHere is that script:\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.ui import WebDriverWait\nfrom selenium.webdriver.support import expected_conditions as EC\nimport time\nimport pyautogui as pg\n\n\nusername = input(""Enter Your Username: "")\n\npassword = input(""Enter Your Password: "")\n\ndriver = webdriver.Chrome()\ndriver.maximize_window()\ndriver.get(""https://accounts.google.com/ServiceLogin?service=mail&passive=true&rm=false&continue=https://mail.google.com/mail/&ss=1&scc=1&ltmpl=default&ltmplcache=2&emr=1&osid=1#identifier"")\ndriver.maximize_window()\n\n\nmail = WebDriverWait(driver, 100).until(EC.element_to_be_clickable((By.XPATH, ""//*[@id=\'identifierId\']""))).send_keys(username)\n\nlogin = WebDriverWait(driver, 100).until(EC.element_to_be_clickable((By.XPATH, ""//*[@id=\'identifierNext\']/span""))).click()\n\npassw = WebDriverWait(driver, 100).until(EC.element_to_be_clickable((By.XPATH, ""//*[@id=\'password\']/div[1]/div/div[1]/input""))).send_keys(password)\n\nnext = WebDriverWait(driver, 100).until(EC.element_to_be_clickable((By.XPATH, ""//*[@id=\'passwordNext\']/span/span""))).click()\n\n', '\nSteps to login to gmail through stackoverflow :\n\nOpen a browser window and open stackoverflow\nClick on log in\nLogin with google\nEnter email and password\nStackoverflow is logged in with gmail credentials\nNow open mail.google.com (gmail.com)\nYou are now logged into gmail using selenium\n\nYou can copy this code and paste in your editor, you have to enter the path of your chrome driver, email address and password for your gmail where it is asked in the code.\nfrom selenium import webdriver\nfrom selenium.webdriver.common.keys import Keys\nfrom selenium.webdriver.common.by import By\nimport time\n\ndriver=webdriver.Chrome(\'Enter the path of the chrome driver here\')\ndriver.get(""https://stackoverflow.com/"")\n\ndriver.maximize_window()\n\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'/html/body/header/div/ol[2]/li[2]/a[1]\').click()#Log in button in stackoverflow\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'//*[@id=""openid-buttons""]/button[1]\').click()# Log in with Google button\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'//*[@id=""identifierId""]\').send_keys(""Enter email address"")# Enter email address\n\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'//*[@id=""identifierNext""]/div/button/div[2]\').click() # Click next button after entering email address\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'//*[@id=""password""]/div[1]/div/div[1]/input\').send_keys(""Enter password"")#Enter password\n\ntime.sleep(5)\n\ndriver.find_element(By.XPATH, \'//*[@id=""passwordNext""]/div/button/div[2]\').click()# Click on next button after entering the password\n\ntime.sleep(5)\n\ndriver.get(""https://mail.google.com"")\n\ntime.sleep(5)\n\ndriver.close()\n\n', '\nFound solution, add these arguements:\noptions.AddArguments(""--disable-web-security"", ""--user-data-dir=true"", ""--allow-running-insecure-content"");\n^^  C# btw\n', '\nI think this is not a problem with the automation framework nor with the automated Chrome application, it is Google server that blocks automated login requests. I don\'t have any clear evidence/really understand how they can do it, but several clues point me to this direction:\n\nFirst, on the login page, after entering your user name and clicking next, a user lookup request is fired, something likes https://accounts.google.com/_/lookup/accountlookup?hl=vi&_reqid=xxxxx&rt=j, the response of this request includes something likes https://accounts.google.com/signin/rejected?rrk=46&hl=vi. In subsequent requests, the browser just tries to resolve & display what the error means to the user.\nSecond, it was stated here that ""Google doesn’t let you sign in from some browsers. Google might stop sign-ins from browsers that are being controlled through software automation rather than a human"". This means Googles has implemented measures to detect requests coming automated browser, especially Chrome-family browsers in debug mode, which are used by many automation frameworks.\nA thread about similar issue with Taiko also mentioned that Google blocks requests from Chrome running in debug mode.\n\nRecently I tried with Cypress and Taiko, but none works, same ""rejected"" issue, which ruined my initial plan of doing an e2e test for my app (which uses GG OIDC login).\n', '\nBelow code worked for me by using selenium-stealth module and editing chromedriver exe\nfrom selenium.webdriver.chrome.options import Options\nfrom selenium import webdriver \nimport time\nfrom selenium.webdriver.common.desired_capabilities import DesiredCapabilities\nfrom selenium_stealth import stealth\nchrome_options = Options()\nchrome_options.add_experimental_option(""useAutomationExtension"", False)\nchrome_options.add_experimental_option(""excludeSwitches"",[""enable-automation""])\nchrome_options.add_argument(""--start-maximized"")\nchrome_options.add_argument(\'--disable-logging\')\nchrome_options.add_argument(\'--no-sandbox\')\nchrome_options.add_argument(\'--disable-dev-shm-usage\')\nchrome_options.add_argument(\'--disable-blink-features=AutomationControlled\')\ncaps = DesiredCapabilities.CHROME\ncaps[\'goog:loggingPrefs\'] = {\'performance\': \'ALL\'}\n\n# for editing chromedriver exe so that its not detected(run only once)\nwith open(""chromedriver.exe"",""rb"") as d:\n    file_data=d.read()\nfile_data=file_data.replace(b""cdc_"",b""tch_"")\nwith open(""chromedriver.exe"",""wb"") as d:\n    d.write(file_data)\ndriver = webdriver.Chrome(\'chromedriver.exe\',chrome_options=chrome_options,desired_capabilities=caps)\n\n# for injecting js to that tab so that browser not detected\nstealth(driver,languages=[""en-US"", ""en""],vendor=""Google Inc."",platform=""Win32"",webgl_vendor=""Intel Inc."",renderer=""Intel Iris OpenGL Engine"",fix_hairline=True,)\ndriver.get(""https://accounts.google.com"")\ntime.sleep(3)\ndriver.switch_to.active_element.send_keys(""myemail@gmail.com\\n"")\ntime.sleep(3)\ndriver.switch_to.active_element.send_keys(""mypassword\\n"")\n\n']"
Can a Perl script install its own CPAN dependencies?,"
I have a Perl script that has two dependencies that exist in CPAN. What I'd like to do is have the script itself prompt the user to install the necessary dependencies so the script will run properly. If the user needs to enter in some kind of authentication to install the dependencies that's fine: what I'm trying to avoid is the following workflow:

Run script -> Watch it fail -> Scour CPAN aimlessly -> Lynch the script writer

Instead I'm hoping for something like:

Run script -> Auto-download script dependencies (authenticating as necessary) -> Script succeeds -> Buy the script writer a beer

Can this be done?
",3k,"
            17
        ","[""\nEach of the standard build paradigms has their own way of specifying dependencies. In all of these cases, the build process will attempt to install your dependencies, automatically in some contexts.\nIn ExtUtils::MakeMaker, you pass a hash reference in the PREREQ_PM field to WriteMakefile:\n# Makefile.PL for My::Module\nuse ExtUtils::MakeMaker;\n\nWriteMakefile (\n    NAME => 'My::Module',\n    AUTHOR => ...,\n    ...,\n    PREREQ_PM => {\n        'Some::Dependency' => 0,             # any version\n        'Some::Other::Dependency' => 0.42,   # at least version 0.42\n        ...\n    },\n    ...\n );\n\nIn Module::Build, you pass a hashref to the build_requires field:\n# Build.PL\nuse Module::Build;\n...\nmy $builderclass = Module::Build->subclass( ... customizations ... );\nmy $builder = $builderclass->new(\n    module_name => 'My::Module',\n    ...,\n    build_requires => {\n        'Some::Dependency' => 0,\n        'Some::Other::Dependency' => 0.42,\n    },\n    ...\n);\n$builderclass->create_build_script();\n\nIn Module::Install, you execute one or more requires commands before calling the command to write the Makefile:\n# Makefile.PL\nuse inc::Module::Install;\n...\nrequires 'Some::Dependency' => 0;\nrequires 'Some::Other::Dependency' => 0.42;\ntest_requires 'Test::More' => 0.89;\n...\nWriteAll;\n\n"", ""\nYou can probably just execute this from inside your script.\nperl -MCPAN -e 'install MyModule::MyDepends'\n""]"
win32: simulate a click without simulating mouse movement?,"
I'm trying to simulate a mouse click on a window. I currently have success doing this as follows (I'm using Python, but it should apply to general win32):
win32api.SetCursorPos((x,y))
win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN,0,0)
win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP,0,0)

This works fine. However, if the click happens while I'm moving the mouse manually, the cursor position gets thrown off. Is there any way to send a click directly to a given (x,y) coordinate without moving the mouse there? I've tried something like the following with not much luck:
nx = x*65535/win32api.GetSystemMetrics(0)
ny = y*65535/win32api.GetSystemMetrics(1)
win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN | \
                     win32con.MOUSEEVENTF_ABSOLUTE,nx,ny)
win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP | \
                     win32con.MOUSEEVENTF_ABSOLUTE,nx,ny)

",21k,"
            10
        ","['\nTry WindowFromPoint() function:\nPOINT pt;\n    pt.x = 30; // This is your click coordinates\n    pt.y = 30;\n\nHWND hWnd = WindowFromPoint(pt);\nLPARAM lParam = MAKELPARAM(pt.x, pt.y);\nPostMessage(hWnd, WM_RBUTTONDOWN, MK_RBUTTON, lParam);\nPostMessage(hWnd, WM_RBUTTONUP, MK_RBUTTON, lParam);\n\n', ""\nThis doesn't answer the question, but it does solve my problem:\nwin32api.ClipCursor((x-1,y-1,x+1,y+1))\nwin32api.SetCursorPos((x,y))\nwin32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN| \\\n                     win32con.MOUSEEVENTF_ABSOLUTE,0,0)\nwin32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP| \\\n                     win32con.MOUSEEVENTF_ABSOLUTE,0,0)\nwin32api.ClipCursor((0,0,0,0))\n\nThe result is that any movements I'm making won't interfere with the click. The downside is that my actual movement will be messed up, so I'm still open to suggestions.\n""]"
"UI Automation ""Selected text""","
Anyone knows how to get selected text from other application using UI Automation and .Net?
http://msdn.microsoft.com/en-us/library/ms745158.aspx
",5k,"
            9
        ","['\nprivate void button1_Click(object sender, EventArgs e) {\n        Process[] plist = Process.GetProcesses();\n\n        foreach (Process p in plist) {\n            if (p.ProcessName == ""notepad"") {\n\n                AutomationElement ae = AutomationElement.FromHandle(p.MainWindowHandle);\n\n                AutomationElement npEdit = ae.FindFirst(TreeScope.Descendants, new PropertyCondition(AutomationElement.ClassNameProperty, ""Edit""));\n\n                TextPattern tp = npEdit.GetCurrentPattern(TextPattern.Pattern) as TextPattern;\n\n                TextPatternRange[] trs;\n\n                if (tp.SupportedTextSelection == SupportedTextSelection.None) {\n                    return;\n                }\n                else {\n                    trs = tp.GetSelection();\n                    lblSelectedText.Text = trs[0].GetText(-1);\n                }\n            }\n        }\n    }\n\n', '\nHere is another solution using only UI Automation.\nIt gets the selected text from Notepad and Wordpad.\n// Get only top level windows\nPropertyCondition condition = new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Window);\nAutomationElementCollection windows = AutomationElement.RootElement.FindAll(TreeScope.Children, condition);\nList<AutomationElement> allDocuments = new List<AutomationElement>();\n\nforeach (AutomationElement window in windows)\n{\n    string className = window.Current.ClassName;\n    if (className == ""Notepad"" || className == ""WordPadClass"")\n    {\n        condition = new PropertyCondition(AutomationElement.ControlTypeProperty, ControlType.Document);\n        AutomationElementCollection documents = window.FindAll(TreeScope.Children, condition);\n\n        if (documents.Count > 0)\n        {\n            allDocuments.Add(documents[0]);\n        }\n    }\n}\n\n// store all pieces of selected text here\nList<string> selectedText = new List<string>();\n\n// iterate through all documents found\nforeach (AutomationElement document in allDocuments)\n{\n    object patternObj = null;\n    if (document.TryGetCurrentPattern(TextPattern.Pattern, out patternObj) == true)\n    {\n        TextPattern textPattern = patternObj as TextPattern;\n        TextPatternRange[] ranges = textPattern.GetSelection();\n\n        foreach (TextPatternRange range in ranges)\n        {\n            string text = range.GetText(-1);\n            if (text.Length > 0)\n            {\n                selectedText.Add(text);\n            }\n        }\n    }\n}\n\n']"
VBA Internet Explorer wait for web page to load,"
I know questions like this have been asked before, but mine is a bit different and has been fairly troubling.  What I'm dealing with is a web page with a form with a few events that load more of the page when certain items in input boxes are filled out.  When these events fire the page loads again, but remains at the same URL with the same nameprop.  I've been using the following types of methods both seperately and strung together to handle waiting for the page to load, but sometimes the VBA still manages to continue executing and set the HTMLDocument variable to a page without the appropriate information on it causing the macro to debug.  Here are the kinds of things I've been trying so far:
While IE.Busy
    DoEvents
Wend

Do Until IE.statusText = ""Done""
    DoEvents
Loop

Do Until IE.readyState = 4
    DoEvents
Loop

I've even attempted to place these events into a loop like the following, but it didn't quite work because the lastModified property only returns a value down to the second and the macro spins through the fields fast enough that it is returning a new page in the same second:
Do Until IE.statusText = ""Done"" And IE.Busy = False And IE.ReadyState = 4 _
And IE.document.lastModified > LastModified ----or---- IE.document.nameprop = _
""some known and expected name prop here""
    While IE.Busy
        DoEvents
    Wend
    Do Until IE.statusText = ""Done""
        DoEvents
    Loop
    Do Until IE.readyState = 4
        DoEvents
    Loop
Loop

Even that fails to wait long enough to set the HTMLDocument object leading to a debug.  I've contemplated setting the next input element and checking that for nothing to further the code, but even that wouldn't be successful 100% of the time because generally the Input elements exist in the HTML but are hidden until the appropriate event is fired, which wouldn't be a problem but they don't load their possible selections until after the event is fired.  It might be an odd page.
Anyway... not sure what else to add.  If there is something else that might be helpful to see just ask.  I guess what I'm looking for is a way to get VBA to wait until IE knows another page isn't on it's way.  It seems to load a few times before it is completely done.
So... Anyone have any ideas?
EDIT:  Found a few new things to try.  Still, no dice.  It was suggested that I add these attempts.  Here is the code, for some reason the VBE and excel instance become non-responsive when using this approach after firing an event that should populate the options on the select element... thinking about trying xml... here is the code:
intCounter = 0
Do until intCounter > 2
    Do Until IE.Busy = False: DoEvents: Loop
    Do Until IE.ReadyState = 4: DoEvents: Loop
    Set HTMLDoc = IE.Document
    Do Until HTMLDoc.ReadyState = ""complete""
    Set HTMLSelect = HTMLDoc.getElementById(""ctl00$ctl00$MainContent$ChildMainContent$ddlEmployeeBranchCodes"")
    intCounter = 0
    For each Opt in HTMLSelect
        intCounter = intCounter + 1
    Next Opt
Loop

Based on what I can see happening on the web page, I know that it is somewhere in this loop that the VBE and Excel become non-responsive.  
Hope that helps... I know it didn't help me... Drats.
EDIT:  Just thought I'd add this.  When it comes to automating a web page, for the most part, I no longer use IE.  I've found it's much better, and sidesteps this issue of async stuff entirely, to simply perform the posts and gets yourself.  May not be the best solution depending on what you're trying to do, but it works pretty reliably if you look at the traffic closely and parameterize things well.
",50k,"
            7
        ","[""\nAfter an exhaustive search, I've determined that the AJAX request, javascript code that runs asynchronously in the background isn't something I can get a signal from in any way.  It does seem to trigger some event when it finishes with loading the page, which is an option I'd like to explore in the future.  However, for my purposes I simply used the same code I was already using to fill out the form on my page and I have it loop through each field again to check to see if the values are still correct before clicking the submit button.  It isn't an ideal solution, but it is a workaround that appears to have taken care of my issue in this case. \nI'm not sure if my solution would be applicable to someone else dealing with this issue, but there it is if it helps.  I think workarounds for this issue are going to have to be based on the application and web page in question.\n"", '\nOld question I know, but I think this is a good answer that I haven\'t seen about much...\n\nI had a similar problem; waiting for all the images on a google image search to load (which is a tricky thing since image loads are prompted by AJAX and the user scrolling the page). As has been suggested in the comments; my solution was to wait for a certain element to appear in the viewport (this is an area a little larger than the monitor screen, and is treated as what you can actually ""see"").\nThis is achieved with the getBoundingClientRect method\nDim myDiv As HTMLDivElement: Set myDiv = currPage.getElementById(""fbar"") \n\'myDiv should some element in the page which will only be visible once everything else is loaded\nDim elemRect As IHTMLRect: Set elemRect = myDiv.getBoundingClientRect\nDo Until elemRect.bottom > 0 \'If the element is not in the viewport, then this returns 0\n    DoEvents\n    \'Now run the code that triggers the Ajax requests\n    \'For me that was simply scrolling down by a big number\n    Set elemRect = myDiv.getBoundingClientRect\nLoop\nmyDiv.ScrollIntoView\n\nI explain in detail in the linked answer how this works, but essentially the BoundingClientRect.bottom is equal to 0 until the element is in the vieport.\nThe element is something which is loaded straight away (like a frame/template for the page). But you don\'t actually see it until all the content has been loaded, because it\'s right at the bottom. \nIf that element is indeed the last thing to be loaded (for my google search it was the Show More Results button), then as long as you get it into the viewport when it\'s loaded, you should be able to detect when it appears on the page. .bottom then returns a non-zero value (something to do with the actual position of the element on the page  - I didn\'t really care though for my purposes). I finish off with a .ScrollIntoView, but that\'s not essential.\n', '\nI had the same problem with My Webpage..\nWhat is did is...\nthe fist option is\nWhile Ie.**document**.readystate=""complete""\nDoEvents\nWend\n\nthere were few boxes in which options were loaded after a button click/even fire in another box...I jsst placed code like this..\nDo Until IE.document.getelementbyid(""Next box"").Lenght>0\nDoEvents\nLoop\nApplication.wait Now+Timevalue(""00:00:02)\n\n']"
How to connect to existing instance of Excel from PowerShell?,"
All examples that automate Excel through PowerShell start with this line:
PS> $Excel = New-Object -Com Excel.Application

This seems to be handling a new instance of Excel, e.g. running $Excel.Visible = $true will show an empty, blank Excel window, not switch to the existing workbook.
If there is already an instance of Excel running, is there a way to connect to it?
",7k,"
            7
        ","['\nInstead of the usual New-Object -ComObject excel.application us this\n$excel = [Runtime.Interopservices.Marshal]::GetActiveObject(\'Excel.Application\')\nRest stays the same. \nOne downside. You will only get the excel ""instances"" started by the same user that will initiate the ps1.  \n', '\nYes, you can access the COM object via HWND [Window handle] using this WIN32 API (AccessibleObjectFromWindow). \n\n(See a SO post sample here of using this api via C#)\n\n.\nYou may have to write an assembly in C# and/or manipulate P/Invoke calls via Powershell.\nYou may give a shot at it & see how it goes.\n']"
reusing Internet Explorer COM Automation Object,"
I am using VBScript macros to utilize the InternetExplorer.Application COM automation object and I am struggling with reusing an existing instance of this object.
From what I have read, I should be able to use the GetObject() method in vbscript to grab a hold of an existing instance of this object.
When I execute the following code I get an ""Object creation failed - moniker syntax error"".
Is my issue really syntax? 
Is my issue how I am trying to use this object? 
or can what I am trying to accomplish just not be done?
Code:
Dim IEObject as object

Sub Main  
  Set IEObject =  GetObject( ""InternetExplorer.Application"" )

  'Set the window visable
  IEObject.Visible = True

  'Navigate to www.google.com
  IEObject.Navigate( ""www.google.com"" )
End Sub

Also, I have no problem running the CreateObject() which opens up a new internet explorer window and navigates where i want to, but i would rather not have the macro open up multiple instances of Internet Explorer.
",11k,"
            6
        ","['\nTry This:\n\nSet IEObject =  GetObject( ,""InternetExplorer.Application"" )\n\n*Notice the comma before ""InternetExplorer.Application""\nEDIT:\nTry this:\n\nDim IE As SHDocVw.InternetExplorer\n\nSet IE = GetObject(,""InternetExplorer.Application"")\n\nYou can also try this:\n\nDim ShellApp\nSet ShellApp = CreateObject(""Shell.Application"")\nDim ShellWindows\nSet ShellWindows = ShellApp.Windows()\nDim i\nFor i = 0 To ShellWindows.Count - 1\n    If InStr(ShellWindows.Item(i).FullName, ""iexplore.exe"") <> 0 Then\n        Set IEObject = ShellWindows.Item(i) \n    End If\nNext\nIEObject.Navigate2(""http://www.google.com"")\n\nEDIT: What you are trying may not be possible, take a look at this. http://support.microsoft.com/kb/239470\n']"
Clicking a button on a page using a Greasemonkey/userscript in Chrome,"
I'm going to be as absolutely verbose here as possible as I've run into a few solutions that didn't end up panning out. Please keep in mind that I don't know Javascript. I know basic HTML and CSS. I don't have any actual programming background but I'm trying to learn bit by bit by researching basic tasks like this. Please talk to me like I'm an idiot. Any lingo I throw around in this post I learned while researching this specific issue. I'm writing this userscript as a personal project and to share with some friends.
What I'm trying to do.
I'm trying to write a userscript for Chrome/Greasemonkey (Chrome is my target browser) that will click the Refresh button on the Battlefield 3 server browser. For those of you that don't know, Battlefield 3 uses a web site paired with a browser plugin for VOIP and actually launching the game via a server browser. The bulk of it seems to be fairly straight forward HTML arranged in tables.
The idea is that when viewing the main page for a server that is full, the script will click the Refresh button every three seconds or so until the page reports an open spot on the server, then stop the refresh loop and click the join server button. I've already got the part of the script running that polls the server current and maximum players then assigns them to their own variables.
At this point I'm trying to get a click to work in the console so I can actually put it to some use in my script and am having zero luck.
The code I'm trying to manipulate.
This is the div for the button that I'm trying to click pulled from the Chrome dev tools:
<div class=""serverguide-header-refresh-button alternate show""> 
<div type=""reset"" class=""common-button-medium-grey"">
<p style=""position: relative;"">
<a href=""/bf3/servers/show/c7088bdc-2806-4758-bf93-2106792b34d8/"">Refresh </a>
</p>
</div>
</div>

(That link is not static. It's a link to a specific server page)
What I've tried.
To actually find the button I'm using getElementsByClassName. It doesn't have a unique ID but the class is unique to that element on this particular page so getElementsByClassName(""serverguide-header-refresh-button"")[0] is pulling the proper div each time. It's getting the script to perform any actual action on the button that's the problem.
document.getElementsByClassName(""serverguide-header-refresh-button"")[0].click();

I now realize this didn't work because it's not a conventional submit button. I don't understand the specifics of the standard here but I get that it doesn't support the .click() method.
function addJQuery(callback) {
  var script = document.createElement(""script"");
  script.setAttribute(""src"", ""http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"");
  script.addEventListener('load', function() {
    var script = document.createElement(""script"");
    script.textContent = ""("" + callback.toString() + "")();"";
    document.body.appendChild(script);
  }, false);
  document.body.appendChild(script);
}

// the guts of this userscript
function main() {
  unsafeWindow.jQuery('.serverguide-header-refresh-button')[0].click();
}

// load jQuery and execute the main function
addJQuery(main);

This is simply unsafeWindow.jQuery('.serverguide-header-refresh-button').click(); wrapped in some code to load jQuery for userscripts. It was a bit I picked up elsewhere but was told it would only work if jQuery was loaded on the page. I figured it was worth a try. This is one of those I have no idea what I'm doing shots in the dark and it didn't work. I tried the same thing below with another snippet of jQuery code I picked up:
function addJQuery(callback) {
  var script = document.createElement(""script"");
  script.setAttribute(""src"", ""http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"");
  script.addEventListener('load', function() {
    var script = document.createElement(""script"");
    script.textContent = ""("" + callback.toString() + "")();"";
    document.body.appendChild(script);
  }, false);
  document.body.appendChild(script);
}

// the guts of this userscript
function main() {
   var evObj = document.createEvent('Events');
      evObj.initEvent(""click"", true, false);
      document.getElementsByClassName('serverguide-header-refresh-button')[0].dispatchEvent(evObj);
}

    // load jQuery and execute the main function
addJQuery(main);

Both of these return Undefined in the Chrome and Firebug consoles.
So, would anyone be so kind as to help me create a bit of code for this script to press the Refresh button on this page?
",11k,"
            6
        ","['\nNote:\n\njQuery .click() does not work reliably on click events that were not set via jQuery in the first place.\nYou need to create the right kind of event; createEvent(\'Events\') is not the way.\nAs Jim Deville pointed out, the link pseudo-button was not being selected.\nYou do not need jQuery for this (so far).\nMake sure that the ""Refresh"" control is loaded statically for the test code as shown in the question.  If it\'s AJAXed in, the click attempt may fire too soon.\n\nPutting that all together, the following code should work.  But beware that some sites (like certain Google apps) use funky, state-sensitive designs -- which require a sequence of events.\nvar refreshBtn = document.querySelector (\n    ""div.serverguide-header-refresh-button div[type=\'reset\'] a""\n);\nvar clickEvent = document.createEvent (\'MouseEvents\');\nclickEvent.initEvent (\'click\', true, true);\nrefreshBtn.dispatchEvent (clickEvent);\n\n', '\nso, you are on the right track, but you keep grabbing the DIV not the A tag. To click on the ""button"" (link in this case), you have to click on the actual link because it won\'t tunnel down to the elements contained in the DIV.\ndocument.querySelector(\'serverguide-header-refresh-button a\')\n\nShould get you the A element to click on. From jQuery $(\'serverguide-header-refresh-button a\').click(); should work.\n']"
simulate backspace key with java.awt.Robot,"
There seems to be an issue simulating the backspace key with java.awt.Robot.
This thread seems to confirm this but it does not propose a solution.
This works:
Robot rob = new Robot();
rob.keyPress(KeyEvent.VK_A);
rob.keyRelease(KeyEvent.VK_A);

This doesn't:
Robot rob = new Robot();
rob.keyPress(KeyEvent.VK_BACK_SPACE);
rob.keyRelease(KeyEvent.VK_BACK_SPACE);

Any ideas?
",10k,"
            5
        ","['\nIt seems to work in this test.\nAddendum: Regarding the cited article, ""Aside from those keys that are defined by the Java language (VK_ENTER, VK_BACK_SPACE, and VK_TAB), do not rely on the values of the VK_ constants. Sun reserves the right to change these values as needed to accomodate a wider range of keyboards in the future.""—java.awt.event.KeyEvent\npublic class RobotTest {\n\n    public static void main(String[] args) {\n        EventQueue.invokeLater(new Runnable() {\n            public void run() {\n                new RobotTest().create();\n            }\n        });\n    }\n\n    private void create() {\n        JFrame f = new JFrame();\n        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);\n        f.setLocationRelativeTo(null);\n        f.setLayout(new FlowLayout());\n        f.add(new JTextField(8));\n        final JButton b = new JButton();\n        f.getRootPane().setDefaultButton(b);\n        b.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e) {\n                b.setText(""@"" + e.getWhen());\n            }\n        });\n        f.add(b);\n        f.setSize(256, 128);\n        f.setVisible(true);\n        doTest();\n    }\n\n    private void doTest() {\n        try {\n            Robot r = new Robot();\n            int[] keys = {\n                KeyEvent.VK_T, KeyEvent.VK_E,\n                KeyEvent.VK_S, KeyEvent.VK_T,\n                KeyEvent.VK_Z, KeyEvent.VK_BACK_SPACE,\n                KeyEvent.VK_ENTER\n            };\n            for (int code : keys) {\n                r.keyPress(code);\n                r.keyRelease(code);\n            }\n        } catch (AWTException ex) {\n            ex.printStackTrace(System.err);\n        }\n    }\n}\n\n', '\nThe Backspace functionality does not work as expected. I added a Shift key with the Backspace and it works fine for me, here is the pseudo-code for it.\nrobot.keyPress(KeyEvent.VK_SHIFT);\nrobot.keyPress(KeyEvent.VK_BACK_SPACE);\nrobot.keyRelease(KeyEvent.VK_BACK_SPACE);\nrobot.keyRelease(KeyEvent.VK_SHIFT);\n\nThis does not seem to work for the Delete key though.\n']"
How to call python file in a feature file of karate automation?,"
I need to call a .py file and pass an argument to one of the functions in it and have to match the result returned.
For instance:
xyz.py
KarateXyz.feature

match result == call('xyz.py')# how to specify the method name and pass an argument in it?

",744,"
            1
        ","[""\nYes, you can use karate.exec() to call any OS process. Whether python is installed is up to you. Refer https://github.com/intuit/karate#karate-exec\n* def result = karate.exec('python foo.py bar')\n\nFor more details, refer: https://stackoverflow.com/a/64352676/143475\n""]"
"Auto-reload browser when I save changes to html file, in Chrome?","
I'm editing an HTML file in Vim and I want the browser to refresh whenever the file underneath changes. 
Is there a plugin for Google Chrome that will listen for changes to the file and auto refresh the page every time I save a change to the file? I know there's XRefresh for Firefox but I could not get XRefresh to run at all.
How hard would it be to write a script to do this myself?
",122k,"
            147
        ","['\nPure JavaScript solution!\nLive.js\nJust add the following to your <head>:\n<script type=""text/javascript"" src=""https://livejs.com/live.js""></script>\n\n\nHow?\nJust include Live.js and it will monitor the current page including local CSS and Javascript by sending consecutive HEAD requests to the server. Changes to CSS will be applied dynamically and HTML or Javascript changes will reload the page. Try it!\n\n\nWhere?\nLive.js works in Firefox, Chrome, Safari, Opera and IE6+ until proven otherwise. Live.js is independent of the development framework or language you use, whether it be Ruby, Handcraft, Python, Django, NET, Java, Php, Drupal, Joomla or what-have-you.\n\nI copied this answer almost verbatim from here, because I think it\'s easier and more general than the currently accepted answer here.\n', '\nWith the addition of a single meta tag into your document, you can instruct the browser to automatically reload at a provided interval:\n<meta http-equiv=""refresh"" content=""3"" >\n\nPlaced within the head tag of your document, this meta tag will instruct the browser to refresh every three seconds.\n', ""\nI know this is an old question but in case it helps someone, there is a reload npm package that solves it.\nIn case that you are not running it on a server or have received the error Live.js doesn't support the file protocol. It needs http.\nJust install it:\nnpm install reload -g\n\nand then at your index.html directory, run:\nreload -b\n\nIt will start a server that will refresh every time you save your changes.\nThere are many other options in case you're running it on the server or anything else. Check the reference for more details!\n"", '\nHandy Bash one-liner for OS X, assuming that you have installed fswatch (brew install fswatch). It watches an arbitrary path/file and refreshes the active Chrome tab when there are changes:\nfswatch -o ~/path/to/watch | xargs -n1 -I {} osascript -e \'tell application ""Google Chrome"" to tell the active tab of its first window to reload\'\n\nSee more about fswatch here: https://stackoverflow.com/a/13807906/3510611\n', '\nI assume you\'re not on OSX?  Otherwise you could do something like this with applescript:\nhttp://brettterpstra.com/watch-for-file-changes-and-refresh-your-browser-automatically/\nThere is also a plugin for chrome called ""auto refresh plus"" where you can specify a reload every x seconds:\nhttps://chrome.google.com/webstore/detail/auto-refresh-plus-page-mo/hgeljhfekpckiiplhkigfehkdpldcggm?hl=en\n', '\nUpdate: Tincr is dead.\nTincr is a Chrome extension that will refresh the page whenever the file underneath changes.\n', '\nUse Gulp to watch the files and Browsersync to reload the browser.\nThe steps are:\nIn the command line execute\n\nnpm install --save-dev gulp browser-sync\n\nCreate gulpfile.js with the following contents:\nvar gulp = require(\'gulp\');\nvar browserSync = require(\'browser-sync\').create();\nvar reload = browserSync.reload;\n\ngulp.task(\'serve\', function() {\n  browserSync.init({\n    server: {\n      baseDir: ""./""\n    }\n  });\n\n  gulp.watch(""*.html"").on(""change"", reload);\n});\n\nRun\n\ngulp serve\n\nEdit HTML, save and see your browser reload. The magic is done through on-the-fly injection of special  tag into your HTML files.\n', '\nhttp://livereload.com/ - native app for OS X, Alpha version for Windows. Open sourced at https://github.com/livereload/LiveReload2\n', ""\nIf you are on GNU/Linux, you can use a pretty cool browser called Falkon. It's based on the Qt WebEngine. It's just like Firefox or Chromium - except, it auto refreshes the page when a file is updated. The auto refresh doesn't matter much whether you use vim, nano, or atom, vscode, brackets, geany, mousepad etc.\nOn Arch Linux, you can install Falkon pretty easily:\nsudo pacman -S falkon\n\nHere's the snap package.\n"", ""\nFollowing couple of lines can do the trick:\nvar bfr = '';\nsetInterval(function () {\n    fetch(window.location).then((response) => {\n        return response.text();\n    }).then(r => {\n        if (bfr != '' && bfr != r) {\n            window.location.reload();\n        }\n        else {\n            bfr = r;\n        }\n    });\n}, 1000);\n\nThis compares current response text with previously buffered response text after every second and will reload the page if there are any change in source code. You don't need any heavy duty plugins if you are just developing light weight pages.\n"", '\nThere is a java app for os x and Chrome called Refreschro. It will monitor a given set of files on the local file system and reload Chrome when a change is detected:\nhttp://neromi.com/refreschro/\n', '\nThis works for me (in Ubuntu):\n#!/bin/bash\n#\n# Watches the folder or files passed as arguments to the script and when it\n# detects a change it automatically refreshes the current selected Chrome tab or\n# window.\n#\n# Usage:\n# ./chrome-refresher.sh /folder/to/watch\n\nTIME_FORMAT=\'%F %H:%M\'\nOUTPUT_FORMAT=\'%T Event(s): %e fired for file: %w. Refreshing.\'\n\nwhile inotifywait --exclude \'.+\\.swp$\' -e modify -q \\\n    -r --timefmt ""${TIME_FORMAT}"" --format ""${OUTPUT_FORMAT}"" ""$@""; do\n    xdotool search --onlyvisible --class chromium windowactivate --sync key F5 \\\n    search --onlyvisible --class gnome-terminal windowactivate\ndone\n\nYou may need to install inotify and xdotool packages (sudo apt-get install inotify-tools xdotool in Ubuntu) and to change args of --class to the actual names of your preferred browser and terminal.\nStart the script as described and just open index.html in a browser. After each save in vim the script will focus your browser\'s window, refresh it, and then return to the terminal.\n', '\nA quick solution that I sometimes use is to divide the screen into\ntwo, and each time a change is made, click on the document xD .\n<script>\ndocument.addEventListener(""click"", function(){\n    window.location.reload();\n})\n</script>\n\n', '\nIf you are you are using visual studio code (which I highly recommend for Web Development), there is an extension by the name Live Server by Ritwick Dey with more than 9 million downloads. Just install it (recommended to restart vs code after that), and then just right-click on your main HTML file, there will be an option ""open with Live Server"", click it and your Website will be automatically open in a browser on a local server.\n', '\nIn node.js, you can wire-up primus.js (websockets) with gulp.js + gulp-watch (a task runner and change listener, respectively), so that gulp lets your browser window know it should refresh whenever html, js, etc, change. This is OS agnostic and I have it working in a local project. \nHere, the page is served by your web server, not loaded as a file from disk, which is actually more like the real thing.\n', ""\nThe most flexible solution I've found is the chrome LiveReload extension paired with a guard server. \nWatch all files in a project, or only the ones you specify. Here is a sample Guardfile config:\nguard 'livereload' do\n  watch(%r{.*\\.(css|js|html|markdown|md|yml)})\nend\n\nThe downside is that you have to set this up per project and it helps if you're familiar with ruby.\nI have also used the Tincr chrome extension - but it appears to be tightly coupled to frameworks and file structures. (I tried wiring up tincr for a jekyll project but it only allowed me to watch a single file for changes, not accounting for includes, partial or layout changes). Tincr however, works great out of the box with projects like rails that have consistent and predefined file structures. \nTincr would be a great solution if it allowed all inclusive match patterns for reloading, but the project is still limited in its feature set. \n"", '\nThis can be done using a simple python script.\n\nUse pyinotify to monitor a particular folder.\nUse Chrome with debugging enabled. Refresh can be done via a websocket connection.\n\nFull details can be referred here.\n', '\nBased on attekei\'s answer for OSX:\n$ brew install fswatch\n\nChuck all this into reload.scpt:\nfunction run(argv) {\n    if (argv.length < 1) {\n        console.log(""Please supply a (partial) URL to reload"");\n        return;\n    }\n    console.log(""Trying to reload: "" + argv[0]);\n    let a = Application(""Google Chrome"");\n    for (let i = 0; i < a.windows.length; i++) {\n        let win = a.windows[i];\n        for (let j = 0; j < win.tabs.length; j++) {\n            let tab = win.tabs[j];\n            if (tab.url().startsWith(""file://"") && tab.url().endsWith(argv[0])) {\n                console.log(""Reloading URL: "" + tab.url());\n                tab.reload();\n                return;\n            }\n        }\n    }\n    console.log(""Tab not found."");\n}\n\nThat will reload the first tab that it finds that starts with file:// and ends with the first command line argument. You can tweak it as desired.\nFinally, do something like this.\nfswatch -o ~/path/to/watch | xargs -n1 osascript -l JavaScript reload.scpt myindex.html \n\nfswatch -o outputs the number of files that have changed in each change event, one per line. Usually it will just print 1. xargs reads those 1s in and -n1 means it passes each one as an argument to a new execution of osascript (where it will be ignored).\n', ""\nAdd this to your HTML\n<script> window.addEventListener('focus', ()=>{document.location = document.location})</script>\n\nWhile you are editing, your browser page is blurred, by switching back to look at it, the focus event is fired and the page reloads.\n"", '\nInstall and set up chromix\nNow add this to your .vimrc\nautocmd BufWritePost *.html,*.js,*.css :silent ! chromix with http://localhost:4500/ reload\n\nchange the port to what you use\n', ""\nOk, here is my crude Auto Hotkey solution (On Linux, try Auto Key). When the save keyboard shortcut gets pressed, activate the browser, click the reload button, then switch back to the editor. Im just tired of getting other solutions running. Wont work if your editor does autosave.\n^s::   ; '^' means ctrl key. '!' is alt, '+' is shift. Can be combined.\n    MouseGetPos x,y\n    Send ^s\n\n    ; if your IDE is not that fast with saving, increase.\n    Sleep 100\n\n    ; Activate the browser. This may differ on your system. Can be found with AHK Window Spy.\n    WinActivate ahk_class Chrome_WidgetWin_1\n    WinWaitActive ahk_class Chrome_WidgetWin_1\n    Sleep 100   ; better safe than sorry.\n\n    ;~ Send ^F5   ; I dont know why this doesnt work ...\n    Click 92,62   ; ... so lets click the reload button instead.\n\n    ; Switch back to Editor. Can be found with AHK Window Spy.\n    WinActivate ahk_class zc-frame\n    WinWaitActive ahk_class zc-frame\n    Sleep 100   ; better safe than sorry.\n\n    MouseMove x,y\n    return\n\n"", '\nOffline solution using R\nThis code will:\n\nsetup a local server using the given .html-file\nreturn the server adress, so that you can watch it in a browser.\nmake the browser refresh everytime a change is saved to the .html-file.\n\ninstall.packages(""servr"")\nservr::httw(dir = ""c:/users/username/desktop/"")\n\n\n\nSimilar solutions exist for python etc. \n', '\nIf you have Node installed on your computer, then you can use light-server.\nSetp 1: Install light-server using command npm install -g light-server\nStep 2: While current working directory is the folder containing the static HTML page, start light-server using command npx light-server -s . -p 5000 -w ""*.css # # reloadcss"" -w ""*.html # # reloadhtml"" -w ""*.js # # reloadhtml""\nStep 3: Open the web page in browser at http://localhost:5000\n\n\nIn Step 2,\nPort can be changed using -p switch\nFiles that are being watched can be changed using -w switch\nServer directory can be changed using -s switch\n\nDocumentation for light-server is at https://www.npmjs.com/package/light-server\n', '\nAdd this in your ""head"" section.\nchange the time from 3000ms to any value which you prefer.\nA small hack to reload html file every 3secs. This is useful to me when I use vim + browser setup for JS development.\n    <script>\n        function autoreload() {\n            location.reload();\n        }\n        setInterval(autoreload, 3000);\n    </script>\n\n', '\nLive reload works fine on js and css changes. However it was not working for laravel\'s blade templates. So I wrote a small script that checks for page changes and reloads if there is change.\nAm not sure if it is the best way, but it works.\nI used the script together with Live.js.\nHere it is.\n    window.addEventListener(""load"", function(){\n        var current_url = window.location.href;\n        var current_data = httpGet(current_url);\n        var compone = current_data.length;\n        setInterval(function(){\n        var current_data_twos = httpGet(current_url);\n        var componecurrent_data_twos = current_data_twos.length;\n        if(compone !=componecurrent_data_twos ){\n          location.reload();\n        }\n      }, 1000);\n    });\n    function httpGet(theUrl)\n    {\n        let xmlhttp;\n\n        if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari\n            xmlhttp=new XMLHttpRequest();\n        } else { // code for IE6, IE5\n            xmlhttp=new ActiveXObject(""Microsoft.XMLHTTP"");\n        }\n        xmlhttp.onreadystatechange=function() {\n            if (xmlhttp.readyState==4 && xmlhttp.status==200) {\n                return xmlhttp.responseText;\n            }\n        }\n        xmlhttp.open(""GET"", theUrl, false);\n        xmlhttp.send();\n        return xmlhttp.response;\n    }\n\n', '\nJust use the Live server extension and open the file with live server. extension namelive server\n', '\npip install https://github.com/joh/when-changed/archive/master.zip\n\nalias watch_refresh_chrome="" when-changed -v -r -1 -s ./ osascript -e \'tell application \\""Google Chrome\\"" to tell the active tab of its first window to reload\' ""\n\nthen just enter the directory you want to monitor execute ""watch_refresh_chrome""\n', '\n(function() {\n    setTimeout(function(){\n        window.location.reload(true);\n    }, 100);\n})();\n\nSave this code into a file livereload.js and include it at the bottom of the HTML script like so:\n<script type=""text/javascript"" src=""livereload.js""></script>\n\nWhat will this do is refresh the page every 100 mili-seconds. Any changes you make in code are instantly visible to the eyes.\n', '\nLive Reload Browser Page\n\nLive Reload Browser Page - tool 2022, for auto refreshing the browser page in real time for Google Chrome.\nAdditional features\n\nauto refreshing the browser page in real time\n\nauto HTML validation of the browser page\n\nreal-time alert on the browser page during web development\n\n\n']"
Is it possible to modify a registry entry via a .bat/.cmd script?,"
Is it possible to modify a registry value (whether string or DWORD) via a .bat/.cmd script?
",187k,"
            51
        ","['\n@Franci Penov - modify is possible in the sense of overwrite with /f, eg  \nreg add ""HKCU\\Software\\etc\\etc"" /f /v ""value"" /t REG_SZ /d ""Yes""\n\n', '\nYou can use the REG command. From http://www.ss64.com/nt/reg.html:\nSyntax:\n\n   REG QUERY [ROOT\\]RegKey /v ValueName [/s]\n   REG QUERY [ROOT\\]RegKey /ve  --This returns the (default) value\n\n   REG ADD [ROOT\\]RegKey /v ValueName [/t DataType] [/S Separator] [/d Data] [/f]\n   REG ADD [ROOT\\]RegKey /ve [/d Data] [/f]  -- Set the (default) value\n\n   REG DELETE [ROOT\\]RegKey /v ValueName [/f]\n   REG DELETE [ROOT\\]RegKey /ve [/f]  -- Remove the (default) value\n   REG DELETE [ROOT\\]RegKey /va [/f]  -- Delete all values under this key\n\n   REG COPY  [\\\\SourceMachine\\][ROOT\\]RegKey [\\\\DestMachine\\][ROOT\\]RegKey\n\n   REG EXPORT [ROOT\\]RegKey FileName.reg\n   REG IMPORT FileName.reg\n   REG SAVE [ROOT\\]RegKey FileName.hiv\n   REG RESTORE \\\\MachineName\\[ROOT]\\KeyName FileName.hiv\n\n   REG LOAD FileName KeyName\n   REG UNLOAD KeyName\n\n   REG COMPARE [ROOT\\]RegKey [ROOT\\]RegKey [/v ValueName] [Output] [/s]\n   REG COMPARE [ROOT\\]RegKey [ROOT\\]RegKey [/ve] [Output] [/s]\n\nKey:\n   ROOT :\n         HKLM = HKey_Local_machine (default)\n         HKCU = HKey_current_user\n         HKU  = HKey_users\n         HKCR = HKey_classes_root\n\n   ValueName : The value, under the selected RegKey, to edit.\n               (default is all keys and values)\n\n   /d Data   : The actual data to store as a ""String"", integer etc\n\n   /f        : Force an update without prompting ""Value exists, overwrite Y/N""\n\n   \\\\Machine : Name of remote machine - omitting defaults to current machine.\n                Only HKLM and HKU are available on remote machines.\n\n   FileName  : The filename to save or restore a registry hive.\n\n   KeyName   : A key name to load a hive file into. (Creating a new key)\n\n   /S        : Query all subkeys and values.\n\n   /S Separator : Character to use as the separator in REG_MULTI_SZ values\n                  the default is ""\\0"" \n\n   /t DataType  : REG_SZ (default) | REG_DWORD | REG_EXPAND_SZ | REG_MULTI_SZ\n\n   Output    : /od (only differences) /os (only matches) /oa (all) /on (no output)\n\n', '\nYes, you can script using the reg command.\nExample:\nreg add HKCU\\Software\\SomeProduct\nreg add HKCU\\Software\\SomeProduct /v Version /t REG_SZ /d v2.4.6\n\nThis would create key HKEY_CURRENT_USER\\Software\\SomeProduct, and add a String value ""v2.4.6"" named ""Version"" to that key.\nreg /? has the details.\n', '\nThis is how you can modify registry, without yes or no prompt and don\'t forget to run as administrator\nreg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\etc\\etc   /v Valuename /t REG_SZ /d valuedata  /f \n\nBelow is a real example to set internet explorer as my default browser\nreg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\https\\UserChoice   /v ProgId /t REG_SZ /d IE.HTTPS  /f \n\n\n/f Force: Force an update without prompting ""Value exists, overwrite\n  Y/N""\n/d Data   : The actual data to store as a ""String"", integer etc\n/v Value   : The value name eg ProgId\n/t DataType  : REG_SZ (default) | REG_DWORD | REG_EXPAND_SZ |\n  REG_MULTI_SZ\n\nLearn more about  Read, Set or Delete registry keys and values, save and restore from a .REG file. from here \n', '\nYou can make a .reg file and call start on it.  You can export any part of the registry as a .reg file to see what the format is.  \nFormat here:\nhttp://support.microsoft.com/kb/310516\nThis can be run on any Windows machine without installing other software.\n', '\nYes. You can use reg.exe which comes with the OS to add, delete or query registry values. Reg.exe does not have an explicit modify command, but you can do it by doing delete and then add.\n', '\nIn addition to reg.exe, I highly recommend that you also check out powershell, its vastly more capable in its registry handling.\n', '\nSee http://www.chaminade.org/MIS/Articles/RegistryEdit.htm\n']"
Register Variables in Loop in an Ansible Playbook,"
I have two ansible tasks as follows 
  tasks:
 - shell: ifconfig -a | sed 's/[ \t].*//;/^\(lo\|\)$/d'
   register: var1
 - debug: var=var1

 - shell: ethtool -i {{ item }} | grep bus-info | cut -b 16-22
   with_items: var1.stdout_lines
   register: var2
 - debug: var=var2

which is used to get a list of interfaces in a machine (linux) and get the bus address for each. I have one more task as follows in tha same playbook 
 - name: Binding the interfaces
   shell: echo {{ item.item }}
   with_flattened: var2.results
   register: var3

which I expect to iterate over value from var2 and then print the bus numbers. 
var2.results is as follows 
""var2"": {
    ""changed"": true,
    ""msg"": ""All items completed"",
    ""results"": [
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i br0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005778"",
            ""end"": ""2015-04-14 20:29:47.122203"",
            ""invocation"": {
                ""module_args"": ""ethtool -i br0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""br0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:47.116425"",
            ""stderr"": """",
            ""stdout"": """",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp13s0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005862"",
            ""end"": ""2015-04-14 20:29:47.359749"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp13s0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp13s0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:47.353887"",
            ""stderr"": """",
            ""stdout"": ""0d:00.0"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp14s0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005805"",
            ""end"": ""2015-04-14 20:29:47.576674"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp14s0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp14s0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:47.570869"",
            ""stderr"": """",
            ""stdout"": ""0e:00.0"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp15s0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005873"",
            ""end"": ""2015-04-14 20:29:47.875058"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp15s0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp15s0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:47.869185"",
            ""stderr"": """",
            ""stdout"": ""0f:00.0"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp5s0f1: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005870"",
            ""end"": ""2015-04-14 20:29:48.112027"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp5s0f1: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp5s0f1:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:48.106157"",
            ""stderr"": """",
            ""stdout"": ""05:00.1"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp5s0f2: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005863"",
            ""end"": ""2015-04-14 20:29:48.355733"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp5s0f2: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp5s0f2:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:48.349870"",
            ""stderr"": """",
            ""stdout"": ""05:00.2"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp5s0f3: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005829"",
            ""end"": ""2015-04-14 20:29:48.591244"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp5s0f3: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp5s0f3:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:48.585415"",
            ""stderr"": """",
            ""stdout"": ""05:00.3"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp9s0f0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005943"",
            ""end"": ""2015-04-14 20:29:48.910992"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp9s0f0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp9s0f0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:48.905049"",
            ""stderr"": """",
            ""stdout"": ""09:00.0"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i enp9s0f1: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005863"",
            ""end"": ""2015-04-14 20:29:49.143706"",
            ""invocation"": {
                ""module_args"": ""ethtool -i enp9s0f1: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""enp9s0f1:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:49.137843"",
            ""stderr"": """",
            ""stdout"": ""09:00.1"",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i lo: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005856"",
            ""end"": ""2015-04-14 20:29:49.386044"",
            ""invocation"": {
                ""module_args"": ""ethtool -i lo: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""lo:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:49.380188"",
            ""stderr"": ""Cannot get driver information: Operation not supported"",
            ""stdout"": """",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i virbr0: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.005859"",
            ""end"": ""2015-04-14 20:29:49.632356"",
            ""invocation"": {
                ""module_args"": ""ethtool -i virbr0: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""virbr0:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:49.626497"",
            ""stderr"": """",
            ""stdout"": """",
            ""warnings"": []
        },
        {
            ""changed"": true,
            ""cmd"": ""ethtool -i virbr0-nic: | grep bus-info | cut -b 16-22"",
            ""delta"": ""0:00:00.024850"",
            ""end"": ""2015-04-14 20:29:49.901539"",
            ""invocation"": {
                ""module_args"": ""ethtool -i virbr0-nic: | grep bus-info | cut -b 16-22"",
                ""module_name"": ""shell""
            },
            ""item"": ""virbr0-nic:"",
            ""rc"": 0,
            ""start"": ""2015-04-14 20:29:49.876689"",
            ""stderr"": """",
            ""stdout"": """",
            ""warnings"": []
        }
    ]

My objective is to get the value of stdout in each item above for example (""stdout"": ""09:00.0"") . I tried giving something like 
     - name: Binding the interfaces
       shell: echo {{ item.item.stdout}}
       with_flattened: var2.results
#       with_indexed_items: var2.results
       register: var3

But this is not giving the bus values in stdout correctly. Appreciate help in listing the variable of variable value in task as given below when the second variable is and indexed list. I am trying to avoid direct index numbering such as item[0] because the number of interfaces are dynamic and direct indexing may result in unexpected outcomes. 
Thanks 
",109k,"
            39
        ","['\nIs this what you\'re looking for:\n\nVariables registered for a task that has with_items have different format, they contain results for all items.\n\n- hosts: localhost\n  tags: s21\n  gather_facts: no\n  vars:\n    images:\n      - foo\n      - bar\n  tasks:\n    - shell: ""echo result-{{item}}""\n      register: ""r""\n      with_items: ""{{images}}""\n\n    - debug: var=r\n\n    - debug: msg=""item.item={{item.item}}, item.stdout={{item.stdout}}, item.changed={{item.changed}}""\n      with_items: ""{{r.results}}""\n\n    - debug: msg=""Gets printed only if this item changed - {{item}}""\n      when: ""{{item.changed == true}}""\n      with_items: ""{{r.results}}""\n\n\nSource: Register variables in with_items loop in Ansible playbook\n']"
Windows Console Application Getting Stuck (Needs Key Press) [duplicate],"






This question already has answers here:
                        
                    



How and why does QuickEdit mode in Command Prompt freeze applications?

                                (2 answers)
                            

Closed 6 years ago.



I have a console program that has different components that run like this:  
void start() {
while(true){
     DoSomething();
     Thread.Sleep(1000*5);
}
}

My main entry point looks like [pseudo-ish code]
Thread.Start(Componenet1.Start);
Thread.Start(Componenet2.Start);

while(true){
     Console.Writeline(""running"");
     Thread.Sleep(1000*5);
}

There are no Console.Reads anywhere. My problem is SOMETIMES the application will be running great but then stop and if I press any key on the window it will start working again. This happens fairly infrequently but I have this program deployed on 100+ VM's running 24/7 in an automated environment.
Also on the computer I have some AHK scripts and other stuff that manipulate the mouse but not sure if that has anything to do with it.
Also note that sometimes the CPU can really be running at 100% on the machines so maybe thread priority is an issue?
SOLUTION: You need to disable quick edit mode. Here is working C# code to do this:
 // http://msdn.microsoft.com/en-us/library/ms686033(VS.85).aspx
    [DllImport(""kernel32.dll"")]
    public static extern bool SetConsoleMode(IntPtr hConsoleHandle, uint dwMode);

    private const uint ENABLE_EXTENDED_FLAGS = 0x0080;

    static void Main(string[] args)
    {
         IntPtr handle = Process.GetCurrentProcess().MainWindowHandle;
         SetConsoleMode(handle, ENABLE_EXTENDED_FLAGS);

",10k,"
            38
        ","['\nIf the user accidentally clicks into the black console window, the cursor changes to a filled white rectangle, and the app hangs at the next Console.Write statement, until another clic is made.\nIt is a generic feature of the Console window when its ""QuickEdit Mode"" is enabled.\nIn order to disable that feature, you should uncheck the ""QuickEdit Mode"" option of your app\'s console window at run-time.\n']"
element not interactable exception in selenium web automation,"
In the below code i cannot send password keys in the password field, i tried clicking the field, clearing the field and sending the keys. But now working in any of the method. But its working if i debug and test
  public class TestMail {
   protected static WebDriver driver;

   protected static String result;

   @BeforeClass

   public static void setup()  {
              System.setProperty(""webdriver.gecko.driver"",""D:\\geckodriver.exe"");

   driver = new FirefoxDriver();

   driver.manage().timeouts().implicitlyWait(60, TimeUnit.SECONDS);

  }

   @Test

 void Testcase1() {

   driver.get(""http://mail.google.com"");

   WebElement loginfield = driver.findElement(By.name(""Email""));
   if(loginfield.isDisplayed()){
       loginfield.sendKeys(""ragesh@gmail.in"");
   }
   else{
  WebElement newloginfield = driver.findElemnt(By.cssSelector(""#identifierId""));                                      
       newloginfield.sendKeys(""ragesh@gmail.in"");
      // System.out.println(""This is new login"");
   }


    driver.findElement(By.name(""signIn"")).click();

  // driver.findElement(By.cssSelector("".RveJvd"")).click();

   driver.manage().timeouts().implicitlyWait(15, TimeUnit.SECONDS);
 // WebElement pwd = driver.findElement(By.name(""Passwd""));
  WebElement pwd = driver.findElement(By.cssSelector(""#Passwd""));

  pwd.click();
  pwd.clear();
 // pwd.sendKeys(""123"");
 if(pwd.isEnabled()){
     pwd.sendKeys(""123"");
 }
 else{
     System.out.println(""Not Enabled"");
 }

",316k,"
            33
        ","['\nTry setting an implicit wait of maybe 10 seconds.\ngmail.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);\n\nOr set an explicit wait. An explicit waits is code you define to wait for a certain condition to occur before proceeding further in the code. In your case, it is the visibility of the password input field. (Thanks to ainlolcat\'s comment)\nWebDriver gmail= new ChromeDriver();\ngmail.get(""https://www.gmail.co.in""); \ngmail.findElement(By.id(""Email"")).sendKeys(""abcd"");\ngmail.findElement(By.id(""next"")).click();\nWebDriverWait wait = new WebDriverWait(gmail, 10);\nWebElement element = wait.until(\nExpectedConditions.visibilityOfElementLocated(By.id(""Passwd"")));\ngmail.findElement(By.id(""Passwd"")).sendKeys(""xyz"");\n\nExplanation: The reason selenium can\'t find the element is because the id of the password input field is initially Passwd-hidden. After you click on the ""Next"" button, Google first verifies the email address entered and then shows the password input field (by changing the id from Passwd-hidden to Passwd). So, when the password field is still hidden (i.e. Google is still verifying the email id), your webdriver starts searching for the password input field with id Passwd which is still hidden. And hence, an exception is thrown.\n', '\n""element not interactable"" error can mean two things :\na.  Element has not properly rendered:\nSolution for this is just to use implicit /explicit wait\n\nImplicit wait :\ndriver.manage().timeouts().implicitlyWait(50, TimeUnit.SECONDS);\n\nExplicit wait :\nWebDriverWait wait=new WebDriverWait(driver, 20);\nelement1 = wait.until(ExpectedConditions.elementToBeClickable(By.className(""fa-stack-1x"")));\n\n\nb. Element has rendered but it is not in the visible part of the screen:\nSolution is just to scroll till the element. Based on the version of Selenium it can be handled in different ways but I will provide a solution that works in all versions :\n    JavascriptExecutor executor = (JavascriptExecutor) driver;\n    executor.executeScript(""arguments[0].scrollIntoView(true);"", element1);\n\n\nSuppose all this fails then another way is to again make use of Javascript executor as following :\nexecutor.executeScript(""arguments[0].click();"", element1);\n\nIf you still can\'t click , then it could again mean two things :\n\n\n1. Iframe\nCheck the DOM to see if the element you are inspecting lives in any frame. If that is true then you would need to switch to this frame before attempting any operation.\n    driver.switchTo().frame(""a077aa5e""); //switching the frame by ID\n    System.out.println(""********We are switching to the iframe*******"");\n    driver.findElement(By.xpath(""html/body/a/img"")).click();\n\n2. New tab\nIf a new tab has opened up and the element exists on it then you again need to code something like below to switch to it before attempting operation.\nString parent = driver.getWindowHandle();\ndriver.findElement(By.partialLinkText(""Continue"")).click();\nSet<String> s = driver.getWindowHandles();\n// Now iterate using Iterator\nIterator<String> I1 = s.iterator();\nwhile (I1.hasNext()) {\nString child_window = I1.next();\nif (!parent.equals(child_window)) {\n    driver.switchTo().window(child_window);\n    element1.click() \n}\n\n', '\nPlease try selecting the password field like this.\n    WebDriverWait wait = new WebDriverWait(driver, 10);\n    WebElement passwordElement = wait.until(ExpectedConditions.elementToBeClickable(By.cssSelector(""#Passwd"")));\n    passwordElement.click();\n  passwordElement.clear();\n     passwordElement.sendKeys(""123"");\n\n', '\nyou may also try full xpath, I had a similar issue where I had to click on an element which has a property javascript onclick function. the full xpath method worked and no interactable exception was thrown.\n', '\nIn my case the element that generated the Exception was a button belonging to a form. I replaced\nWebElement btnLogin = driver.findElement(By.cssSelector(""button""));\nbtnLogin.click();\n\nwith\nbtnLogin.submit();\n\nMy environment was chromedriver windows 10\n', ""\nIn my case, I'm using python-selenium.\nI have two instructions. The second instruction wasn't able to execute.\nI put a time.sleep(1) between two instructions and I'm done.\nIf you want you can change the sleep amount according to your need.\n"", '\nI had the same problem and then figured out the cause. I was trying to type in a span tag instead of an input tag. My XPath was written with a span tag, which was a wrong thing to do. I reviewed the Html for the element and found the problem. All I then did was to find the input tag which happens to be a child element. You can only type in an input field if your XPath is created with an input tagname\n', ""\nI'm going to hedge this answer with this: I know it's crap.. and there's got to be a better way. (See above answers) But I tried all the suggestions here and still got nill. Ended up chasing errors, ripping the code to bits. Then I tried this:\nimport keyboard    \nkeyboard.press_and_release('tab')\nkeyboard.press_and_release('tab')\nkeyboard.press_and_release('tab') #repeat as needed\nkeyboard.press_and_release('space') \n\nIt's pretty insufferable and you've got to make sure that you don't lose focus otherwise you'll just be tabbing and spacing on the wrong thing.\nMy assumption on why the other methods didn't work for me is that I'm trying to click on something the developers didn't want a bot clicking on. So I'm not clicking on it!\n"", '\nI got this error because I was using a wrong CSS selector with the Selenium WebDriver Node.js function By.css().\nYou can check if your selector is correct by using it in the web console of your web browser (Ctrl+Shift+K shortcut), with the JavaScript function document.querySelectorAll().\n', '\nIf it\'s working in the debug, then wait must be the proper solution.\nI will suggest to use the explicit wait, as given below:\nWebDriverWait wait = new WebDriverWait(new ChromeDriver(), 5);\nwait.until(ExpectedConditions.presenceOfElementLocated(By.cssSelector(""#Passwd"")));\n\n', '\nI came across this error too.  I thought it might have been because the field was not visible.  I tried the scroll solution above and although the field became visible in the controlled browser session I still got the exception.  The solution I am committing looks similar to below.  It looks like the event can bubble to the contained input field and the end result is the Selected property becomes true.\nThe field appears in my page something like this.\n<label>\n  <input name=""generic"" type=""checkbox"" ... >\n<label>\n\nThe generic working code looks more or less like this:\nvar checkbox = driver.FindElement(By.Name(""generic""), mustBeVisible: false);\ncheckbox.Selected.Should().BeFalse();\nvar label = checkbox.FindElement(By.XPath(""..""));\nlabel.Click();\ncheckbox.Selected.Should().BeTrue();\n\nYou\'ll need to translate this to your specific language.  I\'m using C# and FluentAssertions.  This solution worked for me with Chrome 94 and Selenium 3.141.0.\n', ""\nI had to hover over the element first for the sub-elements to appear. I didn't take that into account at first.\n    WebElement boardMenu = this.driver.findElement(By.linkText(boardTitle));\n    Actions action = new Actions(this.driver);\n\n    action.moveToElement(boardMenu).perform();\n\nAnother tip is to check that you are having one element of that DOM. Try using Ctrl+F when inspecting the web page and check your xpath there; it should return one element if you are going with the findElement method.\n""]"
How can I unlock the screen programmatically in Android?,"
I am working on a remote automated test framework for Android based on JUnit (tests run outside android, interacting with code inside it). It's all working fairly well, but one issue I have is that when I automatically start a fresh emulator, the screen starts out locked. This appears to affect my tests being able to run, plus, I want to watch the tests run (buttons clicked, text typed, etc.). If I manually start an emulator and unlock its screen, all works well.
Is there a way to programmatically unlock the screen in Android? A Java API, a command line or shell command, etc. would all be fine. Barring that, perhaps there is a way to start an emulator unlocked?
",34k,"
            30
        ","[""\nYou can interact with the emulator via its console interface.\nIf you ever wondered why your emulator started with a number like 5554 - that's because that's the port the emulator listening on.\nYou can find the port for running emulators with the adb devices command.  It will have output like this:\nC:\\>adb devices\nList of devices attached\nemulator-5554   device\n\nSo you can connect to the emulator using a command like:\ntelnet localhost 5554\n\nIf you connect successfully you'll get an OK prompt and you can start entering commands.\nThere are various commands but the one we are interested in is event to simulate hardware events.  We can unlock the screen by pressing Menu which we emulate with the following command:\nevent send EV_KEY:KEY_MENU:1 EV_KEY:KEY_MENU:0\n\nThe EV_KEY:KEY_MENU:1 is key-down event and the EV_KEY:KEY_MENU:0 is the corresponding key-up event.  Make sure you do both or the Menu key will be stuck down.\nI realise scripting this will be far from easy, but it's all I can think of to solve your problem.\nEdit: I don't think event send EV_KEY:KEY_MENU:1 EV_KEY:KEY_MENU:0 is emulating Menu but if I run the command just after I've started the emulator it does unlock it.  Not sure why but I guess this is a start.\n"", '\nThe one-liner that works for me on Android SDK r18 and r20 talking to a 4.0.3 (API 15) emulator:\nadb shell input keyevent 82\n\n', '\nI believe the following link has the answer you are looking for.\nhttp://developer.android.com/guide/topics/testing/activity_testing.html#UnlockDevice\nUnlocking the emulator or device\nYou may find that UI tests don\'t work if the emulator\'s or device\'s home screen is disabled with the keyguard pattern. This is because the application under test can\'t receive key events sent by sendKeys(). The best way to avoid this is to start your emulator or device first and then disable the keyguard for the home screen. \nYou can also explicitly disable the keyguard. To do this, you need to add a permission in the manifest file (AndroidManifest.xml) and then disable the keyguard in your application under test. Note, though, that you either have to remove this before you publish your application, or you have to disable it with code in the published application. \nTo add the the permission, add the element  as a child of the  element. To disable the KeyGuard, add the following code to the onCreate() method of activities you intend to test: \n\nmKeyGuardManager = (KeyguardManager)\n  getSystemService(KEYGUARD_SERVICE);  mLock =\n  mKeyGuardManager.newKeyguardLock(""activity_classname""); \n  mLock.disableKeyguard();where activity_classname is the class name of\n  the activity.\n\n', '\nTry this script:\necho ""event send EV_KEY:KEY_SOFT1:1"" | nc -q1 localhost 5554\nsleep 0.1\necho ""event send EV_KEY:KEY_SOFT1:0"" | nc -q1 localhost 5554\nsleep 0.1\necho ""event send EV_KEY:KEY_SOFT1:1"" | nc -q1 localhost 5554\nsleep 0.1\necho ""event send EV_KEY:KEY_SOFT1:0"" | nc -q1 localhost 5554\nsleep 0.1\n\n', ""\nThe easiest way to unlock the screen (assuming no password) is to pass a KEYCODE_MENU event; however, if the screen is already unlocked, this will actually open a menu, which probably isn't the functionality you're looking for.\nIf you want a simple way to guarantee that the screen will be unlocked without opening a menu by accident, you should pass in a KEYCODE_POWER event first. This will guarantee that the device is in a locked state, so the menu event will only unlock the screen.\nadb shell input keyevent KEYCODE_POWER; adb shell input keyevent KEYCODE_MENU\n\n(Note: The 82 that appears in other responses is the KEYCODE_MENU constant.)\n"", '\nI managed to do it using the shell:\nadb shell\n#input keyevent 82\n\n', '\nYou can lock your Emulator Device by running this command from command prompt \nadb shell input keyevent 26\n\nYou can unlock your Emulator Device by running this command from command prompt \nadb shell input keyevent 82\n\nAfter running the unlock command, you might have to wait for some minutes.\nAbove unlock command will work, when you do not have any security lock.\n']"
