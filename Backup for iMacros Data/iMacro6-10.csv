Title,Description,PostsNum
Important Progress iMacros Product Update,"Dear iMacros Customers and Users, 

We are writing to inform you that Progress will be officially discontinuing the Progress iMacros product, with a planned End-Of-Life date of November 30, 2023. 

What does this mean? 
Moving forward, Progress will continue to support the iMacros product and will only provide critical fixes as needed until the EOL date. We will honor all service agreements through the existing term, except for those contracts that go beyond the EOL date. Customers with service agreements that go beyond the EOL date will be contacted separately to discuss their options and next steps. We will continue to offer service agreement renewals that do not exceed the EOL date. 

What are your next steps? 
Please remain on the lookout for more communications from Progress in the coming months, as more information will be made readily available to assist you as you prepare your transition plans. 

If you have additional questions, please email iMacrosInquiries@progress.com 

On behalf of Progress, thank you for your continued partnership and commitment. 

Sincerely,  
The Progress iMacros Team",2
*** Please read this before reporting problems ***,"Post last updated: May 25, 2020.

If you open a new topic (or post for the first time in some existing topic) to report an issue or ask any question, we can respond much faster if your problem description includes the following information (if applicable, not all questions fit to all problems):

1. What version of iMacros are you using?
You find the iMacros version and build information at the top of every macro that you record, for example ""VERSION BUILD=10100795"". Also specify whether you are using a freeware, trial, or licensed version, e.g. Personal Edition. Please test with the latest version.

2. What operating system are you using? (please also specify language)
Example: Windows 10, Windows 8.1, Windows 7, Windows Server 2012R2, English, German, Chinese, ...

3. Which browser(s) are you using? (include version numbers)
Example: Chrome 74.0.3729.13, Firefox 64.0.2, IE 11/10/9, ...

4. Do the included demo macros work ok? 
This test helps us to determine if the problem is a general iMacros issue or is somehow related to a specific website or configuration.

5. If reporting a problem with the iMacros scripting interface, please also test if the included VBS sample scripts run ok.
This test helps us to determine if the iMacros scripting interface installation is ok.

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the macro that creates the problem?
If you cannot post the macro in a public user forum or the website requires a login, can you provide a similar example of the problem on a publicly accessible website?

7. Do you encounter the same problem recording or replaying the macro in different browsers, such as the iMacros browser, Firefox, Chrome, or Internet Explorer? 
Note: If the problem is specific to Firefox or Chrome, please post in either the iMacros for Firefox or iMacros for Chrome sub-forum respectively.

8. Please include any additional information that is relevant to reproducing the issue.
This includes a detailed description of the steps you've tried as well as the specific error codes and messages, macro logs, screen shots, etc. Please upload screenshots and other relevant files directly to the forum and not to a third-party hosting service!

This information allows us to quickly re-create the issue on our test systems and solve it ASAP.

Additional tips when posting

* Please ensure that the content of your post is relevant to the topic and/or forum where you post it.
For example, if you are having a problem extracting data from a web page and are using Firefox, create your post in the Data Extraction and Web Screen Scraping forum rather than the iMacros for Firefox forum (see note #7 above). If you are unsure which forum to post to, use the General Support & Discussions forum.

* Use a topic title that succinctly describes the problem or issue.
Avoid phrases such as ""Please Help"", ""Urgent"", ""Script not working"", etc. and refrain from using all capital letters and exclamation points. Also, double-check that the spelling of the title and body of the post are correct, since this makes it more likely to be found in searches by other users. Most modern browsers automatically check spelling as you type and underline mistakes, so please correct them before submitting your post.

* Don't post the same question to more than one forum.
If you've miscategorized your original post, just click the Exclamation Icon on the right of the post's subject/title line to report it and let us know where you would like it moved or merged.

* Always provide your FCI (Full Config Info), c.f. items 1-3 above, in your original post even if you think it may not be relevant.
Some of our mods may not even respond unless this information is included. Please don't put this information in your signature, because this can change over time and makes it more confusing when reviewing older posts. Include the information directly in the body of the post instead.

* When sharing screenshots or other relevant files, please upload them directly to the forum rather than use a third-party hosting/sharing service.
Too often these services stop functioning or the files become unavailable for whatever reason. Uploading them here ensures that the full context of the post remains consistent over time.

* Take a minute to review your forum notification settings

Thank you for helping us to help you better!",1
Need to position in the field that has the focus,"Hi all,

I have searched a lot, but did not found or understand how this works. 

I want to paste my input starting in the actual field that is active. not just in the first field. My script does exactly what I want, but starting with the first field on the screen.

I do not use goto URL, but the actual HTML-Site.

Any hint would be great

Newbie96",8
Help on removing comma in numbers and saving,"Hi, I'm completely new to iMarcos and I'm trying to use it to extract some numbers from a webpage. Somehow I'm making it to work, but since those numbers are formatted with commas, I need to remove them in order to read them to database.

Below code somehow worked to remove those commas, but a new issue of it is that once I save to the csv, iMacros doesn't translate the [EXTRACT] into comma. It just puts something like 123[EXTRACT]456[EXTRACT]789[EXTRACT] exactly into the csv.

Am I using a wrong way to remove commas from extraction? Or I'm missing something in the extraction saving? Struggling about this for days and I couldn't solve. Can experts here help? Thank you very much.

Those prompts are for me to keep track of results. The date adding action is used to add a date for the extraction in which it shouldn't be related to my problems.
Code: Select allSET !EXTRACT NULL
ADD !EXTRACT {{!NOW:mm/dd/yyyy}}

TAG POS=8 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=16 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=24 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=40 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=32 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=48 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=56 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

TAG POS=64 TYPE=DIV ATTR=CLASS:ellipsis EXTRACT=TXT
PROMPT {{!EXTRACT}}

SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")
SET !VAR1 EVAL(""var s=\""{{!VAR1}}\""; s.replace(\""\\,\"", \""\"");"")

PROMPT {{!EXTRACT}}
PROMPT {{!VAR1}}

SET !EXTRACT {{!VAR1}}

PROMPT {{!EXTRACT}}
PROMPT {{!VAR1}}

TAG POS=1 TYPE=A ATTR=TXT:Log<SP>Out

SAVEAS TYPE=EXTRACT FOLDER=\\SERVER\d$\IMPORT\ FILE=result.csv
",13
"Different behaviour - scripting vs manual, with AJAX request","Hi all

Our ISP provides an online web site, where you can download a CSV of usage data.
I am attempting to write a tool that extracts this data for each of our customers only a regular basis, and injects it into a database so they can easily retrieve a graphical representation

There are two views of data - summary and detailed.
When I login to the website manually, the process is URL for login screen -> TAG enter details -> click A 'Detailed' -> click A 'Download Usage' -> click BTN 'Download'
The CSV that downloads shows detailed usage data.

I have built this behaviour into iMacros, using recording and some manual adjustments for additional waiting.
But the downloaded CSV is always only the 'summary' data - not the detailed.

I have confirmed by watching the script that iMacros does trigger the click on the A tag 'Detailed', which in theory is what 'switches' the behaviour of the Download button to download detailed data.
But the downloaded CSV is only ever summary view. I can even perform the same behaviour side-by-side, in a Chrome window manually on the right and iMacros 12 built-in browser on the left, and the output from iMacros is summary whereas the output from Chrome is detailed. Interestingly though - when I navigate the page using the iMacros built-in browser manually, it correctly registers that I've clicked on 'Detailed' view and downloads the full detailed CSV.

The website is very AJAX-heavy, to load in controls and data (hence having to build in plenty of additional WAIT commands). 
My thinking is that the built-in iMacros browser is not handling some form of local cache/cookie/session storage command from the website, whereas Chrome et al does.
As an example, in the Chrome developer when switching back forth between 'summary' and 'detailed' view (before downloading the CSV) this error is logged;
VM127:3 [Deprecation] 'window.webkitStorageInfo' is deprecated. Please use 'navigator.webkitTemporaryStorage' or 'navigator.webkitPersistentStorage' instead.

If I'm right, and the website is storing the 'current' view (detailed) in some kind of local storage, is there any way to replicate this behaviour in iMacros?

I've checked the 'Application' tab in Chrome developer console, and can't see any obvious setting stored in Local Session Storage or Cookies, just a SESSION_ID which doesn't help.
I've also tried to run my iMacros script in the main 3 browsers;
- IE 11 worked to load the web page, but no fields were ever filled in on the login page
- Chrome & Firefox were completely unresponsive when I click 'Play in -> ...' in the Script Editor

Only the built-in iMacros browser works, and it comes very close to what's needed by just refuses to 'remember' that it's clicked 'Detailed View' before it downloads
Note that I've tried clicking both the 'Detailed' and 'Download' buttons as both TAGs and EVENTs

I'm using iMacros 12 on Windows 10
If anyone has any suggestions relating to tricks for handling AJAX-heavy pages, ideas about how to force iMacros to 'fully register' a click on an AJAX page, or tips for getting iMacros to work with Chrome on Windows 10 I'd appreciate it

Regards,
Sam",4
Zooming,"New iMacros user here.  I have a web page that is being displayed differently on standard aspect monitors than on their widescreen counterparts (the components I'm using in the macro aren't even present in the trunctated version!).  I have tried various resizing to no avail, but have noticed that when I zoom out the web page is rebuilt with the components I need!  I've searched these forums and the wiki to no avail.  I have tried each recording method and none of them pick up my zooming (ctrl + / ctrl -).  Has anybody successfully gotten zooming to work with IE?

Thanks",4
Using JQuery with iMacros,"Greetings all, I am a long time lurker first time poster. 

I've found a few posts on the web about using JQuery in iMacros but none seem to work.

Here is one:
Code: Select allfunction loadScriptFromURL(url) {
    var request = Components.classes['@mozilla.org/xmlextras/xmlhttprequest;1'].createInstance(Components.interfaces.nsIXMLHttpRequest),
        async = false;
    request.open('GET', url, async);
    request.send();
    if (request.status !== 200) {
        var message = 'an error occurred while loading script at url: ' + url + ', status: ' + request.status;
        iimDisplay(message);
        return false;
    }
    eval(request.response);
    return true;
}

// load JQuery
loadScriptFromURL('http://mysupersecret.blob.core.windows.net/share/jquery-2.0.3.min.js');
$ = window.$,
JQuery = window.JQuery;

Is this correct? Do I have to add this to each macro I plan to use it with or can I reference it somehow?  I've tried adding it to a js file with JQuery but it doesn't like the line ""$ = window.$,""

Any advice would be appreciated, thanks!

Using Firefox 55.0.2 (32-bit) and whatever iMacros is the latest as of 08-18-2017",6
Help: How to capture LinkedIn Search results?,"Hi everyone

I'm new to iMacros and would really appreciate a little bit of newbie help to get me started.

I'm trying to figure out how to capture my LinkedIn search results but it seems really difficult to do 

If any of you iMacro gurus had a script snippet or example you could share it would be a huge help to me!

What I want to do is... do a search (eg for 2nd level connections) and then capture the results.

Specifically:

+ name
+ title
+ profile link
+ number of shared connections

... and then go through X pages of search results saving the data to a text file


I've found plenty of things related to profiles but nothing related to the search results page.

Hope someone might be able to share an example.

Thanks everyone for making this forum great.
R",6
Simple YouTube macro isn't working,"This simple series of clicks is supposed to hit the SHARE button on YouTube, then COPY button for the URL that appears in the popup, then dismiss the popup. (Note that YT has changed the layout of the page very recently).

VERSION BUILD=9030808 RECORDER=FX
TAB T=1
TAG POS=6 TYPE=YT-FORMATTED-STRING ATTR=ID:text
TAG POS=8 TYPE=YT-FORMATTED-STRING ATTR=ID:text
TAG POS=1 TYPE=DIV ATTR=ID:owner-container
TAG POS=8 TYPE=YT-FORMATTED-STRING ATTR=ID:text
TAG POS=2 TYPE=DIV ATTR=ID:info

However, it's as if the string is not passed to the clipboard properly. Instead, the clipboard contains the string associated with the previous run of the macro. That is why there are two tries at TAG POS=8 - trying to get the current URL onto the clipboard.

The purpose is to extract the YouTube link for pasting into an online content management system. I can't figure out the hitch here.",2
Extract email but only if not a duplicate in my CVS file?,"Hi I am going nuts trying to figure out how to extract email from a website but only if that email isn't already in my CVS file.  If the email is already there can I stop the iMacro and have it restart from the begging?

To extract and save I'm using and it works:
Code: Select allTAG POS=1 TYPE=P ATTR=CLASS:""tel-number"" EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=/Users/Me FILE=cl-num.csv

How would I go about checking if the email is already in my CVS?  And if it is make the iMacro restart?

Thanks everyone 


.",14
If equals info in excel cell then...,"Version 11.5
Windows 10 
IE 11

If the number I extract from a website is equal to the number in Column 1 of excel I would like to grab the name in Column 2 of excel and paste it back into a field on the website.  If it does not equal then check next row until there's a match.  Is it possible to perform this?  I imagine I must have to use EVAL to check for a match but I am unsure how to set up the EVAL statement below.
TAG POS=26 TYPE=TD ATTR=* EXTRACT=TXT
SET !LOOP 1
SET !DATASOURCE C:\Users\*\Desktop\*.csv
SET !VAR1 EVAL(""if({{!COL1}}=={{!EXTRACT}}){{{!COL2}}}else{do nothing};"") 
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:txtBorrower CONTENT={{!VAR1}}",10
Half of extracted data goes into 1 cell the rest is seperate,"Hey guys, 

I need help with a couple things.  I have created a macro to go into a webpage and download a table and create an excel file.  Easy enough.

When the table has a small amount of information it puts all of the information into one cell as one long string.  This is ok because I have created a VBA script to split the text and format it how I want.

The problem I am having is that when I download the table and it has a lot of information for a whole month it will put the first half of the report all into one cell and then the second half goes into individual rows.

The macro I have created can't work with both formats.  Is there something I can do when I extract to either have it all go into one cell or have them all go into individual rows but not both?

Thanks",17
Dropdown list not triggered,"Hi All

I'm new to this so please excuse any obvious errors. I'm trying to do something quite basic - get to a train schedule web page, which shows the delays for various lines. I've made a basic script with the iMacros record. When running, it reaches the page, but will not populate the dropdown list to select the line captured during the iMacros record process. I included a 5 second wait to allow any AJAX or dynamic code to load. Here's the script to select the Central line:
Code: Select allVERSION BUILD=9030808 RECORDER=FX
TAB T=1
URL GOTO=https://app.gometro.co.za/#/chooseline
WAIT SECONDS=5
TAG POS=1 TYPE=LI ATTR=TXT:Central


The page uses the React javascript framework (which I'm not familiar with) and the line selection code looks as follows:
Code: Select all<div class=""mdl-grid wrapper""><div class=""mdl-cell mdl-cell--12-col""><!-- react-empty: 860 --><div class=""main-heading"">LINE UPDATES - CHOOSE A LINE</div><div id=""choose-a-line"" style=""display: block;""><div class=""mdl-selectfield""><div class=""mdl-textfield mdl-js-textfield is-upgraded"" data-upgraded="",MaterialTextfield""><input class=""mdl-textfield__input"" id=""textfield-Selectaline"" readonly="""" value="""" type=""text""><label class=""mdl-textfield__label"" for=""textfield-Selectaline"">Select a line</label></div><i class=""mdl-selectfield__arrow""></i></div></div></div></div>


So I'd like to ask the forum members is anyone has suggestions for resolving this?

Many thanks
Cliff",2
Determine row in which a string is in an HTML table,"How can I determine in which row of a table a certain string is and save it into a variable using iMacros? (and use that position to later click a link with iMacros)

Thanks! ",8
Get image source generated via JavaScript,"I have a page with captcha values, 
1.png, 5.png....

I was thinking to extract the image source to get rid of the captcha. But the problem now is, the image source are generated via JavaScript

In that case how can I pickup the image sources?",2
NEWBIE : How to Loop and Click Next?,"first time using iMacros.

I want to run a loop 50x then when it is done, 
click the ""Next"" button and run the same loop again 50x, 
click ""Next""... and run until ""Next"" is no longer clickable.

so far i have this working for 1x loop.  
but i cant get it to run the text extraction+CSV export 50x.. THEN click NEXT.

Code: Select allSET !LOOP 1

TAG POS={{!LOOP}} TYPE=TD ATTR=CLASS:domain EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy}}.csv

'click NEXT'
TAG POS=1 TYPE=A ATTR=TXT:Next

WAIT SECONDS=3",2
Data extraction from .CSV -> export/submission on webpage.,"System info:
1. VERSION BUILD=9.030808 RECORDER=FX
2. Windows 10 - English
3. Firefox 54.0.1
4. The macro works okay, it just doesn't have all the features I need.
5. No problems
6. No problems
7. Just need help with the macro.

I am attempting to submit a large amount of zip codes (for each state in the U.S.), and would like to export data from my .CSV file and loop the function to run through the single column of data.

----------------------------------------------------------------------------------------------------------------------------------------------

Here is my example:
SET !DATASOURCE zips.csv
SET !DATASOURCE_COLUMNS 1
SET !ERRORIGNORE YES
'
'
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:agentProfileForm ATTR=ID:serviceAreaZip CONTENT={{!COL1}}
WAIT SECONDS=1
TAG POS=1 TYPE=INPUT:BUTTON FORM=ID:agentProfileForm ATTR=ID:zips

----------------------------------------------------------------------------------------------------------------------------------------------
The function works partially (I am open to any, and all suggestions). Furthermore, after I type in the zip code, the website displays a ""X reps found in this area."" I was curious to see if it is possible to basically export a number from the answer ""X"" and import it into the 2nd column of my .CSV file.

To summarize it, I am looking to critique my macro to make sure I have set it up correctly, and to also seek assistance on how to export an answer from the submission on the website to the 2nd column in my .CSV file. I appreciate any assistance that I may receive.

(Pic of the result whenever it finds reps)
https://drive.google.com/file/d/0B-7PKC ... 0txMF92bmM

(Pic of the result whenever it doesn't find reps)
https://drive.google.com/open?id=0B-7PK ... WUtUzRESGM

EDIT/UPDATE:
After some consideration, I have gotten to the point where I am able to extract the text into the .CSV file but I am having difficulty trying to choose which column to output the data into. It seems to be that the input isn't the problem, just the export from the text extraction to the input of the extracted data into the .CSV.",6
Bittrex,"Hi guys, 
my macro is for bittrex.com.
I wanna make a macro for make a sale order 15% bigger the ask price .

I have write a code but he dont work....
VERSION BUILD=9030808 RECORDER=FX
TAB T=1
TAG POS=1 TYPE=DIV ATTR=TXT* EXTRACT=TXT
SET !VAR1 {{!EXTRACT}}
SET INC 1.15
SET VALUE EVAL(""{{!VAR1}}*{{INC}}"")
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:form_Sell ATTR=NAME:price_Sell CONTENT={{!VALUE}}

anyone can help me.
thanks (sorry for my english im french)",6
Search Results,"Being new to iMacros, I'm attempting to write a macro to process through a search of names.
I've looked at the documentation and search the forum, but didn't find any examples of what I need to do.
Seems like it would be simple to do, but so far, nothing I've tried works. Could be my syntax of just not using the
command correctly.
Here is the issue: after a user logs in, they need to enter a persons last name to do a search on that.
I prompt for the name and store it in var1, that part works okay.
Once I use that in the search, the search sometimes returns maybe 25 or more last name, first name pairs that
might stretch over 7, 8, 9 pages.
The user then negotiates over those pages till they find a match.
Could be anywhere, say it's on page 4.
I then need to capture the results of that exact match and then use that data later one.
This is what I have 

PROMPT ""Please enter last name name:"" !VAR1 
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/Access/NameSearch/Results ATTR=NAME:TextSearchQuery CONTENT={{!VAR1}}
TAG POS=1 TYPE=BUTTON:SUBMIT FORM=ACTION:/Access/NameSearch/Results ATTR=ID:SearchButton

/* User now is presented with a list, several pages of names that they 
   must select from

TAG POS=1 TYPE=A ATTR=TXT:2
TAG POS=1 TYPE=A ATTR=TXT:3
TAG POS=1 TYPE=A ATTR=TXT:4

/* After the user finds the correct match, they select it and continue on
   with the results of their selection. This is the results from their select
    action:

TAG POS=1 TYPE=TD ATTR=TXT:SMITH,<SP>JOHN<SP>A

I've tried a number of solutions, nothing has worked. 
Here is one example of what I tried with the select command:

TAG POS=1 TYPE=SELECT FORM=NAME:form1 ATTR=NAME:select1 CONTENT=${{!VAR1}}

I just need to know what the user selected, grab that data and continue on.
Any tips or suggestions would be appreciated.",4
Extracting attributes values dynamically imacros,"This is the html text
Code: Select all  <select name=""ctl00$ContentPlaceHolder1$ddltype"" id=""ctl00_ContentPlaceHolder1_ddltype"" class=""page-heading"" style=""background-color: rgb(255, 244, 244); width: 125px; outline: 1px solid blue;"">
    			<option value=""0"">Select Bricks</option>
    			<option value=""brk_A_price"">A</option>
    			<option value=""brk_B_price"">B</option>
    			<option value=""brk_oth_price"">Others</option>
    
    		</select>
    .
    .
    .
    .
    <select name=""ctl00$ContentPlaceHolder1$ddlReportOn"" id=""ctl00_ContentPlaceHolder1_ddlReportOn"" class=""page-heading"" style=""background-color:#FFF4F4;width:135px;"">
    			<option value=""0"">Select Report For</option>
    			<option value=""1"">Comparison</option>
    			<option value=""2"">Variation</option>
    
    		</select>

So from above html I want to extract option Values i.e brk_A_price,brk_B_price,brk_oth_price from first select tag and 1, 2 from second select tag.
Code: Select all 'code to get brk_A_price,brk_B_price,brk_oth_price
    TAG POS=1 TYPE=SELECT ATTR=id:ctl00_ContentPlaceHolder1_ddltype&&TXT:* EXTRACT=HTM
    TAG POS R1 TYPE=option ATTR=value&&TXT
    
    'code to get 1, 2
    TAG POS=1 TYPE=SELECT ATTR=id:ctl00_ContentPlaceHolder1_ddlReportOn&&TXT:* EXTRACT=HTM
    TAG POS R1 TYPE=option ATTR=value&&TXT

However, for every dropdown I would want to change just the **id** attribute, but for the code I tried it is just able to extract the text and not values from `<option..>` tag.

> p.s: http://briks.gov.in/Report/Rept_Building_Brik.aspx is the site from where I'm extracting data

Any suggestion on what changes should be made.
Any help would be much appreciated.
Thanks",2
LinkedIn tagging question,"Windows 10
iMacros for Firefox. VERSION BUILD=9030808
Firefox 54.0.1 (32-bit)

Hi all,

I have a LinkedIn profile scraper that extracts profile data into a CSV (code at bottom of post). It does the job very well, with one key caveat: it can't account for instances where a piece of information is missing from a section of the profile. As an example, see this profile: https://www.linkedin.com/in/darylpereira/

Look at the second position in Daryl's profile and note that he did not include a date range. My program is trained to find position 2 and print it, then find date range 2 and print it. But it can't tell when there is no date range 2. Instead, the date range associated with the 3rd position will be considered the second date range. The result is that the dates are off for him (I have him joining IBM in this capacity in Nov 2005, he really joined in Sep 2008). Many, many profiles have this issue. I need the date range data to be accurately attributed to the positional and educational data. Otherwise, it's not useful for the analysis.

I believe the answer is that I need to be using a python or other coding interface so that I can integrate if/else functionality. But I'm really hoping someone might have a workaround for iMacros, because I'm not any good at coding. Anyway, all ideas are appreciated. Here's the code I mentioned (feel free to use it - the reference is just the list of profile links):
Code: Select allVERSION BUILD=9030808 RECORDER=FX
TAB T=1
TAB CLOSEALLOTHERS
SET !ERRORIGNORE YES
SET !DATASOURCE LinkedInURLs.csv
SET !DATASOURCE_COLUMNS 1
SET !LOOP 1
SET !DATASOURCE_LINE {{!loop}}

URL GOTO={{!COL1}}

WAIT SECONDS=10

ADD !EXTRACT {{!COL1}}

TAG POS=1 TYPE=h1 ATTR=CLASS:* EXTRACT=TXT

TAG POS=1 TYPE=h3 ATTR=class:""Sans-**px-black-**%-semibold"" EXTRACT=TXT
TAG POS=1 TYPE=span ATTR=class:pv-entity__secondary-title* EXTRACT=TXT
TAG POS=1 TYPE=h4 ATTR=class:pv-entity__date-range* EXTRACT=TXT
TAG POS=1 TYPE=h4 ATTR=class:pv-entity__location* EXTRACT=TXT

TAG POS=2 TYPE=h3 ATTR=class:""Sans-**px-black-**%-semibold"" EXTRACT=TXT
TAG POS=2 TYPE=span ATTR=class:pv-entity__secondary-title* EXTRACT=TXT
TAG POS=2 TYPE=h4 ATTR=class:pv-entity__date-range* EXTRACT=TXT
TAG POS=2 TYPE=h4 ATTR=class:pv-entity__location* EXTRACT=TXT

TAG POS=3 TYPE=h3 ATTR=class:""Sans-**px-black-**%-semibold"" EXTRACT=TXT
TAG POS=3 TYPE=span ATTR=class:pv-entity__secondary-title* EXTRACT=TXT
TAG POS=3 TYPE=h4 ATTR=class:pv-entity__date-range* EXTRACT=TXT
TAG POS=3 TYPE=h4 ATTR=class:pv-entity__location* EXTRACT=TXT

TAG POS=4 TYPE=h3 ATTR=class:""Sans-**px-black-**%-semibold"" EXTRACT=TXT
TAG POS=4 TYPE=span ATTR=class:pv-entity__secondary-title* EXTRACT=TXT
TAG POS=4 TYPE=h4 ATTR=class:pv-entity__date-range* EXTRACT=TXT
TAG POS=4 TYPE=h4 ATTR=class:pv-entity__location* EXTRACT=TXT

TAG POS=1 TYPE=h3 ATTR=class:pv-entity__school-name* EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:""pv-entity__secondary-title pv-entity__degree-name*"" EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:""pv-entity__secondary-title pv-entity__fos*"" EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:pv-entity__dates* EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=* FILE=LinkedInResults.csv

WAIT SECONDS=5
",3
Please Help me to Scrool Down Scraping,"Here is my code 
Code: Select allVERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
SET !EXTRACT_TEST_POPUP NO
SET !ERRORIGNORE YES

URL GOTO=https://www.agritechnica.com/en/exhibitors-products/exhibitors-products-2017/#!/
TAG POS={{!LOOP}} TYPE=DIV ATTR=CLASS:<SP>col-xs-12 EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\Yohan\Desktop FILE=lat100.csv

you can check it to visit that link, it just can scrape first 30 data. i need scrool down the data to scrape the next. please help me",1
Extract table,"Hi,

I'm working on a new project : from a datasource csv, I fill out a form with LOOP, that returns tables.
I would like to extract these tables cell by cell but the tables don't have the number of lines.
Actually, I repeat 9 times  (max !VAR) the code :
Code: Select allTAG POS=R1  TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=* FILE=+FICHIERpro_{{!NOW:yyyymmdd}}

SET !TIMEOUT_STEP 1
TAG POS=R1  TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT


SAVEAS TYPE=EXTRACT FOLDER=* FILE=+FICHIERpro_{{!NOW:yyyymmdd}}
...

Sometimes There are more than 9 lines and I waste a lot of time to extract what I want.
How to avoid repeating the code (ENDOFPAGE ?, LOOP?)

Any help would be appreciated.

FF 54.0.1
IMacros 9.0.3
Windows 7",4
Extract data from an empty cell,"Hi,

I am not a professional programmer, but I am doing a small code to extract customer information from a corporate intranet.  

For every client there are several orders, but only one will be avaible (DISPONIBLE).  When the code finds an avaible order, it goes to delivery note url to extract the lines of the items: date, description and dispatched, and normally there are 4 rows.  If the date is empty, dispatched too.

I need that when one row has no date, it skips to the next.  With my code, the second open TAB (delivery note) doesn't close when any date is empty and then the extraction stops.

How do I make it jump to the next row to extract data when the date is empty?

Thanks.
Code: Select all// 1.- Carga de website
var visord1 = ""CODE:"";
visord1 += ""TAB T=1\n"";
visord1 += ""SET !ERRORIGNORE YES\n"";
visord1 += ""SET !TIMEOUT_STEP 2\n"";
visord1 += ""URL GOTO=https://intranet/ma1/jsp/VisorD/visord.jsp\n"";

// 2.- Menú ""buscar""
var visord2 = ""CODE:"";
visord2 += ""FRAME NAME=\""menu\""\n"";
visord2 += ""TAG POS=1 TYPE=A ATTR=TXT:Buscar\n"";

// 3.- Menú ""formulario""
var visord3 = ""CODE:"";
visord3 += ""FRAME NAME=\""Formulario\""\n"";
visord3 += ""SET !DATASOURCE VISORD_telf_nif.csv\n"";
visord3 += ""SET !DATASOURCE_COLUMNS 3\n"";
visord3 += ""SET !DATASOURCE_LINE {{csvline}}\n"";
visord3 += ""ADD !EXTRACT {{!COL1}}\n"";								//Extrae oficina 	Extract 1
visord3 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:principal ATTR=ID:nif CONTENT={{!COL2}}\n"";
visord3 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:principal ATTR=ID:telefono CONTENT={{!COL3}}\n"";
visord3 += ""TAG POS=1 TYPE=INPUT:BUTTON FORM=NAME:principal ATTR=NAME:enviarForm\n"";

// 4.- Menú ""búsqueda""
var visord4 = ""CODE:""
visord4 += ""FRAME NAME=\""Busqueda\""\n"";
visord4 += ""SET !TIMEOUT_STEP 2\n"";							
visord4 += ""TAG POS=1 TYPE=TD ATTR=TXT:{{contador}} EXTRACT=TXT\n""; //Extrae contador   Extract 2
visord3 += ""ADD !EXTRACT {{contador}}\n"";	
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n""; 			//Extrae año    	Extract 3
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae central    Extract 4
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae orden    	Extract 5
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae fecha    	Extract 6
visord4 += ""TAG POS=R2 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae teléfono  	Extract 7
visord4 += ""TAG POS=R3 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae estado    	Extract 8
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae nif    	Extract 9
visord4 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";			//Extrae cliente   	Extract 10

// 5.- Peticion Materiales
var visord5 = ""CODE:"";
visord5 += ""TAB OPEN NEW\n"";
visord5 += ""TAB T=2\n"";
visord5 += ""URL GOTO=https://intranet/ma1/servlet/VisorDPeticionMaterialesNewLook?anno={{ano}}&central={{central}}&orden={{orden}}\n"";
	visord5 += ""TAG POS=2 TYPE=TD ATTR=TXT:201* EXTRACT=TXT\n""; 
	visord5 += ""TAG POS=R1 TYPE=SPAN ATTR=TXT:* EXTRACT=TXT\n""; 
	visord5 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
		visord5 += ""TAG POS=4 TYPE=TD ATTR=TXT:201* EXTRACT=TXT\n"";
		visord5 += ""TAG POS=R1 TYPE=SPAN ATTR=TXT:* EXTRACT=TXT\n"";
		visord5 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
			visord5 += ""TAG POS=6 TYPE=TD ATTR=TXT:201* EXTRACT=TXT\n"";
			visord5 += ""TAG POS=R1 TYPE=SPAN ATTR=TXT:* EXTRACT=TXT\n"";
			visord5 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
				visord5 += ""TAG POS=8 TYPE=TD ATTR=TXT:201* EXTRACT=TXT\n"";
				visord5 += ""TAG POS=R1 TYPE=SPAN ATTR=TXT:* EXTRACT=TXT\n"";
				visord5 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
visord5 += ""TAB T=1\n"";
visord5 += ""TAB CLOSEALLOTHERS\n"";

// 6.- Escritura en fichero.CSV
var visordPRINT  = ""CODE:"";
visordPRINT += ""ADD !EXTRACT {{oficina}}\n"";

visordPRINT += ""ADD !EXTRACT {{num_order}}\n"";
	visordPRINT += ""ADD !EXTRACT {{ano}}\n"";
	visordPRINT += ""ADD !EXTRACT {{central}}\n"";
	visordPRINT += ""ADD !EXTRACT {{orden}}\n"";
	visordPRINT += ""ADD !EXTRACT {{fecha}}\n"";
	visordPRINT += ""ADD !EXTRACT {{telefono}}\n"";
	visordPRINT += ""ADD !EXTRACT {{estado}}\n"";
	visordPRINT += ""ADD !EXTRACT {{nif}}\n"";
	visordPRINT += ""ADD !EXTRACT {{cliente}}\n"";
		visordPRINT += ""ADD !EXTRACT {{date1}}\n"";
		visordPRINT += ""ADD !EXTRACT {{descripcion1}}\n"";
		visordPRINT += ""ADD !EXTRACT {{estado1}}\n"";
		visordPRINT += ""ADD !EXTRACT {{date2}}\n"";
		visordPRINT += ""ADD !EXTRACT {{descripcion2}}\n"";
		visordPRINT += ""ADD !EXTRACT {{estado2}}\n"";
		visordPRINT += ""ADD !EXTRACT {{date3}}\n"";
		visordPRINT += ""ADD !EXTRACT {{descripcion3}}\n"";
		visordPRINT += ""ADD !EXTRACT {{estado3}}\n"";
		visordPRINT += ""ADD !EXTRACT {{date4}}\n"";
		visordPRINT += ""ADD !EXTRACT {{descripcion4}}\n"";
		visordPRINT += ""ADD !EXTRACT {{estado4}}\n"";
visordPRINT += ""SAVEAS TYPE=EXTRACT FOLDER=* FILE=VISORD_o.csv\n"";


//#####################################################################
//#####################################################################

// 1.- Carga de website
iimPlay(visord1); 

// 2.- Menú ""buscar""		
iimPlay(visord2); 		


var save_csv = new Array();

// 3.- Menú ""formulario""
for (var csvline=1;csvline<30;csvline++)
{	
	iimSet(""csvline"",csvline);
	iimPlay(visord3);
	var oficina= iimGetLastExtract(1);					//alert(""oficina: ""+oficina);
	save_csv[0] = oficina;

	
// 4.- Menú ""búsqueda""
	for (var contador=1;contador<4;contador++)
	{
		iimSet(""contador"",contador);
		iimPlay(visord4);
		var num_order = iimGetLastExtract(1);			//alert(""Nº: ""+num_order);
		save_csv[1] = num_order;
		if (num_order == ""#EANF#""){ break;}
		var ano = iimGetLastExtract(2);					//alert(""ano: ""+ano);
		save_csv[2] = ano;
		var central = iimGetLastExtract(3);				//alert(""central: ""+central);
		save_csv[3] = central;
		var orden = iimGetLastExtract(4);				//alert(""orden: ""+orden);
		save_csv[4] = orden;
		var fecha = iimGetLastExtract(5);				//alert(""fecha: ""+fecha);
		save_csv[5] = fecha;
		var telefono = iimGetLastExtract(6);			//alert(""telefono: ""+telefono);
		save_csv[6] = telefono;
		var estado = iimGetLastExtract(7);				//alert(""estado: ""+estado);
		save_csv[7] = estado;
		var nif = iimGetLastExtract(8);					//alert(""nif: ""+nif);
		save_csv[8] = nif;		
		var cliente= iimGetLastExtract(9);				//alert(""cliente: ""+cliente);	
		save_csv[9] = cliente;
		
// 5.- Peticion Materiales		
		if (estado == ""DISPONIBLE"")
		{
			iimSet(""ano"",ano);
			iimSet(""central"",central);
			iimSet(""orden"",orden);
			iimPlay(visord5);
			
			var date1= iimGetLastExtract(1);			//alert(""F.Entrega: ""+date1);
			if (date1 == ""#EANF#"" || date1 == ""__undefined__""){ break;}
						
			save_csv[10] = date1; 
			var descripcion1= iimGetLastExtract(2);		//alert(""Descripcion: ""+descripcion1);
			save_csv[11] = descripcion1;
			var estado1= iimGetLastExtract(3);			//alert(""Estado: ""+estado1);
			save_csv[12] = estado1;
			
			var date2= iimGetLastExtract(4);			//alert(""F.Entrega: ""+date2);
			save_csv[13] = date2;
			var descripcion2= iimGetLastExtract(5);		//alert(""Descripcion: ""+descripcion2);
			save_csv[14] = descripcion2;
			var estado2= iimGetLastExtract(6);			//alert(""Estado: ""+estado2);
			save_csv[15] = estado2;
			
			var date3= iimGetLastExtract(7);			//alert(""F.Entrega: ""+date3);
			save_csv[16] = date3;
			var descripcion3= iimGetLastExtract(8);		//alert(""Descripcion: ""+descripcion3);
			save_csv[17] = descripcion3;
			var estado3= iimGetLastExtract(9);			//alert(""Estado: ""+estado3);
			save_csv[18] = estado3;			
			
			var date3= iimGetLastExtract(10);			//alert(""F.Entrega: ""+date4);
			save_csv[19] = date3;
			var descripcion3= iimGetLastExtract(11);	//alert(""Descripcion: ""+descripcion4);
			save_csv[20] = descripcion3;
			var estado3= iimGetLastExtract(12);			//alert(""Estado: ""+estado4);
			save_csv[21] = estado3;			


			iimSet(""oficina"",save_csv[0]);
				iimSet(""num_order"",save_csv[1]);
				iimSet(""ano"",save_csv[2]);
				iimSet(""central"",save_csv[3]);
				iimSet(""orden"",save_csv[4]);
				iimSet(""fecha"",save_csv[5]);
				iimSet(""telefono"",save_csv[6]);
				iimSet(""estado"",save_csv[7]);
				iimSet(""nif"",save_csv[8]);
				iimSet(""cliente"",save_csv[9]);
					iimSet(""date1"",save_csv[10]);
					iimSet(""descripcion1"",save_csv[11]);
					iimSet(""estado1"",save_csv[12]);	
					iimSet(""date2"",save_csv[13]);
					iimSet(""descripcion2"",save_csv[14]);
					iimSet(""estado2"",save_csv[15]);	
					iimSet(""date3"",save_csv[16]);
					iimSet(""descripcion3"",save_csv[17]);
					iimSet(""estado3"",save_csv[18]);
					iimSet(""date4"",save_csv[19]);
					iimSet(""descripcion4"",save_csv[20]);
					iimSet(""estado4"",save_csv[21]);
					
			iimPlay(visordPRINT);
			save_csv = [];
		}
	}
}
",6
Imacros for reading stock prices,"Hello,

I am wondering whether imacros can be used to read live streaming prices from a webpage (e.g kite.zerodha.com)

If it is possible, I am planning to create a alerting system when a predetermined price appears on the screen.

Any help in these regards appreciated.

Thanks",11
iMacros Ajax Extract,"Just getting started and having some success with several macros. Then....this AJAX issue showed up. I have not had any success extracting the data returned by the AJAX code. TAG doesn't seem to get the job done. The data that I am attempting to extract is not visible in the page source but is visible when I 'inspect' the element. I've added a screen shot of the the code that is visible using 'inspect element' and have outlined the data I am hoping to extract. Any suggestions or tips would be most appreciated. ---Jerry
Currently working on a Mac using Firefox and iMacros version 9030808




",5
iimGetLastExtract() doens't work,"Hello,

My desktop is GNU/Linux debian testing, Firefox 45.9.0 and iMacros for Firefox 8.9.7.

I'm new in Imacros and I'm trying to extract -as a trainning- the data from a table on a website and different tabs.  I have encountered a problem with EXTRACT command combined with iimGetLastExtract(n).

The code can extract (PROMPT {{!EXTRACT}} show value) data and save in .csv file, but  iimGetLastExtract(n) only read null value for all data extracted, and the javascript logical operator's code doens't work.  But, if I insert SET !EXTRACTDIALOG YES javascript works fine but doens't save data in .csv file.
Code: Select all// Carga del website
var macro1 = ""CODE:"";
macro1 += ""TAB T=1\n"";
macro1 += ""URL GOTO=http://es.global-rates.com/estadisticas-economicas/inflacion/indice-de-precios-al-consumo/ipc/ipc.aspx\n"";
macro1 += ""SET !TIMEOUT_STEP 1\n"";

// Extracción de datos	
var macro2 = ""CODE:"";
macro2 += ""SET !TIMEOUT_STEP 1\n"";
macro2 += ""TAG POS=1 TYPE=TD ATTR=TXT:{{i}} EXTRACT=TXT\n"";
macro2 += ""TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
macro2 += ""TAG POS=R2 TYPE=TD ATTR=TXT:* EXTRACT=TXT\n"";
macro2 += ""SET !EXTRACTDIALOG YES\n"";
macro2 += ""SAVEAS TYPE=EXTRACT FOLDER=* FILE=VISORD_o.csv\n"";

// Ir a nueva URL	
var macro3 = ""CODE:"";
macro3 += ""TAB OPEN NEW\n"";
macro3 += ""TAB T=2\n"";
macro3 += ""URL GOTO=http://www.google.com \n"";
macro3 += ""TAG POS=2 TYPE=DIV ATTR=TXT:Google.es* EXTRACT=TXT\n"";
macro3 += ""SAVEAS TYPE=EXTRACT FOLDER=* FILE=VISORD_o.csv\n"";
macro3 += ""TAB T=1\n"";
macro3 += ""TAB CLOSEALLOTHERS\n"";

for (l=1;l<2;l++)
{
	iimPlay(macro1);
	
	for (n=1;n<8;n++)
	{
		var i = [""Alemania"",""Austria"",""Brasil"",""Corea del Sur"",""Dimamarca"",""Eslovaquia"",""Japón""];		
		iimSet(""i"",i[n-1]);
		iimPlay(macro2);
		var date = iimGetLastExtract(2);
		//alert(date);
		if (date == 'mayo 2017')
		{
			iimPlay(macro3);
		}
	}
}

I have read the FAQ's and  SET !EXTRACTDIALOG YES is not supported by Firefox.

Would someone be able to have a look at this and see what I'm doing wrong?  Many thanks for your time and efforts.",3
Extracting a table when two columns share same element name,"Hi,

I'm trying to extract a table with 7 columns of data. 

In the table I'm trying to extract two columns share the same element name ""CLASS:player-name"" I have to apply a regular expression to that element name to remove additional data I do not need. 

When I try to create a loop on the POS of the individual element when The script loops it uses the same player name for both columns in the csv file. 

I've tried to get the script to use relative extraction and have had no luck. 

Could some of the imacros wizards help me or point me in the right direction??

Cheers
TD

Code: Select all
VERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=https://matchstat.com/tennis/all-upcoming-matches

TAG POS=3 TYPE=TD ATTR=CLASS:round EXTRACT=TXT
TAG POS=3 TYPE=TD ATTR=CLASS:event-name EXTRACT=TXT

TAG POS=5 TYPE=TD ATTR=CLASS:player-name EXTRACT=TXT
SET !EXTRACT EVAL(""'{{!EXTRACT}}'.replace(/ \\(.+/gm, '');"")

TAG POS=6 TYPE=TD ATTR=CLASS:player-name EXTRACT=TXT
SET !EXTRACT EVAL(""'{{!EXTRACT}}'.replace(/ \\(.+/gm, '');"")

TAG POS=3 TYPE=TD ATTR=CLASS:odds-td<SP>odds-0 EXTRACT=TXT
TAG POS=3 TYPE=TD ATTR=CLASS:odds-td<SP>odds-1 EXTRACT=TXT
TAG POS=3 TYPE=TD ATTR=CLASS:h2h EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=* FILE=T1.csv

",6
Checking for a word in .csv file,"CIM iMacros for FF v9.0.3 Firefox 54.0 Windows 10

I want to check some data from .csv file with random word from site. If that word exists - to do something and if the word doesn't exist - to do something else. But I didn't find anything similar. EVAL function should do that but I don't know how to check whole .csv 

Example:
.csv file example.csv

content from example.csv is

science
cubic
virtual
internet
form
future

If I check the word science then it does one operation and if the word is clinic then something else. Is this possible with iMacro and .csv file

If yes, just give me some directions, please. If not, sorry for taking your time, simple no is just fine.

Cheers !",14
Getting function Expected when tyring to use reverse(),"Configuration: Surface Pro 2, Win 10, Firefox 53, iMacros Standard Edition (x86) Version 11.0.246.4051
Hi,
I am trying to split out the house address from the total extract.
The Web page HTML has a line break<br> between the name line section and start of address, but when extracted it doesn't appear as extracted=HTM shows the two fields run together ""<SP>lastnamehousenumber<SP>"" with no delimiter. However, I was able to split them using regex on white space.
Since the address fields are always represented the same way my goal is to separate house address, reverse it and split by index, o being zip, 1 being state, 2 being city and 3 the address. That way I don't have to worry about complex address parsing.

Here is the code I have so far. 
Code: Select allVERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
SET !EXTRACT_TEST_POPUP NO
'URL GOTO=https://www.protk.com/ProTeck.LocalVendor.Web/Home/Show?pageName=Cases
FRAME F=1
TAG POS=2 TYPE=TD ATTR=CLASS:ReportManagerTable_rows EXTRACT=TXT
SET Trim_spces EVAL(""var x,y,z; x=\""{{!EXTRACT}}\""; y=x.replace(/^\\s+|\\s+$/gm,'');y;"")
SET Split_spce EVAL(""var w,x,y,z; w = \""{{!EXTRACT}}\""; y = w.split(' ');y;"")
SET raw_address EVAL(""var x,y,z; x = '{{!EXTRACT}}'; y = x.replace(',',' ');y;"")
'***************************GET RID OF WHITE SPACE BETWEEN NAME LINE AND HOUSE NUMBER*********************************************
SET Sub_split_NME_NBR EVAL("" var a,x,y,z;  x = '{{Split_spce}}'; y=x.split(/\\s/g); z = y[1];z;"")
'**********TRIM WHITESPACES AT BEGINNING AND END OF STRING ADDRESS******************************************************
SET Trim_spces EVAL(""var x,y,z; x=\""{{Sub_split_NME_NBR}}\""; y=x.replace(/^\\s+|\\s+$/gm,'');y;"")
SET Rev_addr EVAL(""var x,y,z; x = '{{Sub_split_NME_NBR}}'; z = x.reverse(); z;"")

Here is the error code I get and it must have to do with the reverse() looking like a function call(?). I can't figure out how to get around it.
Code: Select allError -1250: JScript statement in EVAL contains the following error: Function expected. Line 23: SET Rev_addr EVAL(""var x,y,z; x = '{{Sub_split_NME_NBR}}'; z = x.reverse(); z;"")

I have attached a JPG with the ""PROMPT"" records for the !EXTRACT and variables.
Thanks",18
Table extraction ... Can't select the table,"Hello,

I'm trying to extract the data from a table on a website, but I can't get the wizard to highlight the correct part.

The website is http:\\www.poloniex.com and the table is the 'Markets' table to the far right of the page.

Would someone be able to have a look at this and see what I'm doing wrong, I'm only trying to identify the correct table.

Many thanks for your time and efforts.",2
Turn off green Boxes?,"Hi,

I was wondering if it was possible to turn off the green boxes that appear in the iMacros wrapped browser when playing back a script that extracts data. 

Thanks!
Jeff",2
How to scrap an website when you don't know the URL for that,"I have this website that I want retrieve information from. Unfortunately I can't show you because it is password protected.

The site is a list of tables that are dynamically created. 
 they design the link to activate a script. The first link is:
javascript:__doPostBack('ctl00$ContentPlaceHolder1$GridView1$ctl02$LinkButton1','')

The second link is the same, but with the last variable changed ($ctl03')""). It goes from 0 to 30


so is there any possiblity to change url automatic each loop",2
How to loop Css clicks and click subsequent CSS,"Config: Windows 10 64 bit, IMacro Enterprise v11.5.499_3066, Imacro Browser, 
http://forum.imacros.net/search.php 
Essentially I want to click [All Results] and then once that’s done.. I then want to click the nav tabs (that open once I’ve clicked [ALL RESULTS].  Lets say once I click [All Results] it had 1400 different buttons I wanted to click, it doesn’t but lets say it did.  How would I go about looping this?  


The Css after the [ALL RESULTS] is…
#st > option:nth-child(1) 
#st > option:nth-child(3) 
#st > option:nth-child(1) 
I have thus far…
VERSION BUILD=11.5.499.3066
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=http://forum.imacros.net/search.php
TAG SELECTOR=""#st"" CONTENT=%1 
TAG POS=((!LOOP)) TYPE=SELECT ATTR=CLASS* EXTRACT=TXT <-  Is there a way to do this for CSS like increasing in a variable or somehow not having to type the exact CSS name and all for each of them? As I want it to continually loop click TAG SELECTOR=""#st"" CONTENT=%1 and then click subsequent CSS.  Thanks in advance, I appreciate it.",6
Resume extraction though Firefox browser crash,"Hi everyone, i'm facing issue with Firefox browser. Once the browser crashes , I have to start all over with my extraction.

Is there a way for me to continue extracting from where it stopped rather than starting all over again from the beginning using JavaScript?",4
Extract to specific cells in excel,"TAG POS=5 TYPE=A ATTR=TXT:* EXTRACT=txt
SAVEAS TYPE=EXTRACT FOLDER=* FILE=test.csv


Gives extract perfectly and confirm in popup box. Only it places the extract in the A2 column in excel. For example I  need it to go to F20 and next time I run it, I need it to over write f20 again. Ultimately just always be in that specific cell. I have googled and googled and surprisingly do not see anyone else requesting this feature?

Any help would be appreciated.

I tried adding SET !EXTRACT {{!COL6} but that did not help.

I am using firefox 53.0.3
9.0.3 Imacro for firefox.
Win10 english
no other issues with imacros or any other macros ive been using.",4
inputting keywords from CSV file,"I am using a CSV file as input with keywords to my imacros program. I am able to read only the column and generate the search output that I need. I want the program to read even the rows. The input has to be read like a nested for loop ware every row and column have to be inputted in the form (1,2),(1,3),(1,4)..........(1,n) (2,3),(2,4)................(2,n) and so on. Is it possible to read the input file with imacros in this way or is there any other alternative for this.

Here is my program that scrapes information using keywords and saves parsed information in another file. However, I want to use both rows and columns and input more than one keywords at once.
Code: Select all
'VERSION BUILD=9030808 RECORDER=FX
 TAB T=1
 set !extract_test_popup no
 set !replayspeed fast
 set !timeout_page 200
 SET !ERRORIGNORE YES
 SET !TIMEOUT_STEP 2
 SET !Datasource keyword.CSV
 Set !Loop 1
 Set !Datasource_Line {{!Loop}}

 URL GOTO=https://twitter.com/search-advanced

 wait seconds=1
 TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:NoFormName ATTR=NAME:ands CONTENT=
 {{!COl1}}
 TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Search
 wait seconds=1

 ADD !EXTRACT {{!URLCURRENT}}
 Set url {{!Extract}}
 Set !Extract Null



'Keyword Scrape
Tag pos=1 type=h1 attr=class:SearchNavigation-titleText* Extract=Txt
Set key {{!Extract}}
Set !Extract Null


'Main Heading Scrapping
Tag pos=1 type=a attr=class:AdaptiveNewsLargeImageHeadline-title* 
Extract=Txt
Set mainheading {{!Extract}}
Set !Extract Null

'Main heading URL
Tag pos=1 type=a attr=class:AdaptiveNewsLargeImageHeadline-title* 
Extract=href
Set mainheadingurl {{!Extract}}
Set !Extract Null


'Date of Post
 Tag pos=1 type=a attr=class:AdaptiveNewsHeadlineDetails-date<sp>js-nav* 
 Extract=txt
 Set date {{!Extract}}
 Set !Extract Null


 'Username whose post this article
  TAG XPATH=//*[@id=""page-
container""]/div[2]/div/div/div[2]/div/div[2]/div/div[2]/div[2]/div[1]/a/span 
 Extract=Txt
 Set username {{!Extract}}
 Set !Extract Null

'extract user name
TAG POS=1 TYPE=A ATTR=TXT:@* EXTRACT=TXT
Set username1 {{!Extract}}
Set !Extract Null


Add !Extract {{mainheading}}
Add !Extract {{date}}
Add !Extract {{mainheadingurl}}
ADD !EXTRACT {{url}}
Add !Extract {{username}}
Add !Extract {{key}}
Add !Extract {{username1}}


SAVEAS TYPE=EXTRACT FOLDER=* FILE=test1_output.csv
clear'",7
Data Search,"Hi,
I want to find data & save it on CSV automatically. Suppose ""Beyerdynamic T 90"" is a headphone model number, I want to find the Weight of this headphone from google.com automatically from the search result. Is it possible?",1
"New to E-commerce website Extraction, where do i begin","Hello

I have a massive project with extracting products from E-Commerce websites

What i need to do

Select Each product in a given category to open Detail page and extract information(Text or Image)
Select pagination where there are more than one page in one category and continue on next page 

Are there any tutorial/video lessons available that explain process

I have knowledge with HTML/XPath etc., I just need to find some example how to cycle through an E-Commerce site

Any help will be appreciated

Tom",2
Capturing EXTRACT data,"iMacros Version V. 844
Browser Google Chrome versions is: 58.0.3029.110 (64-bit)
Operating System macOS Sierra V. 10.12.5
Included Demos work ok (all of them)

Also tried briefly on a Windows 10 system with Chrome with the same results. All demos worked.


Is there a way to put user-entered data into a variable?

I had been using PROMPT to capture user input data as a variable...

PROMPT ""Please enter text:"" !VAR1

Unfortunately, PROMPT no longer works with the latest Chrome update. 

I've come up with the following workaround that EXTRACTs the user input from an html form I created.  But I can't pass that data along because EXTRACT is not a variable and IEXTRACT does not work within a TAG.  I've spent a lot of time with this and I haven't found a way to do this.  Is there a way to load TAG EXTRACT'd data into a variable?

This is what I am trying to do...

URL GOTO=C:\Users\username\Desktop\FormTest.html
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:form1 ATTR=NAME:abc EXTRACT=TXT 

SET !VAR1 {{!EXTRACT}}

TAB OPEN NEW
TAB T=2
URL GOTO=http://www.forvo.com/word/{{!VAR1}}/#ar

No luck with this, even though I found some demo samples that said it should work.

Any suggestions would be appreciated. Thank you.",4
Extracting Data From Local Text File,"So what I want to do is make a text file (lets say notepad) and write something their (for example ""May 24th 2017""). This text file will sit on my desktop.

I would like to create a macro that retrieves the string of text that I write in that file on my desktop and place it in a text box on a website.

The next day, I'll open that text file and edit the text (for example tomorrow I would edit it to say ""May 25th 2017"") and continue using the macro with the updated text.

Seems simply enough, is this possible? If not, are there any workarounds to accomplish the same thing? Thanks!",5
Problem extracting table row,"Hi all!

I experience a strange problem extracting a specific row from table.
When I extract the entire table with TYPE=TABLE, it works nice; when I extract some specific cell from the same table with TYPE=TD it works nice as well.
However when I try to extract a specific row from the table with TYPE=TR, I end up with a mess of repetitions which looks like that:
111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25Product Development111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25Product Development111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/2013111111VC Seed111111VC Seed111111VC Seed111111VC Seed24/01/20130.25Product Development

Instead of 
1 	 	VC Seed 	 	24/01/2013	0.25		 	Product Development

Can anybody advice why that happens with TYPE=TR and how to avoid it?
One option is to extract the table and SAVEAS only a specific row - however I'm not sure if it's possible with IMacros.

Thank you in advance!",2
Use ONWEBPAGEDIALOG with the MACRO parameter,"I have a macro that populates a WebPage Dialog box.  It was working until just recently.  We have incorporated the information on how to ""Use ONWEBPAGEDIALOG with the MACRO parameter"".  There are 2 issues: 

(1)There are 2 text boxes and 2 drop downs with start and end time.  Following these instructions, I can record changing the text boxes but the drop downs are frozen.  Is this part of iMacros or some option in IE?

(2) When I record changing the text boxes, I compare it to the existing code and it is identical.  I even pasted over the existing code with what I recorded.

When I run the macro, I get an error code -1300.  It is erroring out on the following line:

TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:popupForm ATTR=NAME:eventDesc CONTENT=Memorial<SP>Day

This is the first line in the RFSDialgCHECK.iim.  I'm not sure what it can't find this element when it is what is recorded in iMacros.

Following is the code that runs the the RFSDialgCHECK.iim:

Dim ID As String

 IM = """"
 IM = ""CODE:""
 IM = IM + ""TAB T=1"" + vbNewLine
 IM = IM + ""ONWEBPAGEDIALOG MACRO=C:\Temp\RFSDialgCHECK.iim"" + vbNewLine
 IM = IM + ""TAG POS=5 TYPE=INPUT ATTR=CLASS:*"" + vbNewLine
 IM = IM + ""WAIT SECONDS=2"" + vbNewLine

 Dim eScript As Object
 Set ObjScr = New Scripting.FileSystemObject
 Set eScript = ObjScr.CreateTextFile(""C:\Temp\RFSDialgCHECK.iim"", True)

 ID = ID + ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:popupForm ATTR=NAME:eventDesc CONTENT="" & EDescr + vbNewLine

 If OTime = ""CLOSED"" Then

      ID = ID + ""TAG POS=1 TYPE=SELECT FORM=NAME:popupForm ATTR=NAME:eventOpenTime CONTENT=%"" & OTime + vbNewLine
      ID = ID + ""TAG POS=1 TYPE=SELECT FORM=NAME:popupForm ATTR=NAME:eventCloseTime CONTENT=%"" & ETime + vbNewLine

Else

     ID = ID + ""TAG POS=1 TYPE=SELECT FORM=NAME:popupForm ATTR=NAME:eventOpenTime CONTENT=%"" & NewOpenTime + vbNewLine
     ID = ID + ""TAG POS=1 TYPE=SELECT FORM=NAME:popupForm ATTR=NAME:eventCloseTime CONTENT=%"" & NewCloseTime + vbNewLine

End If

ID = ID + ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:popupForm ATTR=NAME:eventStartDate CONTENT="" & EDate + vbNewLine
ID = ID + ""TAG POS=1 TYPE=INPUT:BUTTON FORM=NAME:popupForm ATTR=NAME:add"" + vbNewLine

eScript.Write ID
eScript.Close

iret = iim1.iimPlay(IM)

Any help would be appreciated.  Thanks for your time.",7
Extracted Data in different columns no placeholder anymore,"Anybody have any ideas? On the 8.9 build, when the macro didn't have any data to extract, it would fill in eanf. This would keep all the data extracted in the same column, neat and easy to filter. Now, when nothing is there, it simply moves the data over, so I end up with something like this:

A	B	C	D
A	B	C	D
A	C	D	
B	D		
B	C	D	

Instead of this

A	B	C	D
A	B	C	D
A	#EANF#	#EANF#	D
#EANF#	B	C	D

Apart from using the older build, is there any fix for this? Basically, I want eanf or some other placeholder for when no data is extracted, so the columns are easily filtered.",8
Issue Extract with firefox plugin,"Browser: Firefox 53.0.2 (32 bit)
S.O. Windows 8.1 Pro
plug in: iMacros for Firefox 9.0.3 (updated April, 24. 2017)

-----------------------

Hello, 

First of all , sorry for my bad english. 

I'm having an issue extracting TXT when in the middle of the text to extract there are Bold or Italic characters. It happens with Firefox plugin.

iMacros program works properly

I've changed the demo page (http://demo.imacros.net/Automate/Extract2) HTML to test if the problem was caused for the web page where I want to extract The text.

I've added bold characters in the middle of the phrase like this:
""The second line is extracted too"" for ""The second line is extracted too"".

In HTML: 

<td style=""width: 52%; outline: 1px solid blue;"" class=""bdytxt"">
 This line is extracted.<br>
 The <strong>second line</strong>
 is extracted, too.
</td>

Running this macro:

VERSION BUILD=8031994
TAB T=1
SET !EXTRACT_TEST_POPUP NO
URL GOTO=http://demo.imacros.net/Automate/Extract2
TAG POS=1 TYPE=TD ATTR=CLASS:bdytxt&&TXT:* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=+_{{!NOW:yyyymmdd_hhnnss}}

the result is: 

This line is extracted.
TheThis line is extracted.
Thesecond lineis extracted, too.

instead of:

This line is extracted.
The second line is extracted, too.


It seems as the extracted text repeats himself when finds the bold tag (<strong>)

Thank You in advance",3
Extracting an image from a website into a new folder.,"Hello,

As stated in the title, I have looked within the iMacros Wiki and am looking for an option to save a new image from a website and put the image into a new folder each time the script is run. I noticed the SAVETARGETAS function and seem like there is some possibility with this command.

However, is it even possible for this option with just the iMacros language? Or will I have to seek out this possibility with Javascript, C#, etc.

Thanks for any help that may be submit as I have been working for this solution for a few days now. ",4
Extract blank when tag fails,"Hello,

I'm using iMacro's build 9030808 for Firefox 53.0.2 (32-bit) on Windows 7. I've been using iMacros to scrape social media profiles for certain pieces of information. Because information on the platform is self-reported, certain pieces of info are often missing, resulting in the tag failing. Ultimately, this means a lot of work for me on the back end sorting the data so that each piece of information is in the correct column. Instead, I'd like to extract a blank each time the program fails to find a piece of information.

I've looked all over the forums, but have yet to find a solution for this yet. This one appears to come close, but was never resolved. http://forum.imacros.net/viewtopic.php?f=7&t=25503

I imagine the solution would involve the EVAL function, but I don't have any experience in javascript. Is there an obvious way to do this? I've pasted an example script below for context:
Code: Select allVERSION BUILD=9030808 RECORDER=FX
TAB T=1
TAB CLOSEALLOTHERS
SET !ERRORIGNORE YES
SET !DATASOURCE Leadership.csv
SET !DATASOURCE_COLUMNS 1
SET !LOOP 1
SET !DATASOURCE_LINE {{!loop}}
URL GOTO={{!COL1}}

WAIT SECONDS=5

TAG POS=1 TYPE=h1 ATTR=CLASS:* EXTRACT=TXT
TAG POS=1 TYPE=h3 ATTR=class:""Sans-17px-black-85%-semibold"" EXTRACT=TXT
TAG POS=1 TYPE=span ATTR=class:""pv-position-entity__secondary-title pv-entity__secondary-title Sans-15px-black-55%"" EXTRACT=TXT
TAG POS=1 TYPE=h4 ATTR=class:""pv-entity__date-range Sans-**px-black-**%"" EXTRACT=TXT
TAG POS=1 TYPE=h4 ATTR=class:""pv-entity__location Sans-**px-black-**% block"" EXTRACT=TXT

TAG POS=2 TYPE=h3 ATTR=class:""Sans-17px-black-85%-semibold"" EXTRACT=TXT
TAG POS=2 TYPE=span ATTR=class:""pv-position-entity__secondary-title pv-entity__secondary-title Sans-15px-black-55%"" EXTRACT=TXT
TAG POS=2 TYPE=h4 ATTR=class:""pv-entity__date-range Sans-**px-black-**%"" EXTRACT=TXT
TAG POS=2 TYPE=h4 ATTR=class:""pv-entity__location Sans-**px-black-**% block"" EXTRACT=TXT

TAG POS=1 TYPE=h3 ATTR=class:""pv-entity__school-name Sans-17px-black-85%-semibold"" EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:""pv-education-entity__secondary-title pv-entity__degree-name pv-entity__secondary-title Sans-**px-black-**%"" EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:""pv-education-entity__secondary-title pv-entity__fos pv-entity__secondary-title Sans-**px-black-**%"" EXTRACT=TXT
TAG POS=1 TYPE=p ATTR=class:""pv-education-entity__date pv-entity__dates Sans-**px-black-**%"" EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=* FILE=Leadership.csv

WAIT SECONDS=5


Thanks!",4
Extract links in separate lines,"Hello, how to save in file one link per line?
Code: Select allSET !EXTRACT_TEST_POPUP NO
SET !ERRORIGNORE YES
TAG POS=1 TYPE=A ATTR=CLASS:marginr EXTRACT=HREF
TAG POS=2 TYPE=A ATTR=CLASS:marginr EXTRACT=HREF
WAIT SECONDS=1
SAVEAS TYPE=EXTRACT FOLDER=D:\ FILE=links.txt


imacros 9.0.3, firefox, windows10 64",2
Can't extract status on LinkedIn,"I'm trying to extract my connection status on a profile on linkedin.  
Code: Select allSET !EXTRACT_TEST_POPUP YES
'
SET !EXTRACT NULL
'Surf to person using LinkedIn URL
TAG POS=2 TYPE=SPAN ATTR=TXT:Pending EXTRACT=TXTALL
'
SAVEAS TYPE=EXTRACT FOLDER=""N:\\Results"" FILE=Extract.csv
'
'End of Loop


When I test with popup ON, the box pops up and says Pending. But I can't get that word to write in to my extraction file!

I have this block of code in a a file that reads URLs from a csv file. I know it's reading my file OK, looping OK, etc. I know it can find the TAG because the popup comes up as expected. But no luck getting it to write that to my results file.

Any help would be greatly appreciated!

Joe",1
"aliexpress data extraction in ""product description""","hi,

i try to scraping aliexpress product page to get ""product description"" tab section.

https://www.aliexpress.com/item/Vfemage ... 72852.html

there is page i need to get ""product description""

i inspect this section as TAG POS=1 TYPE=DIV ATTR=class:description-content EXTRACT=HTM

however, an extract result was contain following only:

        <div class=""ui-box-title"">Product Description</div>
        <div class=""ui-box-body"">

            <div class=""description-content"" data-role=""description"" data-spm=""1000023"">
            <div class=""loading32""></div>
            </div>

        </div>

it seems they hide a HTM content or using any javascript to hide.

is there any method to reveal a content when scraping?

thank",2
Web Scraping Table With SPAN Class,"Hello iMacros Community,

I'm brand new to iMacros, but I have spent a lot of time watching YouTube videos and browsing this forum. However, I haven't been able to figure out how to do this quite yet.

My company uses an eCRM system that loads via Internet Explorer 11, and I am able to get iMacros to go through all of the login process and get to the point where I'm ready to extract records. I can even get it to extract the first row of records. However, I cannot get it to go down to the next row, and extract it. Each of my attempts either involve it scraping the first line multiple times, or in an #EANF# error after the first row.

My code is below:
Code: Select allVERSION BUILD=11.5.498.2403
TAB T=1
TAB CLOSEALLOTHERS
FRAME NAME=WorkAreaFrame1

'Table fields to extract in order. [objectid] is the unique index for each record
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].objectid EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].createdon EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].sender EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].description EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].status EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].employee_concat EXTRACT=TXT
TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].group_concat EXTRACT=TXT
'TAG POS={{!LOOP}} TYPE=A ATTR=ID:C17_W66_V67_V76_items_table[1].ITEMTYPE EXTRACT=TXT
'TAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].priority EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=T:\TELESERV\Continuous<sp>Improvement<sp>Db<sp>Files\TCS-KNX<sp>Daily<sp>Digest FILE=Extract_{{!NOW:ddmmyy_hhnnss}}.csv

'This is the row selector
'TAG POS=1 TYPE=A ATTR=ID:C17_W66_V67_V76_ItemTree_sel_1-rowsel EXTRACT=TXT

'Forward button for next page of results. Need to push if exists, and grab next list.
'TAG POS=4 TYPE=SPAN ATTR=CLASS:th-clr-span EXTRACT=TXT

I do have some commented out lines, until I can figure out how to get the scraping of one list of results. The hard part is that this list can contain up to a maximum of 200 results. If there are more than 200 results, it would need to push the ""Next"" button (TAG POS at the very bottom of the code above), then extract those results as well until the ""Next"" button could not be pressed again.

Each row is indicated in the string at the very end, surrounded in []. So, Code: Select allTAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[1].objectid EXTRACT=TXT would then go to the below for the next line, and so on. Code: Select allTAG POS={{!LOOP}} TYPE=SPAN ATTR=ID:C17_W66_V67_V76_items_table[2].objectid EXTRACT=TXT 
Below is a picture of how our eCRM GUI is set up. 



 eCRM Table Setup 

Although I'm not grabbing every field, the names from the headers should give you an idea of the text that exists within them.

Any help/direction you all could provide would be greatly appreciated.

Thanks!",3
CSV formatting issue with Firefox imacro data extraction,".,.m",7
Important Progress iMacros Product Update,"Dear iMacros Customers and Users, 

We are writing to inform you that Progress will be officially discontinuing the Progress iMacros product, with a planned End-Of-Life date of November 30, 2023. 

What does this mean? 
Moving forward, Progress will continue to support the iMacros product and will only provide critical fixes as needed until the EOL date. We will honor all service agreements through the existing term, except for those contracts that go beyond the EOL date. Customers with service agreements that go beyond the EOL date will be contacted separately to discuss their options and next steps. We will continue to offer service agreement renewals that do not exceed the EOL date. 

What are your next steps? 
Please remain on the lookout for more communications from Progress in the coming months, as more information will be made readily available to assist you as you prepare your transition plans. 

If you have additional questions, please email iMacrosInquiries@progress.com 

On behalf of Progress, thank you for your continued partnership and commitment. 

Sincerely,  
The Progress iMacros Team",2
*** Please read this before reporting problems ***,"Post last updated: May 25, 2020.

If you open a new topic (or post for the first time in some existing topic) to report an issue or ask any question, we can respond much faster if your problem description includes the following information (if applicable, not all questions fit to all problems):

1. What version of iMacros are you using?
You find the iMacros version and build information at the top of every macro that you record, for example ""VERSION BUILD=10100795"". Also specify whether you are using a freeware, trial, or licensed version, e.g. Personal Edition. Please test with the latest version.

2. What operating system are you using? (please also specify language)
Example: Windows 10, Windows 8.1, Windows 7, Windows Server 2012R2, English, German, Chinese, ...

3. Which browser(s) are you using? (include version numbers)
Example: Chrome 74.0.3729.13, Firefox 64.0.2, IE 11/10/9, ...

4. Do the included demo macros work ok? 
This test helps us to determine if the problem is a general iMacros issue or is somehow related to a specific website or configuration.

5. If reporting a problem with the iMacros scripting interface, please also test if the included VBS sample scripts run ok.
This test helps us to determine if the iMacros scripting interface installation is ok.

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the macro that creates the problem?
If you cannot post the macro in a public user forum or the website requires a login, can you provide a similar example of the problem on a publicly accessible website?

7. Do you encounter the same problem recording or replaying the macro in different browsers, such as the iMacros browser, Firefox, Chrome, or Internet Explorer? 
Note: If the problem is specific to Firefox or Chrome, please post in either the iMacros for Firefox or iMacros for Chrome sub-forum respectively.

8. Please include any additional information that is relevant to reproducing the issue.
This includes a detailed description of the steps you've tried as well as the specific error codes and messages, macro logs, screen shots, etc. Please upload screenshots and other relevant files directly to the forum and not to a third-party hosting service!

This information allows us to quickly re-create the issue on our test systems and solve it ASAP.

Additional tips when posting

* Please ensure that the content of your post is relevant to the topic and/or forum where you post it.
For example, if you are having a problem extracting data from a web page and are using Firefox, create your post in the Data Extraction and Web Screen Scraping forum rather than the iMacros for Firefox forum (see note #7 above). If you are unsure which forum to post to, use the General Support & Discussions forum.

* Use a topic title that succinctly describes the problem or issue.
Avoid phrases such as ""Please Help"", ""Urgent"", ""Script not working"", etc. and refrain from using all capital letters and exclamation points. Also, double-check that the spelling of the title and body of the post are correct, since this makes it more likely to be found in searches by other users. Most modern browsers automatically check spelling as you type and underline mistakes, so please correct them before submitting your post.

* Don't post the same question to more than one forum.
If you've miscategorized your original post, just click the Exclamation Icon on the right of the post's subject/title line to report it and let us know where you would like it moved or merged.

* Always provide your FCI (Full Config Info), c.f. items 1-3 above, in your original post even if you think it may not be relevant.
Some of our mods may not even respond unless this information is included. Please don't put this information in your signature, because this can change over time and makes it more confusing when reviewing older posts. Include the information directly in the body of the post instead.

* When sharing screenshots or other relevant files, please upload them directly to the forum rather than use a third-party hosting/sharing service.
Too often these services stop functioning or the files become unavailable for whatever reason. Uploading them here ensures that the full context of the post remains consistent over time.

* Take a minute to review your forum notification settings

Thank you for helping us to help you better!",1
Extracting and comparing variable data.,"Hi everyone,

I am new to this and I was wondering if it is possible to complete this action.

I want to set up a web macro on firefox to output the matching results of the data I input.

On a webpage I have to frequently enter a lot of data into three text boxes, all the data are just a series of random numbers pretty much, the goal of the macro would be to extract all the data from box 1 and box 3 and output which  of the numbers numbers match, after this though, the numbers of which are in the outpoint (the matching numbers from box 1 & 3) if any of these numbers also show up in box 2 to take those away those away from the final output. An example of this I will show below. 

Box 1 
12345 3233 23232 3232 2323 232 23233
54543 54543 545  5455   54543 54557 7776
Box 2 
3233 23232 5454 6565 65657
Box 3
12345 3233 23232 3232 2323 232 23233
7477 7372 87499 9937 3773 9922 9933 

So the final output would be:- 12345 3232 2323 232 23233

I hope this makes sense  if anyone could help or point me in the right direction, would much appreciated  it. 

",4
TAG and SEARCH parameters,"And now for Part II of http://forum.imacros.net/viewtopic.php?f=7&t=27429
One possible outcome of a friend search on FriendlyFriends.com is that a friend was not found. In that case, the resulting web page contains the following:
<div id=""FriendListing"" class=""NoFriend"">
	<p class=""NoFriendSummaryText"">I'm sorry, but your friend was not found.
        </p>
</div>
If I get this result then I want to append the csv record with some relevant notation but I first have to detect this result instead of other possible results. I tried the following but neither work:
SEARCH SOURCE=TXT:""'NoFriendSummaryText'"" IGNORE_CASE=YES
TAG POS=1 TYPE=A ATTR=TXT:*sorry*
Both the macro fails at both cases at the above line.
I think either command will work and I think I just need help with the parameters. I found the above by searching the demo macros and command reference and forum but didn't find an exact solution. Thanks in advance for any help fixing the parameters (ideally for both options).
iMacros for FF v9.0.3, FF52-x32, Win7-x64",6
Extract & Verify,Is there a way to extract a particular data from web page & compare it with a predefined values to return True or False,7
Create URL from CSV and loop,"I'm hoping someone can point me to a model to solve my issue:
As part of a scrape macro, I need to create and navigate to a series of URLs based on values in a csv file. The template URL could be:
http://www.friendlyfriends.com/friendse ... name=LNAME
where FNAME and LNAME are columns in the csv file.
While at each URL I would scrape text but for now I just want to be able to loop thru each URL.
Thanks in advance for any direction.",8
Change Drop Down Button Using CSV,"Version 9.0.3
Windows 10
Firefox 50.1.0

Any one help this code, please

VERSION BUILD=9030808 RECORDER=FX
TAB T=1
SET !DATASOURCE ""C:\\Users\\OFFICE\\Documents\\iMacros\\Datasources\\JobCard-No.csv""
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}

'Select Village name
TAG POS=1 TYPE=SELECT FORM=ID:aspnetForm ATTR=ID:ctl00_ContentPlaceHolder1_DDL_Village EXTRACT=TXT

' Extract Length 15. : TAG POS=1 TYPE=SELECT FORM=ID:aspnetForm ATTR=ID:ctl00_ContentPlaceHolder1_DDL_Village CONTENT=%2906015005007<SP><SP><SP><SP><SP>

SET !VAR5 EVAL(""'{{!EXTRACT}}'.trim();"")

'After trim Extract Length is 13. Because i need to check both in .csv 4th column length is 13.

SET !VAR3 EVAL(""if({{!COL4}}!={{!VAR5}}){TAG POS=1 TYPE=SELECT FORM=ID:aspnetForm ATTR=ID:ctl00_ContentPlaceHolder1_DDL_Village CONTENT={{!COL4}}} else{do nothing and move to next row until a match is found};"") 

I have some error.

missing ; before statement, line: 22 (Error code: -1001)


.CSV File contain




",4
Imacros Player - Access denied,"Hey guys,

Info: Imacros Browser V11.5.498.2403, Windows Server 2008 R2, IIS 7.5

When trying to access a website, I'm getting: ""Access Denied - You don't have permission to access ""http://..."" on this server. Reference #...""
I don't know why this is happening and how can I solve this. It's giving me a reference number but I don't know what to do with it.
Have you guys ever encountered this problem ? If I open IE,FF,CH the site works ok on the server. Only in the imacros player it doesn't work.

Any help is welcome,
Thanks !",4
Scrapping articles via RSS,"I want to scrap a website (http://pkjobvacancy.com/). Everytime a new article is posted on this website I want to copy the text and image of that post, and send me via email on my email address. Please someone give me script for this..
Thank you",6
Fill many value from txt to many tab !,"I'm using
Win 7 64bit
VERSION BUILD=11.1.495.5175
Firefox.

I have 1 file a.txt, 1B line & every line with 1 value.
1
2
3
4
...
1000000000
I have work with my website about value links links\value : link\2 10s end loop link\2
Please help me how i can open new tab & fill value inc +1 for each tab link.

Loop 10 0000
with as new 3 tab for 1 loop. 


open new tab
open links with value line 1

open new tab
open links with value line 2

open new tab
open links with value line 3

end loop 
Loop new

open new tab
open links with value line 4

open new tab
open links with value line 5

open new tab
open links with value line 6
.....
to end 1B line vlaue txt.

Please help me work it.
I try hard very much but i cant. Only work with many firefox & many file txt cant work with many tab with 1 file txt.
Code: Select allVERSION BUILD=2170321 RECORDER=FX
	TAB CLOSEALLOTHERS
	SET !EXTRACT_TEST_POPUP NO
	SET !TIMEOUT_PAGE 30
	SET !ERRORIGNORE YES
	SET !ERRORCONTINUE YES
	SET !TIMEOUT_STEP 1
	SET !DATASOURCE_DELIMITER ;
	SET !DATASOURCE C:\a.txt

	
SET !LOOP 1
SET !DATASOURCE_LINE {{!VAR1}}
SET !VAR2 0

TAB OPEN NEW
TAB T={{!VAR2}}
ADD !VAR2 1
ADD !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=http://wiki.imacros.net/{{!COL1}}


'Open TAB, select it, load website
TAB OPEN NEW
TAB T={{!VAR2}}
ADD !VAR2 1
ADD !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=http://wiki.imacros.net/{{!COL1}}


'Open TAB, select it, load website
TAB OPEN NEW
ADD !VAR2 1
TAB T={{!VAR2}}
ADD !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=http://wiki.imacros.net/{{!COL1}}",3
Extracting Attributes,"It is to my understanding that Imacros can extract parameters now as explained here: http://wiki.imacros.net/TAG#Extract_Custom_Attributes

However, it doesn't explain much about this. After testing on Firefox and not getting it to work, I realized it said it only works with 10.2 which isn't a Firefox version. Does it work with Internet Explorer Imacros?

I hear it can be done with scripts but I don't have a lot of knowlege on so if someone can point me in the direction, the below content in the ""value"" attribute is what needs to be extracted.
Code: Select all<input name=""bullet_point1"" value=""CONTENT TO BE EXTRACTED"">",4
Extract Point Changes - How do I Extract Text,"Hello,

I'm having an issue with a extract point for my macro. When I change the search parameter the site is returning the data in a different point and I am unable to extract the information.

This is the first macro where the search parameter is 50288578 and the extract point is the last line below.
Code: Select allVERSION BUILD=9002379
TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=https://www.rrts.com/Pages/Home.aspx
TAG POS=2 TYPE=I FORM=ACTION:/Pages/Home.aspx ATTR=CLASS:icon-tasks
WAIT SECONDS=1
TAG POS=2 TYPE=INPUT:RADIO FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$Type CONTENT=YES
WAIT SECONDS=1
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$rptPRO$ctl00$rtbPRO CONTENT=50288578
WAIT SECONDS=1
TAG POS=1 TYPE=INPUT:BUTTON FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$cmdSubmit
WAIT SECONDS=10
TAG POS=1 TYPE=SPAN FORM=ACTION:/Tools/Tracking/Pages/MultipleResults.aspx?PUNS=NTAyODg1Nzg= ATTR=ID:ctl00_ctl51_g_a00bf657_07a9_444e_9b38_fb00487e0952_TraceResultID50288578_lblPro* EXTRACT=TXT


This is the second macro where the search parameter is 50288721 and the extract point is the last line below.
Code: Select allVERSION BUILD=9002379
TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=https://www.rrts.com/Pages/Home.aspx
TAG POS=2 TYPE=I FORM=ACTION:/Pages/Home.aspx ATTR=CLASS:icon-tasks
WAIT SECONDS=1
TAG POS=2 TYPE=INPUT:RADIO FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$Type CONTENT=YES
WAIT SECONDS=1
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$rptPRO$ctl00$rtbPRO CONTENT=50288721
WAIT SECONDS=1
TAG POS=1 TYPE=INPUT:BUTTON FORM=ACTION:/Tools/Tracking/Pages/default.aspx ATTR=NAME:ctl00$ctl51$g_58aef1dd_2091_421b_99ff_86b055c64d8b$cmdSubmit
WAIT SECONDS=10
TAG POS=1 TYPE=SPAN FORM=ACTION:/Tools/Tracking/Pages/MultipleResults.aspx?PUNS=NTAyODg3MjE= ATTR=ID:ctl00_ctl51_g_a00bf657_07a9_444e_9b38_fb00487e0952_TraceResultID50288721_lblPro* EXTRACT=TXT

Notice that the extract line is in a different place.

Marco 1
Code: Select allTAG POS=1 TYPE=SPAN FORM=ACTION:/Tools/Tracking/Pages/MultipleResults.aspx?PUNS=NTAyODg1Nzg= ATTR=ID:ctl00_ctl51_g_a00bf657_07a9_444e_9b38_fb00487e0952_TraceResultID50288578_lblPro* EXTRACT=TXT

Macro 2
Code: Select allTAG POS=1 TYPE=SPAN FORM=ACTION:/Tools/Tracking/Pages/MultipleResults.aspx?PUNS=NTAyODg3MjE= ATTR=ID:ctl00_ctl51_g_a00bf657_07a9_444e_9b38_fb00487e0952_TraceResultID50288721_lblPro* EXTRACT=TXT

As a result I am unable to automate this from code if I make the search parameter a variable and try to repeat the macro by just changing the search parameter.

How do I adjust for this so that I am always able to extract the data regardless of the search parameter?

Thank you in advance for you help.

Harry.",2
How to select checkbox in row based on cell txt ?,"Hello, how can I select checkbox in row selected by data inside cell.
Example:

<form>
<table>
<tr><td><input name""CheckBoxName"" type=""checkbox""/></td><td><span>Description 1</span></td><td><span>1,00</span></td></tr>
<tr><td><input name""CheckBoxName"" type=""checkbox""/></td><td><span>Description 2</span></td><td><span>2,00</span></td></tr>
<tr><td><input name""CheckBoxName"" type=""checkbox""/></td><td><span>Description 1</span></td><td><span>1,00</span></td></tr>
</table>
</form>

In this example I want to select checkboxes only when data in second cell = ""Description*"" and data in third cell = ""1,00"".
How can I do this ?",8
Extract Gift Card Balance,"I'm working on an iMacros that 

* Checks the balance of a gift card
* Extracts that balance into a spreadsheet

I'm using a 3 column CSV (datasource):

* Card #
* Exp date
* PIN

A new tab is opened for each line of datasource.

I would like to extract the balance into the original datasource, so that the new CSV would have 4 columns:

* Card #
* Exp date
* PIN
* Balance

I know I could extract it into a separate CSV, then paste it back into my original datasource, but I'd prefer to skip this extra step and have everything in one file.

Here is the incomplete code so far; I haven't added a destination for the extraction yet, b/c I'm hoping to add it back to the datasource - if that's even possible.
Code: Select allVERSION BUILD=5010424 RECORDER=CR
' Check the balance of a Simon Gift Card. Prompts for the Captcha, submits and opens a new tab to check the next gift card balance.
' This method is useful if you have a # of cards to check: the balance will load in the background as another tab opens and checks the next card.
' Once it finishes the spreadsheet, visit each tab to see the balance on your card.
' Feel free to modify and adapt this script.
SET !DATASOURCE SimonGiftCards.csv 
SET !DATASOURCE_COLUMNS 3
SET !VAR1 2
SET !LOOP {{!VAR1}}
SET !DATASOURCE_LINE {{!LOOP}} 
SET !ERRORIGNORE YES
URL GOTO=https://www.simon.com/giftcard/card_balance.aspx
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_ctl00_FullContent_MainContent_tbNumber CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_ctl00_FullContent_MainContent_tbExpDate CONTENT={{!COL2}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_ctl00_FullContent_MainContent_tbCid CONTENT={{!COL3}}
' The Captcha was covered by the dialog box, so added a new position tag to move the webpage back to the top.
TAG POS=1 TYPE=SECTION ATTR=TXT:The<SP>Simon<SP>Giftcard®<SP>Gift<SP>Card<SP>Corporate<SP>Sa*
PROMPT ""Captcha:"" !VAR3
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_ctl00_FullContent_MainContent_CaptchaCodeTextBox CONTENT={{!VAR3}}
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:aspnetForm ATTR=ID:ctl00_ctl00_FullContent_MainContent_checkBalanceSubmit
' Wait for the results page to open with the balance of the gift card.
WAIT SECONDS=20
' Extract the balance of the gift card 
TAG POS=1 TYPE=SPAN ATTR=ID:ctl00_ctl00_FullContent_MainContent_lblBalance EXTRACT=TXT
WAIT SECONDS=20
TAB OPEN
TAB T={{!LOOP}}
SET !VAR2 {{!LOOP}}
ADD !VAR2 -{{!VAR1}}
ADD !VAR2 2
TAB T={{!VAR2}}

FCIM:
VERSION BUILD=5010424 RECORDER=CR
Mac OS X 10.12.3 (16D32)
Chrome Version 56.0.2924.87 (64-bit) - also use Chrome Canary and Firefox
Included demos work",4
Extracting data and paginating on webpage,"Hello respected coders and moderators,

iMacros - latest version (i am not sure where to find that) , Firefox 51.0.1 (32-bit), Windows 7 SP1

I have a list of rows which I use as a datasource for a search form on a website. This website then gives results which could be anywhere from 0 to any number. All these results are then shown with pagination. My requirement is to find the results and paginate among the pages, extract and save as CSV file. I wrote a script which does most of it. However there are 2 problems:

1) I am never sure how many records will show up
2) I am not sure how to handle no records found scenario
3) I am not sure how to paginate if the pagination control exists and if it doesnt exist then obviously need to handle that scenario.

Code: Select allVERSION BUILD=6861208     
TAB T=1     
'TAB CLOSEALLOTHERS     

'SET !EXTRACT_TEST_POPUP YES
'SET !ERRORIGNORE YES

'Declaring all the variables which the macro will need

SET !DATASOURCE C:\pc\list.csv
SET !DATASOURCE_COLUMNS 1
SET !DATASOURCE_COLUMNS 2

SET !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}

URL GOTO=http://www.mywebsite.com/amember4/mymember/myday/mysearch.html

'Set the values in the search fields from my source csv file
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:formtwnonly ATTR=ID:q3237 CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:formtwnonly ATTR=ID:q3238 CONTENT={{!COL2}}
'Invoke search
TAG POS=1 TYPE=INPUT:IMAGE FORM=NAME:formtwnonly ATTR=ID:ajax_bt7

FRAME F=1

'Extract text
TAG POS=1 TYPE=TABLE ATTR=TXT:* EXTRACT=TXT
'TAG POS=2 TYPE=TABLE ATTR=TXT:* EXTRACT=TXT
'TAG POS=3 TYPE=TABLE ATTR=TXT:* EXTRACT=TXT

'Remove quotes from extracted text
SET !VAR2 EVAL(""var extr2=\""{{!EXTRACT}}\""; extr2.replace(/'/g,'');"")

'FRAME NAME=""iframe_a""
'Paginate
'However it may not be always shown
'TAG POS=1 TYPE=FONT ATTR=TXT:Next<SP>50<SP>>>

'Save extracted data
SAVEAS TYPE=EXTRACT FOLDER=C:\pc FILE=TestData.csv

I would appreciate help if any!",5
Trim leading and trailing spaces,"good morning friends,
I have the following code


The extraction of this page https://notariad1970.000webhostapp.com/ ... cipal.html
Code: Select allVERSION BUILD=844 RECORDER=CR
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:form1 ATTR=ID:* EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:lblFechaSistema EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=TXT:Fecha<SP>de<SP>Registro
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\oz\Downloads FILE=1 

The result of the extraction is as follows
Code: Select all54001333300120140059801,""miÃ©rcoles, 08 de febrero de 2017 - 09:14:55 p.m."",""
15 Sep 2015 
"",""
ENVIO EXPEDIENTE DESPACHO DE ORIGEN 
"",""
MEDIANTE OFICIO M-9186 SE DEVUELVE EL EXPEDIENTE AL JUZGADO DE ORIGEN. 
"",""

"",""

"",""
15 Sep 2015 
""


But I want to eliminate spaces and jumps, so that it stays this way
Code: Select all54001333300120140059801,""miÃ©rcoles, 08 de febrero de 2017 - 09:14:55 p.m."",""15 Sep 2015"",""ENVIO EXPEDIENTE DESPACHO DE ORIGEN"",""MEDIANTE OFICIO M-9186 SE DEVUELVE EL EXPEDIENTE AL JUZGADO DE ORIGEN."","""","""",""15 Sep 2015""

I try this code eva, but it did not work

Code: Select allSET !EXTRACT ""    This value has leading and trailing spaces     ""
' Display the value within vertical bars to emphasize the spaces
PROMPT |{{!EXTRACT}}|
SET trimmedValue EVAL(""\""{{!EXTRACT}}\"".replace(/^\\s*|\\s*$/g, \""\"");"")
PROMPT ""|{{trimmedValue}}| - not anymore!""",7
Extract from tag to lines on excel loop,"my imacros is ok i use last firefox version
windows 7 64 bits 
i need one ""simple"" i think ..
extract one data from txt tag but im very noob on imacros 

VERSION BUILD=9030808 RECORDER=FX
SET !DATASOURCE list.csv
SET !DATASOURCE_COLUMNS 1000
SET !DATASOURCE_LINE {{!VAR1}}
TAG POS=3 TYPE=DIV ATTR=TXT:Account<SP>Funding
TAG POS=1 TYPE=A ATTR=TXT:Create<SP>new
TAG POS=1 TYPE=SPAN ATTR=TXT:* EXTRACT=TXT (idk how to extract from tag too < ) 
i need put this extracted tag in one line of list.csv 
im thinking on this 

extract x times > line 1 > column 1 > loop x times
extract x times  > line 2 > column 1 > loop x times
and i FILL my csv file in the end 
if someone have one topic to help... or can write one code... will help me",1
Detect New Tab Open in Mozilla & Close it,"Team,

I browse to a page  which has a bunch of links , Each link does a Postback to a Remote server & get's a URL in response & then that received URl is opened as a Tab in Mozilla Browser . The  time it takes   for the Postback to return varies from widely & hence i need assistance to automate this in Imacros . Basically 

1. Tab1 has all links , which can be clicked by a Tag command 
2. Once the Postback is Received , the URL is opened in Tab 2 

ASK: We need to wait  till the Tab 2 is active ( this can be anywhere between 20 seconds to 2 minutes post link click on Tab1 )
wait 2 seconds & close the Tab 2 .

Please help on any pointers on how to achieve this via Imacros . I am not a programming guy , so please be a little detailed in response 

Any assistance is appreciated",4
"this.dataSource[(line - 1)] is undefined, line: 11 (Error co","Error: this.dataSource[(line - 1)] is undefined, line: 11 (Error code: -1001)
Firefox Plugin
Code: Select allSET !DATASOURCE X:\Test2.csv
SET !LOOP 1
SET !DATASOURCE_COLUMNS 1
SET !DATASOURCE_LINE {{!LOOP}}
SET !VAR1 {{!COL1}}
ADD !EXTRACT {{!LOOP}}
'--------- test2
SET !DATASOURCE X:\Test1.csv
SET !DATASOURCE_COLUMNS 2
SET !LOOP 1
SET !VAR3 {{!COL2}}
SET !VAR2 {{!COL1}}
URL GOTO=http://XXXXXXXXXXXX.com/xxxxx/{{!VAR3}}?xxxxxxx{{!VAR2}}{{!VAR1}}xxxxxxxxxx
ADD !EXTRACT {{!VAR2}}{{!VAR1}}
WAIT SECONDS=0.25
TAG POS=1 TYPE=P ATTR=CLASS:rateType EXTRACT=TXT
TAG POS=1 TYPE=P ATTR=CLASS:rateAmount EXTRACT=TXT
TAG POS=1 TYPE=DIV ATTR=ID:requestedRateText EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=X:\ FILE=Output_{{!VAR2}}.csv

So the run first work but on the second the error shows.
Test1.csv contain only 1 line with ""test123,test456""",1
"Need your Help, Extract http://www.201.tradebig.com/","Hello,

Could you please send me the code for below.

I have many URLs in Excel sheet Ex: http://www.201.tradebig.com/
 and I need to get the data under red words and put it in columns in excel sheet.
Ex:

First Column:  Company Description 
Wennex is exporter of general merchandise. We supply thousands items of different categories such as toys, seasonal decoration, low cost production articles, candle, giftware, houseware and electronic etc. Your enquiries are cordially welcomed 

Second Column:  Product Description 
All kinds of toys and sundries item 

And so on",4
Extract Data Using csv. & String Fn. Open Multi Tab,"Version 9.0.3
Windows 10 
Firefox 50.1.0

Sir,
       I extract data from csv. file. contain few digits. 

csv.file :
/87-
/90-
/482-
/77-
/85-
/279-
/489-
/285-

Using It extracted from drop down list  and compare the  both csv.file & extracted. 
In drop down list different from extracted text (i.e. index value extracted )





So i could not use #EANF# method. 

Some time extracted text vary. (i.e. index value length)



EXTRACTED DATA.jpg (12.5 KiB) Viewed 3729 times


so depends upon csv file length. compare extracted text. In mean time I am using String function. I get  following error. 

""VAR4 is not defined, line: 26 (Error code: -1001)""

Kindly do the needful. 
Here is the code :

VERSION BUILD=9030808 RECORDER=FX
TAB T=1
SET !DATASOURCE ""C:\\Users\\OFFICE\\Documents\\iMacros\\Datasources\\JobCard-No.csv""
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}

'Select Beneficiary Job Card No.
TAG POS=1 TYPE=SELECT FORM=ID:aspnetForm ATTR=ID:ctl00_ContentPlaceHolder1_DDL_Registration CONTENT=%*{{!COL1}}*
WAIT SECONDS=1

SET !EXTRACT NULL
'Extract your Element:
TAG POS=1 TYPE=SELECT ATTR=NAME:ctl00$ContentPlaceHolder1$DDL_Registration EXTRACT=TXT
SET !VAR1 EVAL(""var s=\""{{!COL1}}\""; s.length"")
PROMPT {{!EXTRACT}}
SET !VAR3 18
SET !VAR4 !VAR3 s.toString()
SET !VAR5 !VAR1.toString()
SET !Sub_Str1 EVAL(""var s=\""{{!EXTRACT}}\""; s.substr(VAR4,VAR5)"")
PROMPT {{!Sub_Str1}}
 'Spit out a ""1"" or ""2"" to reuse for ""TAB T=n"":
SET TAB_Nb EVAL(""var s='{{Sub_Str1}}'; var z; if(s=='{{!COL1}}'){z=1;} else{z=2;}; z;"")
'Stay on TAB_1 if Element found or switch to TAB_2 if not found:
TAB OPEN
TAB T={{TAB_Nb}}",4
TABLE: Extract Data Row by Row...,"iMacros: 10.4.28.1074
Firefox: 50.1.0
OS: Windows 8.1 Pro


I come up with a solution like this to extract the first 5 row of a table from this website: ""https://datatables.net/examples/data_so ... array.html""

My question: Is there a way to shorten the query like to extract the full row instead of every cell in a row?
Code: Select allVERSION BUILD=10.4.28.1074
TAB T=1
TAB CLOSEALLOTHERS
SET !EXTRACT_TEST_POPUP NO
URL GOTO=https://datatables.net/examples/data_sources/js_array.html
TAG POS=1 TYPE=TD ATTR=TXT:Airi<SP>Satou
TAG POS=1 TYPE=TD ATTR=CLASS:sorting_1 EXTRACT=TXT
TAG POS=2 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=3 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=4 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=5 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=6 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=2 TYPE=TD ATTR=CLASS:sorting_1 EXTRACT=TXT
TAG POS=8 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=9 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=10 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=11 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=12 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=3 TYPE=TD ATTR=CLASS:sorting_1 EXTRACT=TXT
TAG POS=14 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=15 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=16 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=17 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=18 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=4 TYPE=TD ATTR=CLASS:sorting_1 EXTRACT=TXT
TAG POS=20 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=21 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=22 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=23 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=24 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=5 TYPE=TD ATTR=CLASS:sorting_1 EXTRACT=TXT
TAG POS=26 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=27 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=28 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=29 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=30 TYPE=TD ATTR=* EXTRACT=TXT",6
Table data extraction-format not retained,"Hi,

Browser : Internet explorer 11.0
Os : windows 7 enterprise 
I MAcro :11.1.495.5175


Trying to extract a table in csv.

 I have successully extracted the table but not able to retain the format.
 Can't use firefox as the official site is accessible through internet explorer only.

 any help on this highly appreciated .

thank you

Macro code used :

VERSION BUILD=11.1.495.5175
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=http://20.17.236.130:7220/nbALoginModule/jsp/Links.jsp
'change login id as per the requirement
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:uid CONTENT=nblife41
SET !ENCRYPTION NO
TAG POS=1 TYPE=INPUT:PASSWORD ATTR=NAME:password CONTENT=Life1234 
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:submitLogin
ONDIALOG POS=1 BUTTON=NO
'change the environment name as per the requirment
'TAG POS=1 TYPE=A ATTR=TXT:LnbA<SP>Dev<SP>-<SP>2
'TAG POS=1 TYPE=A ATTR=TXT:LnbA<SP>IST<SP>-<SP>2
TAG POS=1 TYPE=A ATTR=TXT:LnbA<SP>Admin-Cloud<SP>UAT
'New tab opened
'TAG POS=1 TYPE=A ATTR=TXT:LnbA<SP>QA7
TAB T=2
'New tab opened
TAB T=3
TAB T=2
TAB CLOSE
TAB T=2
FRAME NAME=mainContentFrame
TAG POS=1 TYPE=TD ATTR=ID:dm0m0i0tdText
TAG POS=1 TYPE=TD ATTR=ID:dm0m1i0tdText
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:menu:coordmenuForm:menuFormButton
TAG POS=1 TYPE=TD ATTR=ID:dm0m1i0tdText
wait seconds=5

FRAME NAME=file
SET !EXTRACT_TEST_POPUP NO

TAG POS=1 TYPE=DIV ATTR=ID:pollersTableData EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=C:\Users\pjain74\Desktop\macro FILE=pollers1_data.csv



format of data extracted : file attached

The cloumns should appear like this  :

XML103 Document Input     (N2DOCIN)       Waiting   2       50",7
"extracted data in same excel,but new page, with each loop","Browser : Internet explorer 11.0
Os : windows 7 enterprise 
I MAcro :11.1.495.5175

---------------

hi,

I am trying to loop my macro code to extract the data from different tabs of a weboage to a csv file.

Is there any way by which i can extract the data of every tab (in every loop) in a new page of the same csv/excel file.

the basic idea is to avoid  complications of creating so many files. and saving the data in same file but different tabs.

Perhaps we can't extract data in excel with imacro.

but still looking forward to see a solution to it.

Please help...

Thank you.",2
Determining frame ID's/fields for ReCaptcha,"FF43, Imacros 8.9.6 , Windows 7 Ultimate 32 bit 


Hi , 

I am going absolutely crazy with this as I am like 95% done but cant nail it ! I just cant work out the frame Id's/fields needed to define the input given from 2Captcha which is just box 1, and box 4 , for example. I'm sure you know what I mean  


Code: Select allVERSION BUILD=8961227 RECORDER=FX
TAB T=1
SET !REPLAYSPEED FAST
SET !EXTRACT_TEST_POPUP NO
SET !ERRORIGNORE YES
SET !DATASOURCE ""C:\Users\dan\Documents\Imacros\Datasources\kikname.txt""
SET !VAR1 EVAL(""var randomNumber=Math.floor(Math.random()*100000 + 1); randomNumber;"")
URL GOTO=https://kikfinder.com/submit
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:NoFormName ATTR=ID:username CONTENT={{!COL1}}
TAG POS=1 TYPE=SELECT FORM=NAME:NoFormName ATTR=ID:gender CONTENT=%female
TAG POS=1 TYPE=TEXTAREA FORM=NAME:NoFormName ATTR=ID:description CONTENT=hi
FRAME F=1
TAG POS=1 TYPE=DIV ATTR=ROLE:presentation&&CLASS:recaptcha-checkbox-checkmark&&TXT:
WAIT SECONDS=10
ONDOWNLOAD FOLDER=C:\Users\dan\Documents\iMacros\Kikfinder\ FILE=payload.jpg WAIT=YES
FRAME F=2
TAG POS=1 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:SAVEPICTUREAS
WAIT SECONDS=5
TAB OPEN
TAB T=2
URL GOTO=https://2captcha.com/imacros.html
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:http://rucaptcha.com/in.php ATTR=NAME:key CONTENT=0e5c7dd0074b93e4b458f3b2ee2931d4
TAG POS=1 TYPE=INPUT:FILE FORM=ACTION:http://rucaptcha.com/in.php ATTR=NAME:file CONTENT=C:\Users\dan\Documents\iMacros\Kikfinder\payload.jpg
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=TYPE:submit&&VALUE:recognize
ONDIALOG POS=1 BUTTON=OK CONTENT=
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:http://rucaptcha.com/in.php ATTR=*
WAIT SECONDS=1
SET !EXTRACT NULL
TAG POS=1 TYPE=* ATTR=* EXTRACT=TXT
WAIT SECONDS=1
TAB CLOSE
TAB T=1
FRAME F=2
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:rc-imageselect-response-field CONTENT={{!EXTRACT}}
wait seconds=2
wait seconds=900



Like I say, I think the extraction is fine and everything else , but I cant for the life of me work out the frame to define or the response field..The rc-imageselect-response is the last attempt I made before smashing my face into the wall....

Would really appreciate your help as you have helped me before and worked wonders ",5
How do i extract this data,"<div style=""padding: 5px; margin: auto; text-align: center; color: #fefefe;"">
<div style=""margin: auto; width: 93%; padding-top: 16px; padding-bottom: 6px; text-align: left;"">
<span class=""onlineSep""> - </span><a href=""viewprofile.php?username=Max""><b style=""color: lime;"">Max</b></a><span class=""onlineSep""> - </span><a href=""viewprofile.php?username=Wolfsz""><b style=""color: lime;"">Wolfsz</b></a><span class=""onlineSep""> - </span><a href=""viewprofile.php?username=AsusMB""><b style=""color: #FFC753;""><u>AsusMB</u></b></a><span class=""onlineSep""> - </span><a href=""viewprofile.php?username=Slaviour""><b style=""color: #FFC753;""><u>Slaviour</u></b></a>

For example i will run the macro loop (4 times)
It should extract Max, Wolfsz, AsusMB, Slaviour
First loop would extract Max, Second would be Wolfsz etc 

However these usernames will change and i wouldn't know would this be possible(This is an example)",1
extract some info from facebook page,"Hi, a pictures says  more then a thousand words.  Right click and save if you can't see the whole image.


Build 9030808
Mac OSX Sierra
Firefox 50.1

Never programmed in imacros before but now I'm in the situation that I need to solve this task.  Hope someone can help me out. It's probably not that complicated but to me it would take a lifetime to figure this out, have been trying the whole day on my own.",4
Need to hit particular keyword using datasouce in imacros,"IE :8.1
windows 7 enterprise
 Imacro: 11.1.495.5175

*******************************



 snapshot of webpage 
Hi,

Attached is the snapshot of site am working on.

what i want to do is run imacro picking up the keywords from datasource and hit the keyword  and extract data.

Like:

LnbA Admin-Cloud QA2
LnbA Admin - Dev1
LnbA Admin - Dev3

are the tags i want my imacro to click one by one (in each loop and extract data)

below is the code am using to hit a keyword once.

VERSION BUILD=11.1.495.5175
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=http://20.17.236.130:7220/nbALoginModule/jsp/Links.jsp
'change login id as per the requirement
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:uid CONTENT=useridXX
SET !ENCRYPTION NO
TAG POS=1 TYPE=INPUT:PASSWORD ATTR=NAME:password CONTENT=passXX
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:submitLogin
ONDIALOG POS=1 BUTTON=NO
'change the environment name as per the requirment
'TAG POS=1 TYPE=A ATTR=TXT:LnbA<SP>Dev<SP>-<SP>2


how am trying to loop it though (which is not working):


VERSION BUILD=11.1.495.5175
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=http://20.17.236.130:7220/nbALoginModule/jsp/Links.jsp
'change login id as per the requirement
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:uid CONTENT=userXX
SET !ENCRYPTION NO
TAG POS=1 TYPE=INPUT:PASSWORD ATTR=NAME:password CONTENT=passXX
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:submitLogin
ONDIALOG POS=1 BUTTON=NO
SET !DATASOURCE C:\Users\pjain74\Desktop\macro\pollers_input.csv
SET !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
TAG POS=1 TYPE=A ATTR=TXT:{{!COL1}}

********************
sharing the  piece of xml
**************


<tr>			
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbaldev.axa-equitable.com:10225 ... o&app=LIFE"" target=""_blank"")"">
			LnbA DInfomrmals</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbaldev.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA Dev</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=http://nbaldev2.axa-equitable.com:9080/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA Dev-2</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbaldev.axa-equitable.com:10234 ... o&app=LIFE"" target=""_blank"")"">
			LnbA Dev3</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbaldev.axa-equitable.com:10242 ... o&app=LIFE"" target=""_blank"")"">
			LnbA Dev4</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa1.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA QA1</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa2.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			Legacy Migrated </a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa3.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA QA3</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalperf.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA QA4</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa5.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA QA5</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa6.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">
			LnbA QA6</a></td>

			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalist.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">LnbA IST</a></td>

			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalqa8.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">LnbA QA8</a></td>
			<td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbalifeperfabs.axa-equitable.co ... o&app=LIFE"" target=""_blank"")"">LnbA ABS_PERFF</a></td>
			 <!-- <td><a href=""/nbALoginModule/jsp/nbAPost.jsp?urld=https://nbaluat2.axa-equitable.com/nba/sso&app=LIFE"" target=""_blank"")"">LnbA UAT</a></td>  -->


			</tr>


I guess the last line is creating the problem.

any help is highly appreciable

Thank you.",7
E-mail triggers Website - Assistance Appreciated,"Ok, so what i'm attempting to accomplish is to scan my gmail for a specific subject line and if available then go to a URL and login automatically. I also want it to check if the website is already logged in and if not than login (website times out after like 10-20 minutes or so). What I have written so far is the macro opens up my gmail, clicks on an e-mail with a subject verbiage that I have provided then I open a 2nd Tab, navigate to the URL and Login. All this works however the below is what im missing that i'm unable to figure out:

1 - Scan gmail until the e-mail with that specific subject line is available (I dont actually need to click on the e-mail, i just need to know its available as this will be my trigger to navigate to a website).
2 - If e-mail available, navigate to the website but if the site directs me back to the login page than login (I have the login macro all setup just need to know how to identify if website is logged in or not).
3 - I dont want the macro to keep looping through if an e-mail is found and the website is open. only loop (scan) if e-mail not available and website (tab-2) closed.

Below is what I have so far. If anyone could provide assistance that would be appreciated. BTW, my gmail is set to Basic HTML as I read that would be better for iMacro. I'm open to opinions on this as well.
Code: Select allVERSION BUILD=10022823
'Check e-mail/open e-mail
TAB T=1
URL GOTO=https://mail.google.com/mail/u/0/h/1rmx10yed8z4p/?&
TAG POS=1 TYPE=SPAN FORM=NAME:f ATTR=TXT:*<SP>email<SP>subject<SP>verbiage.<SP>*

'Open a new tab and navigate to website of my choice
TAB OPEN
TAB T=2
URL GOTO=https://www.WebsiteExample/AgentDashboard.html/dashboard

'Enter login information and enter site
SIZE X=1172 Y=583
WAIT SECONDS=2.72
DS CMD=CLICK X=524 Y=173 CONTENT=
DS CMD=KEY CONTENT=MyUserName
DS CMD=CLICK X=505 Y=230 CONTENT=
DS CMD=KEY CONTENT=MyPassword
DS CMD=CLICK X=596 Y=281 CONTENT=
WAIT SECONDS=5

System Info:
iMacro v.10.02.2823
iMacro Browser - Stealth Mode (identify as native Internet Explorer)
Windows 10 Pro",7
Not able to extract simple data ?,"Hello, 

im new to iMacro but i really tried my best, but i do not get (any) the result i need 

I just want to extract the balance i have from a website (shown in the top left corner)
Code: Select allURL GOTO=https://www.crypto-games.net/dice/bitcoin
TAG POS=1 TYPE=SELECT ATTR=ID:lblBalance EXTRACT = TXT
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\"";"")

Result is always undefined ...  i appreciate every kind of help",2
Selecte text from paragraph,"Hi, 
I'm using the Firefox Extension(9.0.3) an Firefox 50.1.0

I have folowing HTML:
Code: Select all<p>
first line<br /> second line<br /> E-Mail: <a href=""mailto:test@web.com"">test@web.com</a><br>  <a href=""http://www.web.com"" target=""_blank"">http://www.web.com</a><br> <br />
</p>

I have following imacro:
Code: Select allTAG POS=1 TYPE=P ATTR=TXT:* EXTRACT=TXT

When I extract this - on position of the links the text reepats from top:
Code: Select allfirst line
second line
E-Mail:first line
second line
E-Mail:test@web.com
first line
second line
E-Mail:first line
second line
E-Mail:test@web.com
http://www.web.com


How can I avoid this? What am I doing wrong?

Thanks for your help",2
Need help with extraction from Airlines,"Can someone help me with the Data extraction?
Like: https://bestprice.lufthansa.com/?resolu ... nation=BER#
For example: 	
VIE
Vienna
BER
Berlin
Departing: Apr 22, 2017 - Returning: Apr 23, 2017
1 adult
Economy
from83 €

Any idea? Thanks

EDIT: I will compare the price from different Airlines on there own Homepage.

On the LH Desktop Page some times 5, 6 ,7 Flights go. How to make the different times?
Thanks",2
Scrape elements which are generated by php code,"Hi,
I want to scrape content from webpage which is not visible in Source code. It's probably generated by php script, so I cant find it looking at source code. Of course I can click ""inspect element"" and see the html code of elements I want to extract. What I also can do is clicking at them. 

Event clicks are very similar:
Code: Select allEVENT TYPE=CLICK SELECTOR=""HTML>BODY>DIV>DIV:nth-of-type(2)>DIV>DIV>DIV>DIV>DIV:nth-of-type(5)>DIV:nth-of-type(2)>DIV>DIV>DIV:nth-of-type(3)>DIV:nth-of-type(1)>DIV>TABLE>TBODY>TR>TD:nth-of-type(2)>DIV:nth-of-type(3)>DIV:nth-of-type(2)"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>DIV>DIV:nth-of-type(2)>DIV>DIV>DIV>DIV>DIV:nth-of-type(5)>DIV:nth-of-type(2)>DIV>DIV>DIV:nth-of-type(3)>DIV:nth-of-type(2)>DIV>TABLE>TBODY>TR>TD:nth-of-type(2)>DIV:nth-of-type(3)>DIV:nth-of-type(2)"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>DIV>DIV:nth-of-type(2)>DIV>DIV>DIV>DIV>DIV:nth-of-type(5)>DIV:nth-of-type(2)>DIV>DIV>DIV:nth-of-type(3)>DIV:nth-of-type(3)>DIV>TABLE>TBODY>TR>TD:nth-of-type(2)>DIV:nth-of-type(3)>DIV:nth-of-type(2)"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>DIV>DIV:nth-of-type(2)>DIV>DIV>DIV>DIV>DIV:nth-of-type(5)>DIV:nth-of-type(2)>DIV>DIV>DIV:nth-of-type(3)>DIV:nth-of-type(4)>DIV>TABLE>TBODY>TR>TD:nth-of-type(2)>DIV:nth-of-type(3)>DIV:nth-of-type(2)"" BUTTON=0

As you can see only 1 number is changing. My first question: Is it possible to extract href from these selectors? 

When I click ""inspect element"" and go to the element I want to extract this is what I see:
Code: Select all<div class=""gs-per-result-labels"" url=""http://this-is-what-i-want-to-extract.html""></div>

I tried by scraping by XPATH but it seem not to work (I think because imacros cant find these elements in source code). Do you have any tips for me?


MY OS:
OS: Windows 7 N service pack 1 64 bit
Intel Core i7-4700MQ
16gb ram
gt 755m

Firefox 50.1.0
iMacros for Firefox 9.0.3
VERSION BUILD=9030808 RECORDER=FX",2
Navigating a Report Page,"While I'm still a rookie with iMacros, I've made some solid progress in navigating and extracting needed Web info. Now I'm stuck.
In particular, I am trying to simulate the advancement to the last page of a report. In the default recording mode, an image button is identified for generating the report. When I play the recording, the image button is not found. When I view the raw html, the image button is not present either. I've tried all of the possible iMacro recording options but nothing has worked. Any help is greatly appreciated.

Some details: I/E 11, iMacros 11, Windows 7
I'm using the standalone iMacro product.",5
Extract Downloaded File location is failed,"Hello, i have created code to save pic/image and extract the file download location to csv file.

save image is work , but extract file downloaded location to csv file is failed , result is ""__undefined__"" in csv file.

this is my code
Code: Select allVERSION BUILD=8970419 RECORDER=FX
SET !EXTRACT_TEST_POPUP NO

TAB T=1
URL GOTO=https://www.tokopedia.com/sparepart-tv-69/lampu-led-3-volt-10-kancing-backlight-3-volt-10-kancing-cembung-2
ONDOWNLOAD FOLDER=C:\Users\Yenyen<SP>Nainggolan\Pictures FILE=+_{{!NOW:yyyymmdd_hhnnss}} WAIT=YES
TAG POS=1 TYPE=IMG ATTR=SRC:https://ecs7.tokopedia.net/img/cache/300/product-1/*.jpg CONTENT=EVENT:SAVEPICTUREAS

ADD !EXTRACT {{!DOWNLOADED_FILE_NAME}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=link<SP>gambar.csv


can some one help me ?  ",7
How to compare !VAR1 and !VAR2 number,"Hi iMacros community,

I built some iMacro script to extract 2 numbers from website but I don't know how to compare it. I get numbers but don't know how to find what number is larger than other one.  This is script: 

VERSION BUILD=9030808 RECORDER=FX
TAB T=1

URL GOTO=http://example.com
TAG POS=1 TYPE=TD ATTR=CLASS:text<SP>center&&TXT:* EXTRACT=TXT
SET !VAR1 EVAL 
TAG POS=2 TYPE=TD ATTR=CLASS:text<SP>center&&TXT:* EXTRACT=TXT
SET !VAR2 EVAL 

How can I compare !VAR1 and !VAR2 with iMacro?
I spent 4 days but I am stuck in place
Thank you",19
My macro copies too much,"Hello,

I just created my first macro and it seems doing a little bit too much. I need to automate the following task: copy a cell from a csv file, paste it to google.com/finances search area, get search result, scroll down, copy industry and sector and paste this info to the csv file. My issue is that my macro seems copying everything from the web page and I get industry and sector just on the line 498 of my csv file. 
And I have a couple more questions: how could I avoid it throws me an error if google doesn't find anything, or it runs into an empty cell on my csv file?
I will really appreciate your help.

My macros is bellow:
Code: Select allVERSION BUILD=11.5.498.2403
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
SET !DATASOURCE ""C:\\Users\\Agne\\Desktop\\bandymas\\kitas_failas.csv""
SET !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=google.com/finance
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:q CONTENT={{!COL1}}
TAG POS=1 TYPE=BUTTON:SUBMIT ATTR=ID:gbqfb
TAG POS=10 TYPE=DIV ATTR=CLASS:g-unit<SP>g-first EXTRACT=TXT
SAVEAS TYPE=TXT FOLDER= C:\\Users\\Agne\\Documents\\imacros FILE=naujas.csv",1
Solve Captchas - 1 DAY FREE TRIAL,"=+================+==========================+================+=
The best way to solve captchas online... 
Supports 3,185 captcha types via RESTFul API!

Prices starts at $14.95 ONLY! We don't charge on per 
captcha or pay as you go basis allowing you SAVE MORE on your 
captcha solving expenses.

To order please see http://www.solvecaptchas.com/
=+================+==========================+================+=",1
Extract current selected dropdown into variable,"Hello iMacros pros!

I have a dropdown box with 75 items within it. 

That dropdown box is currently selected on an item. 

Here is the html:
Code: Select all<select id=""toolbar_uid"" name=""toolbar_uid"" onchange=""swapCharacter()"" style=""font-size:8pt;width:120px;"">
                                                            <option value=""267096"" >SomethingHere</option>
                                                                <option value=""267095"" >SomethingThere</option>
                                                                <option value=""267090"" >TheresSomething</option>
                                                                <option value=""74473"" selected>Here'sSomething</option>

How can I extract the CURRENTLY SELECTED option value=""77473"" and store into a variable so that later in the iMacro I can do something like this:
Code: Select allTAG POS=1 TYPE=SELECT FORM=NAME:NoFormName ATTR=NAME:awardto CONTENT=%{{myVariable}}",9
Extract Price and Uploade it into my Page?,"Hi
Some Company offer an Iframe with there Data but the are rubbish.
So my idea is let a script run every ~12h (+ X Min) to extract the Price.

Does anyone do something like that before? The Point is how do deal with the Date? And how to Upload it into an Database?

Thanks!",3
Need Expert Scraping,"I need someone who can provide long term work for me with the equivalent of the following for many countries;

Schedule scripts on server if it is required. Google scraping, Facebook scraping, yellow pages, linkedin, amazon, webshops, specialty sites and other sites with lists of any items. Scrape secured and protected sites, ability for crawlers to enter into login form, emulate ajax requests etc. If site block IP , use proxy or TOR.  Avoid captcha on site in automatic or manual mode. 

Export data into json, csv (excel), mysql, mongodb.",4
Extracting piece of JSON from code,"Hey guys

This really is my last resort, as I tried all different combinations for getting this little script to work.

What I am trying is to extract the part of JSON that is between these brackets [], and including them.
I tried to find out what exactly regex code would look like, and visited regexr.com

code I'm working with:
Code: Select all<script>
	var profitChartData = [{""date"":2011,""profit"":570000,""income"":4578000},{""date"":2012,""profit"":50442000,""income"":127168000},{""date"":2013,""profit"":72790000,""income"":216381000},{""date"":2014,""profit"":18135000,""income"":211685000},{""date"":2015,""profit"":60730000,""income"":457759000}];
</script>
what regexr suggests as solution:
Code: Select allprofitChartData\s\=\s([^]+);

of course it doesn't work...

this is how my non-functional script looks like at the moment:
Code: Select allVERSION BUILD=9030808 RECORDER=FX
TAB T=1

URL GOTO=URL
WAIT SECONDS=5
SEARCH SOURCE=REGEXP:""profitChartData\s\=\s([^]+)"" EXTRACT=""$1""

info:
firefox version: 50.0
imacros for firefox: 9.0.3
windows7 64bit",4
Special characters not extracting properly,"Hello!

I found a post dealing with the same subject, but it doesn't look like a solution was discovered. http://forum.imacros.net/viewtopic.php?f=7&t=18015

I use iMacros for FireFox (Version 8.9.7). I am trying to extract data from a page with special characters in to a CSV. When I extract a word like ""Düsseldorf"" I get ""DÃ¼sseldorf"" in the csv.

Does anyone know a solution to get iMacros to extract the word as it is written on the page?

Also, I'm running Mac OS X Lion 10.7.5 if that matters.

Also, when I remove the ""SET !EXTRACT_TEST_POPUP NO"" so that iMacros shows a prompt with the extracted text the characters display properly in the prompt window, so it's only a problem in the csv file.",6
Extracting info until certain element is no longer on site,"Hi. First of all:
Win 10, 64bits, iMacros v11.1.149/Firefox 47 iMacros for FF v9.0.3
In second place, thanks in advance for helping me.

I'm extracting information form a site... with several pages.
I managed to find a way to extract info from the page but, if I need to get to the next page to keep extracting info, I need the macros to ""click"" the next button.
In the site, there's a '>' symbol that represents the ""next page""...

So, I need to do some imacros steps until I can't find the '>' symbol in the site, on several pages.

This code makes the macros to ""turn the page"": TAG POS=1 TYPE=LI ATTR=TXT:> 

Is there a way I can make like a while? 

while('>' symbol exist){
 several extraction steps and code
 TAG POS=1 TYPE=LI ATTR=TXT:> (the ""next"" click so I can continue the extraction in the next page)
}

Sorry the long post. Thanks in advance.",4
Remove/ignore middle initial when one exists,"WIndows 10, IE11, VERSION BUILD=11.5.498.2403

How would I go about removing a middle initial IF a middle initial exists?  Most of the time its just first and lastname, but on occasion there's a middle initial.  Trying to figure out how to deal with the exceptions.

If there was always a middle initial I know I could do something like this below, but if there isn't one I would get ""undefined John"".  Also will notice below I'm looking to have it in the format Lastname Firstname.   
Code: Select allSET !VAR1 John<SP>S.<SP>Doe
SET !VAR2 EVAL(""var s='{{!VAR1}}'; var x,y; y=s.split(' '); y[2] + ' ' + y[0];"")
PROMPT ""{{!VAR2}}""

Thanks",3
Extracting HREF link atribute on sub class tag,"Win 10, 64bits, iMacros v11.1.149/Firefox extension.

Hi, first of all, thanks to everybody who reply here.
I'm new to iMacros, i've been trying to get it for a while and I have a question.
I'm trying to get the href text of a lot of links in a site... all of them are in class tags like this one...


<h2 class=""clear nombre"">
<a target=""_blank"" onclick=""GATrackEvent(""resultados_HOT"", ""nombre producto"", ""click ficha"", 0, true);"" class=""product-name"" href=""/hoteles/853008-0_lodge-andes"" title=""Lodge Andes undefined""><span class=""openFontSemiBold"">Lodge Andes</span>  </a>
</h2>

I want to save all the href text from these sites and save them in a CVS... I should get the ""/hoteles/853008-0_lodge-andes""
I've tried some time with other examples, and extracting links but this one i've been having troubles...

I thought this might do the trick, but no luck...
Can anybody help me?",8
Extracting when no Name: or ID:,"Is there any way for me to extract the number 16435628 from the code below from a website given there is no Name: or ID:?  Its the on the 5th line down below...  Thanks

Code: Select all<table class=""table table-bordered table-responsive"">
                <thead></thead>
                <tbody data-bind=""foreach: Bills"">
                    <tr data-bind=""css: { altrow: $index()%2 }"">
                        <td style=""background-color: magenta;"" data-bind=""html: DisplayBillNumber""><a href=""BillDetail.html?year=2016&billno=435628&parcel=25000710100000"">16435628</a></td>
                        <td data-bind=""text: DisplayBillType"">Secured Annual</td>
                        <td class=""textright"" data-bind=""html: DisplayLevyAmount""><a href=""DirectLevy.html?year=2016&billno=435628&parcel=25000710100000"">$193.94</a></td>
                        <td class=""textright"" data-bind=""text: DisplayBillAmount"">$1,448.88</td>
                        <td class=""textright"" data-bind=""html: DisplayTaxStatus""><a href=""BillDetail.html?year=2016&billno=435628&parcel=25000710100000"">Click Here</a></td>
                    </tr>
                </tbody>
               ",8
Scrape phone numbers from contact pages using CEO as keyword,"What I'm doing ? I'm scraping CEO phone numbers from company websites.

What I have ?
This is my code, it currently says when CEO word appear on page, extract next 2 elements,
BUT I want like this -> When CEO text appears in page, extract next element which has numbers.
Code: Select allSet !Timeout_Step 0
Set !ErrorIgnore Yes
Set !Extract_Test_PopUP NO
SET !DATASOURCE tj.csv

Tag Pos=1 Type=* ATTR=Txt:*CEO* Extract=Txt 
Tag Pos=R1 Type=* Attr=* Extract=Txt
Tag Pos=R1 Type=* Attr=* Extract=Txt
Set ceo {{!Extract}}
Set !Extract Null

Add !Extract {{ceo}}

SAVEAS TYPE=EXTRACT FOLDER=D:\imacro\ FILE=ceo.csv

Required answers:Code: Select all1. What version of iMacros are you using?
VERSION BUILD=8871104 RECORDER=FX  (Newest PaleMoon version)

2. What operating system are you using? (please also specify language)
Windows 8.1

3. Which browser(s) are you using? (include version numbers)
Palemoon Version: 26.5.0 (x64)

4. Do the included demo macros work ok? 
Yes

5. If reporting a problem with the Scripting Interface, please also test if the included VBS sample scripts run ok.
N/A

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the imacro that creates the problem? If you can not post the imacro or login data in the public user forum, please email N/A

7. Do you encounter the same problem with the iMacros Browser, iMacros for Internet Explorer and iMacros for Firefox? Note: If your question is specifically about iMacros for Firefox or iMacros for Chrome, please use their sub-forums. 
N/A

help appreciated, br. Mark
PS. Is this message in correct format for asking question ?",4
Extracting specific numbers,"If I have a Parcel number of 123-456-78 if I wanted to extract only the first 3 characters I believe I would do this...
Code: Select allTAG POS=23 TYPE=TD ATTR=* EXTRACT=TXT
SET !VAR1 EVAL(""var x=\""{{!EXTRACT}}\""; x=x.match(/^.{3}/).join(''); x;"")
PROMPT {{!VAR1}

But say I wanted to extract the middle 3 characters how would I go about doing this?  I'm looking for it in a way in which it extracts characters 4 through 6 and disregards the dashes, instead of ignoring specific numbers or taking what's between the dashes because the parcel number will always be changing and there may or may not be dashes.
Thank you",6
Having issue with extracting information by following links,"Imacros version: 10
Win 10
The sample scripts work and I am using visual studio to code the scripts.

This is what I am trying to do and it is for personal use so that I can choose the best dentist for my needs. I want to go to google and extract their healthgrade, vitals.com ratings.  For the healthgrade ratings, sometimes the rating is right on the google search results page and I sometimes have to click on the results link to scrape the ratings from the actual healthgrades site. For vitals.com ratings I will always have to click on the link to get the ratings from vitals.com.  The issue I'm having is this: I can can follow the correct links to vitals.com and healthgrades.com and extract the info but for some reason when I issue the BACK command to navigate back to the previous google results page to continue, the extract variable it seems is completely cleared and I only get the last extraction info into the csv file.  Is imacros capable of extracting info by following a multi level link structure?  (e.g. is it possible to retain the extracted data when you navigate into and out of links in the same macro?

Thanks.

Macro to extract the dentist's name and other important data from the search results page of dentaquest.com:
Code: Select allVERSION BUILD=10022823
TAB OPEN 
TAB T=1

TAG POS={{I}} TYPE=TD ATTR=* EXTRACT=TXT
SET name EVAL(""var extract = \""{{!EXTRACT}}\""; if (extract == \""#EANF#\"") MacroError(\""No more listings on this page\""); else extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

SET mypos {{I}}
ADD mypos 2

TAG POS={{mypos}} TYPE=TD ATTR=* EXTRACT=TXT
SET denttype EVAL(""var extract = \""{{!EXTRACT}}\""; if (extract == \""#EANF#\"") MacroError(\""No more listings on this page\""); else extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

ADD mypos 2
TAG POS={{mypos}} TYPE=TD ATTR=* EXTRACT=TXT
SET address EVAL(""var extract = \""{{!EXTRACT}}\""; if (extract == \""#EANF#\"") MacroError(\""No more listings on this page\""); else extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

ADD mypos 1
TAG POS={{mypos}} TYPE=TD ATTR=* EXTRACT=TXT
SET phone EVAL(""var extract = \""{{!EXTRACT}}\""; if (extract == \""#EANF#\"") MacroError(\""No more listings on this page\""); else extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

ADD !EXTRACT {{name}}
ADD !EXTRACT {{denttype}}
ADD !EXTRACT {{address}}
ADD !EXTRACT {{phone}} 

Macro to extract info from google search results and by following relevant search results links:
Code: Select allVERSION BUILD=10022823
TAB T=2
SET !TIMEOUT_PAGE 3

URL GOTO = https://www.google.com/#q={{name}}

WAIT SECONDS=1

'set initial anchor
TAG POS=1 TYPE=A ATTR=HREF:*healthgrades* EXTRACT=TXT
SET !EXTRACT NULL

'set search boundry
TAG POS=R1 TYPE=SPAN ATTR=CLASS:st EXTRACT=TXT
SET !ENDOFPAGE {{!TAGSOURCEINDEX}}
SET !EXTRACT NULL

'reset anchor
TAG POS=1 TYPE=A ATTR=HREF:*healthgrades* EXTRACT=TXT
SET !EXTRACT NULL

'extract ratings for healthgrades
TAG POS=R1 TYPE=DIV ATTR=CLASS:f<SP>slp EXTRACT=TXT
SET ratings EVAL(""var extract = \""{{!EXTRACT}}\""; extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

'follow zocdoc link and extra
TAG POS=1 TYPE=A ATTR=TXT:*Vitals*

'extract number of rating stars
TAG POS=1 TYPE=SPAN ATTR=CLASS:score<SP>overview-number EXTRACT=TXT
SET vitalstars EVAL(""var extract = \""{{!EXTRACT}}\""; extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

'extract number of votes
TAG POS=1 TYPE=A ATTR=HREF:*reviews* EXTRACT=TXT
SET vitalnum EVAL(""var extract = \""{{!EXTRACT}}\""; extract.replace(\""#EANF#\"", \""\"").replace(/^\\s*|,\\s*$/g, \""\"");"")
SET !EXTRACT NULL

WAIT SECONDS=1

BACK

ADD !EXTRACT {{name}}
ADD !EXTRACT {{denttype}}
ADD !EXTRACT {{address}}
ADD !EXTRACT {{phone}}
ADD !EXTRACT {{vitralstars}}
ADD !EXTRACT {{vitralnum}}

SAVEAS TYPE=EXTRACT FOLDER=C:\\Users\Helix\Documents\iMacros\Macros FILE=test.csv

TAB T=1
C# code:
Code: Select allusing System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace dentamacro
{
    class Program
    {
        static void Main(string[] args)
        {
            var i = 5;

            int timeout = 1;
            // Add a reference to iMacros Scripting Interface COM in your project to be able to access control iMacros
            // If you target .NET 4.0, set ""Embed Interop Types"" to false, in the reference to the iMacros Interface COM
            iMacros.Status status;
            iMacros.App app = new iMacros.App();

            app.iimOpen(""-V7"", false, timeout);

            while (i < 87)
            {
                app.iimSet(""I"", i.ToString());
                app.iimPlay(""C:\\Users\\Helix\\Documents\\iMacros\\Macros\\extractname.iim"");
                
                var name =  app.iimGetLastExtract(1);
                var denttype = app.iimGetLastExtract(2);
                var address = app.iimGetLastExtract(3);
                var phone = app.iimGetLastExtract(4);

                if (name == """" || name == ""#EANF#"")
                {
                    break;
                }

                app.iimSet(""name"", name);
                app.iimSet(""denttype"", denttype);
                app.iimSet(""address"", address);
                app.iimSet(""phone"", phone);

                Console.WriteLine(denttype);

                app.iimPlay(""C:\\Users\\Helix\\Documents\\iMacros\\Macros\\searchname.iim"");

                i = i + 9;

            }


        }
    }
}
",1
"Multiple dashes, extracting last 3 numbers.","Windows 10, IE 11, VERSION BUILD=11.5.498.2403

Extracted the text.... 

2637-027-017

I'm trying to isolate the last 3 numbers after the 2nd dash strictly using the dashes because the numbers will always change.  I tried the below but I keep getting 027 instead of 017
Code: Select allSET !VAR1 EVAL(""var s='{{!EXTRACT}}'; var x,y; y=s.split('-'); z=y[1].split('-'); z[1];"")

Even if I just try
Code: Select allSET !VAR2 EVAL(""var s='{{!EXTRACT}}'; var x,y; y=s.split('-'); y[1];"")

It still only picks up 027, would think it would pick up 027-017.  It must not like the duplicate dashes.  Any ideas?",5
Extracting first of two lines,"Windows 10, IE11, VERSION BUILD=11.5.498.2403

When I go to Extract the first person's name below of John Doe it's also grabbing the second line Ann Doe, I'm trying to extract just John Doe.

It's shows like this on the website...
John Doe
Ann Doe

the htm looks like this...
'<td><span id=""ctl00_ContentPlaceHolder1_lblBorrowers"" style=""border: 1px solid green; 
'background-color: magenta;"">John Doe<br>Ann Doe</span></td>

I was attempting something along this line but I don't think I'm even close
Code: Select allTAG POS=1 TYPE=SPAN ATTR=ID:ctl00_ContentPlaceHolder1_lblBorrowers EXTRACT=TXT
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s.split('<br>')[0];"")


I tried '</br>'  tried '<br/>' etc.  But now I'm thinking <br> has nothing to do with it.  

Any idea?  

Thanks",7
Important Progress iMacros Product Update,"Dear iMacros Customers and Users, 

We are writing to inform you that Progress will be officially discontinuing the Progress iMacros product, with a planned End-Of-Life date of November 30, 2023. 

What does this mean? 
Moving forward, Progress will continue to support the iMacros product and will only provide critical fixes as needed until the EOL date. We will honor all service agreements through the existing term, except for those contracts that go beyond the EOL date. Customers with service agreements that go beyond the EOL date will be contacted separately to discuss their options and next steps. We will continue to offer service agreement renewals that do not exceed the EOL date. 

What are your next steps? 
Please remain on the lookout for more communications from Progress in the coming months, as more information will be made readily available to assist you as you prepare your transition plans. 

If you have additional questions, please email iMacrosInquiries@progress.com 

On behalf of Progress, thank you for your continued partnership and commitment. 

Sincerely,  
The Progress iMacros Team",2
*** Please read this before reporting problems ***,"Post last updated: May 25, 2020.

If you open a new topic (or post for the first time in some existing topic) to report an issue or ask any question, we can respond much faster if your problem description includes the following information (if applicable, not all questions fit to all problems):

1. What version of iMacros are you using?
You find the iMacros version and build information at the top of every macro that you record, for example ""VERSION BUILD=10100795"". Also specify whether you are using a freeware, trial, or licensed version, e.g. Personal Edition. Please test with the latest version.

2. What operating system are you using? (please also specify language)
Example: Windows 10, Windows 8.1, Windows 7, Windows Server 2012R2, English, German, Chinese, ...

3. Which browser(s) are you using? (include version numbers)
Example: Chrome 74.0.3729.13, Firefox 64.0.2, IE 11/10/9, ...

4. Do the included demo macros work ok? 
This test helps us to determine if the problem is a general iMacros issue or is somehow related to a specific website or configuration.

5. If reporting a problem with the iMacros scripting interface, please also test if the included VBS sample scripts run ok.
This test helps us to determine if the iMacros scripting interface installation is ok.

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the macro that creates the problem?
If you cannot post the macro in a public user forum or the website requires a login, can you provide a similar example of the problem on a publicly accessible website?

7. Do you encounter the same problem recording or replaying the macro in different browsers, such as the iMacros browser, Firefox, Chrome, or Internet Explorer? 
Note: If the problem is specific to Firefox or Chrome, please post in either the iMacros for Firefox or iMacros for Chrome sub-forum respectively.

8. Please include any additional information that is relevant to reproducing the issue.
This includes a detailed description of the steps you've tried as well as the specific error codes and messages, macro logs, screen shots, etc. Please upload screenshots and other relevant files directly to the forum and not to a third-party hosting service!

This information allows us to quickly re-create the issue on our test systems and solve it ASAP.

Additional tips when posting

* Please ensure that the content of your post is relevant to the topic and/or forum where you post it.
For example, if you are having a problem extracting data from a web page and are using Firefox, create your post in the Data Extraction and Web Screen Scraping forum rather than the iMacros for Firefox forum (see note #7 above). If you are unsure which forum to post to, use the General Support & Discussions forum.

* Use a topic title that succinctly describes the problem or issue.
Avoid phrases such as ""Please Help"", ""Urgent"", ""Script not working"", etc. and refrain from using all capital letters and exclamation points. Also, double-check that the spelling of the title and body of the post are correct, since this makes it more likely to be found in searches by other users. Most modern browsers automatically check spelling as you type and underline mistakes, so please correct them before submitting your post.

* Don't post the same question to more than one forum.
If you've miscategorized your original post, just click the Exclamation Icon on the right of the post's subject/title line to report it and let us know where you would like it moved or merged.

* Always provide your FCI (Full Config Info), c.f. items 1-3 above, in your original post even if you think it may not be relevant.
Some of our mods may not even respond unless this information is included. Please don't put this information in your signature, because this can change over time and makes it more confusing when reviewing older posts. Include the information directly in the body of the post instead.

* When sharing screenshots or other relevant files, please upload them directly to the forum rather than use a third-party hosting/sharing service.
Too often these services stop functioning or the files become unavailable for whatever reason. Uploading them here ensures that the full context of the post remains consistent over time.

* Take a minute to review your forum notification settings

Thank you for helping us to help you better!",1
Simple - Scraping web map,"Hi,
I see lot of tool for web scraping. https://en.wikipedia.org/wiki/Web_scrap ... mple_tools

Any idea of the tool that could scrap/extract web map? I need both - geometry and attributes.

Example of map - https://openmap.mineral.ru. Groups of thematic layers\ Category: Mineral resources management \ Map of subsoil licensing.

It could be easily translated to English with chrome translator.

Please help!",1
Issue with Extraction Wizard,"Normally when I use the Extract Wizard (Text) on links it does not click on the link but extracts the text. Recently I noticed that for youtube videos, when I use the Wizard (Text) on the title links it now clicks on them. You can still set up the extract but it gets more messy as you manually have to go back to the page you want to extract from.

Eg. try to use the Extract Wizard (Text) on the title link of the first video under 

http://www.youtube.com/user/CNN/videos

(I am using the Enterprise version 10.00.2738)",4
Tag Processing Delay,"I am trying to extract some data from a Web site. I am able to successfully navigate thru a number of pages to get to the one that has the data to extract. It works...but it seems to often hang for minutes before completing. Here's the line that causes the delay: 
TAG POS=1 TYPE=A ATTR=ID:ctl00_mainContent_lnkbutDates EXTRACT=TXT

The rest of the site is very responsive. Is there anything that I can do to speed up the process. I have 20-30 extractions per page (about 10 pages) so performance is important.
Some details: I/E 11, iMacros 11, Windows 7

Thanks for any help!",2
Extracting text with no html TYPE,"1. What version of iMacros are you using?
VERSION BUILD=8961227 RECORDER=FX


2. What operating system are you using? (please also specify language)
Windows 7 English

3. Which browser(s) are you using? (include version numbers)
Firefox 49.0.1

4. Do the included demo macros work ok?
Yes

5. If reporting a problem with the Scripting Interface, please also test if the included VBS sample scripts run ok.
N/A

6. Website: Code: Select allhttps://www.thredup.com/product/women-cotton-talbots-blue-long-sleeve-button-down-shirt/17919214
iMacros code I am using now:
Code: Select allTAG POS=1 TYPE=H1 ATTR=CLASS:brand-title EXTRACT=TXT
TAG POS=1 TYPE=H2 ATTR=CLASS:item-title EXTRACT=TXT
TAG POS=1 TYPE=H2 ATTR=CLASS:item-title<SP>item-size EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=CLASS:price EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=CLASS:compare-price EXTRACT=TXT
TAG POS=1 TYPE=DIV ATTR=CLASS:savings-percentage EXTRACT=txt
TAG POS=1 TYPE=DIV ATTR=CLASS:final-sale EXTRACT=TXT
TAG POS=1 TYPE=STRONG ATTR=TXT:Description EXTRACT=TXT
TAG POS=R1 TYPE=LI ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=LI ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=LI ATTR=TXT:* EXTRACT=TXT
TAG POS=R1 TYPE=LI ATTR=TXT:* EXTRACT=TXT
TAG POS=1 TYPE=STRONG ATTR=TXT:Measurements EXTRACT=TXT
>>> TAG POS=R1 TYPE=BR ATTR=TXT:* EXTRACT=HTM 
TAG POS=1 TYPE=STRONG ATTR=TXT:Materials EXTRACT=TXT
>>> TAG POS=R1 TYPE=TXT ATTR=TXT:* EXTRACT=HTM
TAG POS=1 TYPE=STRONG ATTR=TXT:Condition EXTRACT=TXT
>>> TAG POS=R1 TYPE=HTM ATTR=TXT:* EXTRACT=TXT

7. Do you encounter the same problem with the iMacros Browser, iMacros for Internet Explorer and iMacros for Firefox? 
Yes

Problem I am having is grabbing the text for Measurements, Materials and Condition on the website because it is not in span, div, etc. 
Source code is 
Code: Select all<strong>Description</strong><ul><li>Long sleeve</li><li>Blue</li><li>Solid</li></ul></div><div><strong>Measurements</strong><br><!-- react-text: 906 -->44"" Chest, <!-- /react-text --><!-- react-text: 907 -->25"" Length<!-- /react-text --></div><div><strong>Materials</strong><br><!-- react-text: 911 -->100% Cotton<!-- /react-text --></div><div><strong>Condition</strong><br><!-- react-text: 915 -->This item is gently used with minor signs of wear (minor stain).<!-- /react-text --></div>   

the number afterCode: Select all<!-- react-text: changes with every page so I can't use it",8
iMacros for scraping Google?,"Hello everyone! 

I've got a list of 5000 Google keywords. For each of them I want to  go to Google and check TOP 10 pages and save collected links to a report. I would like to save to report also Titles and Desc. 
Is iMacros good tool to do it?  I think so I can load keywords list from CVS file and then learn iMacros to scrape Google. But what with using a lot of proxies during this task? Can iMacros handle it for me? Or can you advice me any other tool to do it?",2
Problem with Dailymotion,"hello, i'm try to build imacros with my channel in dailymotion.
i want to add new thumbnail and new tag. but it doesnt work. 
anyone can help me? this is my code
Code: Select allVERSION BUILD=9030808 RECORDER=FX
SET !ERRORIGNORE YES
SET !DATASOURCE dmtest.csv
SET !DATASOURCE_COLUMNS 9
SET !DATASOURCE_LINE {{!LOOP}}
SET !ERRORIGNORE YES
SET !EXTRACT_TEST_POPUP NO

TAG POS=3 TYPE=DIV ATTR=TXT:Choose<SP>image<SP>to<SP>upload
TAG POS=1 TYPE=INPUT:FILE FORM=ID:upload_preview_form ATTR=ID:upload_preview_form_video_preview CONTENT={{!COL1}}
WAIT SECONDS=5
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:video_edit_0 ATTR=ID:info_0_tags CONTENT={{!COL2}},{{!COL3}}
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:video_edit_0 ATTR=ID:save


NB: Col1 = location image
Thanks",6
RE: Fill form field ONLY if blank,"I'm trying to work with this form, and sometimes the info is pre-filled by the website. Is there a way that if data is in the form field, to not overwrite it? Here is the start of my code below:

VERSION BUILD=8970419 RECORDER=FX
TAB T=1
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:PropertyInfo* ATTR=NAME:estYearPurchased CONTENT=12/2012

So if content was blank, then I can pre-fill with my data. However, if content has data, to NOT pre-fill with my info?

Thanks!",2
Scraping email without opening email client,"Hello!

I am trying to scrape the email of Amazon reviewers who reviewed our products. However, there is just a ""Send an email"" link, and extracting from it only arrives at javascript:void(0). Only after clicking on this link, does it display the actual email of the reviewer. Then it is possible to scrape it.

The issue is that we need to scrape many emails and clicking on ""Send an email"" opens Outlook. I would need to either be able to extract the email without clicking on ""Send an email"", or make it so that iMacros clicks on it but it does not open the email client. I can't do that simply by changing the configuration in my computer, as this scraper would be used by many people. 

Here is an example page: http://www.amazon.com/gp/pdp/profile/A2 ... tbl_3_name

Extracting ""Send an email"" so that it doesn't follow the link does not work either, as I need to actually click on the link instead of just tagging it. Could you guys help?? Thank you very much!",2
Getting data from the screen that is NOT in the source,"Hi

I am trying to get the data from a webpage. But the data doesn't exist in the page source. I am guessing it is generated by javascript/ajax or something. It is an email address. And in page source it looks like this:
Code: Select all<a id=""/gp/profile/A225AROJV5PA03"" class=""a-link-normal pr-email"" href=""javascript:void(0)"">Send an Email</a>

So, the link on the screen says ""Send an Email"". When you click on that link, it changes to an email address. But the email address is nowhere in the html.

Using iMacros, I can easily identify the link as id:/gp/profile/A225AROJV5PA03 and I can extract the text ""Send an Email""

But I want to extract the email address itself.

Does anyone know how to do this?",2
How to click textbox from javascript site,"1. What version of iMacros are you using?
     VERSION BUILD=8970419 RECORDER=FX or Imacros For Firefox 8.9.7
2. What operating system are you using? (please also specify language)
     Windows 10 64 bit (English)
3. Which browser(s) are you using? (include version numbers)
     Firefox 49.0.1
4. Do the included demo macros work ok? 
     Yes
6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the imacro that creates the problem? (Need login)
      Code: Select allhttps://seller.shopee.co.id/portal/product/new 
7. Do you encounter the same problem with the iMacros Browser, iMacros for Internet Explorer and iMacros for Firefox?
    N/A

i'm trying to insert content from csv into a deskripsi textbox (see below)



my problem is i can't insert content to textbox because the code on this site is : 
Code: Select all'//--------------------------------Before Manual Click----------------------------------------------\\
<div class=""edit-input col-8""><div id=""ember1751"" class=""ember-view shopee-textarea shopee-textbox textarea""><div class=""shopee-validation-toast ""><!----></div><div class=""input""> <div id=""ember1752"" class=""ember-view liquid-container"" style=""""><div id=""ember1754"" class=""ember-view liquid-child"" style=""top: 0px; left: 0px;"">        <div class=""placeholder"">Deskripsi Produk dan <s5>#hashtag</s5></div>
</div></div></div><div id=""ember1755"" class=""lf-fade ember-view liquid-container""><!----></div><!----></div></div>

'//--------------------------------After Manual Click the code changed like this----------------------\\
<div class=""edit-input col-8""><div id=""ember1751"" class=""ember-view shopee-textarea shopee-textbox textarea focused""><div class=""shopee-validation-toast ""><!----></div><div class=""input""> <div id=""ember1752"" class=""ember-view liquid-container"" style=""""><div id=""ember1881"" class=""ember-view liquid-child"" style=""top: 0px; left: 0px;"">         <textarea id=""ember1886"" maxlength=""3000"" placeholder=""Deskripsi Produk dan #hashtag"" spellcheck=""false"" class=""ember-view ember-text-area""><!----></textarea>
</div></div></div><div id=""ember1755"" class=""lf-fade ember-view liquid-container""><!----></div><!----></div></div>

this is my code i'm trying many tag xpath but still can't get textarea 
Code: Select allTAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]""
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]/div""
TAG XPATH=""""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]/div/div""
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]/div/div/div""
'This is the textbox xpath it work if i click manual the textbox
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]/div/div/textarea"" CONTENT={{!COL3}}
WAIT SECONDS = 2
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[5]/div/div[1]/div[2]/div/div[3]/input"" CONTENT={{!COL2}}
WAIT SECONDS = 2
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[5]/div/div[2]/div[2]/div/div[2]/input"" CONTENT={{!COL4}}
WAIT SECONDS = 2
'TAG POS=1 TYPE=DIV FORM=ID:ember* ATTR=TXT:Pilih<SP>Kategori&&CLASS:scs-label
TAG POS=1 TYPE=SPAN ATTR=TXT:Pilih<SP>Kategori
TAG POS=2 TYPE=DIV ATTR=TXT:{{!COL6}}
TAG POS=2 TYPE=DIV ATTR=TXT:{{!COL7}}
TAG POS=4 TYPE=DIV ATTR=TXT:{{!COL8}}
WAIT SECONDS = 2
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[2]/div/div[1]""
WAIT SECONDS = 5


if i'm using imageclick through IE Browser it work perfectly but i need to play this through firefox
Code: Select allIMAGECLICK POS=1 IMAGE=C:\Users\biovo\Documents\iMacros\Datasources\shope.png CONFIDENCE=48
TAG XPATH=""/html/body/div[1]/div/div[2]/form/div[1]/div[2]/div[2]/div/div[2]/div/div/textarea"" CONTENT={{!COL3}}
WAIT SECONDS = 2

now my question is how to do a click on that textbox from firefox without manual click or ds click like that .

Thank You, 
Sorry for my bad english ",3
Stripping quotes and ; from html,"Hello all,
took me a couple days to figure this out so thought I would share:

text imacros extractedCode: Select all<span content=""sku:17508782"" itemprop=""productID"" style=""outline: 1px solid blue;""></span>

what I actually wanted
Code: Select all17508782

what I used to get it
Code: Select allSET !EXTRACT NULL  
'Reseting extract to null, then giving the item number in html
TAG POS=R1 TYPE=SPAN ATTR=content:sku* EXTRACT=HTM
SET myVarA EVAL(""var a=\""{{!EXTRACT}}\""; a.replace(/\""/g, \""\"");"") 
'PROMPT  Variable<SP>Var4:<SP><SP>{{myVarA}}
SET myVarB EVAL(""var b=\""{{myVarA}}\""; b.replace(/;/g, \""\"");"")  
SET myVarC EVAL(""var c=\""{{myVarB}}\""; c.replace(\""<span content=sku:\"");"")  
SET myVarD EVAL(""var d=\""{{myVarC}}\""; d.replace(\"" itemprop=productID style=outline: 1px solid blue></span>\"",\""\"");"")  
SET itemNumb EVAL(""var e=\""{{myVarD}}\""; e.replace(\""undefined\"",\""\"");"")     
'PROMPT  Variable<SP>itemNumb:<SP><SP>{{itemNumb}}

hope this is useful to someone else, prompts aren't necessary, I just used them when hacking out a solution",2
How to extract results from haveibeenpwned.com,"I am trying to extract the output of queries submitted to haveibeenpwned.com. (Great website BTW!) 

You enter an email address and it returns a result basically saying ""Good News"" or ""Oh No"". I just want to know if the email address is ""Good News"" answer. If it's an ""Oh No"" answer then I want iMacros to return something else like #EANF (I can sort emails later) 

This ought to be easy, but the issue is that the HTML  has both answers, so whether the page is showing ""Good News"" or ""Oh No"", iMacros can see both answers because both are present in the HTML but only one is displayed. 

How can I distinguish between the displayed answer and the hidden answers and just capture the displayed answer. 

Here's a simple example:
TAB T=1
'URL GOTO=https://haveibeenpwned.com/ - just open this page and leave it open
SET !ERRORIGNORE YES
SET !TIMEOUT_STEP 3
'This is my list of emails to enter on the page one by one in a loop
SET !DATASOURCE emails.csv

'The next bit enters the email address into the form on the page
TAG POS=1 TYPE=INPUT:EMAIL FORM=ACTION:/ ATTR=ID:Account CONTENT={{!col1}}
TAG POS=1 TYPE=BUTTON FORM=ACTION:/ ATTR=ID:searchPwnage
wait seconds=2

'The next bit just extracts the answer ""Good news"" - if this isn't present I would expect #EANF -  but not so because it's there on the page but hidden
TAG POS=1 TYPE=H2 ATTR=TXT:Good* extract=txt

ADD !EXTRACT {{!col1}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=extractPwned.csv
wait seconds=5",6
Extracting data from a Facebook Graph API page,"Hi - I'm new to this, so please be patient.
I have a page returned by the Facebook Graph API which is a page of text, listing FB group information - it looks like this:
{
   ""data"": [
      {
         ""name"": ""GROUP1NAME"",
         ""id"": ""12345678904509092"",
         ""unread"": 25,
         ""bookmark_order"": 999999999
      },
      {
         ""name"": ""GROUP2NAME"",
         ""id"": ""4703459543005192"",
         ""unread"": 2,
         ""bookmark_order"": 999999999
      }, etc etc

I want to scrape a list of the ids, and so far I have this:
SEARCH SOURCE=REGEXP:""id"":\s""([^""]+)"" EXTRACT=""$1""
PROMPT {{!EXTRACT}}
which just returns the first id number.
Any suggestions on how I can loop through the page pulling out every instance of id numbers?",3
Extraction not possible since 9.0.3,"Hi
Imacros 9.0.3, Win7x64, FF 48.0.2 in use.
Example imacros doesn't work: on running any of example iMacro i get errors like Code: Select allPage loading timeout, URL: null, line: 6 (Error code: -802) Internet works, all pages are loaded properly.

Since update to 9.0.3 extracting imacros which always have worked, don't work anymore: they evebn don't write eanf. Imacro i try to run is:
Code: Select allVERSION BUILD=9030808 RECORDER=FX
SET !TIMEOUT_STEP 0
SET !ERRORIGNORE YES
TAB T=1
SET !DATASOURCE videos.csv 
SET !DATASOURCE_COLUMNS 1
SET !LOOP 1
SET !DATASOURCE_LINE {{!LOOP}}
SET !VAR1 EVAL(""var randomNumber=Math.floor(Math.random()*1 + 3); randomNumber;"")
URL GOTO={{!COL1}}
TAG POS=1 TYPE=DIV ATTR=CLASS:_ygd&&TXT:* EXTRACT=HTM      
ADD !EXTRACT {{!URLCURRENT}}
SET !EXTRACT EVAL(""decodeURI('{{!EXTRACT}}');"")
WAIT SECONDS={{!VAR1}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=+{{!NOW:ddmmyyyy}}.csv",1
Question,"Hi all,

I hope i place this topic in the right section.
I have a problem.

I want to extract some txt to a txt file 
But the text i want to extract is 10.000 or 20.000 or 30.000

But i i dont want the . in it. 
So only 10000
Can someone tell me how to remove the . in it?

Iám using imacro version 8970419 for firefox 
and version 11.1.495.5175 as program.

Sorry for the crapy englisch but its not my main language

URL GOTO=*****
TAG POS=2 TYPE=TD ATTR=CLASS:maintxt EXTRACT=TXT
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:NoFormName ATTR=NAME:CONTENT={{!EXTRACT}}
WAIT SECONDS=5
CLICK X=523 Y=324
SAVEAS TYPE=EXTRACT FOLDER=C:\*** FILE=***

this is what i have.
the extact=txt is the 10.000
and in the content it has to place i without the .",3
Website scrapping question is this possible?,What I'm looking to do is take data from Poe.trade a website for a game called path of exile. This site pulls information from the game that people indicated they would like to sell. What I'm looking for is something that will periodically pull data from the website analyse it then send me alerts when certain parameters are met. I was wondering if something like this can even be done.,2
SAVE PDF - Download not finished,"Hey guys,

I am currently using IMacros V11.1.495.5175, Firefox 48, Windows 7 German.

I have a problem with a website where I am trying to download a pdf and the saved file is not completed. 
Instead of a pdf file I get a file which has the extension ""Datei"" and the size it's lower than what it should be (eg. 200kb downloaded out of 344kb).

My code is:

var xpath = ""//ul[@class='techRefContentList']/li["" + i + ""]/div/a""; //I am using xpath to find the <a> tag of the pdf 
var pdf_extract_macro = ""CODE: ONDOWNLOAD FOLDER=* FILE=myfile.pdf WAIT=YES"" + ""\n"";//I set the default download folder because I know there are some issues with it if I try to put a preferential folder (pls tell me otherwise..I really need a preferential folder)
pdf_extract_macro += ""TAG XPATH="" + '""' + xpath + '""' + "" CONTENT=EVENT:SAVEITEM"" + ""\n"";//saving the pdf when the download begins
iimPlay(pdf_extract_macro);

When I look in the download folder, I find a ""Datei"" file that I can't use so I'm guessing the download stops mid way.
This code is being run on two other websites and the pdf is downloaded fine on those.
On this particular site the download link is not in the href but in an onaction property. I don't know if that is the reason why the download is stopping. 

What could I do to make it wait until it's finished ? 

WAIT #ONDOWNLOADCOMPLETE# it's not supported
I was thinking of using !DOWNLOADED_SIZE to check if the download is finished but I don't know how to get the full size of the pdf to compare them.

I'm kind of stuck right now.

My solution was to set the browser to save the pdf in the download folder when the download begins and just TAG the <a>.
This works but I can't set the files name and it's a pain to go trough all the pdfs to find the one I'm looking for.

Any help is greatly appreciated guys.

Thank you !",9
Loop through extraction using field name versus POS?,"Configuration: Surface Pro 2, Win 10, Firefox 47.0.1, iMacros Standard Edition (x86) Version 11.0.246.4051

Hi, 
I am looking for a way to reduce the amount of statements when extracting data. It would be ideal if I could get it down to 2 statements for the lot...since this is a small section of a larger macro I would prefer not to go to .js but handle in .iim files. I only want to extract the data from the fields that match certain field names.  I can't figure out how to loop through POS since the extract selection is based on ATTR=""field name"" not position on web page.

Here is what i have now:
VERSION BUILD=10.3.27.5830
SET !ERRORIGNORE YES
SET !EXTRACT_TEST_POPUP YES
SET !TIMEOUT_STEP 0
'Subject GLA SF
TAG POS=1 TYPE=LABEL ATTR=TXT:Living<SP>Area
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'Subject Year built
TAG POS=1 TYPE=LABEL ATTR=TXT:Year<SP>Built
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'Subject Stories
TAG POS=1 TYPE=LABEL ATTR=TXT:Stories
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'Begin Collect Subdivision data
'year range
TAG POS=1 TYPE=LABEL ATTR=TXT:Year<SP>Built<SP>Range 
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'# with pool
TAG POS=1 TYPE=LABEL ATTR=TXT:With<SP>Pool
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'# single story
TAG POS=1 TYPE=LABEL ATTR=TXT:Single<SP>Story
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'# multi story
TAG POS=1 TYPE=LABEL ATTR=TXT:Multiple<SP>Story
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'Avg GLA SF
TAG POS=1 TYPE=LABEL ATTR=TXT:Sqft
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'Avg Lot SF
TAG POS=1 TYPE=LABEL ATTR=TXT:Lot<SP>Sqft
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT
'End Subdicision
'Deed Hstory-Last Sale date
TAG POS=1 TYPE=TH ATTR=TXT:Sale<SP>Date
TAG POS=R1 TYPE=TD ATTR=CLASS:collapsible-caption EXTRACT=TXT 
 'Deed Hstory- Last Sale price
TAG POS=1 TYPE=TH ATTR=TXT:Sale<SP>Price
TAG POS=R1 TYPE=TD ATTR=CLASS:cell-numeric EXTRACT=TXT
' Most recent Land value
TAG POS=1 TYPE=DIV ATTR=TXT:2017<SP>Prelim
TAG POS=R2 TYPE=SPAN ATTR=CLASS:htable-data EXTRACT=TXT
' Most recent taxes
TAG POS=1 TYPE=DIV ATTR=TXT:2015<SP>Final
TAG POS=R8 TYPE=SPAN ATTR=CLASS:htable-data EXTRACT=TXT
' Subject subdivision
TAG POS=1 TYPE=LABEL ATTR=TXT:Subdivision
TAG POS=R1 TYPE=DIV ATTR=CLASS:* EXTRACT=TXT
' Subject Legal Description
TAG POS=1 TYPE=SPAN ATTR=TXT:Description
TAG POS=R1 TYPE=LABEL ATTR=CLASS:monsoon-fielddata EXTRACT=TXT
' Subject Zoning
TAG POS=1 TYPE=DIV ATTR=TXT:City<SP>Zone
TAG POS=R1 TYPE=LABEL ATTR=CLASS:field-label EXTRACT=TXT
'Does subject have pool
TAG POS=1 TYPE=LABEL ATTR=TXT:Pool
TAG POS=R1 TYPE=DIV ATTR=CLASS:field-value EXTRACT=TXT

 Thanks",4
Dude extracting a url.,"Hi, sorry for my english. I hope you understand me!.  I make a bot extract a url, but i have a problem with the bot, when i go to extract the fragment of url imacros extract all url and i need only the fragment. An example of that:
TAG POS=1 TYPE=CITE ATTR=TXT:www.imdb.com/title/tt0484113/ EXTRACT=TXT

I need only ""tt0484113"", how i can make that? 

Note: that code is random, change for all.

Can someone help me, please? Thanks.

Note 2: I use imacros browser 10 or Firefox the last version.",12
TXT to Time Format then conditional statement,"how do i convert a extracted txt to a time format (nn:ss or 00:00) then compare if the the time is <, >, or = 60:00 which is one minute? if the value is < 60:00 then TAG POS=1... if the value is > 60:00 then TAG POS=2... and so on.",3
FILEDELETE overwrite stopped (?) working,"Configuration: Surface Pro 2, Win 10, Firefox 47.0.1, iMacros Standard Edition (x86) Version 11.0.246.4051
Hi, 
I have a macro that has been running for months extracting data to csv files for use in other form fill macros. Here is the code I have been using to extract then overwrite prior data and save new. 

TAG POS=1 TYPE=TD ATTR=ID:lowLP EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=ID:hiLP EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=ID:ctLP EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=ID:lowSP EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=ID:hiSP EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:ctSP EXTRACT=TXT
TAG POS=1 TYPE=TD ATTR=ID:avgDom EXTRACT=TXT
'Average LP
TAG POS=1 TYPE=TD ATTR=ID:avgLP EXTRACT=TXT
'Average SP
TAG POS=1 TYPE=TD ATTR=ID:avgSP EXTRACT=TXT
'Overwrite old data
FILEDELETE NAME=C:\Users\Public\Documents\iMacros\datasources\BBformdata\Chasedata.csv
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\Public\Documents\iMacros\datasources\BBformdata FILE=Chasedata.csv
Now what happens is new data is appended to prior. See attached output file. 
Thanks",11
how to extract value from the dropdown list? to csv ?,"Code: Select all <select name=""select1"">
 <option value="""">Select Fruits</option>
 <option value=""AP 1"">Apple</option>
 <option value=""BN"">Banana</option>
 <option value=""Special"">Kiwi</option>
 </select>


i only found imacros able to search the value but how to store the value ?
Code: Select allTAG POS=1 TYPE=SELECT FORM=NAME:form1 ATTR=NAME:select1 CONTENT=%BN


code in imacros was 
Code: Select allTAG POS=1 TYPE=SELECT:NAME FORM=ID:demo ATTR=TXT:*&&ID:select1 EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=value.csv
 

if selected Banana, how to i save the value BN and not the Banana ?",11
Save !EXTRACT to specified column,"Hello there,

i have a question regarding extracting information to a csv file. Whenever i try to extract several pieces of information from a website, save them to a csv file, and then arrange them across multiple columns in a single row it doesn't seem to work.  To my knowledge, the following piece of code should lead to the value
Code: Select allADD !EXTRACT {{!VAR1}}
' This is the value i want to save to my csv file
SET !EXTRACT {{!COL3}}
' This *should* specify that i want to save it in the third column
...
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\Piet\Desktop FILE=Template.csv

However, this doesn't put it in the third column, but in the third row. Is it possible somehow to somehow swap this? I don't want to keep transposing my tables in my .csv file afterwards ",4
Scrape images and save them into specific location facebook,"Hi, I'm new to IMacros and i have studied only the surface of the program watching youtube videos ^^

What i am trying to do is simple?
Save facebook pictures and user timeline

I know how to make it automatically go to the pictures pages of a certain user but my problem is that i don't know how to make imacros click on each picture and save them as an image file. And when the images are over, it should stop?
Facebook has this next picture button when i click on the picture and what i am trying to do is to make imacros click on that next image button till the image runs out and save them into a folder i've designated. 

Also, when i try to take a screenshot of the user feed. THere are two problems.
1. I want imacros to scroll to the end of the page in facebook but since facebook doesnt load all the page in once and loads each page only when i reach the end of page, i'm not sure how i can capture them all
2. I want to also include all comments in the imacros page. So i will be taking automatic screenshots after imacros clicks for example, ""show 3 more comments"" i'm not sure how to make imacros click all of the ""show more comments option"" before it saves a screenshots.

LOL sorry if i asked too many questions.
I'll appreciate if anyone can help!
thanks in advance!",2
save an image with specified name,"Hi 
Can any one help me how to save an image from a web page and take a part from its url as a name for the image

for example 
img link : https://services.just.edu.jo/JUSTHandle ... 0wUQ%3d%3d
and i want to save it as itMw%2bPSrRBc8F1D2770wUQ.jpg
and save each name in csv file",1
Extract portion of data,"Configuration: Surface Pro 2, Win 10, Firefox 47.0.1, iMacros Standard Edition (x86) Version 11.0.246.4051

Hi, 
I am trying to extract just the data highlighted in the CMA example. I have tried  both normal POS as well as relative. Both will work but the problem is that it ""extracts"" all three categories and saves as one set of data IE: 121119013434. I have tried many iterations of the extract statement to try and drill down to specific data( 1901) but to no avail. For what it is worth I have attached the web pages HTML. Is there any way to accomplish this?
Thanks",8
Accessing content window - Multiprocess Firefox,"Hey guys,

I am currently using IMacros V11.1.495.5175, Firefox 48, Windows 7 German.
I am writing the code in js and calling iMacros from there.
I just ran into an issue and I don't know if it's going to be a problem in the future.

I have this line: 
final_macro += ""ADD !EXTRACT "" + '""' + lager_col2[0].textContent + '""' + ""\n"";	

When I ran my js in the browser I got this error:
Error: Accessing content window is not supported in multiprocess Firefox, line 208 (Error code: -991)

Should I be worried ? Is the use of textContent forbidden ? 
The problem is that ""lager_col2[0]"" sometimes happen to be a link and I only want the text inside the link, not the tags and everything. So naturally I went with textContent. 
How could I get around this ?´

Additionally, am I setting myself up for trouble when trying to access certain nodes with the use of window.document.getElementsByClassName ? 
I feel like everyone is going to advise me against it but it was easier than using the traditional TAG POS/XPATH/etc

Thank you !",4
detect dynamic content,"hi guys first of all i am terribly sorry i posted the wrong title i am not really sure what to write as i am really new to programming and this is my 1st time to try imacro before buying. I only want to accomplish a simple task that is to detect a certain content from a page. Sorry i dont know what terms to use maybe ill just explain it a bit more.

Pls bear with me here is an image of what the website script does and what i want to accomplish



this is how the code on the website looks like
Code: Select all<form action=""#"" method=""get"" id=""form1"">
 Guess the 1st letter of my name: <input type=""text"" name=""gletter""><br>
</form>

<button type=""submit"" form=""form1"" value=""Submit"">Submit</button>

<div class=""data-outcome item"">
   <!-- ajax result -->
</div>


everytime you press submit a result will show inside <!-- ajax result --> and the code will be
Code: Select all <div class=""inner-item"">
   <div class=""icon-correct"">W<span></span></div>
</div>


if i guess it correctly and
Code: Select all<div class=""inner-item"">
   <div class=""icon-lose"">L<span></span></div>
</div>


if i guess it wrong

so the code looks like this after every guess
Code: Select all<div class=""data-outcome item"">
        <div class=""inner-item"">
            <div class=""icn-win"">W<span></span></div>
        </div>
</div>

i already have an imacro code that letting me guess automatically 
Code: Select allVERSION BUILD=11.1.495.5175
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2

SET !VAR1 EVAL(""var rDW35=Math.floor(Math.random()*3 + 1); rDW35;"")
SET !VAR2 EVAL(""var rDW310=Math.floor(Math.random()*5 + 1); rDW310;"")
SET !VAR3 EVAL(""var rDW57=Math.floor(Math.random()*5 + 3); rDW57;"")
SET !VAR4 EVAL(""var rDW515=Math.floor(Math.random()*6 + 5); rDW515;"")
SET !VAR5 EVAL(""var rDW515=Math.floor(Math.random()*120 + 1); rDW515;"")

WAIT SECONDS={{!VAR5}}

'loop 1
TAG POS=2 TYPE=INPUT:TEXT ATTR=* CONTENT=A
WAIT SECONDS=1
TAG POS=1 TYPE=BUTTON:SUBMIT
WAIT SECONDS={{!VAR1}}

'loop 2
TAG POS=2 TYPE=INPUT:TEXT ATTR=* CONTENT=B
WAIT SECONDS=0.3
TAG POS=1 TYPE=BUTTON:SUBMIT
WAIT SECONDS={{!VAR1}}

'loop 3
TAG POS=2 TYPE=INPUT:TEXT ATTR=* CONTENT=C
WAIT SECONDS=0.3
TAG POS=1 TYPE=BUTTON:SUBMIT
WAIT SECONDS={{!VAR1}}


the code above allows me to guess 3 times actually, it can be 4 or 5 doesnt matter. What i want to do is detect the code if its a win or lose after i click the submit button, if i won and guess it correctly script will stop and go back from start and i lose script will continue until done.

i hope i have explained it well, simple tasks yet very hard for me to even explain it haha so you be the judge

thanks a lot in advance

Best Regards,
Dot",5
Extract text from multiple url's,"Good morning,

I am having a problem extracting text from multiple url's and saving to csv. I am using the code below, the url's are json returns and I am running in firefox.
Code: Select allVERSION BUILD=8031994
TAB T=1
URL GOTO=https://maps.googleapis.com/maps/api/distancematrix/json?origins=Balmain+East,+NSW,+Australia&destinations=Sydney,+NSW,+Australia&key=??
TAG POS=1 TYPE=BODY ATTR=* EXTRACT=TXT
URL GOTO=https://maps.googleapis.com/maps/api/distancematrix/json?origins=Balmoral+Lake+Macquarie,+NSW,+Australia&destinations=Tweed+Heads,+NSW,+Australia&key=??
TAG POS=1 TYPE=BODY ATTR=* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=+_{{!NOW:yyyymmdd_hhnnss}}

Each work perfectly on their own but when put together return only a small portion of the text.

Help would be much appreciated. Thanks!  ",4
Extract Mystery,"Somewhere in one of these 3 scripts 
Billing_First.iim
Code: Select allVERSION BUILD=9052613
SET !REPLAYSPEED FAST
SET MyWait 3
SET PID ""023967496""
SET POS ""99""
SET Proc ""S5102""
SET Mod ""UC""
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Datapanel:_ctl0:_ctl4:ClaimRecipient:ds_ClaimRecipient:mb_ds_ClaimRecipient CONTENT={{ConsumerID}}
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl2:PerformingProvider_ProviderID:mb_PerformingProvider_ProviderID CONTENT={{PID}}
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
IMAGESEARCH POS=1 IMAGE=MCD.png CONFIDENCE=80
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl3:FirstServiceDate:mb_FirstServiceDate CONTENT={{DateOfService}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl4:LastServiceDate:mb_LastServiceDate CONTENT={{LDateOfService}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl5:PlaceOfService:ds_PlaceOfService:mb_ds_PlaceOfService CONTENT={{POS}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl6:Procedure:ds_Procedure:mb_ds_Procedure CONTENT={{Proc}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl7:Modifier1:ds_Modifier1:mb_ds_Modifier1 CONTENT={{Mod}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl10:BilledQuantity:mb_BilledQuantity CONTENT={{Units}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl11:BilledAmount:mb_BilledAmount CONTENT={{Rate}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
TAG POS=3 TYPE=A FORM=NAME:Form ATTR=TXT:add
'TAG POS=3 TYPE=A FORM=NAME:Form ATTR=TXT:add<SP>N


Billing_First2.iim
Code: Select all' Macro without ConsumerID
VERSION BUILD=9052613
SET !REPLAYSPEED FAST
SET MyWait 1
SET PID ""023967496""
SET POS ""99""
SET Proc ""S5102""
SET Mod ""UC""
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl2:PerformingProvider_ProviderID:mb_PerformingProvider_ProviderID CONTENT={{PID}}
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
WAIT SECONDS={{MyWait}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
IMAGESEARCH POS=1 IMAGE=MCD.png CONFIDENCE=80
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl3:FirstServiceDate:mb_FirstServiceDate CONTENT={{DateOfService}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl4:LastServiceDate:mb_LastServiceDate CONTENT={{LDateOfService}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl5:PlaceOfService:ds_PlaceOfService:mb_ds_PlaceOfService CONTENT={{POS}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl6:Procedure:ds_Procedure:mb_ds_Procedure CONTENT={{Proc}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl7:Modifier1:ds_Modifier1:mb_ds_Modifier1 CONTENT={{Mod}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl10:BilledQuantity:mb_BilledQuantity CONTENT={{Units}}
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Detail:Datapanel:_ctl0:_ctl11:BilledAmount:mb_BilledAmount CONTENT={{Rate}}
TAG POS=1 TYPE=ACRONYM FORM=NAME:Form ATTR=TXT:Hard-Copy<SP>Attachments
TAG POS=3 TYPE=A FORM=NAME:Form ATTR=TXT:add
'TAG POS=3 TYPE=A FORM=NAME:Form ATTR=TXT:add<SP>N


PaidAmt.iim
Code: Select allVERSION BUILD=10002738
SET !EXTRACT_TEST_POPUP NO
ADD !EXTRACT {{ConsumerID}}
TAG POS=2 TYPE=A FORM=NAME:Form ATTR=TXT:Paid EXTRACT=TXT
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:Form ATTR=NAME:dnn:ctr366:ClaimPhysicianInformation:_ctl2:Status:Datapanel:_ctl1:_ctl4:PaidAmo* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=status.csv

The extract is sending data to a file named  BillingStaus.csv in folder BillingData
I can't seem to find where to change the path to the folder or change the filename
Or where the extract code is called, I thought I would see a call to PaidAmt.iim

Thank you in advance for any all suggestions
gchichester",2
Loop through results,"Hi everyone.

I need to extract data from a site. There is a simple SELECT option, an INPUT, and a SEARCH BUTTON. So far so good.

Now, the result pages, are not paginated in the traditional way. There is no link to Page 1/2/...., only next page button, which is an input, and it acts like a submit. This input has a NAME attribute, which, on the last page is missing. This is fine with me, because the macro will stop automatically once finished. 

I need to go through all the pages, and extract the data. Now bear with me, I've started to look into iMacros only yesterday, so I'm not really familiar with all the options..
This is the code I've came up so far, and it works for the first page:
Code: Select allVERSION BUILD=8970419 RECORDER=FX
SET !EXTRACT_TEST_POPUP NO
SET !ERRORIGNORE YES

URL GOTO=https://www.eofcom.admin.ch/eofcom/public/searchEofcom_InaFree.do
' select option 2 from the dropdown
TAG POS=1 TYPE=SELECT FORM=ID:chofcomelicensingpresentationnainaformEofcomInaSearchForm ATTR=NAME:nrt CONTENT=%2
' insert value into input box
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:chofcomelicensingpresentationnainaformEofcomInaSearchForm ATTR=NAME:pnp CONTENT=0002
' submit search
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:chofcomelicensingpresentationnainaformEofcomInaSearchForm ATTR=NAME:doSearchFreeByNumber

' *** this is the block I would need to loop through
' get out the text from the result table
TAG POS=1 TYPE=TBODY ATTR=TXT:* EXTRACT=TXT
' remove all the spaces
SET !EXTRACT EVAL(""'{{!EXTRACT}}'.replace(/\s/g, \""\"");"")
' show the result
PROMPT ""{{!EXTRACT}}""
' goto next page
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:chofcomelicensingpresentationnainaformEofcomInaSearchForm ATTR=NAME:getNextInaPage
' *** end block of loop

I've tried to Code: Select allSET !LOOP 25and start the macro in loop mode, but it doesn't work, plus I don't know beforehand how many result pages would be.
From my researches over the net couldn't figure out how to achieve that. Any help would be greatly appreciated.

I am using the free iMacros Firefox extiension (latest, downloaded yesterday), in Debian 8.5, but I also have an XP machine with the trial iMacros Version 11.1.

Note: before someone would complain about legal issues related to scraping data, I have to mention that my company contacted the owners of the site, and asked for an API, which is not available, and they suggested to use the search page instead.

Thanks.",5
How to remove string in a EXTRACT,"This is my code
Code: Select allSET !EXTRACT_TEST_POPUP NO
URL GOTO=https://www.youtube.com/results?search_query=Calvin+Harris+-+This+Is+What+You+Came+For+%28Official+Video%29+ft.+Rihanna
TAG POS=1 TYPE=A ATTR=CLASS:yt-uix-sessionlink<SP>yt-uix-tile-link<SP>yt-ui-ellipsis<SP>yt-ui-ellipsis-2<SP><SP><SP><SP><SP><SP><SP>spf-link<SP> EXTRACT=HREF
SAVEAS TYPE=EXTRACT FOLDER=* FILE=*

I've extracted a csv file content is ""https://www.youtube.com/watch?v=kOkQ4T5WO9E""
but I just want to get content is ""kOkQ4T5WO9E""
what should I do?

I'm sorry, my english is bad.",2
IMacros + XPATH:Count children of tag,"Hey guys, 

I have a quick question related to using XPATH with Imacros. I am trying to count how many <tr> tags are inside a <tbody>
I am currently using IMacros V11.1.495.5175, Firefox 47.0.1, Windows 7 German.

My current code looks like this:

var test_xpath = ""//table[@class='tableProduct']/tbody/select=count(tr)"";
var test_macro = ""CODE: TAG XPATH="" + '""' + test_xpath + '""' + "" EXTRACT=TXT"" + ""\n"";
test_macro += ""SAVEAS TYPE=EXTRACT FOLDER=* FILE=*"" + ""\n"";
iimPlay(test_macro);
alert(iimGetLastExtract());//this should give me the number of <tr> inside the <tbody>...but it's not giving me anything

This information is used in a for loop that will extract more information from each <tr>. I just want to know how many times I need to loop it.
Any help is greatly appreciated. 

Thank you !",5
Javascript elements - can not click to the right button,"Windows 2012 Server | Windows 8.1
Firefox 47.0.1
iMacros for Firefox 8.9.7

Website: vk.com

After I had created a post on my wall and decided to edit this post and add a poll, I've found that I can not make it.

If you want to help me, you may prefer to do it by yourself from scratch, or here is the code I'm using:
Code: Select allTAG POS=1 TYPE=DIV ATTR=CLASS:""post_edit_button fl_r""
TAG POS=1 TYPE=DIV ATTR=CLASS:""post_edit_button fl_r""
TAG POS=1 TYPE=NOBR ATTR=TXT:Attach CONTENT=EVENT:MOUSEOVER
WAIT SECONDS=1.5
TAG POS=1 TYPE=NOBR ATTR=TXT:Other.. CONTENT=EVENT:MOUSEOVER
WAIT SECONDS=1.5
TAG POS=1 TYPE=NOBR ATTR=TXT:Poll CONTENT=EVENT:MOUSEOVER
WAIT SECONDS=1.5
TAG POS=1 TYPE=NOBR ATTR=TXT:Poll

After clicking on last element (TAG POS=1 TYPE=NOBR ATTR=TXT:Poll) JavaScript adds Poll to the form of new post and not to an existing post that I'm editing.

Looks like it happens because of they are using same function with same class, so I've started to look around in order to find the way how to fix it, but I still can't find the way after hours of searching, reading and experimenting.

Clicking to an element by it's XPATH gives an error ""RuntimeError: Element DIV is not visible, line 3 (Error code: -921)"".
Code: Select allEVENT TYPE=CLICK XPATH=""id('add_media_menu_3')/div/div/div/div[2]"" BUTTON=0

I hope there should be an easy way how to manage is, so I ask iMacros community to help me.
I believe this case could be a good example for many situations.",2
extract data from ATTR which is generated,"Hi Guys,
I'm trying to create a macro for creating a page in a web based admin / backend. Couldn't find anything in the forum search. 
My stumbling block is copying the id number of the created page, once created it shows the newly generated id number but the field is the code number and not a constant value.

This is the from the recording
TAG POS=1 TYPE=SPAN ATTR=TXT:3658896 

The next page I create will be for example. 

TAG POS=1 TYPE=SPAN ATTR=TXT:3658899",3
Trouble in clicking button need urgent help,"hi hope you all are fine i am having problem in clicking button using imacros because the button that needs to be clicked is not txt based it is image that is used in css using background property ,

VERSION BUILD=844 RECORDER=CR

TAG POS=8 TYPE=SPAN ATTR=TXT: 

using windows 8 and google chrome browser 

the problem is we just need to click on image button so i need any help from moderators if need any more info on this i will happy to provide thanks,",2
I want to copy a portion of the webpage,"I am trying to open the website http://164.100.140.80/RoRView.aspx where I will select the 1st option  list box in District 1st option in list box Tahasil 1st option in Village name & then in Khatiyan 1st number in the list box then after clicking ROR Front page button a page will appear out of that I want to 1,2,3 Serial number data to clipboard. How to do this ?




I am using Firefox & Imacros for Firefox",5
Automate a filling form with a massive .csv in a table,"Hello!
- iMacros Version: 8.9.70.419
- Browser:Firefox: 47.0.1
- OS: Windows 10 Pro

I need your help regarding the performance of this script I have built in iMacros. It's doing sort of what I intend, sort of  
I want to load some basic information in a couple of text boxes everytime I click on the element (where the loop should be placed)
ctl00_PlaceHolderMain_BandejaEntidades_LstBandejaEntidades_ctrl{{!LOOP}}_LbtnVer.

The issues I'm having are the following:

1. The table where the data is located only displays 10 elements (although I can click on an index below the table that jumps through every 10 elements= This is called TAG POS=1 TYPE=A ATTR=TXT:354) . I want to loop over 3500 items. In addition to that, and to make things worse, the number of elements grow everyday but backwards: every new element starts at ""PlaceHolderMain"" in 0 so the first element that was loaded months ago will be the last on the list. But let's ignore this for a moment, so say I want to loop from 1 to 3500 elements, but since it only displays 10 elements, I get an error in the loop, because it cannot find the element 11, for example. How can I loop this to ALL the elements?

2. When I put the condition: SET !SINGLESTEP YES the code seems to work fine (assuming I just want to loop 10 elements, which I AM NOT!, because of the problem aforementioned). However, this is extremely tedious, I just want to run this and get over it. But the code get stuck when it encounters the line FRAME F=1. Not a runtime error, not running out of time, it just stops! Any idea why and how it can be solved?

3. The server response is extremely slow, every step when it makes a call to the server takes about 30-40 seconds. I've tried countless times to solve this with the IT people, but it seems that I cannot expect anything much from them  Ignoring this, how can I make the script run a little bit faster? Specially the part when it fills out the form and then returns to the main table?

4. When the first loop of filling out the form I got the headers of the .csv file, not the second line that I intended. But since SET !DATASOURCE_LINE {{!LOOP}} would loop every line starting from the element 1, this mean I would have to make another loop? So DATASOURCE starts at 2 but the rows on the table will start at 1 (actually, 0)? I'm really confused right now. Any idea how to solve this? It is my understanding that I would need to create a Javascript file? but I have no idea how to do this!

If someone can give me a hand orientating me on this issues, Im more than grateful!
Edit: I change the comments on the code....


Code: Select allVERSION BUILD=8970419 RECORDER=FX
TAB T=1
SET !LOOP 1
SET !SINGLESTEP YES
SET !DATASOURCE Prueba_Automata_SIPOV_v2.csv
SET !DATASOURCE_COLUMNS 5
SET !DATASOURCE_LINE {{!LOOP}}
'Login is pre-loaded, it should take me to the main table called ""FRMBANDEJAENTIDADES""
URL GOTO=https://www.minagricultura.gov.co/sites/sipov/_layouts/15/SHP-13-MinAgricultura-SIPV/SIPV/FrmBandejaEntidades.aspx
'Click en ""Ingresar""
'TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:aspnetForm ATTR=ID:ctl00_PlaceHolderMain_g_4efd4b82_233f_4f69_a43f_afbd14d8c69e_btnIngresar
'Va a la ultima hoja de la tabla (354)
'TAG POS=1 TYPE=A ATTR=TXT:354
'Click on the button to open another table( ""Ver""): ctrl{n} should be the Loop that allow me to access to every single row to fill the data
TAG POS=1 TYPE=A ATTR=ID:ctl00_PlaceHolderMain_BandejaEntidades_LstBandejaEntidades_ctrl{{!LOOP}}_LbtnVer
'To open the frame to fill in the data (WHEN I EXECUTE THIS WITHOUT SET !SINGLESTEP IT STOPS THE SCRIPT, NOT AN ERROR. IT JUST STOPS)
FRAME F=1
'Fill in the textbox with information retrieved from CSV
TAG POS=1 TYPE=TEXTAREA FORM=ID:aspnetForm ATTR=ID:ctl00_PlaceHolderMain_FrmFallo__supervisionEntidades_TxtAccionesDerivadasOrden CONTENT={{!COL2}}
'Fill in the textbox with information retrieved from CSV
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_PlaceHolderMain_FrmFallo__supervisionEntidades_DtFechaGestion_DtFechaGestionDate CONTENT={{!COL3}}
'Fill in the textbox with information retrieved from CSVo
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_PlaceHolderMain_FrmFallo__supervisionEntidades_TxtDiasTranscurridos CONTENT={{!COL4}}
'Fill in the textbox with information retrieved from CSV
TAG POS=1 TYPE=TEXTAREA FORM=ID:aspnetForm ATTR=ID:ctl00_PlaceHolderMain_FrmFallo__supervisionEntidades_TxtObservaciones CONTENT={{!COL5}}
'Clicks on the button to add the information placed before
TAG POS=1 TYPE=A ATTR=ID:ctl00_PlaceHolderMain_FrmFallo__supervisionEntidades_LbtnAgregar
'¿Regresa a la tabla inicial?
'FRAME F=1
'No sé!
'WAIT SECONDS=45
'TAG POS=4 TYPE=SPAN ATTR=CLASS:s4-clust&&TXT:
",4
"table export to CSV after ""javascript:__doPostBack""","Hello!
First of all, I have to say I just started using imacros today so you can say Im really just a noob   nevertheless I find imacros amazingly powerful. I would really like to learn more about it!
The problem I want to solve is this: I want to extract all the elements on the table that FOLLOWS after I click a link that is referenced as ""javascript:_doPostBack"". Each link ""hosts"" a table, so I need to loop this. If possible, to merge all the resulting tables into one without having to go trough a macro in VBA.
Code: Select allVERSION BUILD=8970419 RECORDER=FX
SET !LOOP 1
SET !EXTRACT_TEST_POPUP NO
TAB T=1
URL GOTO=http://190.24.134.230/tierras/sentencias.aspx
TAG POS=1 TYPE=A ATTR=HREF:javascript:__doPostBack('ctl00$MainContent$GVSentencias','Select${{!LOOP}}')
TAG POS=1 TYPE=TABLE ATTR=* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=TEST.CSV

I'm unsure on how to get the table after the loop? I've tried with relative positioning (TAG POS=1) but it brings *EANF* which I assume is an error in the retrieval?
Any help would be highly appreciated. Im pretty sure this is a dumb question to ask...",5
Extract A Certain Part of Text (Partial),"iMacros for Firefox 8.9.7 (Firefox 47)  , Win 7 x64
Extraction Dialog is created by Imacros 10 IE

The Actual Text is
Code: Select allDear xxxxxxx
Please log in using your login code below:
qpy6HW

This email was sent because someone tried to log in from a new browser or location with your correct email address and password.
If it wasn't you trying to log in, please change your password immediately. Please also consider changing your password on all services you are using this password for.

I want to extract the 
Code: Select allqpy6HW

This Code always changes but the location of the code is always the same

i am trying to store this Code Portion in !VAR
and later use it

in my example the code is Code: Select allqpy6HW
and i want to store this in !VAR

Is it Possible ?

I can Extract the entire Text
Its from an Email

I can help you get an idea if you need a live example . just tell me i will arrange something .",2
Error when communicating with the native messaging host,"Hi guys!

I am newbie to iMACROS and I got some troubles with my script. Any help is appreciated!  

So I created a script to grab information from online and store it in my local csv file. I'm aiming to do it in a loop about size 1000 every time. The script works fine when I run it in smaller loops (ex. <50). 

This morning, I tried to run it in 800 loops, but it stopped at loop 49 and gives me this error. Error: Error when communicating with the native messaging host., line: 36. Line 36 is the last line of my script. And I found that every time I got this error, I just need to change the output file name(both in script and the actual output file's name) and continue running the loop from where it stopped last time. And the script will be good for another 40 or 50 loops until this error pops up again... This is pretty confusing... Please let me know if you have any suggestions  


Below is my CIM:

+ iMacros for Chrome 8.3.5
+ Windoes 8.1 Enterprise
+ Google Chrome Version 50.0.2661.102 m


Below is my script:

VERSION BUILD=8350307 RECORDER=CR
SET !DATASOURCE C:\Users\crispyizzy\Desktop\input.csv
SET !DATASOURCE_COLUMNS 6
SET !DATASOURCE_LINE {{!LOOP}}
SET !EXTRACT_TEST_POPUP NO


URL GOTO=https://myURL.com
FRAME F=3
TAG POS=1 TYPE=A ATTR=ID:C4_W16_V17_IC_INBOX
WAIT SECONDS=2
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:myFormId ATTR=ID:123_search_parameters[2].VALUE1 CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:myFormId ATTR=ID:123_search_parameters[3].VALUE1 CONTENT={{!COL2}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:myFormId ATTR=ID:123_search_parameters[6].VALUE1 CONTENT={{!COL4}}
SET !EXTRACT {{!COL1}}
ADD !EXTRACT {{!COL2}}
ADD !EXTRACT {{!COL3}}
ADD !EXTRACT {{!COL5}}
ADD !EXTRACT {{!COL4}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:myFormId ATTR=ID:123_search_MAX_HITS CONTENT=1
TAG POS=1 TYPE=B ATTR=TXT:Search
WAIT SECONDS=3
TAG POS=1 TYPE=A ATTR=ID:123_items_table[1].incident_id
TAG POS=1 TYPE=TABLE ATTR=CELLSPACING:2 EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_cssngprojh_struct.description EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_catselvn_cat_label EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btadminh_priority EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btorgset_struct.service_org_resp_short EXTRACT=TXT
TAG POS=1 TYPE=A ATTR=ID:123_btpartnerset_soldto_name EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btcustomerh_convert_system_usage EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btadminh_last_change EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btadminh_zcreated_at EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_zinccreatdate_datetime EXTRACT=TXT
TAG POS=1 TYPE=SPAN ATTR=ID:123_btadminh_zconfirmed_at EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\crispyizzy\Desktop FILE=output                                     // This is line 36!
",3
Extracting a web table into Excel columns,"Hi team,

1. What version of iMacros are you using? iMacros Browser v11.1.495.5175 [Trial Version day 1 of 30]  (very new )
2. What operating system are you using?  Windows 10 English 64Bit
3. Which browser(s) are you using? (include version numbers) IE 11.420...

I have been able to extract a table from a webpage and save it to a .csv file.

However when the saved files is opened in notepad, this is what is i get between the ................. lines
............................................................................................. 

Vehicle

Vehicle Type

Tier 4

Tier 3

Tier 2

Tier 1

Vehicle Time Zone

Last Attempted Connection

Last Completed Connection

Days Since Last Completed Connection

6118 (1000544)Hyster H18.00XMKawerauCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington30-June-2016 10:51:1530-June-2016 10:51:381 days
5973 (1000739)Hyster H3.5FTTokoroaCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington20-January-2016 23:46:4620-January-2016 23:47:09162 days
5978 (1000771)Hyster H4.0FTTokoroaCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington27-June-2016 14:08:0527-June-2016 14:08:223 days
6132 (1000838)Hyster H12.00XMNelsonCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington30-June-2016 09:20:4130-June-2016 09:21:311 days
5984 (1001004)Hyster H8.0FTHubCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington30-June-2016 10:18:3630-June-2016 10:18:481 days
5983 (1001005)Hyster H8.00FTHubCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington29-June-2016 10:39:5029-June-2016 10:40:292 days
6125 (1001107)Hyster H12.00XMNelsonCWPGroupIMHYAP(GMT+12:00) Auckland, Wellington29-June-2016 14:39:1329-June-2016 14:39:311 days
...................................................................................

The relevant imacro script lines are:

URL GOTO=http://203.xx.xxx.xxx/Fleet_Online/repo ... ivity.aspx
TAG POS=3 TYPE=TBODY ATTR=* EXTRACT=TXT

'The SAVEAS statement was added manually to write the extracted table to a file
'(The alternative way to get the extracted data is the Scripting Interface)
SAVEAS TYPE=EXTRACT FOLDER=C:\Downloads FILE=Connectivity_{{!NOW:yymmdd_hhnnss}}.csv

'WAIT SECONDS=2
URL GOTO=http://demo.imacros.net/Automate/OK 

.................................................................................................

The first 10 text rows are a single row of column headings.
The rest are the elements which go in the columns

I have searched for some time to find out why I cannot get comma and quotes delimited data being saved to the .csv file.

Can you please advise what I am doing wrong here.

Any assistance is much appreciated.

Cheers 
Bernard",2
"How to take a number, use it to select an image and use text","Hi,

In a form, the antispam works like this :

- a sentence gives a number between 1 & 5, and explains we must write the word corresponding of the image position, 1 to 5.

So for example :
Write the word corresponding of the 4th image
then we have the 5 images which are shown randomly but on the same line, in the same code, just the order changed. Even the name of the image doesn't change.
So we could have 1.gif - 3.gif - 4.gif - 2.gif - 5.gif 
The sentence ask me the 4th, so i must write the sens of the 2.gif image which could be a circle or a square.

So, how can i pick the number of the image, then use it to detect which image is at this position (1 to 5), then i extract the name of the image, in a sorte of table somewhere i stored that 1.gif is a circle, 2.gif a square, 3.gif an arrow, etc. So at the end imacro put the right answer in the field.

thank you,",3
Searching through a webpage using iMacros / Javascript,"Hey everyone,

I know many of you probably hate it when new people come here and expect to get their problems solved, but I've spent so many hours on this problem and something tells me that it can't be that difficult to solve.

What I was trying to do is something very simple: I wanted to create a macro with iMacros that is able to go through a webpage, search for a certain word and if the word is found, click on a button. Else, refresh the page and start again.

I realized that there is no easy way to use if/else on iMacros, so that I'll need to add this with Javascript. Still, my major problem is found in the macro. Basically, if I use the extract option on iMacros, it will only skim through the HTML code of the page, if I understand it correctly. This means that it will need a certain TYPE. The problem is that this webpage I am looking to skim through does update time after time but does not show these new ""results"" in the HTML code. I think it uses some kind of Javascript or php, not showing the text I want to find in the HTML code. How do I still program iMacros to simply search through the ""visible"" text on the page (in a CTRL+F kind of way)?

The macro I had implemented in my .js file that is responsible for extracting looks like this:

VERSION BUILD=8970419 RECORDER=FX
TAB T=1
SET !EXTRACT_TEST_POPUP NO
TAG POS=1 TYPE=A ATTR=TXT:*Text* EXTRACT=TXT

In this example I try and search for the word [...]Text[...] If I try and use the wildcard TYPE=* it simply does not work.

So: Is there a way to search on a page and not only the HTML code with iMacros? How would I do it?
If it doesn't work wit iMacros, is there a way to simply do it with Javascript?

Thanks in advance.",5
Please Help with replace,"iMacros Browser v10.0.2.2823
FF 47.0 x86 en-US with iMacros for FF add-on 8.9.7
Win7 x64

Hi, anyone can help me with eval replace?
in firefox it can replace with fine job, but when extract description,it extract to one paragraph.
im trying using imacros browser, it can extract description with multi paragraph but not with replace.
i prefer to use firefox, but not mind if i must use imacros browser to do the job.
My goal is to extract that description into multi paragraph and replace other text im not using.
THX b4!!
Code: Select all'URL GOTO=https://www.tokopedia.com/kopijayakarta/fiorenza-french-press-coffee-maker-350-ml-for-3-cups
SET !EXTRACT_TEST_POPUP NO
'Set !REPLAYSPEED SLOW
SET !ERRORIGNORE YES
SET !TIMEOUT_STEP 0

VERSION BUILD=10022823
TAB T=1
'gr
TAG POS=1 TYPE=DD ATTR=CLASS:pull-left<SP>m-0 EXTRACT=TXT
SET !VAR1 EVAL(""'{{!EXTRACT}}'.replace(/gr/g, '');"")
'SET !VAR3 EVAL(""var s=\""{{!EXTRACT}}\""; s.replace(/\rb/g,' ')"")
SET !EXTRACT NULL
SET !EXTRACT {{!VAR1}}

'rb
TAG POS=1 TYPE=DD ATTR=CLASS:pull-left<SP>m-0<SP>view-count EXTRACT=TXT
SET !VAR2 EVAL(""'{{!EXTRACT}}'.replace(/rb/g, '');"")
'SET !VAR3 EVAL(""var s=\""{{!EXTRACT}}\""; s.replace(/\rb/g,' ')"")
SET !EXTRACT NULL
SET !EXTRACT {{!VAR2}}

SAVEAS TYPE=EXTRACT FOLDER=C:\Users\dion\Documents\iMacros\Macros FILE=Ordereqweqs{{!NOW:dd-mm-yyyy}}.csv
",6
please someone help me,"haii..
i want to extract data to csv
can someone help me make the script?
i already try but i can't

here's the website
https://seller.shopee.co.id/portal/sale?type=toship

here's the first page


and then what i want to scrape is, when i click the ember. here's the landing page
https://2.bp.blogspot.com/-t66oeks3Fvg/ ... /test2.png

here's the data all i want to scrape

https://2.bp.blogspot.com/-Zvrc49RlbNY/ ... /test6.png

https://1.bp.blogspot.com/-EEupRZJvZ9Q/ ... /test3.png

https://3.bp.blogspot.com/-93Wlx3eb7Mg/ ... /test4.png

https://1.bp.blogspot.com/-43q5jQBh6hE/ ... /test5.png

and i want to play loop for all items at this page
https://seller.shopee.co.id/portal/sale?type=toship

can someone help me?
tq",2
Online OCR,Can you recommend me free online OCR for small pictures?,2
Edit data in CSV,"Hello! I am trying to read data from csv, then use it in webform, but after this I need to edit this data in the CSV to be sure which lines has been used. 
How can I read only certain lines from CSV file which begin only with certain symbol? And how can I edit first symbol of CSV line to tell program not to use this line again next time?

Something like that:
Code: Select all@Line1
Line2
Line3

Reading line1 => used, goto line2; 
Reading line2 => not used, use line2;
Line2 used => change line2 to @line2;
Maybe I can write this ""@ parameter"" in col1, and if col1 = ""@"" then goto next line? How can I write this in IMacros?",9
converting javascript var to imacro !VAR1,"I'm trying to define an imacro Variable !VAR1 with an existing javascript var=extract1. 

But it doesn't work. 
Code: Select all	 	
var extract1 = A

	        macro=""CODE:"";
	        macro+=""SET !TIMEOUT 1\n"";
	        macro+=""SET !ERRORIGNORE YES\n"";
	        macro+=""ADD !VAR1 ""+extract1+""\n"";     // add js var to the !EXTRACT variable
	        retcode = iimPlay(macro);   

Perhaps this is closer to what I want. 

	        macro+=""ADD !VAR1 EVAL(var =extract1)\n"";     // add js var to the !VAR1 variable",4
downloading a file,"Hi, I am new to iMacro.
I have recorded a Marco. When I run it it should download a csv file. But nothing happens.
Here is the code

URL GOTO=https://www.msci.com/end-of-day-data-country
FRAME F=1
TAG POS=1 TYPE=A ATTR=ID:templateForm:tableResult1:0:_id206
TAG POS=1 TYPE=A ATTR=TXT:Download<SP>Data

I think that I have to modifiy the last line since it is the ""Download Data"" is return as a text.

Thanks",5
Important Progress iMacros Product Update,"Dear iMacros Customers and Users, 

We are writing to inform you that Progress will be officially discontinuing the Progress iMacros product, with a planned End-Of-Life date of November 30, 2023. 

What does this mean? 
Moving forward, Progress will continue to support the iMacros product and will only provide critical fixes as needed until the EOL date. We will honor all service agreements through the existing term, except for those contracts that go beyond the EOL date. Customers with service agreements that go beyond the EOL date will be contacted separately to discuss their options and next steps. We will continue to offer service agreement renewals that do not exceed the EOL date. 

What are your next steps? 
Please remain on the lookout for more communications from Progress in the coming months, as more information will be made readily available to assist you as you prepare your transition plans. 

If you have additional questions, please email iMacrosInquiries@progress.com 

On behalf of Progress, thank you for your continued partnership and commitment. 

Sincerely,  
The Progress iMacros Team",2
*** Please read this before reporting problems ***,"Post last updated: May 25, 2020.

If you open a new topic (or post for the first time in some existing topic) to report an issue or ask any question, we can respond much faster if your problem description includes the following information (if applicable, not all questions fit to all problems):

1. What version of iMacros are you using?
You find the iMacros version and build information at the top of every macro that you record, for example ""VERSION BUILD=10100795"". Also specify whether you are using a freeware, trial, or licensed version, e.g. Personal Edition. Please test with the latest version.

2. What operating system are you using? (please also specify language)
Example: Windows 10, Windows 8.1, Windows 7, Windows Server 2012R2, English, German, Chinese, ...

3. Which browser(s) are you using? (include version numbers)
Example: Chrome 74.0.3729.13, Firefox 64.0.2, IE 11/10/9, ...

4. Do the included demo macros work ok? 
This test helps us to determine if the problem is a general iMacros issue or is somehow related to a specific website or configuration.

5. If reporting a problem with the iMacros scripting interface, please also test if the included VBS sample scripts run ok.
This test helps us to determine if the iMacros scripting interface installation is ok.

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the macro that creates the problem?
If you cannot post the macro in a public user forum or the website requires a login, can you provide a similar example of the problem on a publicly accessible website?

7. Do you encounter the same problem recording or replaying the macro in different browsers, such as the iMacros browser, Firefox, Chrome, or Internet Explorer? 
Note: If the problem is specific to Firefox or Chrome, please post in either the iMacros for Firefox or iMacros for Chrome sub-forum respectively.

8. Please include any additional information that is relevant to reproducing the issue.
This includes a detailed description of the steps you've tried as well as the specific error codes and messages, macro logs, screen shots, etc. Please upload screenshots and other relevant files directly to the forum and not to a third-party hosting service!

This information allows us to quickly re-create the issue on our test systems and solve it ASAP.

Additional tips when posting

* Please ensure that the content of your post is relevant to the topic and/or forum where you post it.
For example, if you are having a problem extracting data from a web page and are using Firefox, create your post in the Data Extraction and Web Screen Scraping forum rather than the iMacros for Firefox forum (see note #7 above). If you are unsure which forum to post to, use the General Support & Discussions forum.

* Use a topic title that succinctly describes the problem or issue.
Avoid phrases such as ""Please Help"", ""Urgent"", ""Script not working"", etc. and refrain from using all capital letters and exclamation points. Also, double-check that the spelling of the title and body of the post are correct, since this makes it more likely to be found in searches by other users. Most modern browsers automatically check spelling as you type and underline mistakes, so please correct them before submitting your post.

* Don't post the same question to more than one forum.
If you've miscategorized your original post, just click the Exclamation Icon on the right of the post's subject/title line to report it and let us know where you would like it moved or merged.

* Always provide your FCI (Full Config Info), c.f. items 1-3 above, in your original post even if you think it may not be relevant.
Some of our mods may not even respond unless this information is included. Please don't put this information in your signature, because this can change over time and makes it more confusing when reviewing older posts. Include the information directly in the body of the post instead.

* When sharing screenshots or other relevant files, please upload them directly to the forum rather than use a third-party hosting/sharing service.
Too often these services stop functioning or the files become unavailable for whatever reason. Uploading them here ensures that the full context of the post remains consistent over time.

* Take a minute to review your forum notification settings

Thank you for helping us to help you better!",1
Extract Hidden value on page help?!?,"I can't seem to get this hidden value extracted. 

Here is the code:
<input id=""accHitStatus"" value=""Hit"" type=""hidden"">

And here is what I'm using to try and extract the info:
TAG POS=1 TYPE=INPUT:HIDDEN ATTR=NAME:accHitStatus EXTRACT=TXT

The problem is that there isn't a specified name but it lists the input ID. I've tried ATTR=INPUTID:, ATTR=INPUT_ID, and ATTR=INPUT ID, but no luck.

Any suggestions?",5
Extracting Text from Onmouseover,"Hello,
I want to extract the text by a mouseover event in this page: https://chinesepod.com/tools/glossary/entry/fish

For example: with the second sentence:
Code: Select all                    <td width=""80%"" style=""font-size:18px;"">
                        <span onclick=""onWordClick()"" onmouseover=""tip(event,'he','ta1','他','他')"" onmouseout=""htip()"">他</span><span onclick=""onWordClick()"" onmouseover=""tip(event,'not','bu4','不','不')"" onmouseout=""htip()"">不</span><span onclick=""onWordClick()"" onmouseover=""tip(event,'to like','xi3huan5','喜欢','喜歡')"" onmouseout=""htip()"">喜欢</span><span onclick=""onWordClick()"" onmouseover=""tip(event,'to eat','chi1','吃','吃')"" onmouseout=""htip()"">吃</span><span onclick=""onWordClick()"" onmouseover=""tip(event,'fish','yu2','鱼','魚')"" onmouseout=""htip()"">鱼</span>。                        <br />
                        (He doesn't like to eat fish.)
                    </td>

And extracted data will be: 
Code: Select all- he not to like to eat fish
- ta1 bu4 xi3huan5 chi1 yu2

Can you tell me how to do it ? I appreciate so much. Thank you very much !   


Below is my imacros information:
1. What version of iMacros are you using?
VERSION BUILD=8970419 RECORDER=FX

2. What operating system are you using? (please also specify language)
Windows 7 Ultimate x64

3. Which browser(s) are you using? (include version numbers)
Firefox 46.0.1

4. Do the included demo macros work ok?
Yes",8
I need help with the extraction,"Hello Guys,
I want to extract all data from this site.
http://sec.up.nic.in/ElecLive/resultsearch.aspx
But I don't know how to   
I want complete data from those drop down list options.
Is it possible?

Language: Hindi",7
Extract email Body (GMail),"Hi , i try to extract a gmail body but gmail make random id each time!
i'm newbie   
can someone help me thanks",4
YouNow Date extract and close page by date result,"Hello,

(1)

how can I extract the Date / Time?

URL GOTO=https://www.younow.com/ItsNolyMon/channel
TAG POS=17 TYPE=DIV ATTR=CLASS:minutes-ago<SP>text-muted EXTRACT=TXT

URL GOTO=https://www.younow.com/Nochillmikeyyy/channel
TAG POS=15 TYPE=DIV ATTR=CLASS:minutes-ago<SP>text-muted EXTRACT=TXT

You can see ""TAG POS"" is not the same.

I need the first time under
TAG POS=1 TYPE=A ATTR=TXT:Broadcasts

How can I do this?

I try 
TAG POS=1 TYPE=A ATTR=TXT:Broadcasts
TAG POS=R1 TYPE=DIV ATTR=CLASS:minutes-ago<SP>text-muted EXTRACT=TXT
but this is not the searched result.

I don't find a element of 
TYPE=DIV ATTR=CLASS:minutes-ago<SP>text-muted EXTRACT=TXT
whitch can be the start point for:
TAG POS=R1 TYPE=DIV ATTR=CLASS:minutes-ago<SP>text-muted EXTRACT=TXT

iMacros 10
FireFox 41
win 8 / 64

(2)

As a result, the Text Extraction you get as ""13 days ago"" or ""17 minutes ago"". If the result is older than ""2 days ago"", I would like to close the page by iMacros. Otherwise, to remain open the page. How can I implement with iMacros?

best regards",2
FAIL_IF_FOUND on Checkbox value,"Hi there..

I am VERY new to iMacros, and am so far very impressed.  
As I am only trialling the product at present I am using the free version. (v11)

I am using the product to create automated regression testing, and so checking results is a key element of my macros.

I am currently trying to run a macro which proves whether or not a check box on a page has been ticked.

If the checkbox is not ticked (or is ticked, whichever) I want the Macro to error (FAIL_IF_FOUND?)

I am not sure the best way to accomplish this.  I had it working using image search, but the free version does not include this feature.

How do I extract the value of a checkbox, and then fail the Macro if the value is either YES or NO?

Windows 8.1, IE11
iMacros Sidebar for Internet Explorer (x64) Version 11.1.495.5175
Released on 10/03/2016
Licensed Product: Free Edition

Many thanks in advance.",4
First column of a table,"Hi,

I have to extract the 3rd column's cell of the first row table that has in the 1st column a certain name.

the table looks like:
Code: Select all<tr><td class=""name"">Name1</td><td class=""name"">Name2</td><td><span>ITEMtoEXTRACT</span></td></tr>

till now I've written this code:
Code: Select allTAG POS=1 TYPE=TD ATTR=CLASS:crest-player-name&&TXT:Name1
TAG POS=R1 TYPE=TD ATTR=TXT:*:*:* EXTRACT=TXT
SET !VAR1 {{!EXTRACT}}

That's working fine, but it extracts the 3rd cell also if Name1 is in the second cell. As you see,the 1st and the 2nd cell have the same ATTR.

What should I do?",2
Getting Data source to Loop,"Trying to get my data source (Step2.csv) to loop to the next line of data...it keeps pulling from line 1 and not heading down the list...

for : var imacros_main32  : I bolded the area I need help with. Thanks
Code: Select all//
// This imacros script created by 9kw.eu
// Find more here: http://www.9kw.eu/
//
// The script fill the captcha of recaptcha v2 demo.
//
// Note for users with firefox with the message ""Firefox prevented this page from automatically reloading."":
// UNCHECK the option ""warn me when pages try to redirect"" in your browser
// You find the checkbox under Options > Advanced > General > Accessibility
//
// More informations with iMacros for Firefox and speed up javascript:  
// http://wiki.imacros.net/iMacros_for_Firefox#Javascript_Scripting_Interface
//
// You can use more instances with Firefox:
// http://kb.mozillazine.org/Opening_a_new_instance_of_Firefox_with_another_profile
// https://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles
// http://kb.mozillazine.org/Command_line_arguments
// Like -P ""My Profile"" -no-remote or -ProfileManager
//
// Path to the captcha image with timestamp
// Tempfolder like C:\ or C:\TEMP\ under windows or like /tmp/ under linux
// In Javascript and windows with escape like C:\\TEMP\\
var tempfolder = 'C:\\TEMP\\';//optional, like C:\\TEMP\\

// Tempslash (Path with slashs as (tempfolder) and with the htmlfile recaptcha_v2.html
var tempslash = ""C:/TEMP/"";//optional, like C:/TEMP/

// Step 1: Config for 9kw.eu for your apikey
var apikey = """";

//And priority (prio 1-20)
var prio = ""1"";

// Loops
var max_loop = 1;
var max_wait = """";//seconds, optional

// Url
var myurl = ""URL GOTO=https://www.textnow.com/signup"";
myurl += """";//extra lines

// Submit
var mysubmit = ""TAG POS=1 TYPE=INPUT:SUBMIT FORM=NAME:NoFormName ATTR=*\n"";
mysubmit += """";//extra lines

// Replayspeed
var replayspeed = ""FAST"";//MEDIUM
var replayspeed_clicks = ""FAST"";

// Debug
var breakOnError = false;
var onBreakAlert = true;
var logFile = true;
var logFileName = 'iimLog.txt';
var max_loop_limit = 500;

//Performance for recaptchav2 like default 1 + 10 = Frame 11 as start for few functions
var higher_frame_number = 1;//Standard (like 6)
var other_frame_number = 0;//Startframe
var max_frame_number = 15;//Standardframe as max (like 15)
var total_frame_number = 20;//SearchFrame+SearchOK

//header
var imacros_header = ""SET !EXTRACT_TEST_POPUP NO\n"";
imacros_header += ""SET !ERRORIGNORE NO\n"";
imacros_header += ""SET !TIMEOUT_PAGE 999\n"";
imacros_header += ""SET !TIMEOUT_STEP 999\n""
imacros_header += ""SET !REPLAYSPEED ""+replayspeed+""\n"";

//Main
var logFilePath = getiMacrosFolder('Logs')+'\\'+logFileName;
var tempfile;

var httpRequestObserver =  {  
  observe: function(subject, topic, data)  {  
    if (topic == ""http-on-modify-request"") {  
      var httpChannel = subject.QueryInterface(Components.interfaces.nsIHttpChannel);  
      if (
      	/funcaptcha.com|solvemedia.com|keycaptcha.com|confidenttechnologies.com/.test(httpChannel.originalURI.host) ||
      	/google.com\/recaptcha|gstatic.com\/recaptcha/.test(httpChannel.URI.spec) 
      
      ) {  
	      httpChannel.setRequestHeader(""Accept-Language"", ""en,en-US;de;q=0.5"", false);  
      }
    }  
  },  
  
  get observerService() {  
    return Components.classes[""@mozilla.org/observer-service;1""]  
                     .getService(Components.interfaces.nsIObserverService);  
  },  
  
  register: function()  
  {  
    this.observerService.addObserver(this, ""http-on-modify-request"", false);  
  },  
  
  unregister: function()  
  {  
    this.observerService.removeObserver(this, ""http-on-modify-request"");  
  }  
}; 
var observerService = Components.classes[""@mozilla.org/observer-service;1""].getService(Components.interfaces.nsIObserverService);
observerService.addObserver(httpRequestObserver, ""http-on-modify-request"", false);
httpRequestObserver.register();

(function() {
	// Syntaxcheck: API Key, prio
	if(apikey.match(/^[a-zA-Z0-9]+$/) && apikey.length <= 50 && apikey.length >= 5){}else{alert_message(""API Key \""""+apikey+""\"" is wrong."");return false;}
	var d = parseFloat(prio); if(d >= 0 && d <= 20){}else{alert_message(""Prio \""""+prio+""\"" is not in the set range."");return false;}

	// only valid number
	if (/[^\d]/.test(max_loop)) {
		alert_message('Please enter a valid number for loop play');
		return false;
	}
	
	max_loop = parseInt(max_loop);
	if(max_loop > max_loop_limit){
		alert_message('Loop limit exceed (' + max_loop_limit + ') , edit the following variable to use your own limit.\n\nvar max_loop_limit = ' + max_loop_limit + ';');
		return false;
	}	
	
	for(var loop = 1; loop <= max_loop; loop++){
		var function_code = """";
		function_code = recaptchav2();
		if(function_code == false && breakOnError == true){
			return false;
		}
		if (/[\d]/.test(max_wait)) {
			wait(max_wait);
		}
	}
})();

httpRequestObserver.unregister();
observerService.removeObserver(httpRequestObserver, ""http-on-modify-request"");
//End

// functions
// recaptcha v2
function recaptchav2(){
	var imacros_first = ""CODE:""+imacros_header+""TAB CLOSEALLOTHERS\n""
	imacros_first += ""TAB T=1\n"";
	imacros_first += myurl;
	iimPlay(imacros_first)
	
	// start execution
	var start = new Date(), end; // for benchmarking
	
	// Step 2: Save the captcha picture to local disk
	// initial click macro
	var frame = SearchFrame(""EVENT TYPE=CLICK SELECTOR=\""#recaptcha-anchor>DIV:nth-of-type(5)\"" BUTTON=0"",0);
	iimSet(""frame"",frame)
	//Wait a random number of seconds
	wait(Math.floor(Math.random()*3 + 1));
	var checkOK;
	var more_correct_solutions;
	var captchaid;
	
	if(/[^\d]/.test(frame) || frame < 1){
		if(logFile){
			log_message(""No captcha found as frame number."");
		}
		return false;
	}

	for(var i3=1;i3<=5;i3++){
		captchaid = """";
		tempfile = ""captcha_""+tempfile_date()+"".jpg"";

		// macro for checking captcha checkbox
		var solved = SearchOK(""TAG POS=1 TYPE=SPAN ATTR=ID:recaptcha-anchor&&aria-checked:true CONTENT=EVENT:MOUSEOVER"",1+other_frame_number,max_frame_number);
		if(solved > 0){
			end =+ new Date();
			if(logFile){
				log_message('Captcha is solved\n\rTime spent: '+Math.floor((end-start)/1000));
			}
			//break;
		}else{
			if(i3 > 1){
				//more_correct_solutions = SearchOK(""TAG POS=2 TYPE=DIV ATTR=TXT:Multiple<SP>correct<SP>solutions<SP>required<SP>-<SP>please*&&STYLE: CONTENT=EVENT:MOUSEOVER"",0+other_frame_number);
				if(more_correct_solutions < 1){
					checkOK = SearchOK(""TAG POS=1 TYPE=SPAN ATTR=ID:recaptcha-anchor&&aria-checked:true CONTENT=EVENT:MOUSEOVER"",1+other_frame_number,max_frame_number);
					if(checkOK < 1){
						iimPlay(imacros_first)
						wait(3)
						SearchOK(""EVENT TYPE=CLICK SELECTOR=\""#recaptcha-anchor>DIV:nth-of-type(5)\"" BUTTON=0"",0+other_frame_number);
					}
				}
			}

			var save_image_header = ""SET !REPLAYSPEED ""+replayspeed+""\n"";
			if(tempfolder.length > 3){
				save_image_header = ""ONDOWNLOAD FOLDER=""+tempfolder+"" FILE=""+tempfile+"" WAIT=YES\n"";
			}else{
				save_image_header = ""ONDOWNLOAD FOLDER=""+getiMacrosFolder(""DataSources"")+"" FILE=""+tempfile+"" WAIT=YES\n"";
			}
			var save_image = save_image_header+""TAG POS=1 TYPE=DIV ATTR=ID:rc-imageselect CONTENT=EVENT:SAVE_ELEMENT_SCREENSHOT"";
			frame = SearchFrame(save_image,frame);
			if(frame > 0){
				iimSet(""frame"",frame)
			}
			//iimDisplay(""Frame: ""+frame)
			var clickframe = SearchFrame(""TAG POS=1 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:MOUSEOVER"",frame,max_frame_number);
			// find the captcha with 10 images and higher
			var find10 = SearchOK(""TAG POS=12 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:MOUSEOVER"",clickframe,clickframe);

			// check for the recaptcha with 10 images or find the captcha with 9 images
			var find9;
			if(find10 < 1){
				find9 = SearchOK(""TAG POS=9 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:MOUSEOVER"",clickframe,clickframe);
			}
			
			// check for the recaptcha with 9 images or find the captcha with 8 images
			var find8;
			if(find9 < 1){
				find8 = SearchOK(""TAG POS=8 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:MOUSEOVER"",clickframe,clickframe);
			}
			// check for the recaptcha with 8 images or find the captcha with enough images like 2 and more
			var find2;
			if(find8 < 1){
				find2 = SearchOK(""TAG POS=2 TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=* CONTENT=EVENT:MOUSEOVER"",clickframe,clickframe);
			}
			
			// new captcha image with numbers for the captcha service
			if(find10 > 0 || find9 > 0 || find8 > 0 || find2 > 0){
				var recaptcha_v2_error = false;
				
				for(var ihtml=1;ihtml<=2;ihtml++){
					var imacros_main1 = ""CODE:"";
					imacros_main1 += imacros_header+""TAB OPEN\n"";
					imacros_main1 += ""TAB T=2\n"";
					if(tempslash.length > 0){
						imacros_main1 += ""URL GOTO=file:///""+tempslash+""recaptcha_v2.html?"";
					}else{
						imacros_main1 += ""URL GOTO=file:///""+getiMacrosFolder('DataSources').replace(/\\/g, '/')+'/'+""recaptcha_v2.html?"";
					}
					if(more_correct_solutions > 0){
						if(find10 > 0){
							imacros_main1 += ""6"";
						}else if(find9 > 0){
							imacros_main1 += ""7"";
						}else{
							imacros_main1 += ""8"";
						}
					}else{
						if(find10 > 0){
							imacros_main1 += ""2"";
						}else if(find9 > 0){
							imacros_main1 += ""1"";
						}else{
							imacros_main1 += ""3"";
						}
					}
					if(tempslash.length > 0){
						imacros_main1 += ""=file:///""+tempslash+tempfile+""\n"";
					}else{
						imacros_main1 += ""=file:///""+getiMacrosFolder('DataSources').replace(/\\/g, '/')+'/'+tempfile+""\n"";
					}
					imacros_main1 += ""WAIT SECONDS=1\n"";
					iimPlay(imacros_main1)
					
					var html_ok = SearchOK(""TAG POS=1 TYPE=DIV ATTR=CLASS:c CONTENT=EVENT:MOUSEOVER"",0,0);
					if(html_ok > 0){
						var imacros_main1a;
						if(tempfolder.length > 3){
							imacros_main1a = ""CODE:""+imacros_header+save_image_header+""FILEDELETE NAME=""+tempfolder+tempfile+""\n"";				
						}else{
							imacros_main1a = ""CODE:""+imacros_header+save_image_header+""FILEDELETE NAME=""+getiMacrosFolder(""DataSources"")+'\\'+tempfile+""\n"";									
						}
						imacros_main1a += ""TAG POS=1 TYPE=DIV ATTR=* CONTENT=EVENT:SAVE_ELEMENT_SCREENSHOT\n"";
						imacros_main1a += ""WAIT SECONDS=3\n"";
						imacros_main1a += ""TAB CLOSE\n"";
						iimPlay(imacros_main1a)
						break;
					}else{
						if(ihtml == 1){
							iimPlay(""CODE:"");
							var imacros_main1b = ""CODE:URL GOTO=http://www.9kw.eu/grafik/api/recaptcha_v2.html\n"";
							imacros_main1b += ""WAIT SECONDS=1\n"";
							imacros_main1b += ""TAG POS=1 TYPE=HTML ATTR=* EXTRACT=HTM\nSAVEAS TYPE=HTM FOLDER=\""""+getiMacrosFolder('DataSources')+""\"" FILE=recaptcha_v2.html\n"";
							imacros_main1b += ""WAIT SECONDS=1\n"";
							imacros_main1b += ""TAB CLOSE\n"";
							iimPlay(imacros_main1b)
						}else{
							alert_message(""No recaptcha_v2.html found on your local browser. Please check it."");
							recaptcha_v2_error = true;
							break;
						}
					}
				}
				if(recaptcha_v2_error){
					if(breakOnError){
						return false;
					}else{
						break;
					}					
				}
			}
				
			//Step 3: Open a new tab, and go to 9kw.eu, and submit the captcha picture
			var imacros_main2 = ""CODE:""+imacros_header;
			imacros_main2 += ""TAB OPEN\n"";
			imacros_main2 += ""TAB T=2\n"";
			imacros_main2 += ""URL GOTO=http://www.9kw.eu/grafik/form.html\n"";
			//The apikey is used to identify each of our customers, which you can get from the our page. It is assigned to the CONTENT.
			imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:apikey CONTENT=""+apikey+""\n"";
			//Priority in our system like min. 0 to max. 20 (cost +0-20)
			imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:prio CONTENT=""+prio+""\n"";
			//Options for the form. See more under http://www.9kw.eu/grafik/form.html and http://www.9kw.eu/api.html
			imacros_main2 += ""TAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:selfsolve CONTENT=NO\n"";
			imacros_main2 += ""TAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:confirm CONTENT=NO\n"";
			imacros_main2 += ""TAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:case-sensitive CONTENT=NO\n"";
			imacros_main2 += ""TAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:nomd5 CONTENT=YES\n"";
			//We need only numbers for this captcha
			if(find10 > 0 || find9 > 0 || find8 > 0 || find2 > 0){
				imacros_main2 += ""TAG POS=1 TYPE=INPUT:CHECKBOX FORM=ACTION:/index.cgi ATTR=NAME:numeric CONTENT=YES\n"";
			}
			imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:source CONTENT=imacros\n"";
			// recaptcha v2 for non text captcha or recaptcha for text captcha
			if(find10 > 0 || find9 > 0 || find8 > 0 || find2 > 0){
				imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:oldsource CONTENT=recaptchav2\n"";
			}else{
				imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:oldsource CONTENT=recaptcha\n"";
			}
			//The path of the captcha picture saved is assigned to the CONTENT
			if(tempfolder.length > 0){
				imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:file-upload-01 CONTENT=""+tempfolder+tempfile+""\n"";
			}else{
				imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:file-upload-01 CONTENT=""+getiMacrosFolder('DataSources')+'\\'+tempfile+""\n"";
			}
			//Submit the formdata to 9kw.eu
			imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=TYPE:submit\n"";
			//Clean the !EXTRACT variable for the next task
			imacros_main2 += ""SET !EXTRACT NULL\n"";
			//Extract the characters that are recoginzed from the picture of captcha.
			imacros_main2 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:result EXTRACT=TXT\n"";
			iimPlay(imacros_main2)
			var answer = iimGetLastExtract();
			//Step 4: Check the captcha answer (text or nothing like #EANF# = Extraction Anchor Not Found)
			if(answer == ""#EANF#"" || answer == ""ERROR NO USER""){
				answer = """";
			}
			
			//Extract the captchaid from your captcha submit
			var imacros_main3 = ""CODE:"";
			imacros_main3 += ""SET !EXTRACT NULL\n"";
			imacros_main3 += ""TAG POS=1 TYPE=INPUT ATTR=NAME:captchaid EXTRACT=TXT\n"";
			imacros_main3 += ""SET captchaid {{!EXTRACT}}\n"";
			imacros_main3 += ""TAB CLOSE\n"";
			imacros_main3 += ""FRAME F={{frame}}\n"";
			iimPlay(imacros_main3)
			captchaid = iimGetLastExtract();
			
			//Clean the !EXTRACT variable for the next task
			var imacros_main4 = ""SET !EXTRACT NULL\n"";
			iimPlay(imacros_main4)
			
			//Display extracted data (only for debug)
			//iimDisplay(""captchaid: ""+captchaid+""\nanswer: ""+answer)
			
			//Step 5: Fill the recognized characters to the verification box (Click the pictures 1..16)
			if(find10 > 0 || find9 > 0 || find8 > 0 || find2 > 0){
				var nothing = 0;
				var myarray = answer.split('');
				if(myarray.length < 2){
					alert_message(""No answer found. Check the history on 9kw.eu!"");
					if(breakOnError){
						return false;
					}else{
						break;
					}
				}else{
					for(var i = 0;i < myarray.length; i++){
						if(myarray[i].match(/^[0-9]+$/)){
							if(find10 > 0){
								var two_values;
								if(myarray[i+1].match(/^[0-9]+$/)){
									two_values = myarray[i]+myarray[i+1];
								}else{
									two_values = myarray[i];
								}
								i += 1;
								two_values = two_values.replace(""0"", """");
								nothing += SearchOK(""SET !REPLAYSPEED ""+replayspeed_clicks+""\nTAG POS=""+two_values+"" TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=*"",1+higher_frame_number,max_frame_number);
							}else{
								nothing += SearchOK(""SET !REPLAYSPEED ""+replayspeed_clicks+""\nTAG POS=""+myarray[i]+"" TYPE=IMG ATTR=SRC:https://www.google.com/recaptcha/api2/payload?c=*"",1+higher_frame_number,max_frame_number);
							}
						}
					}
					if(nothing < 2){
						alert_message(""Not enough clicks are possible. Check the min/max frame number."");
						if(breakOnError){
							return false;
						}else{
							break;
						}
					}
				}
			}else{//text captcha
				SearchFrame(""TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:default-response CONTENT=""+answer,0+other_frame_number,max_frame_number);				
			}
				
			//Click the Verify button
			if(find10 > 0 || find9 > 0 || find8 > 0 || find2 > 0){
				SearchFrame(""EVENT TYPE=CLICK SELECTOR=\""HTML>BODY>DIV>DIV>DIV:nth-of-type(3)>DIV:nth-of-type(2)>DIV>DIV:nth-of-type(2)>DIV\"" BUTTON=0"",0+other_frame_number,max_frame_number);
			}else{
				SearchFrame(""TAG POS=1 TYPE=DIV ATTR=ID:recaptcha-verify-button"",0+other_frame_number,max_frame_number);			
			}
		}
		wait(1)
		var solved_check = SearchOK(""TAG POS=1 TYPE=SPAN ATTR=ID:recaptcha-anchor&&aria-checked:true CONTENT=EVENT:MOUSEOVER"",1+other_frame_number,max_frame_number);
			
		// Submit
		if(solved_check > 0){
			SearchFrame(mysubmit,0+other_frame_number);
		}else{
			more_correct_solutions = SearchOK(""TAG POS=2 TYPE=DIV ATTR=TXT:Multiple<SP>correct<SP>solutions<SP>required<SP>-<SP>please*&&STYLE: CONTENT=EVENT:MOUSEOVER"",0+other_frame_number);
		}
		
		var imacros_main31 = ""CODE:""+imacros_header;{
			imacros_main31 += ""CLEAR\n"";
			imacros_main31 += ""SET !ERRORIGNORE YES\n"";
			imacros_main31 += ""SET !DATASOURCE C:\\Log\\Step2.csv\n"";
			imacros_main31 += ""SET !LOOP 1\n"";
			imacros_main31 += ""SET !DATASOURCE_LINE {{loop}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.firstname);&&NG-MAXLENGTH:42&&ID:first&&REQUIRED:&&NG-MODEL:user.first_name* CONTENT={{!COL1}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.lastname);&&NG-MAXLENGTH:42&&NG-REQUIRED:true&&NG-MODEL:user.last_name* CONTENT={{!COL2}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.username);&&NG-PATTERN:/^(?![0-9]*$)[a-zA-Z0-9_][a-zA-Z0-9_.]*[a-zA-Z0-9_]$/&&ON-BLURS:username* CONTENT={{!COL3}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=INPUT:PASSWORD FORM=NAME:userForm ATTR=TYPE:password* CONTENT={{!COL4}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);<SP>clearErrors(userForm.email)* CONTENT={{!COL5}}\n"";
			imacros_main31 += ""TAG POS=1 TYPE=BUTTON FORM=NAME:userForm ATTR=CLASS:btn<SP>btn-primary<SP>btnFullWidth<SP>standardBtn<SP>ng-binding&&TYPE:submit&&NG-HIDE:processing\n"";
			imacros_main31 += ""WAIT SECONDS=13\n"";
			iimPlay(imacros_main31)
			}
			
			var imacros_main32 = ""CODE:""+imacros_header;{
			imacros_main31 += ""!TIMEOUT_STEP 3"" + ""\n"";
			imacros_main32 += ""WAIT SECONDS=1\n"";
			imacros_main32 += ""TAG POS=1 TYPE=A ATTR=CLASS:btn-primary<SP>unlocked-button\n""
			imacros_main32 += ""WAIT SECONDS=2\n"";
			imacros_main32 += ""EVENT TYPE=CLICK SELECTOR=\""#areacode\"" BUTTON=0\n""
			imacros_main32 += ""EVENTS TYPE=KEYPRESS SELECTOR=\""#areacode\"" CHARS=\""815\""\n"";
			imacros_main32 += ""WAIT SECONDS=2\n"";
			imacros_main32 += ""EVENT TYPE=CLICK SELECTOR=\""#enterAreaCodeForm>DIV:nth-of-type(2)>INPUT\"" BUTTON=0\n"";
			imacros_main32 += ""WAIT SECONDS=3\n"";
			imacros_main32 += ""EVENT TYPE=CLICK SELECTOR=\""#fb-close-button\"" BUTTON=0\n"";
			imacros_main32 += ""WAIT SECONDS=1\n"";
			iimPlay(imacros_main32)
			}
			
		
		//Step 6: Check and send the captcha feedback back to the captcha service (OK:1, NotOK:2, EN: Right/False, DE: Richtig/Falsch)
		var htmlcode = """";
		if(captchaid.length > 0){
			if(solved_check > 0){
				var imacros_main4b = ""CODE:TAG POS=1 TYPE=DIV ATTR=CLASS:recaptcha-success EXTRACT=TXT\n"";
				iimPlay(imacros_main4b)
				htmlcode = iimGetLastExtract();
			}
		}
						
		var feedback;
		if(htmlcode.match(/Juhu/) || htmlcode.match(/Hooray/) || solved_check > 0 || more_correct_solutions < 1){
			feedback = 1;
		}else{
			feedback = 2;
		}
			
		if(captchaid.length > 0){
			var imacros_main5 = ""CODE:TAB OPEN\n"";
			imacros_main5 += ""TAB T=2\n"";
			imacros_main5 += ""URL GOTO=http://www.9kw.eu/index.cgi?source=imacros&action=usercaptchacorrectback&apikey=""+apikey+""&correct=""+feedback+""&id=""+captchaid+""\n"";
			imacros_main5 += ""TAB CLOSE\n"";
			iimPlay(imacros_main5)
			
			// Cleanup: Delete the old captcha picture
			if(tempfolder.length > 0){
				iimPlay(""CODE:""+imacros_header+""SET !ERRORIGNORE YES\nFILEDELETE NAME=""+tempfolder+tempfile+""\n"");
			}else{
				iimPlay(""CODE:""+imacros_header+""SET !ERRORIGNORE YES\nFILEDELETE NAME=""+getiMacrosFolder('Downloads')+tempfile+""\n"");
			}
		}
		if(feedback == ""1""){
			break;
		}
	}
	return;
}


// random between 1 and 9
function rand(){
	return Math.floor(Math.random()*9) + 1;
}

// wait function like wait(2) for two seconds
function wait(waittime){
	iimPlay(""CODE: WAIT SECONDS=""+waittime+""\n"");
	return;
}

// wait function like wait(2) for two seconds
function getextract(shortcode){
	iimPlay(""CODE: ""+shortcode);
	return iimGetLastExtract();
}

// date functione
function tempfile_date() {
	now = new Date();
	year = """" + now.getFullYear();
	month = """" + (now.getMonth() + 1); if (month.length == 1) { month = ""0"" + month; }
	day = """" + now.getDate(); if (day.length == 1) { day = ""0"" + day; }
	hour = """" + now.getHours(); if (hour.length == 1) { hour = ""0"" + hour; }
	minute = """" + now.getMinutes(); if (minute.length == 1) { minute = ""0"" + minute; }
	second = """" + now.getSeconds(); if (second.length == 1) { second = ""0"" + second; }
	return year + month + day + ""_"" + hour + minute + second;
}

// find frame with true or false as return
function SearchOK(checkcode,firstframenumber,lastframenumber){
	var check = ""CODE:""+""SET !REPLAYSPEED ""+replayspeed+""\n"";
	check += ""SET !ERRORIGNORE YES"" + ""\n"";
	check += ""SET !TIMEOUT_STEP 0"" + ""\n""; 
	check += ""FRAME F={{i}}"" + ""\n""; 
	check += ""SET !ERRORIGNORE NO"" + ""\n"";
			
	if (checkcode != """"){
		check += checkcode + ""\n""; 
	}else{
		return 0;
	}
		
	if(/^\d+$/.test(firstframenumber)) {
		frame = firstframenumber;
	}else{
		frame = 1;
	}
	
	if(/^\d+$/.test(lastframenumber)) {
		frame2 = lastframenumber;
	}else{
		frame2 = total_frame_number;
	}

	for(var i=frame;i<=frame2;i++){
		iimSet(""i"",i)

		if(iimPlay(check) == true){
			return 1;
		}
	}
	return 0;
}

// find frame with the framenumber as return
function SearchFrame(checkcode,firstframenumber){
	var check = ""CODE:""+""SET !REPLAYSPEED ""+replayspeed+""\n"";
	check += ""SET !ERRORIGNORE YES"" + ""\n"";
	check += ""SET !TIMEOUT_STEP 0"" + ""\n""; 
	check += ""FRAME F={{i}}"" + ""\n""; 
	check += ""SET !ERRORIGNORE NO"" + ""\n"";
			
	if (checkcode != """"){
		check += checkcode + ""\n""; 
	}else{
		return 0;
	}
		
	if(/^\d+$/.test(firstframenumber)) {
		frame = firstframenumber;
	}else{
		frame = 1;
	}

	for(var i=frame;i<=total_frame_number;i++){
		iimSet(""i"",i)

		//if the result of the macro is true save frame number and break
		if(iimPlay(check) == true){
			frame = i;
			break;
		}
	}
	//return frame number
	return frame;
}

// Get the imacros folder
function getiMacrosFolder(folderName){
   var pname;
   switch (folderName){
      case ""Macros"" :
         pname = ""defsavepath"";
         break;
      case ""DataSources"" :
         pname = ""defdatapath"";
         break;
      case ""Downloads"" :
         pname = ""defdownpath"";
         break;
      case ""Logs"" :
         pname = ""deflogpath"";
         break;
      default :
         throw folderName + "" is not a valid iMacros folder name"";
         break;
   }
   return imns.Pref.getFilePref(pname).path;
}

// Logfunction
function log_message(msg) {
	var time = new Date().toString().replace(/\s+GMT.*/, '');
	msg = time + ' - ' + msg + '\n';
	var file_o = imns.FIO.openNode(logFilePath);
	imns.FIO.appendTextFile(file_o, msg);
}

// Logfunction
function alert_message(msg){
	if(logFile){
		log_message(msg);
	}

	iimDisplay(msg);

	if(onBreakAlert){
		alert(msg);
	}
}


var imacros_main31 = ""CODE:""+imacros_header;{
         imacros_main31 += ""CLEAR\n"";
         imacros_main31 += ""SET !ERRORIGNORE YES\n"";
         imacros_main31 += ""SET !DATASOURCE C:\\Log\\Step2.csv\n"";
         imacros_main31 += ""SET !LOOP 1\n"";
         imacros_main31 += ""SET !DATASOURCE_LINE {{loop}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.firstname);&&NG-MAXLENGTH:42&&ID:first&&REQUIRED:&&NG-MODEL:user.first_name* CONTENT={{!COL1}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.lastname);&&NG-MAXLENGTH:42&&NG-REQUIRED:true&&NG-MODEL:user.last_name* CONTENT={{!COL2}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);clearErrors(userForm.username);&&NG-PATTERN:/^(?![0-9]*$)[a-zA-Z0-9_][a-zA-Z0-9_.]*[a-zA-Z0-9_]$/&&ON-BLURS:username* CONTENT={{!COL3}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=INPUT:PASSWORD FORM=NAME:userForm ATTR=TYPE:password* CONTENT={{!COL4}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:userForm ATTR=TYPE:text&&NG-FOCUS-ASYNC:movePlaceholder($event);<SP>clearErrors(userForm.email)* CONTENT={{!COL5}}\n"";
         imacros_main31 += ""TAG POS=1 TYPE=BUTTON FORM=NAME:userForm ATTR=CLASS:btn<SP>btn-primary<SP>btnFullWidth<SP>standardBtn<SP>ng-binding&&TYPE:submit&&NG-HIDE:processing\n"";
         imacros_main31 += ""WAIT SECONDS=13\n"";
         iimPlay(imacros_main31)
         }",1
Need to Extract Current URLs from 2 Tabs and Save to CSV,"Hi

Noob here.  I am trying to create a macro that clicks on 2 links in Tab 1 (this I have figured out) ..and saves the 2 currenturls in CSV. (this is the problem)

This is how I've thought about this:

1. Tab 1
2. Find ""First Link"" click on it
3. Tab 2
4. Grab CURRENTURL
5. Go back to Tab 1
6. Find ""Second Link"" click on it
7. Tab 3
8. Grab CURRENTURL
9. Go back to Tab 1

The end result should be 2 different URLs saved in 1 CSV file
Code: Select allVERSION BUILD=8970419 RECORDER=FX
TAB T=1
TAG POS=1 TYPE=A ATTR=TXT:First<SP>Link<SP>*
TAB T=2
ADD !EXTRACT {{!URLCURRENT}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=urls.csv
WAIT SECONDS=0.3
SET !EXTRACT NULL
TAB T=1
TAG POS=1 TYPE=A ATTR=TXT:Second<SP>Link<SP>*
TAB T=3
ADD !EXTRACT {{!URLCURRENT}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=urls.csv
WAIT SECONDS=0.3
TAB T=1

^ This saves the url from Tab 2 TWICE in the CSV file, they should be different URLs (URL from Tab 2 and URL from Tab 3)

Any ideas?",2
Case for the Pros - Help with Looping & Excluding,"I am completely new to Imacros and I might need some help from you 

My plan is to automatically sent a message to specific users on an online marketplace.

I would like to have a script for that which allows me to execute whenever I need it.

First, go to this website: http://www.kapaza.be

Enter a search term: for example ""iphone 4""

Brings you here --> http://www.kapaza.be/nl/belgie?ca=0&l=0 ... =3&ps=&pe=

Then click on the Headline of every single result, scroll down the page and sent me message to the user by filling in: Name, E-Mail, Phone & Question. The Button to sent the message is  ""Verstuur je Bericht"" 

See here --> http://www.kapaza.be/nl/telefonie-acces ... 928109.htm

Now the tricky part comes...

1. How can I skip offers which have certain words in the Offer Headline? ( I only want to contact people who sell something and not those who are looking to buy an Iphone)
- For example words like: ""looking for"", ""Buying"" etc

2. How can I implement a function which checks if a member has already been contacted. I don´t want to sent the same message twice to the same user. I was thinking to save every Offer Headline to an excel / csv file after the member has been contacted. If the script goes into the Offer it checks if Offer Headline is in the csv File. If yes --> skip. Maybe there´s an easier option for this. Any help here is appreciated.

3. How can I run the script over several different pages. I don´t want to stop if the script hits the last result on page 1.

Hope someone is able to help me with this!

Here´s some additional info: 

Working on a Mac OS X (10.9.5)
Browser: Chrome (version 50.0.2661.102 (64-bit))

Thanks a lot ",4
Remove last 4 characters from input text field,"Hi! I am fairly new to iMacros. I am using iMacros to extract some text from title of the page then paste that text in a text box. Currently when I put that extracted text, it gets .mp4 written in it (title contains .mp4). I want to remove '.mp4' and replace it with '.com'
Currently I am doing this:
Code: Select allTAG POS=1 TYPE=INPUT:TEXT FORM=NAME:NoFormName ATTR=ID:videoedit_title EXTRACT=TXT
SET !VAR2 {{!EXTRACT}}
SET !EXTRACT NULL
TAG POS=1 TYPE=TEXTAREA FORM=NAME:NoFormName ATTR=ID:videoedit_description CONTENT=""{{!VAR2}}.com""
wait seconds=2

This adds .com to the end but there is no code to remove .mp4

Any help would be appreciated. Thanks.",4
Blocking Ads or Selecting alternate xpath element,"Imacros Desktop V10 Windows 7 

Intermittent google ad serving is interrupting my script - when the ad is served the required Xpath div changes from 6 to 7. Is there a way of selecting the alternate xpath if the first is not found (i.e. when the ad is served) Or anyway of blocking it? Filtering images doesn't work...

Thanks
Code: Select allVERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
SET !DATASOURCE C:\File.csv
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}
SET !TIMEOUT_STEP 1
SET !ERRORIGNORE YES
'CLEAR
URL GOTO=https://www.endole.co.uk/search/?search=Asset
FILTER TYPE=IMAGES STATUS=ON
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/search/ ATTR=NAME:search CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:/search/ ATTR=CLASS:search_button
WAIT SECONDS=1.206
TAG XPATH=/html/body/div[7]/div[1]/div[6]/div/div[1]/a <!-- Alt Xpath -/html/body/div[7]/div[1]/div[7]/div/div[1]/a  -->
WAIT SECONDS=0.06
TAG POS=1 TYPE=H1 ATTR=* EXTRACT=TXT
TAG POS=3 TYPE=H5 ATTR=* EXTRACT=TXT
TAG POS=5 TYPE=H5 ATTR=* EXTRACT=TXT
TAG POS=6 TYPE=H5 ATTR=* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\ FILE=C:\File.csv",8
click the first link based on search result from CSV,"I need to click a link that isn't based on the text value of that link, so what ever the link will be on each iteration. I have looked at xpath but obviously the value will change each time. Any pointers would be gratefully received.
Code: Select allVERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
SET !DATASOURCE C:\Users\Tom\Desktop\EANF.csv 
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=https://www.endole.co.uk/company/
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/search/ ATTR=NAME:search CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:/search/ ATTR=CLASS:search_button

TAG POS=1 TYPE=A ATTR=TXT:Infosys<SP>Limited 
<!-- This needs to be defined as relating to the result from the CSV -->

TAG POS=10 TYPE=LI ATTR=CLASS:overview_bullet EXTRACT=TXT
TAG POS=11 TYPE=LI ATTR=CLASS:overview_bullet EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\Tom\Desktop FILE=C:\Users\Tom\Desktop\EANFWrite.csv",6
Number of Options in a Select tag,"Hello.. I need to find out how I can get the number of options in a Select tag

For example, the following Select tag has 3 options. I would like to be able to get the value 3 using Imacros and some VBScripting if required..
Code: Select all	<SELECT NAME=""name1"">
		<OPTION VALUE=""value1"" SELECTED>Item1
		<OPTION VALUE=""value2"" >Item2 
		<OPTION VALUE=""value3"" >Item3 
	</SELECT>


thanks",4
URLs,"Hi. Sorry for bad English. As can be substituted for the expression of links to startup on the page would not be tied to a particular site? I need to fill in similar forms.
Code: Select all<code>URL GOTO=http://site.ru/</code>",3
Unable to handle Javascript popup,"hi Team,

In one of my site where I am performing screen scraping. I am unable to handle the code of a popup window.

Issue in detail: Once I click button 1(disable account), a popup is thrown asking for confirmation click button 2(are you sure?). This popup code is written in javascript and I am unable to handle that popup Imacros code. 

Generated code(no luck): 
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:btnOnOff
WAIT SECONDS=1
TAB T=1
ONDIALOG POS=1 BUTTON=NO 

Let me know if you need any more details in this regard. Thank you. 

Regards,
Ashwin",2
TAG selection and input for autogen custom textbox,"Hi Team,

I am using Imacros for one of the web application for screen scraping. 

Issue: Using a tag to select and input text into a hybrid custom text box as described in the screen shot. 

TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:s2id_autogen1

The value for ATTR which in this case is autogen1 randomly changes to something like autogen22/autogen12/autogen18 etc.

Do let me know if you need any more details in this regard. Thank you.",5
Data that is extracted does not change,"Imacros VERSION BUILD=8350307 
Windows 10
Google chrome Version 50.0.2661.87 m (64-bit)

I have setup a rather long macro that extracts data from a website based on the output from a dropdown box and data input section. I require to input information that changes the output however the area that it extracts is the same.

My problem is that the information that is extracted does not change and only appears to extract the first set of inputs out of a total of five inputs.

If i have not explained anything well enough or you need more explanation please ask and i will attempt to add more information to help you answer the problem. I'm a rather new user of this forum with only my second post so any help with the explanations as well would be great, i have pasted the code below for troubleshooting.

Thanks for any help that you can provide.
Code: Select allVERSION BUILD=8340723 RECORDER=CR
'Setting up input data and looping
SET !DATASOURCE Shippinginput.csv 
SET !DATASOURCE_COLUMNS 11
'SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}
SET !EXTRACT_TEST_POPUP NO
SET !TIMEOUT_PAGE 10
SET !ERRORIGNORE YES
'Varible url based on Sku name
'First area code
URL GOTO=http://www.australiandirect.com.au/?rf=kw&kw={{!COL1}}
'Outputting Sku Name
' Reset webpage bypass values to defaults
SET !ERRORIGNORE NO
TAG POS=1 TYPE=P ATTR=TXT:{{!COL1}} Extract=txt
'searching for product using Sku data
'  bypass webpage loading time
SET !TIMEOUT_PAGE 10
TAG POS=1 TYPE=IMG ATTR=SRC:http://www.australiandirect.com.au/assets/thumb/{{!COL1}}*
'Inputing postcode and suburb for first time
WAIT SECONDS=8
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT={{!COL2}}
WAIT SECONDS=8
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%{{!COL3}}*
TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Calculate
WAIT SECONDS=4
'Outputting Standard shipping
' Ignore error incase of extract error
SET !ERRORIGNORE YES
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Std_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Standard Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Std_Shipping EVAL(""var s='{{Std_Shipping_Tmp}}'; var z=s.trim(); z;"")
' Outputting Express shipping
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Express_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Express Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Express_Shipping EVAL(""var s='{{Express_Shipping_Tmp}}'; var z=s.trim(); z;"")
SET !ERRORIGNORE NO
'Inputing postcode and suburb second time
'WAIT SECONDS=8
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT={{!COL4}}
WAIT SECONDS=8
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%{{!COL5}}*
TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Calculate
WAIT SECONDS=4
'Outputting Standard shipping
' Ignore error incase of extract error
SET !ERRORIGNORE YES
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Std_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Standard Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Std_Shipping EVAL(""var s='{{Std_Shipping_Tmp}}'; var z=s.trim(); z;"")
' Outputting Express shipping
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Express_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Express Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Express_Shipping EVAL(""var s='{{Express_Shipping_Tmp}}'; var z=s.trim(); z;"")
SET !ERRORIGNORE NO
'Inputing postcode and suburb for third time
'WAIT SECONDS=8
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT={{!COL6}}
WAIT SECONDS=8
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%{{!COL7}}*
TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Calculate
WAIT SECONDS=4
'Outputting Standard shipping
' Ignore error incase of extract error
SET !ERRORIGNORE YES
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Std_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Standard Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Std_Shipping EVAL(""var s='{{Std_Shipping_Tmp}}'; var z=s.trim(); z;"")
' Outputting Express shipping
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Express_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Express Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Express_Shipping EVAL(""var s='{{Express_Shipping_Tmp}}'; var z=s.trim(); z;"")
SET !ERRORIGNORE NO
'Inputing postcode and suburb for forth time
'WAIT SECONDS=8
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT={{!COL8}}
WAIT SECONDS=8
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%{{!COL9}}*
TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Calculate
WAIT SECONDS=4
'Outputting Standard shipping
' Ignore error incase of extract error
SET !ERRORIGNORE YES
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Std_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Standard Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Std_Shipping EVAL(""var s='{{Std_Shipping_Tmp}}'; var z=s.trim(); z;"")
' Outputting Express shipping
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Express_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Express Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Express_Shipping EVAL(""var s='{{Express_Shipping_Tmp}}'; var z=s.trim(); z;"")
SET !ERRORIGNORE NO
'Inputing postcode and suburb for last time
'WAIT SECONDS=8
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT={{!COL10}}
WAIT SECONDS=8
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%{{!COL11}}*
TAG POS=1 TYPE=BUTTON FORM=NAME:NoFormName ATTR=TXT:Calculate
WAIT SECONDS=4
'Outputting Standard shipping
' Ignore error incase of extract error
SET !ERRORIGNORE YES
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Std_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Standard Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Std_Shipping EVAL(""var s='{{Std_Shipping_Tmp}}'; var z=s.trim(); z;"")
' Outputting Express shipping
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* EXTRACT=TXT
SET Express_Shipping_Tmp EVAL(""var s='{{!EXTRACT}}'; var x,y,z; x=s.split('Express Shipping'); y=x[1].split('- '); z=y[1].substr(0,7); z;"")
SET Express_Shipping EVAL(""var s='{{Express_Shipping_Tmp}}'; var z=s.trim(); z;"")
'Header added manually in the File...
' Reset webpage bypass values to defaults
SET !ERRORIGNORE NO
SET !EXTRACT {{!COL1}}
ADD !EXTRACT {{Std_Shipping}}
ADD !EXTRACT {{Std_Shipping}}
ADD !EXTRACT {{Std_Shipping}}
ADD !EXTRACT {{Std_Shipping}}
ADD !EXTRACT {{Std_Shipping}}
ADD !EXTRACT {{Express_Shipping}}
ADD !EXTRACT {{Express_Shipping}}
ADD !EXTRACT {{Express_Shipping}}
ADD !EXTRACT {{Express_Shipping}}
ADD !EXTRACT {{Express_Shipping}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy}}.csv",2
How to extract this site,"I am finding it very difficult to work out how to re-iterate extracting for this page

1. goto    http://www.vcglr.vic.gov.au/
2. click    Find a current licence  https://liquor.vcglr.vic.gov.au/alarm_i ... m_internet
3. click    Search Now   under Search Temporary Licences
4. input   90110000  into Temporary Licence Number
5. extract results

re-iterate for 90110001  ...  90113500

Recording & Playback does not seem to work I assume due to the hidden items
As a novice IMacro i don't have the skills to solve this
any help would be greatly appreciated

EDIT: I probably still don't have the skills to do this but I got it working enough

thanks 
gregF",3
Extracting data from div,"Hi all,

I have a div which is mentioned below.

File name	         Date	                 Size	              Status	        Download
Status_One	04/18/2016	1245	             Success	Download Button
Status_Two	04/18/2016	12314564	     Success	Download Button
Status_Three	04/18/2016	14587	     Success	Download Button
Status_Four	04/19/2016	789451	     Success	Download Button
Status_Five	04/19/2016	1256              Success        Download Button
Status_Six	        04/19/2016	021	             Success	Download Button
Status_Seven	04/19/2016	45214	     Success	Download Button


I want extract data row by row and after that download the individual file. Please help me.

waiting for the reply.

Thanks,
Sai",3
How to find the position of a special character in a string,"I am only new at iMacro - go easy on me 

I am extracting a block of text which has multiple lines, but I only want the text on the first line.
But how do I use javascript to identify the location of the new line character?

I have tried this: 

SET newlinepos EVAL(""\""{{!EXTRACT}}\"".indexOf(/\\n/);"")

The macro runs happily, but it always returns ""-1"", which I assume means ""not found"".

Any suggestions?",2
Extracting text from a readonly textbox that changes?,"Hi, I'm trying to create a macro where I can loop it and every certain number of minutes it extracts and saves the value.  I'm having some trouble because when I select the textbox and attempt to add the command, it'll fail to do it if the number changes. (Which it's supposed to.)
Code: Select allTAG POS=1 TYPE=INPUT:TEXT ATTR=VALUE:0.00001839 EXTRACT=TXT

this is the line of code that is created when i try to perform the ""extract text"" task. Whenever I try to repeat the entire process it won't save the file afterwards because it can't find the value it's looking for, when I just want it to look in that box and take whatever value is in there. 

I tried doing ATTR=VALUE:* but it still didn't save as either TXT or CSV.. Here is the full code.
Code: Select allVERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
PROXY ADDRESS=[Censored]
SET !EXTRACT_TEST_POPUP NO
SET !TIMEOUT_PAGE 120
URL GOTO=https://www.satoshidice.com/?secret=[Censored]
TAG POS=1 TYPE=LI ATTR=TXT:Invest
WAIT SECONDS=20
'text input activated
TAG POS=1 TYPE=INPUT:TEXT ATTR=VALUE:* EXTRACT=TXT
WAIT SECONDS=2
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy_hhnnss}}.csv

Any help would be greatly appreciated, thanks.",2
Skip steps if text is found,"Hey everyone, I'm trying to find out if it's possible for a section to be skipped if a specific text is found in a webpage. For example, say I have a macro that is going to 10 websites and extracting 10 different items from each page. The first item is either ""skip to next page"" or ""extract all items"", just to be simple. If the ""skip to next page"" is present, instead of extracting the remaining 9 items, that section of the macro is skipped and the macro moves to the next page. If the ""extract all items"" is found, then the remaining 9 items are extracted and the macro would move to the next page. Basically, and IF argument to either continue the macro or skip steps.",5
Clickbank Imacros Script,"Hi everyone, I am pretty new to imacros but have basic knowledge about how it works. I am trying to create a script which will go to clickbank marketplace, copy the title and affiliate link of the product. I tried doing it but I don't know how to make imacros copy the url, title or save the details in csv

Can somebody please help me??

I would really appreciate.

Regards
IndeXer",3
How to start a new sheet on csv using !ONDOWNLOAD,"So, i was downloading .csv files from various websites for some report purpose and was saving it to a desired file name using the ! ONDOWNLOAD command on the iMacros plugin for IE/Chrome. However, i want to start saving these downloaded data on to a new sheet on the same .csv file. Is there some way we can do it using iMacros?

I have searched the internet for a solution, but still no luck. ",2
Scroll Ajax and Extract data,"iMacros for Firefox 9.0.0b2
WIN 10 64
FF 45.0.1

Say I want to get some sneaker's price on a website and the result is dynamic, I have to scroll down if I want to get the data, I have attached my code.

My Code:

TAB T=1
TAB CLOSEALLOTHERS
SET !ERRORIGNORE YES
URL GOTO=https://stockx.com/sneakers/most-popular?view=list
WAIT SECONDS=2
TAG POS={{!LOOP}} TYPE=A ATTR=TXT:*&&HREF:*&&DATA-REACTID:.4.0.1.0.1.2.1.1.1.0:*
WAIT SECONDS=2
TAG POS=1 TYPE=TITLE ATTR=* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Test.csv


If you the run the code it will go to the website and click into each sneaker and get the title and back and get next one and so on and so forth, but there's more sneakers in the list that one has to scroll to see more.

My question is how should I add in the scroll function to make it work?

URL GOTO=javascript:window.scrollBy(0,20000)

^^^this one doesn't work in the sense that it will only scroll down maybe 20 rows more but it doesn't help in the big picture.

Thanks for all of your helps and time and effort!",4
I need to download a lot of xls files(around 10000),"I need to download a lot of xls files(around 10000), and it takes around 30 seconds to finish one downloading routine.
So the total time I need is 10000x30s = 80hours!!! It's a really frustrating number.
I wonder if I can speed up this process?? Thanks in advance",3
Extract Sliding Banners ?,"Hi All,

can anyone point me in the right direction to save screenshots each time a banner image changes ?

below website is what im trying to capture screenshots for..

http://www.autosessive.com/



imacros 11.1495.5175
Windows 8 pro x64
Firefox 44.02 +firefox imacro addon.",4
Scraping data from images? ( NOT captcha ),"Hi,

With the help if iMacros, I was able to download 1000+ .png images that contain CLEARLY written phone numbers.

I want to scrape the text ( numbers ) from the those images to send a mass SMS campaign. What is the best way/tool to get this done?

P.S - I understand that this question is probably irrelevant to iMacros but I am relying on the expertise of the community and hoping to get some recommendations.",6
Captcha img changes when downloaded,"At the moment I'm trying to display a captcha in a message box so I can complete it manually then let it continue automatically, but as I progress I intend to have captchas sent to a Captcha solving site. The problem I've got with one site is I haven't got a direct link to the image. So when I download the captcha I just get a different image to what is still on the webpage. 
It there a way round this?   

http://buxvertise.com/modules/captcha/c ... hp?r=login

I' started with iMacros 3 days ago so apologies if this is a stupid question. Ive searched through older posts but couldnt find anything
regarding it.   

I'm using iMacros version 6.90 with internet explorer 8 on windows 7",5
Selective Search and Export to CSV,"Hello Team,

Firstly, thanks a million for making iMacros. Its the best thing I found to manage my work. I will skip to the query.

Please help me with the problem I am facing. I have reviewed many (really lot of) articles on this forum but my lack of knowledge in programming makes it very tough to understand the technical jargons used, or direct info provided without any explanations on why something needs to be where.

I am sorry, I could not find/understand how to find and sort selective data from one page,, and extract into selected(dedicated) columns to manage my portfolio.
[I use firefox(45.0.1)+iMacros plugin(just installed plugin yesterday so it should be the most/latest available. I use Windows7. I am clueless on programming and hence request you to kindly help me with some comments for the iMacros script that will be shown.]

I have been trying to extract data from only 2 columns of this webpage for randomly selected stocks from this link:
https://www1.nseindia.com/live_market/d ... market.htm

Now the code starts like this:
URL GOTO=https://www1.nseindia.com/live_market/d ... market.htm
‘ The second command below is to be sorting the table by the symbol so that I can review later easily.
TAG POS=1 TYPE=A ATTR=TXT:Symbol

{{Above, the link is first opened and then I sort the table by the Symbol (alphabetically)}}

The problem is when I make an iMarco by selecting the column in the table, it gets a POS<ID> today, and tomorrow it may change.

[For example, when I select ‘BHEL’ as shown below, I get  TAG POS=124 TYPE=TD ATTR=* EXTRACT=TXT.   The problem is the POS124 keeps changing dynamically and there is no way to track them. It can happen monthly or weekly, that the POS124 becomes POS138 tomorrow for that stock.]

I am looking for a few things as listed below:
•	The iMacro should automatically search for the term ‘BHEL’ in the first column and then pull its value(from price column), irrespective of the POS<ID> it holds for this month/week.
•	If I decide to monitor 5 stocks(like shown below in red), the iMacros should automatically push the time-stamp in column1 and then populate the 5stocks’ values in col2/3/4/5/6.
•	The iMacros should run until the system time becomes 3PM. 

Please suggest what scripts need to be added.

Here is a screenshot of the 2 columns.






I would be very very grateful to have any help or suggestions on this one. 

Thank you!",2
Extracting URL,"Hello everyone, I just start to use imacros and I encounter the first problem ...

I would like to extract the URLs of Google results. I want the URLs present on the Google page are extracted , and then go to the next page , etc. Then save them to a .csv file

I found this script on a forum but it hardly works . It extracts the first URL, but for the second URL, it's says #EANF# on notice...Thanks for your help   (sorry my english is very low)
Code: Select allVERSION BUILD=6650406 RECORDER=FX
TAB T=1
SET !ERRORIGNORE YES
SET !ERRORCONTINUE YES
SET !EXTRACT_TEST_POPUP NO
SET !TIMEOUT_STEP 1
URL GOTO=http://google.fr/search?q=seo
TAG POS=1 TYPE=H2 ATTR=CLASS:HD
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv
TAG POS=R1 TYPE=A ATTR=* EXTRACT=HREF
TAG POS=R1 TYPE=SPAN ATTR=CLASS:ALTCTS
SAVEAS TYPE=EXTRACT FOLDER=* FILE=google-scraper.csv

Windows 8, FF 45.0.1, imacros 8.9.6",3
How to copy text from source code of a website???,"I'm facing a problem when I'm using Imacros to copy text from source code of a website. It can not copy. Any one help me plz.
Here 2 picture, 1 



 is browsing popup and 2 



 is source code, I need to copy yellow mark text to another page.",6
How to extract data from table ?,"Hello,
Code: Select allURL GOTO=https://chinesepod.com/tools/glossary/entry/ugly

TAG POS=1 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=1 TYPE=A ATTR=TXT:Download&&HREF:* EXTRACT=HREF

TAG POS=2 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=2 TYPE=A ATTR=TXT:Download&&HREF:* EXTRACT=HREF

TAG POS=3 TYPE=TD ATTR=TXT:* EXTRACT=TXT
TAG POS=3 TYPE=A ATTR=TXT:Download&&HREF:* EXTRACT=HREF

SAVEAS TYPE=EXTRACT FOLDER=E:\ FILE=pinyin.csv
I use this code to extract text and URL but it always extract wrong URL. 

So the text doesn't match the URL. How to fix it ? Thank you very much",4
Extracting from dropdown by xpath,"VERSION BUILD=8961227
WIndows XP
Firefox 40.0.1

Is it possible to extract from dropdown if I mark it by xpath ?
Code: Select allTAG XPATH=""/html/body/div[2]/div/div[4]/div/div[1]/div[6]/div[2]/div[2]/div/div[3]/div/table/tbody/tr[1]/td[3]/select"" CONTENT=%2 EXTRACT=TXT 

I receive:
wrong format of TAG command, line 4 (Error code: -910)

As it is mentioned here -> http://wiki.imacros.net/Data_Extraction ... T_Elements it works for select elements but if it works for select elements marked by xpath ?",7
insert  name of the image,"I need to insert, in the  a.txt  also the  name of the image:  immages_{{!NOW:mmdd_hhnnss}}.jpg


ONDOWNLOAD FOLDER=* FILE=immages_{{!NOW:mmdd_hhnnss}}.jpg
TAG POS=1 TYPE=IMG ATTR=HREF:* CONTENT=EVENT:SAVEITEM
SAVEAS TYPE=EXTRACT FOLDER=* FILE=a.txt


I speak little English, I try to explain, better

Image is renames: 0318_48195648.jpg
It is placed in a.txt 0318_48195648.jpg",3
How to extract a variable number,"Imacros VERSION BUILD=8350307 
Windows 10
Google chrome Version 49.0.2623.87 m (64-bit)

So far i have a simple macro set-up to extract the price of the standard shipping from the webpage, however when i use the record setting it highlights the whole column and displays alot of unnecessary information. After the information is removed and only the price of the shipping remains i want to be able to use the macro to extract the shipping regardless of the two inputs.

If i have not explained anything well enough or you need more explanation please ask and i will attempt to add more information to help you answer the problem. I'm a new user of this forum and of marco so any help with the explanations as well would be great, i have pasted a small portion of the code below for troubleshooting. 

Thanks for any help that you can provide.

VERSION BUILD=8350307 RECORDER=CR
URL GOTO=http://www.australiandirect.com.au/buy/ ... ry/KA12230
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:zip CONTENT=6215
WAIT SECONDS=5
TAG POS=1 TYPE=SELECT ATTR=ID:shloc_selector_cysel CONTENT=%PRESTON<SP>BEACH;WA
TAG POS=1 TYPE=BUTTON ATTR=ID:btn-calculator
TAG POS=1 TYPE=DIV ATTR=TXT:Add<SP>To<SP>Cart<SP>Add<SP>To<SP>Wishlist<SP>Standard<SP>Sh* Extract=txt",8
"Need data extraction to work in the ""loop""","I am hoping someone could advise me on the script below, I am new to this.  I am having 2 issues now: 1) It will do the data extraction part only if I do ""play"", without the loop.  But I want it on a loop.  I need it to pull the entry from a cell on my datasource, enter it on the website, search, and save the result if any, and then do it on a loop moving down each cell. 2) Also, I would like to either have the extraction from each loop saved into one file, or else not save it if there is no result.  I am using the iMacros Browser (trial) in Windows, because I needed the Image wizard for the slider bar and text extraction.   

VERSION BUILD=8881205 RECORDER=FX 
TAB T=1 
'CSV = Comma Separated Values in each line of the file 
SET !DATASOURCE vietnam.csv
'Number of columns in the CSV file. This must be accurate! 
SET !DATASOURCE_COLUMNS 1 
'Start at line 2 to skip the header in the file 
SET !LOOP 1 
'Increase the current position in the file with each loop 
SET !DATASOURCE_LINE {{!LOOP}}
URL GOTO=https://sanctionssearch.ofac.treas.gov/
TAG POS=1 TYPE=IMG ATTR=ID:Slider1_handleImage
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:ctl00$MainContent$Slider1 CONTENT=80
TAG POS=1 TYPE=INPUT:TEXT FORM=ID:aspnetForm ATTR=ID:ctl00_MainContent_txtLastName CONTENT={{!COL1}}
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ID:aspnetForm ATTR=ID:ctl00_MainContent_btnSearch
TAG POS=1 TYPE=DIV ATTR=ID:ctl00_MainContent_pnlResults EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy_hhnnss}}.csv
WAIT SECONDS=3",2
Variable POS TAG in Loop,"MY CONFIG:
iMacros 8.9.6 for Firefox
Firefox 45.0
Mac OSX 10.10.5
Code: Select allTAG POS=1 TYPE=SPAN ATTR=TXT:Optionen
ONDOWNLOAD FOLDER=* FILE=+_{{!NOW:yyyymmdd_hhnnss}} WAIT=YES
TAG POS=36 TYPE=SPAN ATTR=TXT:Herunterladen
TAG POS=55 TYPE=I ATTR=TXT:

TAG POS=1 TYPE=SPAN ATTR=TXT:Optionen
ONDOWNLOAD FOLDER=* FILE=+_{{!NOW:yyyymmdd_hhnnss}} WAIT=YES
TAG POS=38 TYPE=SPAN ATTR=TXT:Herunterladen
TAG POS=55 TYPE=I ATTR=TXT:


I have that variable TAG POS in
Code: Select allTAG POS=36 TYPE=SPAN ATTR=TXT:Herunterladen

and want to build a loop. i dont know how i can solve that.",9
Text Extract - Generate & Visit URL,"Hey Guys, 

i cant get it till an hour. Maybe u can help me. The Problem is of course really easy. 

So i have a small page: 
<html>
 <head>
  <title>PHP-Test</title>
 </head>
 <body>
http://test.de/index.html
</body>.....

and i have a code in imacro:
TAG POS=1 TYPE=body ATTR=* EXTRACT=TXT
SET verification_url {{!EXTRACT}}
URL GOTO={{verification_url}} 

the result in the Browser is always:
www.http.com//test.de/index.html

I cant find my mistake. Maybe you have an idea? 

Thanks & Best Chris!",10
Ondownload retrieves an .aspx file instead of .xls,"Hi,
I am trying to download an .xls file from https://www.altisource.com/MortgageServ ... vices.aspx
When I click manually on the link it downloads correctly. 
When I use OnDownload in a script, I get an .aspx file which looks like the HTML of the page rather than the real download. 
When I script the imacros using DS, same thing.
Has anyone seen this before?

Macros 10.4.28.1074 Windows 7.",4
exclude extracted data from SAVEAS based on criteria ?,"OS: Windows 8.1 64 bit
iMacros 10.0.2

Good day,

My datasource is a .csv that contains the terms I am using to search in a website. The results of searches are individual pages, depending upon the search term.

It happens that for some of the search terms there exist no individual pages and the website where I am searching shows a  ""0 items exist"" message.

iMacros still extracts data according with the its tag positioning and the DOM structure of the ""0 items exist"" page or gets #EANF# in the cases  it does not find a tag match on the page.
Then, iMacros saves the extracted that in a row of the extraction csv.


I wish to exclude from Code: Select allSAVEAS TYPE=EXTRACT .csv the rows that belong to the ""0 items exist"" webpage (in other words my extracted CSV to show only the complete data extracted from the website).

Question:
 How do I prevent the rows from ""items do not exist""  to appear in the EXTRACT csv? 
What is the condition to be placed looking like?

Thank you.",5
read extracted data,"hi 
iam a beginner with imacros and i need help with this point 
i want my script to read an extracted data which i already had 
and compare it with the current data with help of java and if statement  
here is an example :
i have an extracted data ( text ) = ""mywindow""
i want my script to read this text and if my browser window title = the extracted data ""mywindow"" , then stop the script 
iam not asking about if statement i will handle with it 
iam asking about to access tab data and compare it with an text or with already extracted data 
thank you  ",1
"same elements ,different TAG POS=x across webpages. extract?","Question: How to extract data with iMacros from a website whose TAG POS=x of the same element is variable between different webpages?

Dear iMacros community,

I wish to extract data from a website that contains multiple webpages by searching in the website according to a list of keywords defined in a datasource .csv.

iMacros should enter sequentially in each individual page, grab certain elements on each webpage and save data in a csv. The elements to be extracted are the same in between all webpages.

My problem is that the TAG POS=x does not remain the same for an element when moving from webpage to webpage.

e.g on a page a HTML TAG element has TCode: Select allAG POS=95 TYPE=SPAN ATTR=* EXTRACT=TXT, while on other page same HTML TAG element changes to Code: Select allTAG POS=96 TYPE=SPAN ATTR=* EXTRACT=TXT
The only possibility I am thinking would be to pick the elements by their text attribute ( I mean their text).

Question:
Does the TXT parameter like TXT:Manufacturer (or eventually TXT:Manufacturer*) permits the selection without knowing the exact TAG POS=?

Is there other solution to make this kind of an extraction with iMacros?(variable position of the tag for the same html element across pages)

Thank you.",6
Can iMacros extract metadata?,"Hello,

I have a list of URLs that I want to extract metadata from.  I am only concerned with extracting the date from each page:

<meta name=""dc.date.created"" content=""2004-07-23"" />

I want to know when each page was created - but there are hundreds of pages.

Please let me know if this is possible with the software asap.

Thank you.",3
downloading image,"i want to download captcha image from 2captcha.com. but the captcha image location is  like ""data:image/jpeg;base64....."" so couldont download the image.  i downloaded captcha from other websites using imacros but i couldn't download from 2captcha.com.
any solutions plz?",2
Extract information [DONE],"Hello,
i try to build something in imacro but i had now problems.
Before captcha Solving see i this http://i.imgur.com/ghPl7Ng.png and after successfull captcha solving I see this http://i.imgur.com/LwUMRJd.png

Now i want when the extraxt Text ""Your<SP>Investing<SP>account<SP>will<SP>be<SP>credited<SP>"" the same like this ""Your<SP>Investing<SP>account<SP>will<SP>be<SP>credited<SP>"" than there schould be a if than. 
But how work this with this code:
Code: Select all'SEARCH SOURCE=REGEXP:""greencheck.png\"" style=\""display: ([^;]+);"" IGNORE_CASE=YES EXTRACT=""$1""
TAG POS=1 TYPE=IMG ATTR=ID:profit-correct EXTRACT=HTM       [color=#00BF40]-> This i must change in TAG POS=1 TYPE=CENTER ATTR=TXT:Your<SP>Investing<SP>account<SP>will<SP>be<SP>credited<SP>wi* EXTRACT=HTM [/color]
SET !VAR7 {{!EXTRACT}}
SET !EXTRACT NULL
SET !VAR8 EVAL(""if ('{{!VAR7}}'.match(/style=\""display: block/)) {var x = \""1\"";} else {var x = \""2\"";} x;"")      [color=#00FF00]-> But here i do not know and need help[/color]
TAB OPEN
TAB T=2
URL GOTO=http://www.9kw.eu/index.cgi?source=imacros&action=usercaptchacorrectback&apikey={{!VAR2}}&correct={{!VAR8}}&id={{!VAR5}}
WAIT SECONDS=2
TAB CLOSE
TAB T=1 

After this i had an other question: 
I want realaize the same like up, but i want a if than loop when a number is greater than. How i can realize this.

I think that are for you profis very easy but for a dummy difficult. thx for helping!",6
Extract and save to .CSV + LOOP,"VERSION BUILD=11.0.246.4051
Windows 8.1
IE11
Included demo macros work ok
the included VBS sample scripts run ok
encounter the same problm with iMacros IE, Firefox, Chrome

Hello,

It's my 1st macro so being indulgent   
I didn't find solution in Wiki, FAQ and this forum.

My macro is about data extraction and saving into a .CSV
VERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=http://annuaire.agencebio.org/resultats ... activite=0
TAG POS=1 TYPE=A ATTR=TXT:en<SP>savoir<SP>+
TAG POS=2 TYPE=DIV ATTR=CLASS:band_sqr EXTRACT=TXT SET !EXTRACT {{!COL1}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:fn EXTRACT=TXT SET !EXTRACT {{!COL2}}
TAG POS=1 TYPE=DIV ATTR=CLASS:adr EXTRACT=TXT SET !EXTRACT {{!COL3}}
TAG POS=16 TYPE=SPAN ATTR=* EXTRACT=TXT SET !EXTRACT {{!COL4}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:email EXTRACT=TXT SET !EXTRACT {{!COL5}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:url EXTRACT=TXT SET !EXTRACT {{!COL6}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy_hhnnss}}.csv
BACK
TAG POS=2 TYPE=A ATTR=TXT:en<SP>savoir<SP>+
TAG POS=2 TYPE=DIV ATTR=CLASS:band_sqr EXTRACT=TXT SET !EXTRACT {{!COL1}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:fn EXTRACT=TXT SET !EXTRACT {{!COL2}}
TAG POS=1 TYPE=DIV ATTR=CLASS:adr EXTRACT=TXT SET !EXTRACT {{!COL3}}
TAG POS=16 TYPE=SPAN ATTR=* EXTRACT=TXT SET !EXTRACT {{!COL4}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:email EXTRACT=TXT SET !EXTRACT {{!COL5}}
TAG POS=1 TYPE=SPAN ATTR=CLASS:url EXTRACT=TXT SET !EXTRACT {{!COL6}}
SAVEAS TYPE=EXTRACT FOLDER=* FILE=Extract_{{!NOW:ddmmyy_hhnnss}}.csv

etc. etc. (there is x15 "" TAG POS=* TYPE=A ATTR=TXT:en<SP>savoir<SP>+ "" per page)

This website is a directory. My goal is to extract contact informations for each company and save it into an excel file (1 company per line)   
I didn't find command to extract each text element, put each element into an excel column, and save all into a .csv

Many thanks for your help",10
"Extracting  Product Info,Pics,Price to local MSAccessDB","Hi All,
Apologies up front as I am new to iMacros, and Web Data Mining in general.
I'm sure this has been asked before however I did spend a few hours researching and was not able to come up with results.
My particular issue is I have a customer who has a very old ecommerce site.  They don't have the code for it. Dev has been out of touch for many years and I have been tasked to redo the site.  Problem is no code, no DB for product, pricing, pics, etc....  I essentially need to get all the product info with pics of their old site, get it in a database format, then build new site and populate.   
Need to scrape a website that sells truck parts.
Need to extract all product info, graphics, prices to a local MS Access DB

Are there any good iMacro examples?
I will continue to dig further, any help would be appreciated.

Thanks
R",3
Extracting text from one textbox into separated lines.,"VERSION BUILD=8.9.6
Windows 7
Mozilla Firefox 44.0.2
So I have a textbox, which contain this text (example):
facebook.com/12345678910111
facebook.com/23456789101112
facebook.com/34567891011121
After using extraction I always got this (text without line breaks):
""http://facebook.com/12345678910111http: ... 7891011121""
The problem is, that I need iMacros to save text from textbox with line breaks.
I need this 'coz this textbox contains list of FaceBook IDs. After saving them in txt file, I use it as sourcefile for !DATASOURCE, so I can input into searchbox on facebook 1 ID at each loop of iMacros.
Code: Select allTAG POS=1 TYPE=TEXTAREA ATTR=ID:text EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=FBID.txt
Code: Select allSET !DATASOURCE FBID.txt
SET !DATASOURCE_LINE {{!LOOP}}
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:gedit_users_search_inp CONTENT={{!COL1}}

If anyone could help me, I would appreciate.",3
Important Progress iMacros Product Update,"Dear iMacros Customers and Users, 

We are writing to inform you that Progress will be officially discontinuing the Progress iMacros product, with a planned End-Of-Life date of November 30, 2023. 

What does this mean? 
Moving forward, Progress will continue to support the iMacros product and will only provide critical fixes as needed until the EOL date. We will honor all service agreements through the existing term, except for those contracts that go beyond the EOL date. Customers with service agreements that go beyond the EOL date will be contacted separately to discuss their options and next steps. We will continue to offer service agreement renewals that do not exceed the EOL date. 

What are your next steps? 
Please remain on the lookout for more communications from Progress in the coming months, as more information will be made readily available to assist you as you prepare your transition plans. 

If you have additional questions, please email iMacrosInquiries@progress.com 

On behalf of Progress, thank you for your continued partnership and commitment. 

Sincerely,  
The Progress iMacros Team",2
*** Please read this before reporting problems ***,"Post last updated: May 25, 2020.

If you open a new topic (or post for the first time in some existing topic) to report an issue or ask any question, we can respond much faster if your problem description includes the following information (if applicable, not all questions fit to all problems):

1. What version of iMacros are you using?
You find the iMacros version and build information at the top of every macro that you record, for example ""VERSION BUILD=10100795"". Also specify whether you are using a freeware, trial, or licensed version, e.g. Personal Edition. Please test with the latest version.

2. What operating system are you using? (please also specify language)
Example: Windows 10, Windows 8.1, Windows 7, Windows Server 2012R2, English, German, Chinese, ...

3. Which browser(s) are you using? (include version numbers)
Example: Chrome 74.0.3729.13, Firefox 64.0.2, IE 11/10/9, ...

4. Do the included demo macros work ok? 
This test helps us to determine if the problem is a general iMacros issue or is somehow related to a specific website or configuration.

5. If reporting a problem with the iMacros scripting interface, please also test if the included VBS sample scripts run ok.
This test helps us to determine if the iMacros scripting interface installation is ok.

6. If recording or replay fails on a specific website: Can you please post the URL of the web page and/or the macro that creates the problem?
If you cannot post the macro in a public user forum or the website requires a login, can you provide a similar example of the problem on a publicly accessible website?

7. Do you encounter the same problem recording or replaying the macro in different browsers, such as the iMacros browser, Firefox, Chrome, or Internet Explorer? 
Note: If the problem is specific to Firefox or Chrome, please post in either the iMacros for Firefox or iMacros for Chrome sub-forum respectively.

8. Please include any additional information that is relevant to reproducing the issue.
This includes a detailed description of the steps you've tried as well as the specific error codes and messages, macro logs, screen shots, etc. Please upload screenshots and other relevant files directly to the forum and not to a third-party hosting service!

This information allows us to quickly re-create the issue on our test systems and solve it ASAP.

Additional tips when posting

* Please ensure that the content of your post is relevant to the topic and/or forum where you post it.
For example, if you are having a problem extracting data from a web page and are using Firefox, create your post in the Data Extraction and Web Screen Scraping forum rather than the iMacros for Firefox forum (see note #7 above). If you are unsure which forum to post to, use the General Support & Discussions forum.

* Use a topic title that succinctly describes the problem or issue.
Avoid phrases such as ""Please Help"", ""Urgent"", ""Script not working"", etc. and refrain from using all capital letters and exclamation points. Also, double-check that the spelling of the title and body of the post are correct, since this makes it more likely to be found in searches by other users. Most modern browsers automatically check spelling as you type and underline mistakes, so please correct them before submitting your post.

* Don't post the same question to more than one forum.
If you've miscategorized your original post, just click the Exclamation Icon on the right of the post's subject/title line to report it and let us know where you would like it moved or merged.

* Always provide your FCI (Full Config Info), c.f. items 1-3 above, in your original post even if you think it may not be relevant.
Some of our mods may not even respond unless this information is included. Please don't put this information in your signature, because this can change over time and makes it more confusing when reviewing older posts. Include the information directly in the body of the post instead.

* When sharing screenshots or other relevant files, please upload them directly to the forum rather than use a third-party hosting/sharing service.
Too often these services stop functioning or the files become unavailable for whatever reason. Uploading them here ensures that the full context of the post remains consistent over time.

* Take a minute to review your forum notification settings

Thank you for helping us to help you better!",1
Add the current time and date into field,"Hello Newbie here!! I am looking for a way to add the current time and date into a webpage. I recorded a macro and put in the current time and date but when I run the macro obviously it puts in the date it was when I created the macro and not the current date. Below is the macro code. Thanks

TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_1 CONTENT=%2
TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_2 CONTENT=%17
TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_3 CONTENT=%2016
TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_4 CONTENT=%1
TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_5 CONTENT=%:00
TAG POS=1 TYPE=SELECT FORM=NAME:frmDetail ATTR=NAME:Date_6 CONTENT=%PM",1
Help Scraping Photo Titles from Flickr,"I am working on a project to help a photographer archive all of his photo info (namely titles) from Flickr. Here's an example:
https://www.flickr.com/photos/harold_da ... o9j8-7mTZU

I need a script that can:
1. Grab the photo title
2. Grab the photo URL
3. Save everything to a .csv file

Here's what I have so far for the photo title... it is grabbing ""#EANF#"" each time.
Code: Select allVERSION BUILD=8920312 RECORDER=FX
TAB T=1
SET !ERRORIGNORE YES
TAG POS=1 TYPE=H1 ATTR=CLASS:<SP>meta-field<SP>photo-title<SP>&&ID:yui_3_16_0_1_1455545478543_1747
TAG POS=R1 TYPE=H1 ATTR=CLASS:<SP>meta-field<SP>photo-title<SP>&&ID:yui_3_16_0_1_1455545478543_1747* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=/Users/daniel/Desktop FILE=harold.csv

Any idea how I can get this to work?",4
extracting all link in a web page,"i'm trying to extract links in a web page but i only can get one link. can anyone help me to fix my code for extacting all links in it?

VERSION BUILD=8961227 RECORDER=FX
TAB T=1
URL GOTO=https://www.blogger.com/profile/16168795899587474395
TAG POS=1 TYPE=DIV ATTR=CLASS:contents-after-sidebar*
TAG POS=1 TYPE=li ATTR=CLASS:sidebar-item*
TAG POS=R{{!LOOP}} TYPE=A ATTR=HREF:* EXTRACT=HREF

thanks ",3
Data extracting from PDF,"Looking for help creating a script/workflow for extracting data from a PDF and separating the contents based on unique identifiers used as delimitation.

If anyone has experience with this sort of exercise please get in touch with me. Need help ASAP.",2
Commas in Text save as CSV File,"Hi All,
again, sorry for the newb questions.  I really cant find an asnwer on this one however it appears everyone has expereinced but doesnt appear to be solutions or people who answered their own post with a solution but didnt post the solution?  uuhhgg.

anyways,,,  

I am using the iMacros Browser V11.0.246.4051 to attemtp to figure any of this out.  Where I am at now is dealing with scraping a text title that has commas in it.  When it is saved as a CSV file of course it seperates out the words that has commas between them.  For example.

Precut Insulation, Door Skin Damper Kit, Inner

I need this in one column in the CSV File NOT three colums.

There has got to be a way around this?  can someone share a solution how to either eliminate the commas in the text or get iMacros to ignore the commas in the text when saving as CSV file.

Yes I know its comma deliminted,,, if I could change that?  wouldnt know where that option is to change the dleiminters?  even if that is possible?  would it make a difference exporting text to a database?  is that more difficult?   I would think this would be a real common problem and that there would be simple soljutions all over?  any help would be appreciated.  thanks...",2
i can't extract text to a variable in vba,"Code: Select allDim iim, status
Set iim = CreateObject(""imacros"")
status = iim.iimOpen(""-ie"", False)
Dim macro

macro = ""VERSION BUILD=10022823"" + vbNewLine
macro = macro + ""TAB T=1"" + vbNewLine
macro = macro + ""TAB CLOSEALLOTHERS"" + vbNewLine
macro = macro + ""URL GOTO=https://visa.mofa.gov.sa/Omra/addOmraVisa"" + vbNewLine
macro = macro + ""TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:/Omra/addOmraVisa ATTR=NAME:ApplicationNumber CONTENT=66359690"" + vbNewLine
macro = macro + ""TAG POS=1 TYPE=DIV FORM=ACTION:/Omra/addOmraVisa ATTR=TXT:Application<SP>Number<SP>Choose<SP>Saudi<SP>Mission<SP>selectSearch"" + vbNewLine
macro = macro + ""'text input activated"" + vbNewLine
macro = macro + ""TAG POS=1 TYPE=SPAN FORM=ACTION:/Omra/addOmraVisa ATTR=CLASS:t-input"" + vbNewLine
macro = macro + ""TAG POS=1 TYPE=LI ATTR=TXT:Islamabad"" + vbNewLine
macro = macro + ""TAG POS=1 TYPE=BUTTON:SUBMIT FORM=ACTION:/Omra/addOmraVisa ATTR=NAME:CommandName"" + vbNewLine
macro = macro + ""'text input activated"" + vbNewLine
macro = macro + ""TAG POS=3 TYPE=SPAN ATTR=CLASS:addlabel EXTRACT=TXT"" + vbNewLine
macro = macro + ""TAG POS=3 TYPE=SPAN ATTR=CLASS:addlabel EXTRACT=TXT"" + vbNewLine
macro = macro + ""TAG POS=3 TYPE=SPAN ATTR=CLASS:addlabel EXTRACT=TXT"" + vbNewLine
macro = macro + ""TAG POS=3 TYPE=SPAN ATTR=CLASS:addlabel EXTRACT=TXT"" + vbNewLine
Me.Text3.Value = iim.iimgetlastextract(1)

status = iim.iimPlayCode(macro)
i can't copy the EXTRACT=TXT to  me.text3.value thankx in advance",2
Extracting some lines from a website,"Hello guys.
Need some help with a script. I want to extract this messages from this site.

I want to extract the email and the message and put them in csv file and should look like this: ""email@dasdasda.com E-mail address is valid"" Or if the email is invalid it will look like this ""email@dasdasda.com E-mail is invalid""

I tried to extract the text and save it to a file like this
""TAG POS=1 TYPE=TD ATTR=TD:* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=tanana""
but it didint work..
Any suggestions ? Thanks and have a great day you all.


",7
Can't save format,"I am using Windows and tried this macro on Chrome, FF and IE. 
I downloaded iM last night so it's a new version. 

iM changes the source code when I do a 'SAVEAS', compared to when I manually do a 'file' -> 'saveas' -> 'web page html only' in Firefox. It's definitely different. 

How can I make the iMacros 'saveas' be the same as my manual FF save?

My iMacros code is:

URL GOTO=http://www.webpage
SAVEAS TYPE=HTM FOLDER=C:\xampp\htdocs FILE=name.htm",3
Extracting Page Source Information If Present,"VERSION BUILD=8961227 RECORDER=FX
Windows 8.1 Firefox 44.0

Okay, please forgive me for what may end up being very novice questions. I am fairly new to trying to use iMacros. Added it to Chrome a couple years ago but never really tried using it. I just added it to Firefox and am trying to find out if it can even do what I want it to do.

I am trying to use iMacros to search the page HTML source for a specific string. If that string exists I would like for it to extract that string along with the following 60 characters and date and time to append it to a CSV file. The thing is, that string could appear in the source 1 time, 20 times or perhaps not at all. I would then want the macro to wait 10 minutes, refresh the page and do the search all over again. I am looking for what may be subtle differences in if the string is found or not. Though I can determine the differences by analyzing the CSV file later. 

I am successfully able to search the page source with the below code. I have been able to get it to display a popup when the string is found. The problem is that it times out when the string is not found and the loop ends. Also, it is only prompting that the string exists. It is not logging that the string exists in a file for later analysis. I am also only able to extract the exact string, not the following 60 characters. 
Code: Select allVERSION BUILD=8961227 RECORDER=FX
TAB T=1
TAG POS=1 TYPE=INPUT:SUBMIT FORM=NAME:SearchForm ATTR=*
TAG POS=1 TYPE=A ATTR=TXT:More<SP>Dates
SEARCH SOURCE=REGEXP:""(String_Text_To_Find)"" IGNORE_CASE=YES EXTRACT=$1
PROMPT {{!EXTRACT}}

I hope that I provided enough information for someone to be able to answer my question. I guess I want to know if this is even something that iMacros is capable of doing before I put a lot of time in to working through it to only find out it isn't possible. My knowledge of iMacros and the code is very rudimentary right now, but I hope to learn a lot here and reading any resources you could point me to.

Thanks in advance!",2
extract email from text,"Hi,
Thanks for Shugarhttp://stackoverflow.com/users/4270557/shugar in stackoverflow
Code: Select allSET testString ""bla bla bla xyz@mail.com bla bla bla""
SET email EVAL(""'{{testString}}'.match(/(([^<>()[\\]\\\.,;:\\s@\\\""]+(\\.[^<>()[\\]\\\.,;:\\s@\\\""]+)*)|(\\\"".+\\\""))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/g)[0];"")
PROMPT {{email}}

http://stackoverflow.com/questions/3055 ... th-imacros",2
Search for a list of URLs in site and extract to file?,"I need to search my site for several old URLs so they can be updated.  Then, for each URL that's found I need to extract the page URL where it was found and the link text that's displayed.  This all needs to be written to a CSV file  for review.  I'm fairly sure the URL will only appear once on a page and there won't be multiple URLs found on a page, but I can't rule that out.  Ideally the macro could read the URLs I'm searching for from an excel or CSV file (in which case I would need the macro to list which URL was found with the other info mentioned above, but I'm willing to search them individually. I've tried checking the example macros, forums and wiki, but I'm having trouble fitting it all together (haven't used iMacros in a loooong time).  Help or a point in the right direction is appreciated!",7
[solved] Imacro does not extract,"hey all so I've spent hours and hours trying to solve tis but I couldn't...you guys are my last hope:

I want to extract the word style / label of hundreds of words in this dictionary: http://www.oxfordlearnersdictionaries.c ... antagonist

for example in the link above I want the ""(formal)"" to be extracted, but no matter what I do, it won't... here's my code:
Code: Select allURL GOTO=http://www.oxfordlearnersdictionaries.com/definition/english/antagonist
TAG POS=1 TYPE=SPAN ATTR=ID:antagonist__15&&REG:fml&&CLASS:reg EXTRACT=TXT 

I've written more specific ATTR's but were all failures and Imacro won't extract",3
imacros browser crash,"Good evening to everybody,

I have a problem with my iMacros script in iMacros Browser.

I'm using Windows 7

This is the message of the CrashReport.txt:

========================================
2016-01-18 11:54:07Z
iMacros version 10.3.27.5830, IE version 11.0.9600.16428, OS version Microsoft Windows NT 6.1.7601 Service Pack 1

Exception at System.Drawing.Graphics FromHdcInternal(IntPtr)
Memoria insufficiente.
   in System.Drawing.Graphics.FromHdcInternal(IntPtr hdc)
   in System.Drawing.BufferedGraphicsContext.CreateBuffer(IntPtr src, Int32 offsetX, Int32 offsetY, Int32 width, Int32 height)
   in System.Drawing.BufferedGraphicsContext.AllocBuffer(Graphics targetGraphics, IntPtr targetDC, Rectangle targetRectangle)
   in System.Drawing.BufferedGraphicsContext.Allocate(IntPtr targetDC, Rectangle targetRectangle)
   in System.Windows.Forms.Control.WmPaint(Message& m)
   in System.Windows.Forms.Control.WndProc(Message& m)
   in System.Windows.Forms.Label.WndProc(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   in System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)

========================================
2016-01-18 11:54:32Z
iMacros version 10.3.27.5830, IE version 11.0.9600.16428, OS version Microsoft Windows NT 6.1.7601 Service Pack 1

Exception at IntPtr GetCOMIPFromRCW(System.Object, IntPtr, IntPtr ByRef, Boolean ByRef)
Impossibile utilizzare oggetti COM separati dai relativi RCW sottostanti.
   in System.StubHelpers.StubHelpers.GetCOMIPFromRCW(Object objSrc, IntPtr pCPCMD, IntPtr& ppTarget, Boolean& pfNeedsRelease)
   in SHDocVw.WebBrowserClass.PutProperty(String Property, Object vtValue)
   in iMacros.Core.Logic.DirectScreenApi.HKReplay_Stop(WebBrowserClass webBrowser)
   in iMacros.Core.Logic.MacroPlayer.UninitializeDSPlayback(WebBrowserClass webBrowser)
   in iMacros.Core.Logic.MacroPlayer.Play(Macro macro, Boolean blockCommands)
   in iMacros.WinUI.Common.SidebarControl.PlayStart(Func`1 getMacro, Int32 repeatCount)
   in iMacros.WinUI.Common.SidebarControl.PlayStart(String relativePath, Int32 repeatCount)
   in iMacros.WinUI.Common.SidebarControl.#=qw2TiTV0rLGKHkj17Rx2ftltL2UetAgk7i1eWYslwXKQ=(Object #=qBdLLW6tIgV9gex7GuA6ibw==, EventArgs #=qR9TIpSAhK0gAw1hHShpghw==)
   in System.Windows.Forms.Control.OnClick(EventArgs e)
   in System.Windows.Forms.Button.OnClick(EventArgs e)
   in System.Windows.Forms.Button.WndProc(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   in System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)

This is the script Code:

VERSION BUILD=8881205 RECORDER=FX
TAB T=1
SET !ERRORIGNORE YES
SET !TIMEOUT_STEP 0
SET !EXTRACT_TEST_POPUP NO
SET !DATASOURCE prova.csv
SET !DATASOURCE_LINE {{!LOOP}}
'PROMPT {{!COL1}}


FRAME NAME=mainFrame

TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:fSearch ATTR=CLASS:f CONTENT={{!COL1}}
SIZE X=992 Y=735
DS CMD=MOVETO X=460 Y=267 CONTENT=
WAIT SECONDS = 0.1
DS CMD=LDOWN X=460 Y=267 CONTENT=
DS CMD=LUP X=460 Y=267 CONTENT=
DS CMD=MOVETO X=426 Y=294 CONTENT=
DS CMD=MOVETO X=262 Y=344 CONTENT=

WAIT SECONDS = 0.5


DS CMD=MOVETO X=243 Y=344 CONTENT=
DS CMD=MOVETO X=346 Y=352 CONTENT=
DS CMD=RDOWN X=346 Y=352 CONTENT=
DS CMD=RUP X=346 Y=352 CONTENT=
DS CMD=MOVETO X=362 Y=361 CONTENT=
DS CMD=MOVETO X=380 Y=361 CONTENT=
DS CMD=LDOWN X=380 Y=361 CONTENT=
DS CMD=LUP X=380 Y=361 CONTENT=
DS CMD=MOVETO X=215 Y=456 CONTENT=


WAIT SECONDS = 0.5

FRAME NAME=""mainFrame""
TAG POS=1 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=2 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=1 TYPE=SELECT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=3 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=1 TYPE=INPUT ATTR=CLASS:""f fR fD""&&VALUE:* EXTRACT=TXT 
TAG POS=2 TYPE=SELECT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=4 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT 
TAG POS=5 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=6 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=7 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=8 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=9 TYPE=INPUT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=3 TYPE=SELECT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=4 TYPE=SELECT ATTR=CLASS:""f fR""&&VALUE:* EXTRACT=TXT
TAG POS=1 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=2 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=3 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=4 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=5 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=6 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=7 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=8 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=9 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=10 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=11 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=12 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
TAG POS=13 TYPE=DIV ATTR=CLASS:""f fO""&&VALUE:* EXTRACT=TXT
SAVEAS TYPE=EXTRACT FOLDER=* FILE=test.csv

URL GOTO=http://prova.it

WAIT SECONDS = 2

SIZE X=992 Y=735
'DS CMD=MOVETO X=176 Y=526 CONTENT=
'DS CMD=MOVETO X=252 Y=646 CONTENT=
'DS CMD=MOVETO X=202 Y=709 CONTENT=
'DS CMD=MOVETO X=137 Y=726 CONTENT=
'DS CMD=MOVETO X=199 Y=709 CONTENT=
'DS CMD=MOVETO X=140 Y=723 CONTENT=
'DS CMD=MOVETO X=134 Y=723 CONTENT=
'DS CMD=MOVETO X=80 Y=732 CONTENT=
'DS CMD=MOVETO X=48 Y=726 CONTENT=
'DS CMD=MOVETO X=295 Y=723 CONTENT=
'DS CMD=MOVETO X=359 Y=729 CONTENT=
'DS CMD=MOVETO X=167 Y=729 CONTENT=
'DS CMD=MOVETO X=48 Y=728 CONTENT=
DS CMD=MOVETO X=12 Y=725 CONTENT=
DS CMD=MOVETO X=20 Y=725 CONTENT=
DS CMD=LDOWN X=20 Y=725 CONTENT=
DS CMD=MOVETO X=7 Y=726 CONTENT=
DS CMD=LDOWN X=7 Y=726 CONTENT=
DS CMD=LDBLCLK X=7 Y=726 CONTENT=
DS CMD=LDOWN X=7 Y=726 CONTENT=
DS CMD=MOVETO X=58 Y=537 CONTENT=
DS CMD=MOVETO X=61 Y=521 CONTENT=
DS CMD=MOVETO X=51 Y=518 CONTENT=
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOUSEWHEEL X=51 Y=518 CONTENT=120
DS CMD=MOVETO X=50 Y=515 CONTENT=
DS CMD=MOUSEWHEEL X=50 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=50 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=50 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=48 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=48 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=48 Y=515 CONTENT=120
DS CMD=MOUSEWHEEL X=45 Y=514 CONTENT=120
DS CMD=MOUSEWHEEL X=45 Y=514 CONTENT=120
DS CMD=MOUSEWHEEL X=45 Y=514 CONTENT=120
DS CMD=MOVETO X=38 Y=508 CONTENT=
DS CMD=MOUSEWHEEL X=38 Y=508 CONTENT=120
DS CMD=MOUSEWHEEL X=38 Y=508 CONTENT=120
DS CMD=MOUSEWHEEL X=38 Y=508 CONTENT=120
DS CMD=MOUSEWHEEL X=39 Y=507 CONTENT=240
DS CMD=MOUSEWHEEL X=39 Y=507 CONTENT=240
DS CMD=MOUSEWHEEL X=39 Y=507 CONTENT=240
DS CMD=MOVETO X=44 Y=505 CONTENT=
DS CMD=MOVETO X=47 Y=510 CONTENT=
DS CMD=MOVETO X=70 Y=498 CONTENT=
DS CMD=MOVETO X=173 Y=272 CONTENT=
DS CMD=MOVETO X=189 Y=188 CONTENT=
DS CMD=MOVETO X=196 Y=162 CONTENT=
DS CMD=MOUSEWHEEL X=196 Y=162 CONTENT=120
DS CMD=MOUSEWHEEL X=196 Y=162 CONTENT=120
DS CMD=MOUSEWHEEL X=196 Y=162 CONTENT=120
DS CMD=MOUSEWHEEL X=196 Y=156 CONTENT=120
DS CMD=MOUSEWHEEL X=196 Y=156 CONTENT=120
DS CMD=MOUSEWHEEL X=196 Y=156 CONTENT=120
DS CMD=MOVETO X=198 Y=152 CONTENT=
DS CMD=MOUSEWHEEL X=198 Y=152 CONTENT=120
DS CMD=MOUSEWHEEL X=198 Y=152 CONTENT=120
DS CMD=MOUSEWHEEL X=198 Y=152 CONTENT=120
DS CMD=MOVETO X=199 Y=146 CONTENT=
DS CMD=MOVETO X=198 Y=158 CONTENT=
DS CMD=MOVETO X=135 Y=204 CONTENT=
DS CMD=MOVETO X=137 Y=224 CONTENT=
DS CMD=MOVETO X=84 Y=361 CONTENT=
DS CMD=MOVETO X=60 Y=364 CONTENT=
DS CMD=MOVETO X=42 Y=364 CONTENT=
DS CMD=MOVETO X=50 Y=361 CONTENT=
DS CMD=MOVETO X=54 Y=360 CONTENT=
DS CMD=MOVETO X=47 Y=358 CONTENT=
DS CMD=MOVETO X=54 Y=357 CONTENT=
DS CMD=LDOWN X=54 Y=357 CONTENT=
DS CMD=LUP X=54 Y=357 CONTENT=
DS CMD=MOVETO X=73 Y=399 CONTENT=

WAIT SECONDS = 1


Can you help me?

Thanks in advance for the answers.",6
Trim/replace/split extracted htm Before and After.,"Hello,

I'm having trouble trimming/replacing or splitting extracted html, I have tried every code from the forum and nothing seems to be working. I need to get ""Limited stock available."" and replace the text if found with a 1 for csv saving. I was able to remove everything after ""available."" but have no idea how to remove all text before ""Limited"". what's the current way to do this?

TAG POS=1 TYPE=DIV ATTR=CLASS:notices<SP>clear<SP>clearfix EXTRACT=HTM
SET !VAR2 EVAL(""var s=\""{{!VAR1}}\""; s.split(\"" (\"", 1);"")
PROMPT {{!VAR2}}
<div class=""notices clear clearfix"" style=""border: 1px solid blue; border-image: none;"" oldBorder=""undefined"">                             <a class=""notice save"" aria-describedby=""qtip-0"" href=""#"" data-content='Buy <em class=""placeholder"">6</em> of this item for $<em class=""placeholder"">4.77</em> each' data-hasqtip=""0""><span class=""sprite sprite-save""></span></a>                            <a class=""notice av un"" aria-describedby=""qtip-1"" href=""#"" data-content='<div>Limited stock available. (0)<br/><br/> Inventory levels fluctuate throughout the day as products are being received and shipped.  Contact your Customer Service Specialist for further availablity.</div><div style=""margin: 2px 0; padding: 3px 8px; font-weight: bold; color: #FFF; background-color: #8A3C18;"">Availability outside of your region</div><div><span style=""display: inline-block; width: 225px; padding: 0 8px;"">Portland, OR:</span> <span style=""display:inline-block;width:10px;height:10px;background-color:#0F0""></span></div><div><span style=""display: inline-block; width: 225px; padding: 0 8px;"">Denver, CO:</span> <span style=""display:inline-block;width:10px;height:10px;background-color:#0F0""></span></div><div><span style=""display: inline-block; width: 225px; padding: 0 8px;"">Fairless Hills, PA:</span> <span style=""display:inline-block;width:10px;height:10px;background-color:#0F0""></span></div><div style=""margin: 2px 0; padding: 2px; height: 2px; background-color: #8A3C18;""></div><div style=""font-size: 10px; padding: 0 8px;"">Fulfillment from outside of your region may incur additional freight charges. Please contact your Customer Service Specialist for assistance.</div>' data-hasqtip=""1""><span class=""sprite sprite-oos""></span></a>                    </div>

iMacros Browser (x86) Version 10.4.28.1074
IE 11
Windows 8.1",7
Infinite scroll,"Hello,

I want to scrap a site where results are dynamically generated with an infinite scroll (in ajax).
When I arrive on the page, there's only 20 results.
So if I make a TAG POS=30 it doesn't work.

I need to scroll manually the page, then the next results appears and then the TAG POS=30 work.

How can I succeed in scrolling the page automatically with imacros for Firefox ?
I have tried with url goto=javascript:window.scrollBy(0,20000) which I have found on a forum, but it doesn't work too.

Thanks",4
How to extract the link after a specific div,"Hi,


I would like to create a list of link for a newspaper, so i built this macro :
Code: Select allVERSION BUILD=8940826 RECORDER=FX
TAB T=1
SET !ERRORIGNORE YES
SET !LOOP 1
URL GOTO=http://www.lemonde.fr/recherche/?keywords=keyword&qt=recherche_globale&page_num={{!loop}}
TAG POS=1 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=2 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=3 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=4 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=5 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=6 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=7 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=8 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=9 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
TAG POS=10 TYPE=A ATTR=CLASS:grid_3*alpha*obf* EXTRACT=HREF
SAVEAS TYPE=EXTRACT FOLDER=* FILE=links_lemonde.txt
WAIT SECONDS=3


Everything was good at the begining, but then i discover sometimes links are not formated always  with this attribute, so i search the commun symbole:
Code: Select all<article class=""grid_12 alpha enrichi mgt8"">
               <div class=""grid_11 conteneur_fleuve alpha omega"">
                  <a href=""/culture/article/2012/04/02/selection-cd_1679176_3246.html?xtmc=immobilier&xtcr=3463"" class=""grid_3 alpha obf""><img width=""147"" height=""97"" data-item-type=""article"" data-lazyload=""true"" alt=""Sélection CD"" title=""Sélection CD"" class=""lazy-retina"" data-src=""http://s2.lemde.fr/image/2007/03/10/147x97/881629_7_2fa4_les-journalistes-de-la-rubrique-musiques-du_72443f12f62ce8088d1db266472488c7.jpg"" src=""data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="" onload=""lmd.pic(this);"" onerror=""lmd.pic(this);""></a>
                  <div class=""grid_8 omega resultat"">
                                    <h3 class=""txt4_120 ""><a href=""/culture/article/2012/04/02/selection-cd_1679176_3246.html?xtmc=immobilier&xtcr=3463"">Sélection CD</a></h3>
                     <span class=""txt1 signature"">LE MONDE | 9 avril 2012</span>
                     <p class=""txt3"">Chutes de type Niagara glauque (Flowing Down Too Slow), mirages psychédéliques (Domeniche alla periferia dell'impero), corps fantomatiques (Nell'alto dei giorni immobili), trames effilochées (The Nameless City), tous ces moments de désagrégation se doublent paradoxalement d'une irrésistible force...</p>
                  </div>
               </div>
            </article>
            <article class=""grid_12 alpha enrichi mgt8"">
               <div class=""grid_11 conteneur_fleuve alpha omega"">
                                 <div class=""grid_11 omega resultat"">
                     <h3 class=""txt4_120 marqueur_restreint""><a href=""/a-la-une/article/2012/04/09/le-club-des-entrepreneurs-intouchables_1682627_3208.html?xtmc=immobilier&xtcr=3464"">Le club des entrepreneurs intouchables</a></h3>
                     <span class=""txt1 signature"">LE MONDE | 9 avril 2012</span>
                     <p class=""txt3"">Ils appartiennent à la caste la plus méprisée d'Inde et pourtant, aujourd'hui, ils ont réussi dans les affaires. ...Ces quelques centaines de patrons tissent leur réseau et revendiquent leur place parmi l'élite...Ce n'est pas pour sa moquette rouge épaisse, ses moulures au plafond et son volumineux...</p>
                  </div>
               </div>
            </article>
 

I founded that :
Code: Select all<div class=""grid_* omega resultat""><h3 class=""txt4_120 "">

Where  * = 8 or 11 

Here an example page http://www.lemonde.fr/recherche/?keywor ... ge_num=424

So i try to do this modification (and few others) :
Code: Select allTAG POS=1 TYPE=DIV ATTR=CLASS:grid_*omega*resultat&&TXT:HREF*
TAG POS=R1 TYPE=A ATTR=HREF:* EXTRACT=HREF 


But i don't succeed.

So, do you have an idea to help me with this macro?

Thank you",10
Terrible webpage,"Perhaps someone can help me..

There is a terrible webpage that not allow me to use SAVEAS...  This is the link

http://www.supercias.gob.ec/portalinfor ... onista.php

You can try with any ID, for example 0990858322001

Thanks in advance..",2
"Tag a link in a specific div on facebook, LinkshimAsyncLink","Sorry for my english ...
VERSION BUILD=10022823 iMacro browser
       I have some difficult to tag a HREF on facebook page, am able to tag the div to open the post but that open all in the story line, the link of post is hide in a dom process (down key, mouse over and mouse clear reval Href)

i have try on extract txt, with imageclick work but very slow and make some lag

facebook code is complex


(Auto Image Post on the Div)
TAG POS=1 TYPE=DIV ATTR=CLASS:_6l-<SP>__c_

It's it possible make a tag similar this ?  But working lol or with apps id maybe

(Exemple of Expert Recording Extract mode)
TAG POS=1 TYPE=A ATTR=ONCLICK:LinkshimAsyncLink.swap(this,<SP>""https:\/\/www.facebook.com\/l.php?u=https\u00253A\u00252F\u00252Fvs-fb-php-p1.......)"");&&ONMOUSEOVER:LinkshimAsyncLink.swap(this,<SP>""https:\/\/vs-fb-php-p1........"");&&CLASS:_52c6&&STYLE:background-color:<SP>magenta;&&HREF:https://vs-fb-php-p1..........&&TARGET:_blank&&OLDSTYLE:magenta

(But the tag not work when i record in expert)",3
How to extract text by using imacros? Example shown,"How do I extract PETER

from:
Code: Select all<form id=""flagform1"" action=""generator.php"" method=""POST"">
<input id=""flag1"" name=""flagalt"" value=""PETER"" type=""hidden"">
<input name=""generator"" value=""1"" type=""hidden"">
<div class=""btn-group btn-group-justified"">
<a id=""copy1"" data-clipboard-target=""generator1"" title=""Copy"" class=""btn btn-success zeroclipboard-is-hover"">Copy</a>
<a href=""javascript:void(0);"" onclick=""$(this).closest(""form"").submit();"" title=""Flag as invalid"" class=""btn btn-danger"">Flag as invalid</a>
</div>
</form>
I've have this so far:
Code: Select allTAG POS=2 TYPE=form ATTR=flag1:flagalt EXTRACT=TXT
But it wont work!

I'm running Windows 7 Ultimate 64bit.
iMacros for firefox, latest firefox verison 43.0.1",6
"Tag with Direct Screen, Open in new tab","I try make a comande for open a x,y direct click on a new tab, am not realy good for program

So my question is how Tag a element with 
IMAGESEARCH POS=1 IMAGE=sample.png CONFIDENCE=85
DS CMD=MOVETO X={!IMAGEX} Y={!IMAGEY}
...

OR

How extract a HREF from a image validation for open in a new tab 

Ty for help",3
dynamic class; what do I do if the class changes?,"iMacros Version 11.0.246.4051
Browser FireFox 42.0
OS Windows 7 Home Premium - Service Pack 1


CAN I EXTRACT CLASS TYPE?

I don't even know the words to ask or research this as I don't even know how to explain it... 

When I click on one location it may have any of the five random images... it can return any of the following:

TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>yellow_things&&TXT:  EXTRACT=HTM
TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>brown_things&&TXT:  EXTRACT=HTM
TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>red_things&&TXT:      EXTRACT=HTM
TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>blue_things&&TXT:     EXTRACT=HTM
TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>green_things&&TXT:   EXTRACT=HTM
TAG POS=1 TYPE=DIV ATTR=CLASS:cell<SP>image<SP>orange_things&&TXT: EXTRACT=HTM

None of which will provde me with anything to extracted accept "" EXTRACT=HTM "" which returns (yellow_things) in the return string and that could be something that I could use if I new how to regex ""?????_things"" from a long HTM string.

Example return string
<div style=""outline: 1px solid blue;"" class=""cell image green_things""></div>

Question: should I try to regex ""??????_things"" out of the HTM?
Or is there a different method to count how many green_things are on this page?

What I am trying to do... is click ten of these images and extract how many of each colour was found in the list.

Sorry for sounding so dumb.. but I don't know where to begin... can someone provide me with what terms/words/keywords to research so I will know where to start when researching?

This is not on a public page... so I can not provide a link... sorry.",7
How to determine if a button is available,"I'm working on macro (Excel VBA) that will loop through a series of vouchers in PeopleSoft Accounts Payable. After the macro ""saves"" the voucher, it will click on the ""Next in List"" button. This works fine.

The vendor has over 5,000 vouchers. In PeopleSoft AP, only 300 records can be displayed at a time. 

What I want to do is validate the ""Next in List"" button to see if it is grayed out (and not available). If it is grayed out, then I will perform some other action to display the next 300 records.

Is this possible? Can iMacros determine if a button is ""available"" or not?

I'm using iMacros 10.3 and PeopleSoft Accounts Payable 9.1 and Internet Explorer 11.

Thanks for the help.....",2
"If field doesn't exist, how to skip it ?","Im scraping fields Town or Street addresses from my urls.
Sometimes my url doesn't Town or Street fields and when this happens, 
imacros will do ""Tag waiting 6 seconds"" command automatically.

Is it possible to skip Town or Street code if it doesn't exist in url ?
How should I modify my code.  
Code: Select allVERSION BUILD=8601111 RECORDER=FX
SET !ERRORIGNORE YES
SET !EXTRACT_TEST_POPUP NO
SET !DATASOURCE addresses.csv
SET !ENCRYPTION NO
PROXY ADDRESS={{!COL2}}
SET !ENCRYPTION NO
ONLOGIN USER={{!COL3}} PASSWORD={{!COL4}}

TAB T=1
WAIT SECONDS=2
URL GOTO={{!COL1}}

Tag Pos=1 Type=Div Attr=Class:large-4*&&Txt:Street<sp>address Content=Event:MouseOver
Tag Pos=R1 Type=Div Attr=* Extract=Txt
Set street {{!Extract}}
Set !Extract Null
Set FinalVar Eval(""var a = '{{street}}'; if (a != '#EANF#') { b = a; } else { b = 'Not found!'; } b;"")

Tag Pos=1 Type=Div Attr=Class:large-4*&&Txt:Town Content=Event:MouseOver
Tag Pos=R1 Type=Div Attr=* Extract=Txt
Set town {{!Extract}}
Set !Extract Null
Set FinalVar Eval(""var a = '{{town}}'; if (a != '#EANF#') { b = a; } else { b = 'Not found!'; } b;"")

add !extract {{street}}
add !extract {{town}}

SAVEAS TYPE=EXTRACT FOLDER=c:\imacros FILE=test1.csv


Help appreciated !",2
How To Extract A Number From H3 TAG,"Code: Select all<h3 class=""n""> ""2.&nbsp;"" <a href=""/los-angeles-ca/mip/california-hospital-medical-center-457886157?lid=457886157"" data-analytics=""{""target"":""name"",""feature_click"":""""}"" rel="""" itemprop=""name"" class=""business-name"" data-impressed=""1""> text next to the numer i want to extract </a>

(2. Hospital Medical Center)

i want to extract number 2 and to it as anchor. and loop through lists exporting only text without numbers reference to exel file.

help would be appreciated thank you.
Code: Select allTAG POS=3 TYPE=H3 ATTR=TXT:{{!LOOP}}. EXTRACT=TXT
'SET !EXTRACT NULL

TAG POS=R1 TYPE=A ATTR=CLASS:business-name EXTRACT=TXT
TAG POS=R1 TYPE=SPAN ATTR=CLASS:street-address EXTRACT=TXT
TAG POS=R1 TYPE=SPAN ATTR=CLASS:locality EXTRACT=TXT
TAG POS=R1 TYPE=SPAN ATTR=ITEMPROP:addressRegion EXTRACT=TXT
TAG POS=R1 TYPE=SPAN ATTR=ITEMPROP:postalCode EXTRACT=TXT
TAG POS=R1 TYPE=DIV ATTR=CLASS:phones<SP>phone<SP>primary EXTRACT=TXT

SAVEAS TYPE=EXTRACT FOLDER=* FILE=test-2.csv

Tried this but in vain!!",1
Captcha Solutions,"Here one captcha solver support for iMacros from Captcha Solutions http://www.captchasolutions.com/ They solve captchas for as low as $0.0017 per captcha solved.


VERSION BUILD=8820413 RECORDER=FX
TAB T=1

ONDOWNLOAD FOLDER=c:\ FILE=captcha.jpg

TAG POS=1 TYPE=IMG ATTR=HREF:*captcha* CONTENT=EVENT:SAVE_ELEMENT_SCREENSHOT

SET !EXTRACT_TEST_POPUP NO
TAB OPEN
TAB T=2

URL GOTO=http://api.captchasolutions.com/solve
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:http://api.captchasolutions.com/solve ATTR=NAME:p CONTENT=imacros
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:http://api.captchasolutions.com/solve ATTR=NAME:key CONTENT=YOUR_API_KEY_HERE
TAG POS=1 TYPE=INPUT:TEXT FORM=ACTION:http://api.captchasolutions.com/solve ATTR=NAME:secret CONTENT=YOUR_SECRET_KEY_HERE
TAG POS=1 TYPE=INPUT:FILE FORM=ACTION:http://api.captchasolutions.com/solve ATTR=NAME:captcha CONTENT=C:\captcha.jpg
TAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:http://api.captchasolutions.com/solve ATTR=VALUE:Send
wait seconds=5
TAG POS=6 TYPE=TD ATTR=* EXTRACT=TXT
SET !VAR1 {{!EXTRACT}}

TAB CLOSE
TAB T=1

TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:NoFormName ATTR=NAME:captcha CONTENT={{!var1}}",2
Data Replace with EVAL doubt,"When I use only 1 EVAL code, all works fine. See below:

VERSION BUILD=6060703 RECORDER=CR
URL GOTO={{!URLCURRENT}}

SET !EXTRACT_TEST_POPUP NO

TAG POS=1 TYPE=H1 ATTR=TXT:* EXTRACT=TXT
SET !VAR1 {{!EXTRACT}} 
SET !EXTRACT NULL

WAIT SECONDS=1

TAG POS=8 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR2 {{!EXTRACT}} 
SET !EXTRACT NULL

WAIT SECONDS=1

TAG POS=4 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR3 {{!EXTRACT}} 
SET !EXTRACT NULL

WAIT SECONDS=1

TAG POS=12 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR4 {{!EXTRACT}} 
SET !VAR4 EVAL(""var s='{{!EXTRACT}}'; s.replace('Site: ', '');"")

WAIT SECONDS=1

TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR1}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR2}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR3}} here the word ""Site:"" is replaced fine. All the rest is held. perfect!
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR4}}

However, when I use 2 or more EVAL, the text of the first EVAL comes together to the second   See below:

VERSION BUILD=6060703 RECORDER=CR
URL GOTO={{!URLCURRENT}}

SET !EXTRACT_TEST_POPUP NO

TAG POS=1 TYPE=H1 ATTR=TXT:* EXTRACT=TXT
SET !VAR1 {{!EXTRACT}} 
SET !EXTRACT NULL

WAIT SECONDS=1

TAG POS=8 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR2 {{!EXTRACT}} 
SET !EXTRACT NULL

WAIT SECONDS=1

TAG POS=4 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR3 {{!EXTRACT}} 
SET !VAR3 EVAL(""var s='{{!EXTRACT}}'; s.replace('City: ', '');"")

WAIT SECONDS=1

TAG POS=12 TYPE=P ATTR=TXT:* EXTRACT=TXT
SET !VAR4 {{!EXTRACT}} 
SET !VAR4 EVAL(""var s='{{!EXTRACT}}'; s.replace('Site: ', '');"")

WAIT SECONDS=1

TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR1}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR2}}
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR3}} instead replace the prefix City: and held the city name, comes all the code City: name_of_the_city[EXTRACT] site_name 
TAG POS=1 TYPE=INPUT:TEXT FORM=ID_text={{!VAR4}} instead replace the prefix Site: and held the site name, comes all the code City: name_of_the_city[EXTRACT] site_name 

Wrong: City: name_of_the_city[EXTRACT] site_name
Correct: California
Correct: http://www.google.com

Could you, please, help me with some sample code?

Thanks! ",3
How to increment a variable when controlled by loop (SOLVED),"Hi,
How do I increment a variable by 1, starting with 1, when controlled via a loop?

I have 15 records per page (100 pages) I want to extract, via a loop.

I want a save a record number for each record:  1,2,3 ....1500.

If I  Code: Select allSET !VAR1 EVAL(""{{!LOOP}}*{{!VAR5}}"") at the end of the loop, and add 1 to VAR1 after each extraction, that works, except Record#1 is blank and Record#2 is 1

Is there a way to initially set a variable to 1 not 0?

Or is there another way to increment a loop controlled variable, so the first value is 1.

Thanks,  Chris",7
V11 Relative positioniong,"I am using V11 standard under Win 10 with Firefox 41.0.2.
I primarily use iMacros for form filling and this is the first time using the data extracting wizard. I have written a data extract macro using the wizard,  the macro extracts the data okay, but no matter what I have tried(creating anchor tag before extracting) the wizard generates absolute position.
What am I missing?
Ex:
VERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=https://mymonsoon.com/Parcel/Details?up ... 6512&fc=qs
'Set anchor
TAG POS=1 TYPE=SPAN ATTR=TXT:Property<SP>Information
TAG POS=2 TYPE=LABEL ATTR=CLASS:field-label EXTRACT=TXT
TAG POS=6 TYPE=LABEL ATTR=CLASS:monsoon-fielddata EXTRACT=TXT",4
"REGEXP, Can not compile regular expression","I have used the http://gskinner.com/RegExr/ to make this WORKING regular expression:
(?<="")http://mysite.com/.*?(?="") 
It means Search for "" input and exclude it, then search for http://mysite.com/, then search for any chars, ending with "" iput, excluding it.This string match links that refer to mysite.com

But iMacros says error while compiling 
SEARCH SOURCE=REGEXP:""(?<="")http://mysite.com/.*?(?="")"" IGNORE_CASE=YES EXTRACT=$1
Why? ",16
XPATH wiki is wrong,"Browser = FF 42.0
iMacros = 8.9.4
OS = Windows 7 & 10, Mac 10.7.5 - 10.9

The information on this page is wrong. 
http://wiki.imacros.net/XPATH 
This is the solution. 
Code: Select allTAB T=1     
TAB CLOSEALLOTHERS  
URL GOTO=http://demo.imacros.net/Automate/TestForm1
TAG XPATH=""//input[@name='name']"" CONTENT=""Tom Tester""
TAG XPATH=""//select[@name='food']"" CONTENT=$Pizza
TAG XPATH=""//select[@name='drink']"" CONTENT=$Water
TAG XPATH=""//input[@id='small']"" CONTENT=YES
TAG XPATH=""//select[@name='dessert']"" CONTENT=$Apple<SP>Pie:$Fruits
TAG XPATH=""//input[@value='Yes']"" CONTENT=Yes
SET !ENCRYPTION NO
TAG XPATH=""//input[@name='Reg_code']"" CONTENT=""demo123""
TAG XPATH=""//textarea[@name='Remarks']"" CONTENT=""Hi Tom! Sorry, your script didn't work. Hacked by RethinkReality.""
TAG XPATH=""//button[@type='submit']""
WAIT SECONDS=5
URL GOTO=http://demo.imacros.net/Automate/OK
#EDIT: Had extra quotation marks when transferred it from JS to iim, it works now.",2
EXTRACT TOP 30 links in a FACEBOOK Search query result,"Hi Im trying to extract the top 30 posts (links only) facebook search query result and save it to a csv file.

Code: Select allVERSION BUILD=10022823
TAB T=1
TAB CLOSEALLOTHERS
SET !ERRORIGNORE YES
SET !DATASOURCE kwlist.csv
SET !DATASOURCE_COLUMNS 1
SET !DATASOURCE_LINE {{!LOOP}}
SET !VAR1 https://www.facebook.com/search/top/?q=
ADD !VAR1 {{!COL1}}
URL GOTO= {{!VAR1}}
TAG POS={{!LOOP}} TYPE=A ATTR=CLASS:_5pcq EXTRACT=HREF
TAG POS={{!LOOP}} TYPE=ABBR ATTR=CLASS:_5ptz EXTRACT=TITLE
SAVEAS TYPE=EXTRACT FOLDER=C:\Users\KennethPaulNava\Desktop\URL FILE=keys.csv

Somebody please help",5
Extracting Content into specific columns in Excel,"Hi Team,

I managed to pull the content from a web source onto a spreadsheet. But it is all getting displayed in 1 column sequentially. I want to direct the extracted content each into specific columns. Please help me out on this.

Thanks in Advance",6
iMacros will not download file from new tab,"I am trying to download a file from:
http://www.auction.com/event/Southern-C ... lter=reset

If I click on the button for ""Auction Inventory"" manually, the browser opens a new tab which points to this URL, and the file will start to download:
http://www.auction.com/xhr?format=xls&q ... ry_trustee

I can also go directly to that second URL to download the file (bypassing the need to click on ""Auction Inventory"")

However, if I run this in iMacros (10.4, Windows 7) a blank new tab is opened but no file is downloaded. 

Any thoughts?

Thanks!",2
Need help in extracting data,"I have couple of urls like this in excel sheet

http://allcompanieslist.com/Directors/G ... 5PTC083078
http://allcompanieslist.com/Directors/U ... 5PTC083087

So bascially imacros should fetch this url from excel and then extract information like diectors back to excel. Please help


Thanks 
Kumarr",3
Extracting data for flights,"Hello,

I'm trying to use iMacros to extract some data from Google Flights, however I'm not able to extract all the airline names from the cheapest flight, however it only extracts the content from the tooltip even if I'm trying to extract all the text inside the span class ""tooltipUseHtml tooltipLeft"". On this website I would like it to extract the following text: ""JAL, Iberia · Iberia Express"" instead of ""IB 3740 operated by Iberia Express"" as it does at this moment.

Code: Select allTAG POS=1 TYPE=DIV ATTR=CLASS:tooltipContent<SP>HMTHUQB-d-k EXTRACT=TXT

That's the code I'm using but as I said it's not working as expected... Extracting both sentences ""IB 3740 operated by Iberia Express"" and ""JAL, Iberia · Iberia Express"" would also be fine.

Can anybody please help me to get this right?

Thanks for your help!",2
Search and Extract,"Hello I'm trying to figure out how to search a an identifier and scrape an associated cost with it for example I want to search for the ISBN 9781111771577 and extract the amount of ""Total additional charges' I am playing around with the SEARCH SOURCE=REGEXP: Extract function but seem to be unable to use it correctly and normally get an error 'RuntimeError: Source does not match to REGEXP=''9781449635978'', line 7 (Error code: -926)' can anyone help?

Code: Select all<div class=""itemInfoWrapper cf"">
 <div class=""mobpad cf product-data"">
 <a href=""/textbooks/gardners-art-through-the-ages-vol-1-a-global-history-14th-edition/9781111771577"" class=""imglnk""><img src=""https://img.valorebooks.com/H90/97/9781/978111/9781111771577.jpg"" width=""60"" alt=""Gardner's Art through the Ages V..."" /></a>
 <div class=""itemdata"">
 <a href=""/textbooks/gardners-art-through-the-ages-vol-1-a-global-history-14th-edition/9781111771577"" class=""title"">Gardner's Art through the Ages V...</a>
 
[color=#FF0000][b] <span class=""product-data-label"">ISBN-13: 9781111771577</span><br/>[/b][/color]
 
 
 <span class=""product-data-label"">ISBN: 111177157X</span><br/>
 
 <span class=""product-data-label""><span class=""darkBlue"">Status:</span>
 <a class=""itemstatus"" href="""" target=""_blank"">Shipped</a></span><br/>
 <span class=""product-data-label""><span class=""darkBlue"">Shipping:</span> Standard</span><br/>
 <span class=""product-data-label""><span class=""darkBlue"">Condition:</span> Very Good</span><br/>
 
 <span class=""product-data-label clip clip-1-desktop clip-2"">
 <span class=""darkBlue"">Comments:</span>
 <span class=""""> High-quality textbook rentals since 2006. We do not ship to Alaska, Hawaii or any off-shore territories.
 <span class=""clipEllipsis"">&#133; <button class=""defaultLink moreBtn"">more</button></span>
 <button class=""defaultLink lessBtn"">less</button>
 <span class=""clipFill""></span>
 </span>
<tr class=""totalRow darkBlue"">
[color=#FF0000] [b]<td class=""labelCell"" colspan=""2"">Total additional charges:</td>
 <td>$28.92</td>[/b][/color]
 </tr>
 </table>
 <button class=""flat_button purple aclbclose"" type=""button""><span class=""icon-left-open""></span>Back</button>
 </div>",2
Extract data after the last - (dash) from a string,"I had an extracted string for ex: ""The records are: 1-300 301-600 601-900 901-1037"". The length of this string is not constant always. I want only ""1037"" i.e., whatever after last - (dash). I have no knowledge on java. Please write a Eval() code for me to use it in imacros. I had knowledge on writing imacros code except this java code on Eval() to extract as above.
Thanks in advance.",1
Getting house number from address,"Using V11 on win 10 and firefox 42
Trying to split off house number from US address and put in VAR1. US Address format : ""xxxxx E sunny ave"" No zip
I am new to java script so and I have messed with this till I'm out of ideas.
Here is code with URL but that is password protected and since extract pop-up show correct returns correct address I'm pretty sure problem is in Set format.
I get this error
Error -1100: Wrong format of SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s=s.split("" "",1);"") command, at line: 7

VERSION BUILD=10.3.27.5830
TAB T=1
TAB CLOSEALLOTHERS
URL GOTO=https://mymonsoon.com/Parcel/Details?up ... 1067&fc=qs
'Extract address
TAG POS=3 TYPE=DIV ATTR=CLASS:monsoon-fielddata EXTRACT=TXT
'Get house number
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s=s.split("" "",1);"")
PROMPT {{!VAR1}}

Error -1100: Wrong format of SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s=s.split("" "",1);"") command, at line: 7",6
mouse right click script,"hello guys,

i need your help...i m looking for a mouse right click script.

details : 

when i right click on image then a ""view image"" option appears (which is in eight line of window). i want when i click on view image it should be open in new tab on firefox. if any website has 10 image on first page then all the images should be open in new tabs. 

plz guys help me out to get this imacro script.

script for example site : goodfon.su",2
Extracting string of numbers,"I'm using the iMacros Firefox plugin. I would like to be able to extract an order number from a webpage. The order number isn't contained within a tag, so I'm not sure how to do this. This is the bit of code that I'm looking at:
Code: Select all<br>Order Number:3732856<br>

How can I extract ""3732856"" from that?",1
Problem on Download with Google Search Console,"Hi,
I would use IMacro for doing a backup of Search Analytics in Google Search Console. 

I'm trying to record a macro but there is a problem with the download button.
In specific, when I click on the Download Button a window appears, where I can select CVS or Google Docs and after click on ""Ok"".
I've tried to record the macro in different ways but everytime when I run the macro, it doesn't find the ""Google Docs"" item or ""Ok"" that appears only if I click on Download button.

Error:
RuntimeError: element DIV specified by TXT:Google<SP>Docs was not found, line 5 (Error code: -921)

can anyone help me?",1
how to extract the data more accurate and precise.,"Hello friends.
I'm learning extract with iMacros.
The following script that I created.
Code: Select allTAG POS=1 TYPE=IMG ATTR=CLASS:cboxPhoto&&HREF:https://*.*&&ALT:* CONTENT=EVENT:SAVEPICTUREAS
TAG POS=1 TYPE=IMG ATTR=CLASS:cboxPhoto&&HREF:https://*.*&&ALT:*&&TXT:* EXTRACT=HREF
TAG POS=1 TYPE=BUTTON ATTR=TYPE:button&&ID:cboxNext
ONDOWNLOAD FOLDER=D:\Hasil<SP>Scrape\image\ FILE=*
WAIT SECONDS=2
TAG POS=1 TYPE=IMG ATTR=CLASS:cboxPhoto&&HREF:https://*.*&&ALT:* CONTENT=EVENT:SAVEPICTUREAS
TAG POS=1 TYPE=IMG ATTR=CLASS:cboxPhoto&&HREF:https://*.*&&ALT:*&&TXT:* EXTRACT=HREF
TAG POS=1 TYPE=BUTTON ATTR=TYPE:button&&ID:cboxNext
ONDOWNLOAD FOLDER=D:\Hasil<SP>Scrape\image\ FILE=* 
WAIT SECONDS=2

and the result is like this:
Code: Select allhttp://sample.com/img/656757657h576567.jpg
1. csv file in the form of data like this
2. JPG files.

This script has been worked.

The question that makes me confused.
1. how can I generate a csv file which only the file name only, without the full URL. example 656757657h576567.jpg
2. how that can change the file name 656757657h576567.jpg automatically according to the title of the article?

Anyway I use iMacros for Firefox
I use Firefox 42 OS Windows 7, iMacros Version 8.9.4

thank you for willing to help. I hope the day you're getting better.",3
Basic Request - Can't find answer - Extract Data From Pages,"Hi all,

I'm sure this has been discussed before and will be more than happy to go over an older thread but I couldn't find anything matching what i want.  I'm looking to basically go over a directory that has multiple pages in it. I'd like to extract multiple values from pages that look like sheets including different values and have it loop through the pages one by one and extract all the info.  Can someone please help?

Currently Using Firefox 41.0.2  with iMacro installed version: 8.9.4


ps: Thank you admin for the approval!",4
Page not opening,"Hello

I have macros working successfully with two different websites but am having a problem with a third.
When recording the website responds as expected, but when I run the macro it doesn't carry out a page opening.
Obviously it then fails on the next line.
I have removed the remainder of the macro below the fail line, and when this is run it says it has completed successfully, but the last event hasn't happened.
I'm using IE11 and the recording is:

VERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=https://www.XXXXXXXXXXlogin.aspx
TAG POS=1 TYPE=INPUT:TEXT ATTR=NAME:ctl00$ContentPlaceHolder1$txtEmailAddress CONTENT=XXXXXXXXX
SET !ENCRYPTION NO
TAG POS=1 TYPE=INPUT:PASSWORD ATTR=NAME:ctl00$ContentPlaceHolder1$txtpassword CONTENT=XXXXXXXXX
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=NAME:ctl00$ContentPlaceHolder1$btnLogin
TAG POS=1 TYPE=SPAN ATTR=TXT:Go<SP>To<SP>Premium
'New tab opened
TAB T=2
wait seconds=35
TAG POS=3 TYPE=DIV ATTR=TXT:81132633598

(The wait 35 seconds is because this page is slow to open.)

The last line doesn't open the page containing the customer information. During recording when the element is clicked it is highlighted green and the page opens, but during play it is outlined but not highlighted and nothing happens.
Right clicking on the page doesn't offer an Inspect Element option, but using the F12 pointer the element is highlighted as:

<div title=""81132633598"" style=""width: 62px; height: 13px; vertical-align: middle;"" unselectable=""on"">81132633598</div>
Unfortunately I can't post the website details.

Hope someone may be able to help.
TIA",2
loop through drop down selection,"VERSION BUILD=8940826 RECORDER=FX
firefox 41.0.2
WIN: 8.1 Pro
------------------------------------------------

Hello,
I am looking for a way to loop  through a dropdown menu and each time, select one item, do a task afterwards and then select the next item, do the same task and so on, until all items were selected.
I searched the forum and found this:
The best approach would be to loop until you get #EANF#, meaning that there are no further entries to be extracted.


I do not really know how to realize this as iim.
In case I need scripting (VBS), could you help me?
Thanks in advance",4
Eval(),"OS : Windows 7 Ultimate 64 bits
FF 41.0.2
Imacros

Good afternoon , is there any way I can extract part of the html ID and insert into another ?

Ex :
Code: Select allVERSION BUILD=8940826 RECORDER=FX
TAB T=1
URL GOTO=http://192.168.0.254/heaven/menu/menu.php
TAG POS=1 TYPE=A ATTR=ID:item_210
FRAME NAME=""menu_iframe""
TAG POS=1 TYPE=IMG ATTR=ID:id_img_pesq_top
TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:F1 ATTR=ID:SC_idcliente CONTENT=520
TAG POS=1 TYPE=IMG ATTR=ID:id_img_sc_b_pesq_bot
TAG POS=1 TYPE=IMG ATTR=SRC:http://192.168.0.254/heaven/_lib/img/sys__NM__sys__NM__nm_primeiro_tec_bmd_edit.gif
TAG POS=1 TYPE=A ATTR=TXT:Financeiro*
FRAME NAME=""mnuClientes_iframe""
TAG POS=1 TYPE=SPAN ATTR=ID:id_sc_field_datavencimento_*&&TXT:*/11/2015 EXTRACT=TXT
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; if(s = */11/2015){MacroError(\""TRUE\"");} else {MacroError(\""FALSE\"");};"")
SET !EXTRACT NULL
PROMPT {{!VAR1}}
Code: Select allTAG POS=1 TYPE=SPAN ATTR=ID:id_sc_field_datavencimento_*&&TXT:*/11/2015 EXTRACT=TXT

In that part of the code takes any text containing / 11/2014 in which id_sc_field_datavencimento_*

That is, I want to extract what is in the * add and elsewhere

EX :
Code: Select allvar x = EXTRACT value of *
var y = id_test_

if x = 1 or 2 or 3 or 4 then
y = y + x


Another question

I can use the * in eval ?

SET !VAR1 EVAL(
""var s=\""{{!EXTRACT}}\"";
if(s = */11/2015){MacroError(\""TRUE\"");}
else 
{MacroError(\""FALSE\"");};"")",2
Automatically downloading vCard .vcf's,"I have a webpage with up to 150 vCard files. I'd like to download them automatically into iMacros folder. 

I've chased this around for hours, FAQ coverage of ONDOWNLOAD command seems sparse. 

I am a self-admitted total noob at macros and scripting. I'm sure this is something simple I am missing from my inexperience. Any assistance would be appreciated. Thanks 

Here's the variations I have tried.
Code: Select allVERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=URL OF SITE
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR>TD>TABLE>TBODY>TR>TD>H4>SELECT"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR>TD>TABLE>TBODY>TR>TD>H4>SELECT>OPTION:nth-of-type(11)"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""#as_keyword"" BUTTON=0
EVENTS TYPE=KEYPRESS SELECTOR=""#as_keyword"" CHARS=""__""
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR>TD>TABLE>TBODY>TR>TD>H4>INPUT:nth-of-type(2)"" BUTTON=0
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR:nth-of-type(6)>TD>TABLE>TBODY>TR:nth-of-type(2)>TD:nth-of-type(8)>H5>A:nth-of-type(2)"" BUTTON=0
'New tab opened
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR:nth-of-type(6)>TD>TABLE>TBODY>TR:nth-of-type(3)>TD:nth-of-type(8)>H5>A:nth-of-type(2)"" BUTTON=0
'New tab opened
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR:nth-of-type(6)>TD>TABLE>TBODY>TR:nth-of-type(4)>TD:nth-of-type(8)>H5>A:nth-of-type(2)"" BUTTON=0
'New tab opened
EVENT TYPE=CLICK SELECTOR=""HTML>BODY>TABLE:nth-of-type(4)>TBODY>TR>TD>TABLE:nth-of-type(2)>TBODY>TR>TD>TABLE>TBODY>TR:nth-of-type(6)>TD>TABLE>TBODY>TR:nth-of-type(5)>TD:nth-of-type(8)>H5>A:nth-of-type(2)"" BUTTON=0
'New tab opened 
Code: Select allVERSION BUILD=11.0.246.4051
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
URL GOTO=WEB URL
TAG POS=1 TYPE=SELECT ATTR=TXT:Company<SP>Name<SP>City<SP>State<SP>Zip<SP>Code<SP>Country<SP>Phone<SP>Toll<SP>Free<SP>Phone<SP>Mobile<SP>First<SP>Nam*&&CLASS:input_form&&STYLE:z-index:<SP>20;&&NAME:as_field CONTENT=%email
TAG POS=1 TYPE=INPUT:TEXT ATTR=ID:as_keyword&&CLASS:input_form&&SIZE:15&&NAME:as_keyword CONTENT=__
TAG POS=1 TYPE=INPUT:SUBMIT ATTR=ONCLICK:return<SP>checkSearchKeyword(document.search_form.as_keyword.value);&&CLASS:button_submit_grey&&TYPE:submit&&VALUE:Search
TAG POS=1 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=2 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=3 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=4 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=5 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=6 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=7 TYPE=A ATTR=TXT:vCard
ONDOWNLOAD FOLDER=* FILE=* WAIT=NO
TAG POS=8 TYPE=A ATTR=TXT:vCard
TAG POS=9 TYPE=A ATTR=TXT:vCard
TAG POS=10 TYPE=A ATTR=TXT:vCard
TAG POS=11 TYPE=A ATTR=TXT:vCard
TAG POS=12 TYPE=A ATTR=TXT:vCard
TAG POS=13 TYPE=A ATTR=TXT:vCard
TAG POS=14 TYPE=A ATTR=TXT:vCard",1
I want to copy something from addressbar,"Hi guys 

I am very new on iMacro.I want to extract a URL only copy something from URL and paste it on another tab.Such as

My url look like  http://indianvisa-bangladesh.nic.in/vis ... %205%20min.

I just copy 6 digit 2C4DD6 which is called OTP from url and paset it another TAB

Please help me.


I have this command it copy from body but I want copy from Address bar

TAG POS=1 TYPE=INPUT:SUBMIT FORM=NAME:OnlineForm ATTR=ID:btn2
TAG POS=4 TYPE=TD ATTR=* EXTRACT=TXT
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s.split(' ')[9];"")
SET !VAR2 EVAL(""var parts = \""{{!VAR1}}\"".split(\"".\""); parts[parts.length-2];"")
SET !VAR2 EVAL(""if (\""{{!VAR2}}\"" == '#EANF#') ''; else \""{{!VAR2}}\"";"")
TAB T=3
SET !ENCRYPTION NO
TAG POS=1 TYPE=INPUT:PASSWORD FORM=NAME:OnlineForm ATTR=ID:otp CONTENT={{!VAR2}}
SET !EXTRACT NULL
TAG POS=1 TYPE=INPUT:SUBMIT FORM=NAME:OnlineForm ATTR=ID:btn",2
Removing all characters before first dash (-) in a string,"We have been inserting a user ID before our users email address and now need to remove these users IDs. I need to remove the all characters before the first dash (including the first dash) in this field and then paste it back with just the email.

They could be formatted like this: 1370546521-james-bond123@yahoo.com
Need the result to be: james-bond123@yahoo.com

I have iMacros 8.9.4, Firefox 40.0.3 and Windows 7 and have been using the following function to remove some leading XXXX's before a credit card number and thought I could build on it:

TAG POS=1 TYPE=INPUT:TEXT FORM=NAME:aspnetForm ATTR=ID:ctl00_MainContent_ucCustomerProfile_tbEmail EXTRACT=TXT
SET !VAR1 EVAL(""var s=\""{{!EXTRACT}}\""; s.replace(/[XXXX]+/g,'')"")
SET !EXTRACT NULL

I have been messing with the EVAL function and havent been able to get something working. I would really appreciate any help, thanks ahead of time!",4
SAVEAS after a loop of extract commands,"Hi,

I am building a scraper tool which is extracting a handful of attributes from a webpage. The plan is to loop through a series of webpages using a CSV input and looping through the commands.

I have written the macro which works apart from one issue. The SAVEAS command is included in the loop, which outputs multiple files. I would like the SAVEAS to sit out side the loop to be executed at the end, so that there is a single output file with a row of many items (such as the wiki example: ""item1"", ""item2"", ""item 3"", ... ).

The macro as I have it now is as follows, can anyone help?
Code: Select allVERSION BUILD=8940826 RECORDER=FX
TAB T=1
TAB CLOSEALLOTHERS
SET !PLAYBACKDELAY 0.2
SET !EXTRACT_TEST_POPUP NO

SET !DATASOURCE urllist.csv
SET !DATASOURCE_COLUMNS 1
SET !LOOP 2
SET !DATASOURCE_LINE {{!LOOP}}


URL GOTO={{!COL1}}
ADD !EXTRACT {{!URLCURRENT}}
TAG POS=1 TYPE=A ATTR=TXT:view
TAG POS=8 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=14 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=24 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=26 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=28 TYPE=TD ATTR=* EXTRACT=TXT
TAG POS=30 TYPE=TD ATTR=* EXTRACT=TXT



SAVEAS TYPE=EXTRACT FOLDER=* FILE=extract-v7_LOOP{{!NOW:yymmdd_hhnnss}}.csv


Thanks,
Larry",3
